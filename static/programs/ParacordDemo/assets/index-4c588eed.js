var wn=Object.defineProperty;var En=(et,tt,rt)=>tt in et?wn(et,tt,{enumerable:!0,configurable:!0,writable:!0,value:rt}):et[tt]=rt;var Tn=(et,tt)=>()=>(tt||et((tt={exports:{}}).exports,tt),tt.exports);var xr=(et,tt,rt)=>(En(et,typeof tt!="symbol"?tt+"":tt,rt),rt);var An=Tn((exports,module)=>{(async()=>{(function(){const et=document.createElement("link").relList;if(et&&et.supports&&et.supports("modulepreload"))return;for(const nt of document.querySelectorAll('link[rel="modulepreload"]'))rt(nt);new MutationObserver(nt=>{for(const it of nt)if(it.type==="childList")for(const ot of it.addedNodes)ot.tagName==="LINK"&&ot.rel==="modulepreload"&&rt(ot)}).observe(document,{childList:!0,subtree:!0});function tt(nt){const it={};return nt.integrity&&(it.integrity=nt.integrity),nt.referrerPolicy&&(it.referrerPolicy=nt.referrerPolicy),nt.crossOrigin==="use-credentials"?it.credentials="include":nt.crossOrigin==="anonymous"?it.credentials="omit":it.credentials="same-origin",it}function rt(nt){if(nt.ep)return;nt.ep=!0;const it=tt(nt);fetch(nt.href,it)}})();var n$3,l$3,u$4,i$1,t$5,o$2,r$4,f$3,e$3,c$3={},s$3=[],a$1=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,v$5=Array.isArray;function h$5(et,tt){for(var rt in tt)et[rt]=tt[rt];return et}function p$6(et){var tt=et.parentNode;tt&&tt.removeChild(et)}function y$4(et,tt,rt){var nt,it,ot,st={};for(ot in tt)ot=="key"?nt=tt[ot]:ot=="ref"?it=tt[ot]:st[ot]=tt[ot];if(arguments.length>2&&(st.children=arguments.length>3?n$3.call(arguments,2):rt),typeof et=="function"&&et.defaultProps!=null)for(ot in et.defaultProps)st[ot]===void 0&&(st[ot]=et.defaultProps[ot]);return d$3(et,st,nt,it,null)}function d$3(et,tt,rt,nt,it){var ot={type:et,props:tt,key:rt,ref:nt,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:it??++u$4};return it==null&&l$3.vnode!=null&&l$3.vnode(ot),ot}function _$3(){return{current:null}}function k$6(et){return et.children}function b$5(et,tt){this.props=et,this.context=tt}function g$5(et,tt){if(tt==null)return et.__?g$5(et.__,et.__.__k.indexOf(et)+1):null;for(var rt;tt<et.__k.length;tt++)if((rt=et.__k[tt])!=null&&rt.__e!=null)return rt.__e;return typeof et.type=="function"?g$5(et):null}function m$5(et){var tt,rt;if((et=et.__)!=null&&et.__c!=null){for(et.__e=et.__c.base=null,tt=0;tt<et.__k.length;tt++)if((rt=et.__k[tt])!=null&&rt.__e!=null){et.__e=et.__c.base=rt.__e;break}return m$5(et)}}function w$6(et){(!et.__d&&(et.__d=!0)&&t$5.push(et)&&!x$5.__r++||o$2!==l$3.debounceRendering)&&((o$2=l$3.debounceRendering)||r$4)(x$5)}function x$5(){var et,tt,rt,nt,it,ot,st,at;for(t$5.sort(f$3);et=t$5.shift();)et.__d&&(tt=t$5.length,nt=void 0,it=void 0,st=(ot=(rt=et).__v).__e,(at=rt.__P)&&(nt=[],(it=h$5({},ot)).__v=ot.__v+1,L$4(at,ot,it,rt.__n,at.ownerSVGElement!==void 0,ot.__h!=null?[st]:null,nt,st??g$5(ot),ot.__h),M$3(nt,ot),ot.__e!=st&&m$5(ot)),t$5.length>tt&&t$5.sort(f$3));x$5.__r=0}function P$2(et,tt,rt,nt,it,ot,st,at,ct,ut){var lt,ht,ft,dt,pt,gt,_t,mt=nt&&nt.__k||s$3,At=mt.length;for(rt.__k=[],lt=0;lt<tt.length;lt++)if((dt=rt.__k[lt]=(dt=tt[lt])==null||typeof dt=="boolean"||typeof dt=="function"?null:typeof dt=="string"||typeof dt=="number"||typeof dt=="bigint"?d$3(null,dt,null,null,dt):v$5(dt)?d$3(k$6,{children:dt},null,null,null):dt.__b>0?d$3(dt.type,dt.props,dt.key,dt.ref?dt.ref:null,dt.__v):dt)!=null){if(dt.__=rt,dt.__b=rt.__b+1,(ft=mt[lt])===null||ft&&dt.key==ft.key&&dt.type===ft.type)mt[lt]=void 0;else for(ht=0;ht<At;ht++){if((ft=mt[ht])&&dt.key==ft.key&&dt.type===ft.type){mt[ht]=void 0;break}ft=null}L$4(et,dt,ft=ft||c$3,it,ot,st,at,ct,ut),pt=dt.__e,(ht=dt.ref)&&ft.ref!=ht&&(_t||(_t=[]),ft.ref&&_t.push(ft.ref,null,dt),_t.push(ht,dt.__c||pt,dt)),pt!=null?(gt==null&&(gt=pt),typeof dt.type=="function"&&dt.__k===ft.__k?dt.__d=ct=C$3(dt,ct,et):ct=$$2(et,dt,ft,mt,pt,ct),typeof rt.type=="function"&&(rt.__d=ct)):ct&&ft.__e==ct&&ct.parentNode!=et&&(ct=g$5(ft))}for(rt.__e=gt,lt=At;lt--;)mt[lt]!=null&&(typeof rt.type=="function"&&mt[lt].__e!=null&&mt[lt].__e==rt.__d&&(rt.__d=A$4(nt).nextSibling),q$6(mt[lt],mt[lt]));if(_t)for(lt=0;lt<_t.length;lt++)O$1(_t[lt],_t[++lt],_t[++lt])}function C$3(et,tt,rt){for(var nt,it=et.__k,ot=0;it&&ot<it.length;ot++)(nt=it[ot])&&(nt.__=et,tt=typeof nt.type=="function"?C$3(nt,tt,rt):$$2(rt,nt,nt,it,nt.__e,tt));return tt}function S$2(et,tt){return tt=tt||[],et==null||typeof et=="boolean"||(v$5(et)?et.some(function(rt){S$2(rt,tt)}):tt.push(et)),tt}function $$2(et,tt,rt,nt,it,ot){var st,at,ct;if(tt.__d!==void 0)st=tt.__d,tt.__d=void 0;else if(rt==null||it!=ot||it.parentNode==null)t:if(ot==null||ot.parentNode!==et)et.appendChild(it),st=null;else{for(at=ot,ct=0;(at=at.nextSibling)&&ct<nt.length;ct+=1)if(at==it)break t;et.insertBefore(it,ot),st=ot}return st!==void 0?st:it.nextSibling}function A$4(et){var tt,rt,nt;if(et.type==null||typeof et.type=="string")return et.__e;if(et.__k){for(tt=et.__k.length-1;tt>=0;tt--)if((rt=et.__k[tt])&&(nt=A$4(rt)))return nt}return null}function H$3(et,tt,rt,nt,it){var ot;for(ot in rt)ot==="children"||ot==="key"||ot in tt||T$3(et,ot,null,rt[ot],nt);for(ot in tt)it&&typeof tt[ot]!="function"||ot==="children"||ot==="key"||ot==="value"||ot==="checked"||rt[ot]===tt[ot]||T$3(et,ot,tt[ot],rt[ot],nt)}function I$3(et,tt,rt){tt[0]==="-"?et.setProperty(tt,rt??""):et[tt]=rt==null?"":typeof rt!="number"||a$1.test(tt)?rt:rt+"px"}function T$3(et,tt,rt,nt,it){var ot;t:if(tt==="style")if(typeof rt=="string")et.style.cssText=rt;else{if(typeof nt=="string"&&(et.style.cssText=nt=""),nt)for(tt in nt)rt&&tt in rt||I$3(et.style,tt,"");if(rt)for(tt in rt)nt&&rt[tt]===nt[tt]||I$3(et.style,tt,rt[tt])}else if(tt[0]==="o"&&tt[1]==="n")ot=tt!==(tt=tt.replace(/Capture$/,"")),tt=tt.toLowerCase()in et?tt.toLowerCase().slice(2):tt.slice(2),et.l||(et.l={}),et.l[tt+ot]=rt,rt?nt||et.addEventListener(tt,ot?z$5:j$3,ot):et.removeEventListener(tt,ot?z$5:j$3,ot);else if(tt!=="dangerouslySetInnerHTML"){if(it)tt=tt.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(tt!=="width"&&tt!=="height"&&tt!=="href"&&tt!=="list"&&tt!=="form"&&tt!=="tabIndex"&&tt!=="download"&&tt!=="rowSpan"&&tt!=="colSpan"&&tt in et)try{et[tt]=rt??"";break t}catch{}typeof rt=="function"||(rt==null||rt===!1&&tt[4]!=="-"?et.removeAttribute(tt):et.setAttribute(tt,rt))}}function j$3(et){return this.l[et.type+!1](l$3.event?l$3.event(et):et)}function z$5(et){return this.l[et.type+!0](l$3.event?l$3.event(et):et)}function L$4(et,tt,rt,nt,it,ot,st,at,ct){var ut,lt,ht,ft,dt,pt,gt,_t,mt,At,It,Mt,kt,Ct,Ut,Wt=tt.type;if(tt.constructor!==void 0)return null;rt.__h!=null&&(ct=rt.__h,at=tt.__e=rt.__e,tt.__h=null,ot=[at]),(ut=l$3.__b)&&ut(tt);try{t:if(typeof Wt=="function"){if(_t=tt.props,mt=(ut=Wt.contextType)&&nt[ut.__c],At=ut?mt?mt.props.value:ut.__:nt,rt.__c?gt=(lt=tt.__c=rt.__c).__=lt.__E:("prototype"in Wt&&Wt.prototype.render?tt.__c=lt=new Wt(_t,At):(tt.__c=lt=new b$5(_t,At),lt.constructor=Wt,lt.render=B$3),mt&&mt.sub(lt),lt.props=_t,lt.state||(lt.state={}),lt.context=At,lt.__n=nt,ht=lt.__d=!0,lt.__h=[],lt._sb=[]),lt.__s==null&&(lt.__s=lt.state),Wt.getDerivedStateFromProps!=null&&(lt.__s==lt.state&&(lt.__s=h$5({},lt.__s)),h$5(lt.__s,Wt.getDerivedStateFromProps(_t,lt.__s))),ft=lt.props,dt=lt.state,lt.__v=tt,ht)Wt.getDerivedStateFromProps==null&&lt.componentWillMount!=null&&lt.componentWillMount(),lt.componentDidMount!=null&&lt.__h.push(lt.componentDidMount);else{if(Wt.getDerivedStateFromProps==null&&_t!==ft&&lt.componentWillReceiveProps!=null&&lt.componentWillReceiveProps(_t,At),!lt.__e&&lt.shouldComponentUpdate!=null&&lt.shouldComponentUpdate(_t,lt.__s,At)===!1||tt.__v===rt.__v){for(tt.__v!==rt.__v&&(lt.props=_t,lt.state=lt.__s,lt.__d=!1),lt.__e=!1,tt.__e=rt.__e,tt.__k=rt.__k,tt.__k.forEach(function(Ft){Ft&&(Ft.__=tt)}),It=0;It<lt._sb.length;It++)lt.__h.push(lt._sb[It]);lt._sb=[],lt.__h.length&&st.push(lt);break t}lt.componentWillUpdate!=null&&lt.componentWillUpdate(_t,lt.__s,At),lt.componentDidUpdate!=null&&lt.__h.push(function(){lt.componentDidUpdate(ft,dt,pt)})}if(lt.context=At,lt.props=_t,lt.__P=et,Mt=l$3.__r,kt=0,"prototype"in Wt&&Wt.prototype.render){for(lt.state=lt.__s,lt.__d=!1,Mt&&Mt(tt),ut=lt.render(lt.props,lt.state,lt.context),Ct=0;Ct<lt._sb.length;Ct++)lt.__h.push(lt._sb[Ct]);lt._sb=[]}else do lt.__d=!1,Mt&&Mt(tt),ut=lt.render(lt.props,lt.state,lt.context),lt.state=lt.__s;while(lt.__d&&++kt<25);lt.state=lt.__s,lt.getChildContext!=null&&(nt=h$5(h$5({},nt),lt.getChildContext())),ht||lt.getSnapshotBeforeUpdate==null||(pt=lt.getSnapshotBeforeUpdate(ft,dt)),P$2(et,v$5(Ut=ut!=null&&ut.type===k$6&&ut.key==null?ut.props.children:ut)?Ut:[Ut],tt,rt,nt,it,ot,st,at,ct),lt.base=tt.__e,tt.__h=null,lt.__h.length&&st.push(lt),gt&&(lt.__E=lt.__=null),lt.__e=!1}else ot==null&&tt.__v===rt.__v?(tt.__k=rt.__k,tt.__e=rt.__e):tt.__e=N$2(rt.__e,tt,rt,nt,it,ot,st,ct);(ut=l$3.diffed)&&ut(tt)}catch(Ft){tt.__v=null,(ct||ot!=null)&&(tt.__e=at,tt.__h=!!ct,ot[ot.indexOf(at)]=null),l$3.__e(Ft,tt,rt)}}function M$3(et,tt){l$3.__c&&l$3.__c(tt,et),et.some(function(rt){try{et=rt.__h,rt.__h=[],et.some(function(nt){nt.call(rt)})}catch(nt){l$3.__e(nt,rt.__v)}})}function N$2(et,tt,rt,nt,it,ot,st,at){var ct,ut,lt,ht=rt.props,ft=tt.props,dt=tt.type,pt=0;if(dt==="svg"&&(it=!0),ot!=null){for(;pt<ot.length;pt++)if((ct=ot[pt])&&"setAttribute"in ct==!!dt&&(dt?ct.localName===dt:ct.nodeType===3)){et=ct,ot[pt]=null;break}}if(et==null){if(dt===null)return document.createTextNode(ft);et=it?document.createElementNS("http://www.w3.org/2000/svg",dt):document.createElement(dt,ft.is&&ft),ot=null,at=!1}if(dt===null)ht===ft||at&&et.data===ft||(et.data=ft);else{if(ot=ot&&n$3.call(et.childNodes),ut=(ht=rt.props||c$3).dangerouslySetInnerHTML,lt=ft.dangerouslySetInnerHTML,!at){if(ot!=null)for(ht={},pt=0;pt<et.attributes.length;pt++)ht[et.attributes[pt].name]=et.attributes[pt].value;(lt||ut)&&(lt&&(ut&&lt.__html==ut.__html||lt.__html===et.innerHTML)||(et.innerHTML=lt&&lt.__html||""))}if(H$3(et,ft,ht,it,at),lt)tt.__k=[];else if(P$2(et,v$5(pt=tt.props.children)?pt:[pt],tt,rt,nt,it&&dt!=="foreignObject",ot,st,ot?ot[0]:rt.__k&&g$5(rt,0),at),ot!=null)for(pt=ot.length;pt--;)ot[pt]!=null&&p$6(ot[pt]);at||("value"in ft&&(pt=ft.value)!==void 0&&(pt!==et.value||dt==="progress"&&!pt||dt==="option"&&pt!==ht.value)&&T$3(et,"value",pt,ht.value,!1),"checked"in ft&&(pt=ft.checked)!==void 0&&pt!==et.checked&&T$3(et,"checked",pt,ht.checked,!1))}return et}function O$1(et,tt,rt){try{typeof et=="function"?et(tt):et.current=tt}catch(nt){l$3.__e(nt,rt)}}function q$6(et,tt,rt){var nt,it;if(l$3.unmount&&l$3.unmount(et),(nt=et.ref)&&(nt.current&&nt.current!==et.__e||O$1(nt,null,tt)),(nt=et.__c)!=null){if(nt.componentWillUnmount)try{nt.componentWillUnmount()}catch(ot){l$3.__e(ot,tt)}nt.base=nt.__P=null,et.__c=void 0}if(nt=et.__k)for(it=0;it<nt.length;it++)nt[it]&&q$6(nt[it],tt,rt||typeof et.type!="function");rt||et.__e==null||p$6(et.__e),et.__=et.__e=et.__d=void 0}function B$3(et,tt,rt){return this.constructor(et,rt)}function D$3(et,tt,rt){var nt,it,ot;l$3.__&&l$3.__(et,tt),it=(nt=typeof rt=="function")?null:rt&&rt.__k||tt.__k,ot=[],L$4(tt,et=(!nt&&rt||tt).__k=y$4(k$6,null,[et]),it||c$3,c$3,tt.ownerSVGElement!==void 0,!nt&&rt?[rt]:it?null:tt.firstChild?n$3.call(tt.childNodes):null,ot,!nt&&rt?rt:it?it.__e:tt.firstChild,nt),M$3(ot,et)}function E$3(et,tt){D$3(et,tt,E$3)}function F$3(et,tt,rt){var nt,it,ot,st,at=h$5({},et.props);for(ot in et.type&&et.type.defaultProps&&(st=et.type.defaultProps),tt)ot=="key"?nt=tt[ot]:ot=="ref"?it=tt[ot]:at[ot]=tt[ot]===void 0&&st!==void 0?st[ot]:tt[ot];return arguments.length>2&&(at.children=arguments.length>3?n$3.call(arguments,2):rt),d$3(et.type,at,nt||et.key,it||et.ref,null)}function G$2(et,tt){var rt={__c:tt="__cC"+e$3++,__:et,Consumer:function(nt,it){return nt.children(it)},Provider:function(nt){var it,ot;return this.getChildContext||(it=[],(ot={})[tt]=this,this.getChildContext=function(){return ot},this.shouldComponentUpdate=function(st){this.props.value!==st.value&&it.some(function(at){at.__e=!0,w$6(at)})},this.sub=function(st){it.push(st);var at=st.componentWillUnmount;st.componentWillUnmount=function(){it.splice(it.indexOf(st),1),at&&at.call(st)}}),nt.children}};return rt.Provider.__=rt.Consumer.contextType=rt}n$3=s$3.slice,l$3={__e:function(et,tt,rt,nt){for(var it,ot,st;tt=tt.__;)if((it=tt.__c)&&!it.__)try{if((ot=it.constructor)&&ot.getDerivedStateFromError!=null&&(it.setState(ot.getDerivedStateFromError(et)),st=it.__d),it.componentDidCatch!=null&&(it.componentDidCatch(et,nt||{}),st=it.__d),st)return it.__E=it}catch(at){et=at}throw et}},u$4=0,i$1=function(et){return et!=null&&et.constructor===void 0},b$5.prototype.setState=function(et,tt){var rt;rt=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=h$5({},this.state),typeof et=="function"&&(et=et(h$5({},rt),this.props)),et&&h$5(rt,et),et!=null&&this.__v&&(tt&&this._sb.push(tt),w$6(this))},b$5.prototype.forceUpdate=function(et){this.__v&&(this.__e=!0,et&&this.__h.push(et),w$6(this))},b$5.prototype.render=k$6,t$5=[],r$4=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,f$3=function(et,tt){return et.__v.__b-tt.__v.__b},x$5.__r=0,e$3=0;const preact_module=Object.freeze(Object.defineProperty({__proto__:null,Component:b$5,Fragment:k$6,cloneElement:F$3,createContext:G$2,createElement:y$4,createRef:_$3,h:y$4,hydrate:E$3,get isValidElement(){return i$1},get options(){return l$3},render:D$3,toChildArray:S$2},Symbol.toStringTag,{value:"Module"})),globals="";var t$4,r$3,u$3,i,o$1=0,f$2=[],c$2=[],e$2=l$3.__b,a=l$3.__r,v$4=l$3.diffed,l$2=l$3.__c,m$4=l$3.unmount;function d$2(et,tt){l$3.__h&&l$3.__h(r$3,et,o$1||tt),o$1=0;var rt=r$3.__H||(r$3.__H={__:[],__h:[]});return et>=rt.__.length&&rt.__.push({__V:c$2}),rt.__[et]}function h$4(et){return o$1=1,s$2(B$2,et)}function s$2(et,tt,rt){var nt=d$2(t$4++,2);if(nt.t=et,!nt.__c&&(nt.__=[rt?rt(tt):B$2(void 0,tt),function(at){var ct=nt.__N?nt.__N[0]:nt.__[0],ut=nt.t(ct,at);ct!==ut&&(nt.__N=[ut,nt.__[1]],nt.__c.setState({}))}],nt.__c=r$3,!r$3.u)){var it=function(at,ct,ut){if(!nt.__c.__H)return!0;var lt=nt.__c.__H.__.filter(function(ft){return ft.__c});if(lt.every(function(ft){return!ft.__N}))return!ot||ot.call(this,at,ct,ut);var ht=!1;return lt.forEach(function(ft){if(ft.__N){var dt=ft.__[0];ft.__=ft.__N,ft.__N=void 0,dt!==ft.__[0]&&(ht=!0)}}),!(!ht&&nt.__c.props===at)&&(!ot||ot.call(this,at,ct,ut))};r$3.u=!0;var ot=r$3.shouldComponentUpdate,st=r$3.componentWillUpdate;r$3.componentWillUpdate=function(at,ct,ut){if(this.__e){var lt=ot;ot=void 0,it(at,ct,ut),ot=lt}st&&st.call(this,at,ct,ut)},r$3.shouldComponentUpdate=it}return nt.__N||nt.__}function p$5(et,tt){var rt=d$2(t$4++,3);!l$3.__s&&z$4(rt.__H,tt)&&(rt.__=et,rt.i=tt,r$3.__H.__h.push(rt))}function y$3(et,tt){var rt=d$2(t$4++,4);!l$3.__s&&z$4(rt.__H,tt)&&(rt.__=et,rt.i=tt,r$3.__h.push(rt))}function _$2(et){return o$1=5,F$2(function(){return{current:et}},[])}function A$3(et,tt,rt){o$1=6,y$3(function(){return typeof et=="function"?(et(tt()),function(){return et(null)}):et?(et.current=tt(),function(){return et.current=null}):void 0},rt==null?rt:rt.concat(et))}function F$2(et,tt){var rt=d$2(t$4++,7);return z$4(rt.__H,tt)?(rt.__V=et(),rt.i=tt,rt.__h=et,rt.__V):rt.__}function T$2(et,tt){return o$1=8,F$2(function(){return et},tt)}function q$5(et){var tt=r$3.context[et.__c],rt=d$2(t$4++,9);return rt.c=et,tt?(rt.__==null&&(rt.__=!0,tt.sub(r$3)),tt.props.value):et.__}function x$4(et,tt){l$3.useDebugValue&&l$3.useDebugValue(tt?tt(et):et)}function P$1(et){var tt=d$2(t$4++,10),rt=h$4();return tt.__=et,r$3.componentDidCatch||(r$3.componentDidCatch=function(nt,it){tt.__&&tt.__(nt,it),rt[1](nt)}),[rt[0],function(){rt[1](void 0)}]}function V$3(){var et=d$2(t$4++,11);if(!et.__){for(var tt=r$3.__v;tt!==null&&!tt.__m&&tt.__!==null;)tt=tt.__;var rt=tt.__m||(tt.__m=[0,0]);et.__="P"+rt[0]+"-"+rt[1]++}return et.__}function b$4(){for(var et;et=f$2.shift();)if(et.__P&&et.__H)try{et.__H.__h.forEach(k$5),et.__H.__h.forEach(w$5),et.__H.__h=[]}catch(tt){et.__H.__h=[],l$3.__e(tt,et.__v)}}l$3.__b=function(et){r$3=null,e$2&&e$2(et)},l$3.__r=function(et){a&&a(et),t$4=0;var tt=(r$3=et.__c).__H;tt&&(u$3===r$3?(tt.__h=[],r$3.__h=[],tt.__.forEach(function(rt){rt.__N&&(rt.__=rt.__N),rt.__V=c$2,rt.__N=rt.i=void 0})):(tt.__h.forEach(k$5),tt.__h.forEach(w$5),tt.__h=[],t$4=0)),u$3=r$3},l$3.diffed=function(et){v$4&&v$4(et);var tt=et.__c;tt&&tt.__H&&(tt.__H.__h.length&&(f$2.push(tt)!==1&&i===l$3.requestAnimationFrame||((i=l$3.requestAnimationFrame)||j$2)(b$4)),tt.__H.__.forEach(function(rt){rt.i&&(rt.__H=rt.i),rt.__V!==c$2&&(rt.__=rt.__V),rt.i=void 0,rt.__V=c$2})),u$3=r$3=null},l$3.__c=function(et,tt){tt.some(function(rt){try{rt.__h.forEach(k$5),rt.__h=rt.__h.filter(function(nt){return!nt.__||w$5(nt)})}catch(nt){tt.some(function(it){it.__h&&(it.__h=[])}),tt=[],l$3.__e(nt,rt.__v)}}),l$2&&l$2(et,tt)},l$3.unmount=function(et){m$4&&m$4(et);var tt,rt=et.__c;rt&&rt.__H&&(rt.__H.__.forEach(function(nt){try{k$5(nt)}catch(it){tt=it}}),rt.__H=void 0,tt&&l$3.__e(tt,rt.__v))};var g$4=typeof requestAnimationFrame=="function";function j$2(et){var tt,rt=function(){clearTimeout(nt),g$4&&cancelAnimationFrame(tt),setTimeout(et)},nt=setTimeout(rt,100);g$4&&(tt=requestAnimationFrame(rt))}function k$5(et){var tt=r$3,rt=et.__c;typeof rt=="function"&&(et.__c=void 0,rt()),r$3=tt}function w$5(et){var tt=r$3;et.__c=et.__(),r$3=tt}function z$4(et,tt){return!et||et.length!==tt.length||tt.some(function(rt,nt){return rt!==et[nt]})}function B$2(et,tt){return typeof tt=="function"?tt(et):tt}var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"||typeof window<"u"?window:typeof self<"u"?self:{};function getDefaultExportFromCjs(et){return et&&et.__esModule&&Object.prototype.hasOwnProperty.call(et,"default")?et.default:et}function getAugmentedNamespace(et){if(et.__esModule)return et;var tt=et.default;if(typeof tt=="function"){var rt=function nt(){if(this instanceof nt){var it=[null];it.push.apply(it,arguments);var ot=Function.bind.apply(tt,it);return new ot}return tt.apply(this,arguments)};rt.prototype=tt.prototype}else rt={};return Object.defineProperty(rt,"__esModule",{value:!0}),Object.keys(et).forEach(function(nt){var it=Object.getOwnPropertyDescriptor(et,nt);Object.defineProperty(rt,nt,it.get?it:{enumerable:!0,get:function(){return et[nt]}})}),rt}var lib$5={exports:{}},seed=1;function getNextValue(){return seed=(seed*9301+49297)%233280,seed/233280}function setSeed$1(et){seed=et}var randomFromSeed$1={nextValue:getNextValue,seed:setSeed$1},randomFromSeed=randomFromSeed$1,ORIGINAL="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-",alphabet$3,previousSeed,shuffled;function reset(){shuffled=!1}function setCharacters(et){if(!et){alphabet$3!==ORIGINAL&&(alphabet$3=ORIGINAL,reset());return}if(et!==alphabet$3){if(et.length!==ORIGINAL.length)throw new Error("Custom alphabet for shortid must be "+ORIGINAL.length+" unique characters. You submitted "+et.length+" characters: "+et);var tt=et.split("").filter(function(rt,nt,it){return nt!==it.lastIndexOf(rt)});if(tt.length)throw new Error("Custom alphabet for shortid must be "+ORIGINAL.length+" unique characters. These characters were not unique: "+tt.join(", "));alphabet$3=et,reset()}}function characters(et){return setCharacters(et),alphabet$3}function setSeed(et){randomFromSeed.seed(et),previousSeed!==et&&(reset(),previousSeed=et)}function shuffle$2(){alphabet$3||setCharacters(ORIGINAL);for(var et=alphabet$3.split(""),tt=[],rt=randomFromSeed.nextValue(),nt;et.length>0;)rt=randomFromSeed.nextValue(),nt=Math.floor(rt*et.length),tt.push(et.splice(nt,1)[0]);return tt.join("")}function getShuffled(){return shuffled||(shuffled=shuffle$2(),shuffled)}function lookup(et){var tt=getShuffled();return tt[et]}function get$2(){return alphabet$3||ORIGINAL}var alphabet_1={get:get$2,characters,seed:setSeed,lookup,shuffled:getShuffled},crypto$a=typeof window=="object"&&(window.crypto||window.msCrypto),randomByte;!crypto$a||!crypto$a.getRandomValues?randomByte=function(et){for(var tt=[],rt=0;rt<et;rt++)tt.push(Math.floor(Math.random()*256));return tt}:randomByte=function(et){return crypto$a.getRandomValues(new Uint8Array(et))};var randomByteBrowser=randomByte,format_browser=function(et,tt,rt){for(var nt=(2<<Math.log(tt.length-1)/Math.LN2)-1,it=-~(1.6*nt*rt/tt.length),ot="";;)for(var st=et(it),at=it;at--;)if(ot+=tt[st[at]&nt]||"",ot.length===+rt)return ot},alphabet$2=alphabet_1,random$1=randomByteBrowser,format$4=format_browser;function generate$1(et){for(var tt=0,rt,nt="";!rt;)nt=nt+format$4(random$1,alphabet$2.get(),1),rt=et<Math.pow(16,tt+1),tt++;return nt}var generate_1=generate$1,generate=generate_1,REDUCE_TIME=1567752802062,version$8=7,counter,previousSeconds;function build(et){var tt="",rt=Math.floor((Date.now()-REDUCE_TIME)*.001);return rt===previousSeconds?counter++:(counter=0,previousSeconds=rt),tt=tt+generate(version$8),tt=tt+generate(et),counter>0&&(tt=tt+generate(counter)),tt=tt+generate(rt),tt}var build_1=build,alphabet$1=alphabet_1;function isShortId(et){if(!et||typeof et!="string"||et.length<6)return!1;var tt=new RegExp("[^"+alphabet$1.get().replace(/[|\\{}()[\]^$+*?.-]/g,"\\$&")+"]");return!tt.test(et)}var isValid=isShortId;(function(et){var tt=alphabet_1,rt=build_1,nt=isValid,it=0;function ot(ut){return tt.seed(ut),et.exports}function st(ut){return it=ut,et.exports}function at(ut){return ut!==void 0&&tt.characters(ut),tt.shuffled()}function ct(){return rt(it)}et.exports=ct,et.exports.generate=ct,et.exports.seed=ot,et.exports.worker=st,et.exports.characters=at,et.exports.isValid=nt})(lib$5);var libExports$1=lib$5.exports,shortid=libExports$1;const shortid$1=getDefaultExportFromCjs(shortid),CONSTANTS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},assert=function(et,tt){if(!et)throw assertionError(tt)},assertionError=function(et){return new Error("Firebase Database ("+CONSTANTS.SDK_VERSION+") INTERNAL ASSERT FAILED: "+et)},stringToByteArray$1=function(et){const tt=[];let rt=0;for(let nt=0;nt<et.length;nt++){let it=et.charCodeAt(nt);it<128?tt[rt++]=it:it<2048?(tt[rt++]=it>>6|192,tt[rt++]=it&63|128):(it&64512)===55296&&nt+1<et.length&&(et.charCodeAt(nt+1)&64512)===56320?(it=65536+((it&1023)<<10)+(et.charCodeAt(++nt)&1023),tt[rt++]=it>>18|240,tt[rt++]=it>>12&63|128,tt[rt++]=it>>6&63|128,tt[rt++]=it&63|128):(tt[rt++]=it>>12|224,tt[rt++]=it>>6&63|128,tt[rt++]=it&63|128)}return tt},byteArrayToString=function(et){const tt=[];let rt=0,nt=0;for(;rt<et.length;){const it=et[rt++];if(it<128)tt[nt++]=String.fromCharCode(it);else if(it>191&&it<224){const ot=et[rt++];tt[nt++]=String.fromCharCode((it&31)<<6|ot&63)}else if(it>239&&it<365){const ot=et[rt++],st=et[rt++],at=et[rt++],ct=((it&7)<<18|(ot&63)<<12|(st&63)<<6|at&63)-65536;tt[nt++]=String.fromCharCode(55296+(ct>>10)),tt[nt++]=String.fromCharCode(56320+(ct&1023))}else{const ot=et[rt++],st=et[rt++];tt[nt++]=String.fromCharCode((it&15)<<12|(ot&63)<<6|st&63)}}return tt.join("")},base64$a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(et,tt){if(!Array.isArray(et))throw Error("encodeByteArray takes an array as a parameter");this.init_();const rt=tt?this.byteToCharMapWebSafe_:this.byteToCharMap_,nt=[];for(let it=0;it<et.length;it+=3){const ot=et[it],st=it+1<et.length,at=st?et[it+1]:0,ct=it+2<et.length,ut=ct?et[it+2]:0,lt=ot>>2,ht=(ot&3)<<4|at>>4;let ft=(at&15)<<2|ut>>6,dt=ut&63;ct||(dt=64,st||(ft=64)),nt.push(rt[lt],rt[ht],rt[ft],rt[dt])}return nt.join("")},encodeString(et,tt){return this.HAS_NATIVE_SUPPORT&&!tt?btoa(et):this.encodeByteArray(stringToByteArray$1(et),tt)},decodeString(et,tt){return this.HAS_NATIVE_SUPPORT&&!tt?atob(et):byteArrayToString(this.decodeStringToByteArray(et,tt))},decodeStringToByteArray(et,tt){this.init_();const rt=tt?this.charToByteMapWebSafe_:this.charToByteMap_,nt=[];for(let it=0;it<et.length;){const ot=rt[et.charAt(it++)],st=it<et.length?rt[et.charAt(it)]:0;++it;const at=it<et.length?rt[et.charAt(it)]:64;++it;const ct=it<et.length?rt[et.charAt(it)]:64;if(++it,ot==null||st==null||at==null||ct==null)throw new DecodeBase64StringError;const ut=ot<<2|st>>4;if(nt.push(ut),at!==64){const lt=st<<4&240|at>>2;if(nt.push(lt),ct!==64){const ht=at<<6&192|ct;nt.push(ht)}}}return nt},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let et=0;et<this.ENCODED_VALS.length;et++)this.byteToCharMap_[et]=this.ENCODED_VALS.charAt(et),this.charToByteMap_[this.byteToCharMap_[et]]=et,this.byteToCharMapWebSafe_[et]=this.ENCODED_VALS_WEBSAFE.charAt(et),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[et]]=et,et>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(et)]=et,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(et)]=et)}}};class DecodeBase64StringError extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const base64Encode=function(et){const tt=stringToByteArray$1(et);return base64$a.encodeByteArray(tt,!0)},base64urlEncodeWithoutPadding=function(et){return base64Encode(et).replace(/\./g,"")},base64Decode=function(et){try{return base64$a.decodeString(et,!0)}catch(tt){console.error("base64Decode failed: ",tt)}return null};function deepCopy(et){return deepExtend(void 0,et)}function deepExtend(et,tt){if(!(tt instanceof Object))return tt;switch(tt.constructor){case Date:const rt=tt;return new Date(rt.getTime());case Object:et===void 0&&(et={});break;case Array:et=[];break;default:return tt}for(const rt in tt)!tt.hasOwnProperty(rt)||!isValidKey$1(rt)||(et[rt]=deepExtend(et[rt],tt[rt]));return et}function isValidKey$1(et){return et!=="__proto__"}class Deferred{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((tt,rt)=>{this.resolve=tt,this.reject=rt})}wrapCallback(tt){return(rt,nt)=>{rt?this.reject(rt):this.resolve(nt),typeof tt=="function"&&(this.promise.catch(()=>{}),tt.length===1?tt(rt):tt(rt,nt))}}}function getUA(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function isMobileCordova(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(getUA())}function isReactNative$1(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function isNodeSdk(){return CONSTANTS.NODE_ADMIN===!0}function isIndexedDBAvailable(){try{return typeof indexedDB=="object"}catch{return!1}}function validateIndexedDBOpenable(){return new Promise((et,tt)=>{try{let rt=!0;const nt="validate-browser-context-for-indexeddb-analytics-module",it=self.indexedDB.open(nt);it.onsuccess=()=>{it.result.close(),rt||self.indexedDB.deleteDatabase(nt),et(!0)},it.onupgradeneeded=()=>{rt=!1},it.onerror=()=>{var ot;tt(((ot=it.error)===null||ot===void 0?void 0:ot.message)||"")}}catch(rt){tt(rt)}})}const ERROR_NAME="FirebaseError";class FirebaseError extends Error{constructor(tt,rt,nt){super(rt),this.code=tt,this.customData=nt,this.name=ERROR_NAME,Object.setPrototypeOf(this,FirebaseError.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ErrorFactory.prototype.create)}}class ErrorFactory{constructor(tt,rt,nt){this.service=tt,this.serviceName=rt,this.errors=nt}create(tt,...rt){const nt=rt[0]||{},it=`${this.service}/${tt}`,ot=this.errors[tt],st=ot?replaceTemplate(ot,nt):"Error",at=`${this.serviceName}: ${st} (${it}).`;return new FirebaseError(it,at,nt)}}function replaceTemplate(et,tt){return et.replace(PATTERN,(rt,nt)=>{const it=tt[nt];return it!=null?String(it):`<${nt}?>`})}const PATTERN=/\{\$([^}]+)}/g;function jsonEval(et){return JSON.parse(et)}function stringify(et){return JSON.stringify(et)}const decode$i=function(et){let tt={},rt={},nt={},it="";try{const ot=et.split(".");tt=jsonEval(base64Decode(ot[0])||""),rt=jsonEval(base64Decode(ot[1])||""),it=ot[2],nt=rt.d||{},delete rt.d}catch{}return{header:tt,claims:rt,data:nt,signature:it}},isValidFormat=function(et){const tt=decode$i(et),rt=tt.claims;return!!rt&&typeof rt=="object"&&rt.hasOwnProperty("iat")},isAdmin=function(et){const tt=decode$i(et).claims;return typeof tt=="object"&&tt.admin===!0};function contains(et,tt){return Object.prototype.hasOwnProperty.call(et,tt)}function safeGet(et,tt){if(Object.prototype.hasOwnProperty.call(et,tt))return et[tt]}function isEmpty(et){for(const tt in et)if(Object.prototype.hasOwnProperty.call(et,tt))return!1;return!0}function map$4(et,tt,rt){const nt={};for(const it in et)Object.prototype.hasOwnProperty.call(et,it)&&(nt[it]=tt.call(rt,et[it],it,et));return nt}function querystring(et){const tt=[];for(const[rt,nt]of Object.entries(et))Array.isArray(nt)?nt.forEach(it=>{tt.push(encodeURIComponent(rt)+"="+encodeURIComponent(it))}):tt.push(encodeURIComponent(rt)+"="+encodeURIComponent(nt));return tt.length?"&"+tt.join("&"):""}class Sha1{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let tt=1;tt<this.blockSize;++tt)this.pad_[tt]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(tt,rt){rt||(rt=0);const nt=this.W_;if(typeof tt=="string")for(let ht=0;ht<16;ht++)nt[ht]=tt.charCodeAt(rt)<<24|tt.charCodeAt(rt+1)<<16|tt.charCodeAt(rt+2)<<8|tt.charCodeAt(rt+3),rt+=4;else for(let ht=0;ht<16;ht++)nt[ht]=tt[rt]<<24|tt[rt+1]<<16|tt[rt+2]<<8|tt[rt+3],rt+=4;for(let ht=16;ht<80;ht++){const ft=nt[ht-3]^nt[ht-8]^nt[ht-14]^nt[ht-16];nt[ht]=(ft<<1|ft>>>31)&4294967295}let it=this.chain_[0],ot=this.chain_[1],st=this.chain_[2],at=this.chain_[3],ct=this.chain_[4],ut,lt;for(let ht=0;ht<80;ht++){ht<40?ht<20?(ut=at^ot&(st^at),lt=1518500249):(ut=ot^st^at,lt=1859775393):ht<60?(ut=ot&st|at&(ot|st),lt=2400959708):(ut=ot^st^at,lt=3395469782);const ft=(it<<5|it>>>27)+ut+ct+lt+nt[ht]&4294967295;ct=at,at=st,st=(ot<<30|ot>>>2)&4294967295,ot=it,it=ft}this.chain_[0]=this.chain_[0]+it&4294967295,this.chain_[1]=this.chain_[1]+ot&4294967295,this.chain_[2]=this.chain_[2]+st&4294967295,this.chain_[3]=this.chain_[3]+at&4294967295,this.chain_[4]=this.chain_[4]+ct&4294967295}update(tt,rt){if(tt==null)return;rt===void 0&&(rt=tt.length);const nt=rt-this.blockSize;let it=0;const ot=this.buf_;let st=this.inbuf_;for(;it<rt;){if(st===0)for(;it<=nt;)this.compress_(tt,it),it+=this.blockSize;if(typeof tt=="string"){for(;it<rt;)if(ot[st]=tt.charCodeAt(it),++st,++it,st===this.blockSize){this.compress_(ot),st=0;break}}else for(;it<rt;)if(ot[st]=tt[it],++st,++it,st===this.blockSize){this.compress_(ot),st=0;break}}this.inbuf_=st,this.total_+=rt}digest(){const tt=[];let rt=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let it=this.blockSize-1;it>=56;it--)this.buf_[it]=rt&255,rt/=256;this.compress_(this.buf_);let nt=0;for(let it=0;it<5;it++)for(let ot=24;ot>=0;ot-=8)tt[nt]=this.chain_[it]>>ot&255,++nt;return tt}}function errorPrefix(et,tt){return`${et} failed: ${tt} argument `}const stringToByteArray=function(et){const tt=[];let rt=0;for(let nt=0;nt<et.length;nt++){let it=et.charCodeAt(nt);if(it>=55296&&it<=56319){const ot=it-55296;nt++,assert(nt<et.length,"Surrogate pair missing trail surrogate.");const st=et.charCodeAt(nt)-56320;it=65536+(ot<<10)+st}it<128?tt[rt++]=it:it<2048?(tt[rt++]=it>>6|192,tt[rt++]=it&63|128):it<65536?(tt[rt++]=it>>12|224,tt[rt++]=it>>6&63|128,tt[rt++]=it&63|128):(tt[rt++]=it>>18|240,tt[rt++]=it>>12&63|128,tt[rt++]=it>>6&63|128,tt[rt++]=it&63|128)}return tt},stringLength=function(et){let tt=0;for(let rt=0;rt<et.length;rt++){const nt=et.charCodeAt(rt);nt<128?tt++:nt<2048?tt+=2:nt>=55296&&nt<=56319?(tt+=4,rt++):tt+=3}return tt};function getModularInstance(et){return et&&et._delegate?et._delegate:et}class Component{constructor(tt,rt,nt){this.name=tt,this.instanceFactory=rt,this.type=nt,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(tt){return this.instantiationMode=tt,this}setMultipleInstances(tt){return this.multipleInstances=tt,this}setServiceProps(tt){return this.serviceProps=tt,this}setInstanceCreatedCallback(tt){return this.onInstanceCreated=tt,this}}var LogLevel;(function(et){et[et.DEBUG=0]="DEBUG",et[et.VERBOSE=1]="VERBOSE",et[et.INFO=2]="INFO",et[et.WARN=3]="WARN",et[et.ERROR=4]="ERROR",et[et.SILENT=5]="SILENT"})(LogLevel||(LogLevel={}));const levelStringToEnum={debug:LogLevel.DEBUG,verbose:LogLevel.VERBOSE,info:LogLevel.INFO,warn:LogLevel.WARN,error:LogLevel.ERROR,silent:LogLevel.SILENT},defaultLogLevel=LogLevel.INFO,ConsoleMethod={[LogLevel.DEBUG]:"log",[LogLevel.VERBOSE]:"log",[LogLevel.INFO]:"info",[LogLevel.WARN]:"warn",[LogLevel.ERROR]:"error"},defaultLogHandler=(et,tt,...rt)=>{if(tt<et.logLevel)return;const nt=new Date().toISOString(),it=ConsoleMethod[tt];if(it)console[it](`[${nt}]  ${et.name}:`,...rt);else throw new Error(`Attempted to log a message with an invalid logType (value: ${tt})`)};class Logger{constructor(tt){this.name=tt,this._logLevel=defaultLogLevel,this._logHandler=defaultLogHandler,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(tt){if(!(tt in LogLevel))throw new TypeError(`Invalid value "${tt}" assigned to \`logLevel\``);this._logLevel=tt}setLogLevel(tt){this._logLevel=typeof tt=="string"?levelStringToEnum[tt]:tt}get logHandler(){return this._logHandler}set logHandler(tt){if(typeof tt!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=tt}get userLogHandler(){return this._userLogHandler}set userLogHandler(tt){this._userLogHandler=tt}debug(...tt){this._userLogHandler&&this._userLogHandler(this,LogLevel.DEBUG,...tt),this._logHandler(this,LogLevel.DEBUG,...tt)}log(...tt){this._userLogHandler&&this._userLogHandler(this,LogLevel.VERBOSE,...tt),this._logHandler(this,LogLevel.VERBOSE,...tt)}info(...tt){this._userLogHandler&&this._userLogHandler(this,LogLevel.INFO,...tt),this._logHandler(this,LogLevel.INFO,...tt)}warn(...tt){this._userLogHandler&&this._userLogHandler(this,LogLevel.WARN,...tt),this._logHandler(this,LogLevel.WARN,...tt)}error(...tt){this._userLogHandler&&this._userLogHandler(this,LogLevel.ERROR,...tt),this._logHandler(this,LogLevel.ERROR,...tt)}}const instanceOfAny=(et,tt)=>tt.some(rt=>et instanceof rt);let idbProxyableTypes,cursorAdvanceMethods;function getIdbProxyableTypes(){return idbProxyableTypes||(idbProxyableTypes=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function getCursorAdvanceMethods(){return cursorAdvanceMethods||(cursorAdvanceMethods=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const cursorRequestMap=new WeakMap,transactionDoneMap=new WeakMap,transactionStoreNamesMap=new WeakMap,transformCache=new WeakMap,reverseTransformCache=new WeakMap;function promisifyRequest(et){const tt=new Promise((rt,nt)=>{const it=()=>{et.removeEventListener("success",ot),et.removeEventListener("error",st)},ot=()=>{rt(wrap(et.result)),it()},st=()=>{nt(et.error),it()};et.addEventListener("success",ot),et.addEventListener("error",st)});return tt.then(rt=>{rt instanceof IDBCursor&&cursorRequestMap.set(rt,et)}).catch(()=>{}),reverseTransformCache.set(tt,et),tt}function cacheDonePromiseForTransaction(et){if(transactionDoneMap.has(et))return;const tt=new Promise((rt,nt)=>{const it=()=>{et.removeEventListener("complete",ot),et.removeEventListener("error",st),et.removeEventListener("abort",st)},ot=()=>{rt(),it()},st=()=>{nt(et.error||new DOMException("AbortError","AbortError")),it()};et.addEventListener("complete",ot),et.addEventListener("error",st),et.addEventListener("abort",st)});transactionDoneMap.set(et,tt)}let idbProxyTraps={get(et,tt,rt){if(et instanceof IDBTransaction){if(tt==="done")return transactionDoneMap.get(et);if(tt==="objectStoreNames")return et.objectStoreNames||transactionStoreNamesMap.get(et);if(tt==="store")return rt.objectStoreNames[1]?void 0:rt.objectStore(rt.objectStoreNames[0])}return wrap(et[tt])},set(et,tt,rt){return et[tt]=rt,!0},has(et,tt){return et instanceof IDBTransaction&&(tt==="done"||tt==="store")?!0:tt in et}};function replaceTraps(et){idbProxyTraps=et(idbProxyTraps)}function wrapFunction(et){return et===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(tt,...rt){const nt=et.call(unwrap$2(this),tt,...rt);return transactionStoreNamesMap.set(nt,tt.sort?tt.sort():[tt]),wrap(nt)}:getCursorAdvanceMethods().includes(et)?function(...tt){return et.apply(unwrap$2(this),tt),wrap(cursorRequestMap.get(this))}:function(...tt){return wrap(et.apply(unwrap$2(this),tt))}}function transformCachableValue(et){return typeof et=="function"?wrapFunction(et):(et instanceof IDBTransaction&&cacheDonePromiseForTransaction(et),instanceOfAny(et,getIdbProxyableTypes())?new Proxy(et,idbProxyTraps):et)}function wrap(et){if(et instanceof IDBRequest)return promisifyRequest(et);if(transformCache.has(et))return transformCache.get(et);const tt=transformCachableValue(et);return tt!==et&&(transformCache.set(et,tt),reverseTransformCache.set(tt,et)),tt}const unwrap$2=et=>reverseTransformCache.get(et);function openDB(et,tt,{blocked:rt,upgrade:nt,blocking:it,terminated:ot}={}){const st=indexedDB.open(et,tt),at=wrap(st);return nt&&st.addEventListener("upgradeneeded",ct=>{nt(wrap(st.result),ct.oldVersion,ct.newVersion,wrap(st.transaction),ct)}),rt&&st.addEventListener("blocked",ct=>rt(ct.oldVersion,ct.newVersion,ct)),at.then(ct=>{ot&&ct.addEventListener("close",()=>ot()),it&&ct.addEventListener("versionchange",ut=>it(ut.oldVersion,ut.newVersion,ut))}).catch(()=>{}),at}const readMethods=["get","getKey","getAll","getAllKeys","count"],writeMethods=["put","add","delete","clear"],cachedMethods=new Map;function getMethod(et,tt){if(!(et instanceof IDBDatabase&&!(tt in et)&&typeof tt=="string"))return;if(cachedMethods.get(tt))return cachedMethods.get(tt);const rt=tt.replace(/FromIndex$/,""),nt=tt!==rt,it=writeMethods.includes(rt);if(!(rt in(nt?IDBIndex:IDBObjectStore).prototype)||!(it||readMethods.includes(rt)))return;const ot=async function(st,...at){const ct=this.transaction(st,it?"readwrite":"readonly");let ut=ct.store;return nt&&(ut=ut.index(at.shift())),(await Promise.all([ut[rt](...at),it&&ct.done]))[0]};return cachedMethods.set(tt,ot),ot}replaceTraps(et=>({...et,get:(tt,rt,nt)=>getMethod(tt,rt)||et.get(tt,rt,nt),has:(tt,rt)=>!!getMethod(tt,rt)||et.has(tt,rt)}));class PlatformLoggerServiceImpl{constructor(tt){this.container=tt}getPlatformInfoString(){return this.container.getProviders().map(tt=>{if(isVersionServiceProvider(tt)){const rt=tt.getImmediate();return`${rt.library}/${rt.version}`}else return null}).filter(tt=>tt).join(" ")}}function isVersionServiceProvider(et){const tt=et.getComponent();return(tt==null?void 0:tt.type)==="VERSION"}const name$o="@firebase/app",version$1$1="0.9.13",logger$1=new Logger("@firebase/app"),name$n="@firebase/app-compat",name$m="@firebase/analytics-compat",name$l="@firebase/analytics",name$k="@firebase/app-check-compat",name$j="@firebase/app-check",name$i="@firebase/auth",name$h="@firebase/auth-compat",name$g="@firebase/database",name$f="@firebase/database-compat",name$e="@firebase/functions",name$d="@firebase/functions-compat",name$c="@firebase/installations",name$b="@firebase/installations-compat",name$a="@firebase/messaging",name$9="@firebase/messaging-compat",name$8="@firebase/performance",name$7$1="@firebase/performance-compat",name$6$1="@firebase/remote-config",name$5$1="@firebase/remote-config-compat",name$4$1="@firebase/storage",name$3$1="@firebase/storage-compat",name$2$1="@firebase/firestore",name$1$1="@firebase/firestore-compat",name$p="firebase",version$7="9.23.0",PLATFORM_LOG_STRING={[name$o]:"fire-core",[name$n]:"fire-core-compat",[name$l]:"fire-analytics",[name$m]:"fire-analytics-compat",[name$j]:"fire-app-check",[name$k]:"fire-app-check-compat",[name$i]:"fire-auth",[name$h]:"fire-auth-compat",[name$g]:"fire-rtdb",[name$f]:"fire-rtdb-compat",[name$e]:"fire-fn",[name$d]:"fire-fn-compat",[name$c]:"fire-iid",[name$b]:"fire-iid-compat",[name$a]:"fire-fcm",[name$9]:"fire-fcm-compat",[name$8]:"fire-perf",[name$7$1]:"fire-perf-compat",[name$6$1]:"fire-rc",[name$5$1]:"fire-rc-compat",[name$4$1]:"fire-gcs",[name$3$1]:"fire-gcs-compat",[name$2$1]:"fire-fst",[name$1$1]:"fire-fst-compat","fire-js":"fire-js",[name$p]:"fire-js-all"},_apps=new Map,_components=new Map;function _addComponent(et,tt){try{et.container.addComponent(tt)}catch(rt){logger$1.debug(`Component ${tt.name} failed to register with FirebaseApp ${et.name}`,rt)}}function _registerComponent(et){const tt=et.name;if(_components.has(tt))return logger$1.debug(`There were multiple attempts to register component ${tt}.`),!1;_components.set(tt,et);for(const rt of _apps.values())_addComponent(rt,et);return!0}const ERRORS$2={["no-app"]:"No Firebase App '{$appName}' has been created - call initializeApp() first",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["no-options"]:"Need to provide options, when not being deployed to hosting via source.",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["idb-open"]:"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.",["idb-get"]:"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.",["idb-set"]:"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.",["idb-delete"]:"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},ERROR_FACTORY=new ErrorFactory("app","Firebase",ERRORS$2),SDK_VERSION$1=version$7;function registerVersion(et,tt,rt){var nt;let it=(nt=PLATFORM_LOG_STRING[et])!==null&&nt!==void 0?nt:et;rt&&(it+=`-${rt}`);const ot=it.match(/\s|\//),st=tt.match(/\s|\//);if(ot||st){const at=[`Unable to register library "${it}" with version "${tt}":`];ot&&at.push(`library name "${it}" contains illegal characters (whitespace or "/")`),ot&&st&&at.push("and"),st&&at.push(`version name "${tt}" contains illegal characters (whitespace or "/")`),logger$1.warn(at.join(" "));return}_registerComponent(new Component(`${it}-version`,()=>({library:it,version:tt}),"VERSION"))}const DB_NAME="firebase-heartbeat-database",DB_VERSION=1,STORE_NAME="firebase-heartbeat-store";let dbPromise=null;function getDbPromise(){return dbPromise||(dbPromise=openDB(DB_NAME,DB_VERSION,{upgrade:(et,tt)=>{switch(tt){case 0:et.createObjectStore(STORE_NAME)}}}).catch(et=>{throw ERROR_FACTORY.create("idb-open",{originalErrorMessage:et.message})})),dbPromise}async function readHeartbeatsFromIndexedDB(et){try{return await(await getDbPromise()).transaction(STORE_NAME).objectStore(STORE_NAME).get(computeKey(et))}catch(tt){if(tt instanceof FirebaseError)logger$1.warn(tt.message);else{const rt=ERROR_FACTORY.create("idb-get",{originalErrorMessage:tt==null?void 0:tt.message});logger$1.warn(rt.message)}}}async function writeHeartbeatsToIndexedDB(et,tt){try{const rt=(await getDbPromise()).transaction(STORE_NAME,"readwrite");await rt.objectStore(STORE_NAME).put(tt,computeKey(et)),await rt.done}catch(rt){if(rt instanceof FirebaseError)logger$1.warn(rt.message);else{const nt=ERROR_FACTORY.create("idb-set",{originalErrorMessage:rt==null?void 0:rt.message});logger$1.warn(nt.message)}}}function computeKey(et){return`${et.name}!${et.options.appId}`}const MAX_HEADER_BYTES=1024,STORED_HEARTBEAT_RETENTION_MAX_MILLIS=30*24*60*60*1e3;class HeartbeatServiceImpl{constructor(tt){this.container=tt,this._heartbeatsCache=null;const rt=this.container.getProvider("app").getImmediate();this._storage=new HeartbeatStorageImpl(rt),this._heartbeatsCachePromise=this._storage.read().then(nt=>(this._heartbeatsCache=nt,nt))}async triggerHeartbeat(){const tt=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),rt=getUTCDateString();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===rt||this._heartbeatsCache.heartbeats.some(nt=>nt.date===rt)))return this._heartbeatsCache.heartbeats.push({date:rt,agent:tt}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(nt=>{const it=new Date(nt.date).valueOf();return Date.now()-it<=STORED_HEARTBEAT_RETENTION_MAX_MILLIS}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const tt=getUTCDateString(),{heartbeatsToSend:rt,unsentEntries:nt}=extractHeartbeatsForHeader(this._heartbeatsCache.heartbeats),it=base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:rt}));return this._heartbeatsCache.lastSentHeartbeatDate=tt,nt.length>0?(this._heartbeatsCache.heartbeats=nt,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),it}}function getUTCDateString(){return new Date().toISOString().substring(0,10)}function extractHeartbeatsForHeader(et,tt=MAX_HEADER_BYTES){const rt=[];let nt=et.slice();for(const it of et){const ot=rt.find(st=>st.agent===it.agent);if(ot){if(ot.dates.push(it.date),countBytes(rt)>tt){ot.dates.pop();break}}else if(rt.push({agent:it.agent,dates:[it.date]}),countBytes(rt)>tt){rt.pop();break}nt=nt.slice(1)}return{heartbeatsToSend:rt,unsentEntries:nt}}class HeartbeatStorageImpl{constructor(tt){this.app=tt,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return isIndexedDBAvailable()?validateIndexedDBOpenable().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await readHeartbeatsFromIndexedDB(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(tt){var rt;if(await this._canUseIndexedDBPromise){const nt=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(rt=tt.lastSentHeartbeatDate)!==null&&rt!==void 0?rt:nt.lastSentHeartbeatDate,heartbeats:tt.heartbeats})}else return}async add(tt){var rt;if(await this._canUseIndexedDBPromise){const nt=await this.read();return writeHeartbeatsToIndexedDB(this.app,{lastSentHeartbeatDate:(rt=tt.lastSentHeartbeatDate)!==null&&rt!==void 0?rt:nt.lastSentHeartbeatDate,heartbeats:[...nt.heartbeats,...tt.heartbeats]})}else return}}function countBytes(et){return base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:et})).length}function registerCoreComponents(et){_registerComponent(new Component("platform-logger",tt=>new PlatformLoggerServiceImpl(tt),"PRIVATE")),_registerComponent(new Component("heartbeat",tt=>new HeartbeatServiceImpl(tt),"PRIVATE")),registerVersion(name$o,version$1$1,et),registerVersion(name$o,version$1$1,"esm2017"),registerVersion("fire-js","")}registerCoreComponents("");var name$7="firebase",version$6="9.23.0";registerVersion(name$7,version$6,"app");const name$6="@firebase/database",version$5="0.14.4";let SDK_VERSION="";function setSDKVersion(et){SDK_VERSION=et}class DOMStorageWrapper{constructor(tt){this.domStorage_=tt,this.prefix_="firebase:"}set(tt,rt){rt==null?this.domStorage_.removeItem(this.prefixedName_(tt)):this.domStorage_.setItem(this.prefixedName_(tt),stringify(rt))}get(tt){const rt=this.domStorage_.getItem(this.prefixedName_(tt));return rt==null?null:jsonEval(rt)}remove(tt){this.domStorage_.removeItem(this.prefixedName_(tt))}prefixedName_(tt){return this.prefix_+tt}toString(){return this.domStorage_.toString()}}class MemoryStorage{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(tt,rt){rt==null?delete this.cache_[tt]:this.cache_[tt]=rt}get(tt){return contains(this.cache_,tt)?this.cache_[tt]:null}remove(tt){delete this.cache_[tt]}}const createStoragefor=function(et){try{if(typeof window<"u"&&typeof window[et]<"u"){const tt=window[et];return tt.setItem("firebase:sentinel","cache"),tt.removeItem("firebase:sentinel"),new DOMStorageWrapper(tt)}}catch{}return new MemoryStorage},PersistentStorage=createStoragefor("localStorage"),SessionStorage=createStoragefor("sessionStorage"),logClient=new Logger("@firebase/database"),LUIDGenerator=function(){let et=1;return function(){return et++}}(),sha1$2=function(et){const tt=stringToByteArray(et),rt=new Sha1;rt.update(tt);const nt=rt.digest();return base64$a.encodeByteArray(nt)},buildLogMessage_=function(...et){let tt="";for(let rt=0;rt<et.length;rt++){const nt=et[rt];Array.isArray(nt)||nt&&typeof nt=="object"&&typeof nt.length=="number"?tt+=buildLogMessage_.apply(null,nt):typeof nt=="object"?tt+=stringify(nt):tt+=nt,tt+=" "}return tt};let logger=null,firstLog_=!0;const enableLogging$1=function(et,tt){assert(!tt||et===!0||et===!1,"Can't turn on custom loggers persistently."),et===!0?(logClient.logLevel=LogLevel.VERBOSE,logger=logClient.log.bind(logClient),tt&&SessionStorage.set("logging_enabled",!0)):typeof et=="function"?logger=et:(logger=null,SessionStorage.remove("logging_enabled"))},log$e=function(...et){if(firstLog_===!0&&(firstLog_=!1,logger===null&&SessionStorage.get("logging_enabled")===!0&&enableLogging$1(!0)),logger){const tt=buildLogMessage_.apply(null,et);logger(tt)}},logWrapper=function(et){return function(...tt){log$e(et,...tt)}},error$1=function(...et){const tt="FIREBASE INTERNAL ERROR: "+buildLogMessage_(...et);logClient.error(tt)},fatal=function(...et){const tt=`FIREBASE FATAL ERROR: ${buildLogMessage_(...et)}`;throw logClient.error(tt),new Error(tt)},warn$1=function(...et){const tt="FIREBASE WARNING: "+buildLogMessage_(...et);logClient.warn(tt)},warnIfPageIsSecure=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&warn$1("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},isInvalidJSONNumber=function(et){return typeof et=="number"&&(et!==et||et===Number.POSITIVE_INFINITY||et===Number.NEGATIVE_INFINITY)},executeWhenDOMReady=function(et){if(document.readyState==="complete")et();else{let tt=!1;const rt=function(){if(!document.body){setTimeout(rt,Math.floor(10));return}tt||(tt=!0,et())};document.addEventListener?(document.addEventListener("DOMContentLoaded",rt,!1),window.addEventListener("load",rt,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&rt()}),window.attachEvent("onload",rt))}},MIN_NAME="[MIN_NAME]",MAX_NAME="[MAX_NAME]",nameCompare=function(et,tt){if(et===tt)return 0;if(et===MIN_NAME||tt===MAX_NAME)return-1;if(tt===MIN_NAME||et===MAX_NAME)return 1;{const rt=tryParseInt(et),nt=tryParseInt(tt);return rt!==null?nt!==null?rt-nt===0?et.length-tt.length:rt-nt:-1:nt!==null?1:et<tt?-1:1}},stringCompare=function(et,tt){return et===tt?0:et<tt?-1:1},requireKey$2=function(et,tt){if(tt&&et in tt)return tt[et];throw new Error("Missing required key ("+et+") in object: "+stringify(tt))},ObjectToUniqueKey=function(et){if(typeof et!="object"||et===null)return stringify(et);const tt=[];for(const nt in et)tt.push(nt);tt.sort();let rt="{";for(let nt=0;nt<tt.length;nt++)nt!==0&&(rt+=","),rt+=stringify(tt[nt]),rt+=":",rt+=ObjectToUniqueKey(et[tt[nt]]);return rt+="}",rt},splitStringBySize=function(et,tt){const rt=et.length;if(rt<=tt)return[et];const nt=[];for(let it=0;it<rt;it+=tt)it+tt>rt?nt.push(et.substring(it,rt)):nt.push(et.substring(it,it+tt));return nt};function each(et,tt){for(const rt in et)et.hasOwnProperty(rt)&&tt(rt,et[rt])}const doubleToIEEE754String=function(et){assert(!isInvalidJSONNumber(et),"Invalid JSON number");const tt=11,rt=52,nt=(1<<tt-1)-1;let it,ot,st,at,ct;et===0?(ot=0,st=0,it=1/et===-1/0?1:0):(it=et<0,et=Math.abs(et),et>=Math.pow(2,1-nt)?(at=Math.min(Math.floor(Math.log(et)/Math.LN2),nt),ot=at+nt,st=Math.round(et*Math.pow(2,rt-at)-Math.pow(2,rt))):(ot=0,st=Math.round(et/Math.pow(2,1-nt-rt))));const ut=[];for(ct=rt;ct;ct-=1)ut.push(st%2?1:0),st=Math.floor(st/2);for(ct=tt;ct;ct-=1)ut.push(ot%2?1:0),ot=Math.floor(ot/2);ut.push(it?1:0),ut.reverse();const lt=ut.join("");let ht="";for(ct=0;ct<64;ct+=8){let ft=parseInt(lt.substr(ct,8),2).toString(16);ft.length===1&&(ft="0"+ft),ht=ht+ft}return ht.toLowerCase()},isChromeExtensionContentScript=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},isWindowsStoreApp=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"},INTEGER_REGEXP_=new RegExp("^-?(0*)\\d{1,10}$"),INTEGER_32_MIN=-2147483648,INTEGER_32_MAX=2147483647,tryParseInt=function(et){if(INTEGER_REGEXP_.test(et)){const tt=Number(et);if(tt>=INTEGER_32_MIN&&tt<=INTEGER_32_MAX)return tt}return null},exceptionGuard=function(et){try{et()}catch(tt){setTimeout(()=>{const rt=tt.stack||"";throw warn$1("Exception was thrown by user callback.",rt),tt},Math.floor(0))}},beingCrawled=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},setTimeoutNonBlocking=function(et,tt){const rt=setTimeout(et,tt);return typeof rt=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(rt):typeof rt=="object"&&rt.unref&&rt.unref(),rt};class AppCheckTokenProvider{constructor(tt,rt){this.appName_=tt,this.appCheckProvider=rt,this.appCheck=rt==null?void 0:rt.getImmediate({optional:!0}),this.appCheck||(rt==null||rt.get().then(nt=>this.appCheck=nt))}getToken(tt){return this.appCheck?this.appCheck.getToken(tt):new Promise((rt,nt)=>{setTimeout(()=>{this.appCheck?this.getToken(tt).then(rt,nt):rt(null)},0)})}addTokenChangeListener(tt){var rt;(rt=this.appCheckProvider)===null||rt===void 0||rt.get().then(nt=>nt.addTokenListener(tt))}notifyForInvalidToken(){warn$1(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class FirebaseAuthTokenProvider{constructor(tt,rt,nt){this.appName_=tt,this.firebaseOptions_=rt,this.authProvider_=nt,this.auth_=null,this.auth_=nt.getImmediate({optional:!0}),this.auth_||nt.onInit(it=>this.auth_=it)}getToken(tt){return this.auth_?this.auth_.getToken(tt).catch(rt=>rt&&rt.code==="auth/token-not-initialized"?(log$e("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(rt)):new Promise((rt,nt)=>{setTimeout(()=>{this.auth_?this.getToken(tt).then(rt,nt):rt(null)},0)})}addTokenChangeListener(tt){this.auth_?this.auth_.addAuthTokenListener(tt):this.authProvider_.get().then(rt=>rt.addAuthTokenListener(tt))}removeTokenChangeListener(tt){this.authProvider_.get().then(rt=>rt.removeAuthTokenListener(tt))}notifyForInvalidToken(){let tt='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?tt+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?tt+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':tt+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',warn$1(tt)}}class EmulatorTokenProvider{constructor(tt){this.accessToken=tt}getToken(tt){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(tt){tt(this.accessToken)}removeTokenChangeListener(tt){}notifyForInvalidToken(){}}EmulatorTokenProvider.OWNER="owner";const PROTOCOL_VERSION="5",VERSION_PARAM="v",TRANSPORT_SESSION_PARAM="s",REFERER_PARAM="r",FORGE_REF="f",FORGE_DOMAIN_RE=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,LAST_SESSION_PARAM="ls",APPLICATION_ID_PARAM="p",APP_CHECK_TOKEN_PARAM="ac",WEBSOCKET="websocket",LONG_POLLING="long_polling";class RepoInfo{constructor(tt,rt,nt,it,ot=!1,st="",at=!1,ct=!1){this.secure=rt,this.namespace=nt,this.webSocketOnly=it,this.nodeAdmin=ot,this.persistenceKey=st,this.includeNamespaceInQueryParams=at,this.isUsingEmulator=ct,this._host=tt.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=PersistentStorage.get("host:"+tt)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(tt){tt!==this.internalHost&&(this.internalHost=tt,this.isCacheableHost()&&PersistentStorage.set("host:"+this._host,this.internalHost))}toString(){let tt=this.toURLString();return this.persistenceKey&&(tt+="<"+this.persistenceKey+">"),tt}toURLString(){const tt=this.secure?"https://":"http://",rt=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${tt}${this.host}/${rt}`}}function repoInfoNeedsQueryParam(et){return et.host!==et.internalHost||et.isCustomHost()||et.includeNamespaceInQueryParams}function repoInfoConnectionURL(et,tt,rt){assert(typeof tt=="string","typeof type must == string"),assert(typeof rt=="object","typeof params must == object");let nt;if(tt===WEBSOCKET)nt=(et.secure?"wss://":"ws://")+et.internalHost+"/.ws?";else if(tt===LONG_POLLING)nt=(et.secure?"https://":"http://")+et.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+tt);repoInfoNeedsQueryParam(et)&&(rt.ns=et.namespace);const it=[];return each(rt,(ot,st)=>{it.push(ot+"="+st)}),nt+it.join("&")}class StatsCollection{constructor(){this.counters_={}}incrementCounter(tt,rt=1){contains(this.counters_,tt)||(this.counters_[tt]=0),this.counters_[tt]+=rt}get(){return deepCopy(this.counters_)}}const collections={},reporters={};function statsManagerGetCollection(et){const tt=et.toString();return collections[tt]||(collections[tt]=new StatsCollection),collections[tt]}function statsManagerGetOrCreateReporter(et,tt){const rt=et.toString();return reporters[rt]||(reporters[rt]=tt()),reporters[rt]}class PacketReceiver{constructor(tt){this.onMessage_=tt,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(tt,rt){this.closeAfterResponse=tt,this.onClose=rt,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(tt,rt){for(this.pendingResponses[tt]=rt;this.pendingResponses[this.currentResponseNum];){const nt=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let it=0;it<nt.length;++it)nt[it]&&exceptionGuard(()=>{this.onMessage_(nt[it])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}const FIREBASE_LONGPOLL_START_PARAM="start",FIREBASE_LONGPOLL_CLOSE_COMMAND="close",FIREBASE_LONGPOLL_COMMAND_CB_NAME="pLPCommand",FIREBASE_LONGPOLL_DATA_CB_NAME="pRTLPCB",FIREBASE_LONGPOLL_ID_PARAM="id",FIREBASE_LONGPOLL_PW_PARAM="pw",FIREBASE_LONGPOLL_SERIAL_PARAM="ser",FIREBASE_LONGPOLL_CALLBACK_ID_PARAM="cb",FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM="seg",FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET="ts",FIREBASE_LONGPOLL_DATA_PARAM="d",FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM="dframe",MAX_URL_DATA_SIZE=1870,SEG_HEADER_SIZE=30,MAX_PAYLOAD_SIZE=MAX_URL_DATA_SIZE-SEG_HEADER_SIZE,KEEPALIVE_REQUEST_INTERVAL=25e3,LP_CONNECT_TIMEOUT=3e4;class BrowserPollConnection{constructor(tt,rt,nt,it,ot,st,at){this.connId=tt,this.repoInfo=rt,this.applicationId=nt,this.appCheckToken=it,this.authToken=ot,this.transportSessionId=st,this.lastSessionId=at,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=logWrapper(tt),this.stats_=statsManagerGetCollection(rt),this.urlFn=ct=>(this.appCheckToken&&(ct[APP_CHECK_TOKEN_PARAM]=this.appCheckToken),repoInfoConnectionURL(rt,LONG_POLLING,ct))}open(tt,rt){this.curSegmentNum=0,this.onDisconnect_=rt,this.myPacketOrderer=new PacketReceiver(tt),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(LP_CONNECT_TIMEOUT)),executeWhenDOMReady(()=>{if(this.isClosed_)return;this.scriptTagHolder=new FirebaseIFrameScriptHolder((...ot)=>{const[st,at,ct,ut,lt]=ot;if(this.incrementIncomingBytes_(ot),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,st===FIREBASE_LONGPOLL_START_PARAM)this.id=at,this.password=ct;else if(st===FIREBASE_LONGPOLL_CLOSE_COMMAND)at?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(at,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+st)},(...ot)=>{const[st,at]=ot;this.incrementIncomingBytes_(ot),this.myPacketOrderer.handleResponse(st,at)},()=>{this.onClosed_()},this.urlFn);const nt={};nt[FIREBASE_LONGPOLL_START_PARAM]="t",nt[FIREBASE_LONGPOLL_SERIAL_PARAM]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(nt[FIREBASE_LONGPOLL_CALLBACK_ID_PARAM]=this.scriptTagHolder.uniqueCallbackIdentifier),nt[VERSION_PARAM]=PROTOCOL_VERSION,this.transportSessionId&&(nt[TRANSPORT_SESSION_PARAM]=this.transportSessionId),this.lastSessionId&&(nt[LAST_SESSION_PARAM]=this.lastSessionId),this.applicationId&&(nt[APPLICATION_ID_PARAM]=this.applicationId),this.appCheckToken&&(nt[APP_CHECK_TOKEN_PARAM]=this.appCheckToken),typeof location<"u"&&location.hostname&&FORGE_DOMAIN_RE.test(location.hostname)&&(nt[REFERER_PARAM]=FORGE_REF);const it=this.urlFn(nt);this.log_("Connecting via long-poll to "+it),this.scriptTagHolder.addTag(it,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){BrowserPollConnection.forceAllow_=!0}static forceDisallow(){BrowserPollConnection.forceDisallow_=!0}static isAvailable(){return BrowserPollConnection.forceAllow_?!0:!BrowserPollConnection.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!isChromeExtensionContentScript()&&!isWindowsStoreApp()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(tt){const rt=stringify(tt);this.bytesSent+=rt.length,this.stats_.incrementCounter("bytes_sent",rt.length);const nt=base64Encode(rt),it=splitStringBySize(nt,MAX_PAYLOAD_SIZE);for(let ot=0;ot<it.length;ot++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,it.length,it[ot]),this.curSegmentNum++}addDisconnectPingFrame(tt,rt){this.myDisconnFrame=document.createElement("iframe");const nt={};nt[FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM]="t",nt[FIREBASE_LONGPOLL_ID_PARAM]=tt,nt[FIREBASE_LONGPOLL_PW_PARAM]=rt,this.myDisconnFrame.src=this.urlFn(nt),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(tt){const rt=stringify(tt).length;this.bytesReceived+=rt,this.stats_.incrementCounter("bytes_received",rt)}}class FirebaseIFrameScriptHolder{constructor(tt,rt,nt,it){this.onDisconnect=nt,this.urlFn=it,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=LUIDGenerator(),window[FIREBASE_LONGPOLL_COMMAND_CB_NAME+this.uniqueCallbackIdentifier]=tt,window[FIREBASE_LONGPOLL_DATA_CB_NAME+this.uniqueCallbackIdentifier]=rt,this.myIFrame=FirebaseIFrameScriptHolder.createIFrame_();let ot="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(ot='<script>document.domain="'+document.domain+'";<\/script>');const st="<html><body>"+ot+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(st),this.myIFrame.doc.close()}catch(at){log$e("frame writing exception"),at.stack&&log$e(at.stack),log$e(at)}}}static createIFrame_(){const tt=document.createElement("iframe");if(tt.style.display="none",document.body){document.body.appendChild(tt);try{tt.contentWindow.document||log$e("No IE domain setting required")}catch{const rt=document.domain;tt.src="javascript:void((function(){document.open();document.domain='"+rt+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return tt.contentDocument?tt.doc=tt.contentDocument:tt.contentWindow?tt.doc=tt.contentWindow.document:tt.document&&(tt.doc=tt.document),tt}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const tt=this.onDisconnect;tt&&(this.onDisconnect=null,tt())}startLongPoll(tt,rt){for(this.myID=tt,this.myPW=rt,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const tt={};tt[FIREBASE_LONGPOLL_ID_PARAM]=this.myID,tt[FIREBASE_LONGPOLL_PW_PARAM]=this.myPW,tt[FIREBASE_LONGPOLL_SERIAL_PARAM]=this.currentSerial;let rt=this.urlFn(tt),nt="",it=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+SEG_HEADER_SIZE+nt.length<=MAX_URL_DATA_SIZE;){const ot=this.pendingSegs.shift();nt=nt+"&"+FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM+it+"="+ot.seg+"&"+FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET+it+"="+ot.ts+"&"+FIREBASE_LONGPOLL_DATA_PARAM+it+"="+ot.d,it++}return rt=rt+nt,this.addLongPollTag_(rt,this.currentSerial),!0}else return!1}enqueueSegment(tt,rt,nt){this.pendingSegs.push({seg:tt,ts:rt,d:nt}),this.alive&&this.newRequest_()}addLongPollTag_(tt,rt){this.outstandingRequests.add(rt);const nt=()=>{this.outstandingRequests.delete(rt),this.newRequest_()},it=setTimeout(nt,Math.floor(KEEPALIVE_REQUEST_INTERVAL)),ot=()=>{clearTimeout(it),nt()};this.addTag(tt,ot)}addTag(tt,rt){setTimeout(()=>{try{if(!this.sendNewPolls)return;const nt=this.myIFrame.doc.createElement("script");nt.type="text/javascript",nt.async=!0,nt.src=tt,nt.onload=nt.onreadystatechange=function(){const it=nt.readyState;(!it||it==="loaded"||it==="complete")&&(nt.onload=nt.onreadystatechange=null,nt.parentNode&&nt.parentNode.removeChild(nt),rt())},nt.onerror=()=>{log$e("Long-poll script failed to load: "+tt),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(nt)}catch{}},Math.floor(1))}}const WEBSOCKET_MAX_FRAME_SIZE=16384,WEBSOCKET_KEEPALIVE_INTERVAL=45e3;let WebSocketImpl=null;typeof MozWebSocket<"u"?WebSocketImpl=MozWebSocket:typeof WebSocket<"u"&&(WebSocketImpl=WebSocket);class WebSocketConnection{constructor(tt,rt,nt,it,ot,st,at){this.connId=tt,this.applicationId=nt,this.appCheckToken=it,this.authToken=ot,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=logWrapper(this.connId),this.stats_=statsManagerGetCollection(rt),this.connURL=WebSocketConnection.connectionURL_(rt,st,at,it,nt),this.nodeAdmin=rt.nodeAdmin}static connectionURL_(tt,rt,nt,it,ot){const st={};return st[VERSION_PARAM]=PROTOCOL_VERSION,typeof location<"u"&&location.hostname&&FORGE_DOMAIN_RE.test(location.hostname)&&(st[REFERER_PARAM]=FORGE_REF),rt&&(st[TRANSPORT_SESSION_PARAM]=rt),nt&&(st[LAST_SESSION_PARAM]=nt),it&&(st[APP_CHECK_TOKEN_PARAM]=it),ot&&(st[APPLICATION_ID_PARAM]=ot),repoInfoConnectionURL(tt,WEBSOCKET,st)}open(tt,rt){this.onDisconnect=rt,this.onMessage=tt,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,PersistentStorage.set("previous_websocket_failure",!0);try{let nt;isNodeSdk(),this.mySock=new WebSocketImpl(this.connURL,[],nt)}catch(nt){this.log_("Error instantiating WebSocket.");const it=nt.message||nt.data;it&&this.log_(it),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=nt=>{this.handleIncomingFrame(nt)},this.mySock.onerror=nt=>{this.log_("WebSocket error.  Closing connection.");const it=nt.message||nt.data;it&&this.log_(it),this.onClosed_()}}start(){}static forceDisallow(){WebSocketConnection.forceDisallow_=!0}static isAvailable(){let tt=!1;if(typeof navigator<"u"&&navigator.userAgent){const rt=/Android ([0-9]{0,}\.[0-9]{0,})/,nt=navigator.userAgent.match(rt);nt&&nt.length>1&&parseFloat(nt[1])<4.4&&(tt=!0)}return!tt&&WebSocketImpl!==null&&!WebSocketConnection.forceDisallow_}static previouslyFailed(){return PersistentStorage.isInMemoryStorage||PersistentStorage.get("previous_websocket_failure")===!0}markConnectionHealthy(){PersistentStorage.remove("previous_websocket_failure")}appendFrame_(tt){if(this.frames.push(tt),this.frames.length===this.totalFrames){const rt=this.frames.join("");this.frames=null;const nt=jsonEval(rt);this.onMessage(nt)}}handleNewFrameCount_(tt){this.totalFrames=tt,this.frames=[]}extractFrameCount_(tt){if(assert(this.frames===null,"We already have a frame buffer"),tt.length<=6){const rt=Number(tt);if(!isNaN(rt))return this.handleNewFrameCount_(rt),null}return this.handleNewFrameCount_(1),tt}handleIncomingFrame(tt){if(this.mySock===null)return;const rt=tt.data;if(this.bytesReceived+=rt.length,this.stats_.incrementCounter("bytes_received",rt.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(rt);else{const nt=this.extractFrameCount_(rt);nt!==null&&this.appendFrame_(nt)}}send(tt){this.resetKeepAlive();const rt=stringify(tt);this.bytesSent+=rt.length,this.stats_.incrementCounter("bytes_sent",rt.length);const nt=splitStringBySize(rt,WEBSOCKET_MAX_FRAME_SIZE);nt.length>1&&this.sendString_(String(nt.length));for(let it=0;it<nt.length;it++)this.sendString_(nt[it])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(WEBSOCKET_KEEPALIVE_INTERVAL))}sendString_(tt){try{this.mySock.send(tt)}catch(rt){this.log_("Exception thrown from WebSocket.send():",rt.message||rt.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}WebSocketConnection.responsesRequiredToBeHealthy=2,WebSocketConnection.healthyTimeout=3e4;class TransportManager{constructor(tt){this.initTransports_(tt)}static get ALL_TRANSPORTS(){return[BrowserPollConnection,WebSocketConnection]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(tt){const rt=WebSocketConnection&&WebSocketConnection.isAvailable();let nt=rt&&!WebSocketConnection.previouslyFailed();if(tt.webSocketOnly&&(rt||warn$1("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),nt=!0),nt)this.transports_=[WebSocketConnection];else{const it=this.transports_=[];for(const ot of TransportManager.ALL_TRANSPORTS)ot&&ot.isAvailable()&&it.push(ot);TransportManager.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}TransportManager.globalTransportInitialized_=!1;const UPGRADE_TIMEOUT=6e4,DELAY_BEFORE_SENDING_EXTRA_REQUESTS=5e3,BYTES_SENT_HEALTHY_OVERRIDE=10*1024,BYTES_RECEIVED_HEALTHY_OVERRIDE=100*1024,MESSAGE_TYPE="t",MESSAGE_DATA="d",CONTROL_SHUTDOWN="s",CONTROL_RESET="r",CONTROL_ERROR="e",CONTROL_PONG="o",SWITCH_ACK="a",END_TRANSMISSION="n",PING="p",SERVER_HELLO="h";class Connection{constructor(tt,rt,nt,it,ot,st,at,ct,ut,lt){this.id=tt,this.repoInfo_=rt,this.applicationId_=nt,this.appCheckToken_=it,this.authToken_=ot,this.onMessage_=st,this.onReady_=at,this.onDisconnect_=ct,this.onKill_=ut,this.lastSessionId=lt,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=logWrapper("c:"+this.id+":"),this.transportManager_=new TransportManager(rt),this.log_("Connection created"),this.start_()}start_(){const tt=this.transportManager_.initialTransport();this.conn_=new tt(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=tt.responsesRequiredToBeHealthy||0;const rt=this.connReceiver_(this.conn_),nt=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(rt,nt)},Math.floor(0));const it=tt.healthyTimeout||0;it>0&&(this.healthyTimeout_=setTimeoutNonBlocking(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>BYTES_RECEIVED_HEALTHY_OVERRIDE?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>BYTES_SENT_HEALTHY_OVERRIDE?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(it)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(tt){return rt=>{tt===this.conn_?this.onConnectionLost_(rt):tt===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(tt){return rt=>{this.state_!==2&&(tt===this.rx_?this.onPrimaryMessageReceived_(rt):tt===this.secondaryConn_?this.onSecondaryMessageReceived_(rt):this.log_("message on old connection"))}}sendRequest(tt){const rt={t:"d",d:tt};this.sendData_(rt)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(tt){if(MESSAGE_TYPE in tt){const rt=tt[MESSAGE_TYPE];rt===SWITCH_ACK?this.upgradeIfSecondaryHealthy_():rt===CONTROL_RESET?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):rt===CONTROL_PONG&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(tt){const rt=requireKey$2("t",tt),nt=requireKey$2("d",tt);if(rt==="c")this.onSecondaryControl_(nt);else if(rt==="d")this.pendingDataMessages.push(nt);else throw new Error("Unknown protocol layer: "+rt)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:PING,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:SWITCH_ACK,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:END_TRANSMISSION,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(tt){const rt=requireKey$2("t",tt),nt=requireKey$2("d",tt);rt==="c"?this.onControl_(nt):rt==="d"&&this.onDataMessage_(nt)}onDataMessage_(tt){this.onPrimaryResponse_(),this.onMessage_(tt)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(tt){const rt=requireKey$2(MESSAGE_TYPE,tt);if(MESSAGE_DATA in tt){const nt=tt[MESSAGE_DATA];if(rt===SERVER_HELLO){const it=Object.assign({},nt);this.repoInfo_.isUsingEmulator&&(it.h=this.repoInfo_.host),this.onHandshake_(it)}else if(rt===END_TRANSMISSION){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let it=0;it<this.pendingDataMessages.length;++it)this.onDataMessage_(this.pendingDataMessages[it]);this.pendingDataMessages=[],this.tryCleanupConnection()}else rt===CONTROL_SHUTDOWN?this.onConnectionShutdown_(nt):rt===CONTROL_RESET?this.onReset_(nt):rt===CONTROL_ERROR?error$1("Server Error: "+nt):rt===CONTROL_PONG?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):error$1("Unknown control packet command: "+rt)}}onHandshake_(tt){const rt=tt.ts,nt=tt.v,it=tt.h;this.sessionId=tt.s,this.repoInfo_.host=it,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,rt),PROTOCOL_VERSION!==nt&&warn$1("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const tt=this.transportManager_.upgradeTransport();tt&&this.startUpgrade_(tt)}startUpgrade_(tt){this.secondaryConn_=new tt(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=tt.responsesRequiredToBeHealthy||0;const rt=this.connReceiver_(this.secondaryConn_),nt=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(rt,nt),setTimeoutNonBlocking(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(UPGRADE_TIMEOUT))}onReset_(tt){this.log_("Reset packet received.  New host: "+tt),this.repoInfo_.host=tt,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(tt,rt){this.log_("Realtime connection established."),this.conn_=tt,this.state_=1,this.onReady_&&(this.onReady_(rt,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):setTimeoutNonBlocking(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(DELAY_BEFORE_SENDING_EXTRA_REQUESTS))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:PING,d:{}}}))}onSecondaryConnectionLost_(){const tt=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===tt||this.rx_===tt)&&this.close()}onConnectionLost_(tt){this.conn_=null,!tt&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(PersistentStorage.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(tt){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(tt),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(tt){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(tt)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class ServerActions{put(tt,rt,nt,it){}merge(tt,rt,nt,it){}refreshAuthToken(tt){}refreshAppCheckToken(tt){}onDisconnectPut(tt,rt,nt){}onDisconnectMerge(tt,rt,nt){}onDisconnectCancel(tt,rt){}reportStats(tt){}}let EventEmitter$7=class{constructor(et){this.allowedEvents_=et,this.listeners_={},assert(Array.isArray(et)&&et.length>0,"Requires a non-empty array")}trigger(et,...tt){if(Array.isArray(this.listeners_[et])){const rt=[...this.listeners_[et]];for(let nt=0;nt<rt.length;nt++)rt[nt].callback.apply(rt[nt].context,tt)}}on(et,tt,rt){this.validateEventType_(et),this.listeners_[et]=this.listeners_[et]||[],this.listeners_[et].push({callback:tt,context:rt});const nt=this.getInitialEvent(et);nt&&tt.apply(rt,nt)}off(et,tt,rt){this.validateEventType_(et);const nt=this.listeners_[et]||[];for(let it=0;it<nt.length;it++)if(nt[it].callback===tt&&(!rt||rt===nt[it].context)){nt.splice(it,1);return}}validateEventType_(et){assert(this.allowedEvents_.find(tt=>tt===et),"Unknown event: "+et)}};class OnlineMonitor extends EventEmitter$7{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!isMobileCordova()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new OnlineMonitor}getInitialEvent(tt){return assert(tt==="online","Unknown event type: "+tt),[this.online_]}currentlyOnline(){return this.online_}}const MAX_PATH_DEPTH=32,MAX_PATH_LENGTH_BYTES=768;class Path{constructor(tt,rt){if(rt===void 0){this.pieces_=tt.split("/");let nt=0;for(let it=0;it<this.pieces_.length;it++)this.pieces_[it].length>0&&(this.pieces_[nt]=this.pieces_[it],nt++);this.pieces_.length=nt,this.pieceNum_=0}else this.pieces_=tt,this.pieceNum_=rt}toString(){let tt="";for(let rt=this.pieceNum_;rt<this.pieces_.length;rt++)this.pieces_[rt]!==""&&(tt+="/"+this.pieces_[rt]);return tt||"/"}}function newEmptyPath(){return new Path("")}function pathGetFront(et){return et.pieceNum_>=et.pieces_.length?null:et.pieces_[et.pieceNum_]}function pathGetLength(et){return et.pieces_.length-et.pieceNum_}function pathPopFront(et){let tt=et.pieceNum_;return tt<et.pieces_.length&&tt++,new Path(et.pieces_,tt)}function pathGetBack(et){return et.pieceNum_<et.pieces_.length?et.pieces_[et.pieces_.length-1]:null}function pathToUrlEncodedString(et){let tt="";for(let rt=et.pieceNum_;rt<et.pieces_.length;rt++)et.pieces_[rt]!==""&&(tt+="/"+encodeURIComponent(String(et.pieces_[rt])));return tt||"/"}function pathSlice(et,tt=0){return et.pieces_.slice(et.pieceNum_+tt)}function pathParent(et){if(et.pieceNum_>=et.pieces_.length)return null;const tt=[];for(let rt=et.pieceNum_;rt<et.pieces_.length-1;rt++)tt.push(et.pieces_[rt]);return new Path(tt,0)}function pathChild(et,tt){const rt=[];for(let nt=et.pieceNum_;nt<et.pieces_.length;nt++)rt.push(et.pieces_[nt]);if(tt instanceof Path)for(let nt=tt.pieceNum_;nt<tt.pieces_.length;nt++)rt.push(tt.pieces_[nt]);else{const nt=tt.split("/");for(let it=0;it<nt.length;it++)nt[it].length>0&&rt.push(nt[it])}return new Path(rt,0)}function pathIsEmpty(et){return et.pieceNum_>=et.pieces_.length}function newRelativePath(et,tt){const rt=pathGetFront(et),nt=pathGetFront(tt);if(rt===null)return tt;if(rt===nt)return newRelativePath(pathPopFront(et),pathPopFront(tt));throw new Error("INTERNAL ERROR: innerPath ("+tt+") is not within outerPath ("+et+")")}function pathEquals(et,tt){if(pathGetLength(et)!==pathGetLength(tt))return!1;for(let rt=et.pieceNum_,nt=tt.pieceNum_;rt<=et.pieces_.length;rt++,nt++)if(et.pieces_[rt]!==tt.pieces_[nt])return!1;return!0}function pathContains(et,tt){let rt=et.pieceNum_,nt=tt.pieceNum_;if(pathGetLength(et)>pathGetLength(tt))return!1;for(;rt<et.pieces_.length;){if(et.pieces_[rt]!==tt.pieces_[nt])return!1;++rt,++nt}return!0}class ValidationPath{constructor(tt,rt){this.errorPrefix_=rt,this.parts_=pathSlice(tt,0),this.byteLength_=Math.max(1,this.parts_.length);for(let nt=0;nt<this.parts_.length;nt++)this.byteLength_+=stringLength(this.parts_[nt]);validationPathCheckValid(this)}}function validationPathPush(et,tt){et.parts_.length>0&&(et.byteLength_+=1),et.parts_.push(tt),et.byteLength_+=stringLength(tt),validationPathCheckValid(et)}function validationPathPop(et){const tt=et.parts_.pop();et.byteLength_-=stringLength(tt),et.parts_.length>0&&(et.byteLength_-=1)}function validationPathCheckValid(et){if(et.byteLength_>MAX_PATH_LENGTH_BYTES)throw new Error(et.errorPrefix_+"has a key path longer than "+MAX_PATH_LENGTH_BYTES+" bytes ("+et.byteLength_+").");if(et.parts_.length>MAX_PATH_DEPTH)throw new Error(et.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+MAX_PATH_DEPTH+") or object contains a cycle "+validationPathToErrorString(et))}function validationPathToErrorString(et){return et.parts_.length===0?"":"in property '"+et.parts_.join(".")+"'"}class VisibilityMonitor extends EventEmitter$7{constructor(){super(["visible"]);let tt,rt;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(rt="visibilitychange",tt="hidden"):typeof document.mozHidden<"u"?(rt="mozvisibilitychange",tt="mozHidden"):typeof document.msHidden<"u"?(rt="msvisibilitychange",tt="msHidden"):typeof document.webkitHidden<"u"&&(rt="webkitvisibilitychange",tt="webkitHidden")),this.visible_=!0,rt&&document.addEventListener(rt,()=>{const nt=!document[tt];nt!==this.visible_&&(this.visible_=nt,this.trigger("visible",nt))},!1)}static getInstance(){return new VisibilityMonitor}getInitialEvent(tt){return assert(tt==="visible","Unknown event type: "+tt),[this.visible_]}}const RECONNECT_MIN_DELAY=1e3,RECONNECT_MAX_DELAY_DEFAULT=60*5*1e3,RECONNECT_MAX_DELAY_FOR_ADMINS=30*1e3,RECONNECT_DELAY_MULTIPLIER=1.3,RECONNECT_DELAY_RESET_TIMEOUT=3e4,SERVER_KILL_INTERRUPT_REASON="server_kill",INVALID_TOKEN_THRESHOLD=3;class PersistentConnection extends ServerActions{constructor(tt,rt,nt,it,ot,st,at,ct){if(super(),this.repoInfo_=tt,this.applicationId_=rt,this.onDataUpdate_=nt,this.onConnectStatus_=it,this.onServerInfoUpdate_=ot,this.authTokenProvider_=st,this.appCheckTokenProvider_=at,this.authOverride_=ct,this.id=PersistentConnection.nextPersistentConnectionId_++,this.log_=logWrapper("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=RECONNECT_MIN_DELAY,this.maxReconnectDelay_=RECONNECT_MAX_DELAY_DEFAULT,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,ct&&!isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");VisibilityMonitor.getInstance().on("visible",this.onVisible_,this),tt.host.indexOf("fblocal")===-1&&OnlineMonitor.getInstance().on("online",this.onOnline_,this)}sendRequest(tt,rt,nt){const it=++this.requestNumber_,ot={r:it,a:tt,b:rt};this.log_(stringify(ot)),assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(ot),nt&&(this.requestCBHash_[it]=nt)}get(tt){this.initConnection_();const rt=new Deferred,nt={action:"g",request:{p:tt._path.toString(),q:tt._queryObject},onComplete:ot=>{const st=ot.d;ot.s==="ok"?rt.resolve(st):rt.reject(st)}};this.outstandingGets_.push(nt),this.outstandingGetCount_++;const it=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(it),rt.promise}listen(tt,rt,nt,it){this.initConnection_();const ot=tt._queryIdentifier,st=tt._path.toString();this.log_("Listen called for "+st+" "+ot),this.listens.has(st)||this.listens.set(st,new Map),assert(tt._queryParams.isDefault()||!tt._queryParams.loadsAllData(),"listen() called for non-default but complete query"),assert(!this.listens.get(st).has(ot),"listen() called twice for same path/queryId.");const at={onComplete:it,hashFn:rt,query:tt,tag:nt};this.listens.get(st).set(ot,at),this.connected_&&this.sendListen_(at)}sendGet_(tt){const rt=this.outstandingGets_[tt];this.sendRequest("g",rt.request,nt=>{delete this.outstandingGets_[tt],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),rt.onComplete&&rt.onComplete(nt)})}sendListen_(tt){const rt=tt.query,nt=rt._path.toString(),it=rt._queryIdentifier;this.log_("Listen on "+nt+" for "+it);const ot={p:nt},st="q";tt.tag&&(ot.q=rt._queryObject,ot.t=tt.tag),ot.h=tt.hashFn(),this.sendRequest(st,ot,at=>{const ct=at.d,ut=at.s;PersistentConnection.warnOnListenWarnings_(ct,rt),(this.listens.get(nt)&&this.listens.get(nt).get(it))===tt&&(this.log_("listen response",at),ut!=="ok"&&this.removeListen_(nt,it),tt.onComplete&&tt.onComplete(ut,ct))})}static warnOnListenWarnings_(tt,rt){if(tt&&typeof tt=="object"&&contains(tt,"w")){const nt=safeGet(tt,"w");if(Array.isArray(nt)&&~nt.indexOf("no_index")){const it='".indexOn": "'+rt._queryParams.getIndex().toString()+'"',ot=rt._path.toString();warn$1(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${it} at ${ot} to your security rules for better performance.`)}}}refreshAuthToken(tt){this.authToken_=tt,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(tt)}reduceReconnectDelayIfAdminCredential_(tt){(tt&&tt.length===40||isAdmin(tt))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=RECONNECT_MAX_DELAY_FOR_ADMINS)}refreshAppCheckToken(tt){this.appCheckToken_=tt,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const tt=this.authToken_,rt=isValidFormat(tt)?"auth":"gauth",nt={cred:tt};this.authOverride_===null?nt.noauth=!0:typeof this.authOverride_=="object"&&(nt.authvar=this.authOverride_),this.sendRequest(rt,nt,it=>{const ot=it.s,st=it.d||"error";this.authToken_===tt&&(ot==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(ot,st))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},tt=>{const rt=tt.s,nt=tt.d||"error";rt==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(rt,nt)})}unlisten(tt,rt){const nt=tt._path.toString(),it=tt._queryIdentifier;this.log_("Unlisten called for "+nt+" "+it),assert(tt._queryParams.isDefault()||!tt._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(nt,it)&&this.connected_&&this.sendUnlisten_(nt,it,tt._queryObject,rt)}sendUnlisten_(tt,rt,nt,it){this.log_("Unlisten on "+tt+" for "+rt);const ot={p:tt},st="n";it&&(ot.q=nt,ot.t=it),this.sendRequest(st,ot)}onDisconnectPut(tt,rt,nt){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",tt,rt,nt):this.onDisconnectRequestQueue_.push({pathString:tt,action:"o",data:rt,onComplete:nt})}onDisconnectMerge(tt,rt,nt){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",tt,rt,nt):this.onDisconnectRequestQueue_.push({pathString:tt,action:"om",data:rt,onComplete:nt})}onDisconnectCancel(tt,rt){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",tt,null,rt):this.onDisconnectRequestQueue_.push({pathString:tt,action:"oc",data:null,onComplete:rt})}sendOnDisconnect_(tt,rt,nt,it){const ot={p:rt,d:nt};this.log_("onDisconnect "+tt,ot),this.sendRequest(tt,ot,st=>{it&&setTimeout(()=>{it(st.s,st.d)},Math.floor(0))})}put(tt,rt,nt,it){this.putInternal("p",tt,rt,nt,it)}merge(tt,rt,nt,it){this.putInternal("m",tt,rt,nt,it)}putInternal(tt,rt,nt,it,ot){this.initConnection_();const st={p:rt,d:nt};ot!==void 0&&(st.h=ot),this.outstandingPuts_.push({action:tt,request:st,onComplete:it}),this.outstandingPutCount_++;const at=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(at):this.log_("Buffering put: "+rt)}sendPut_(tt){const rt=this.outstandingPuts_[tt].action,nt=this.outstandingPuts_[tt].request,it=this.outstandingPuts_[tt].onComplete;this.outstandingPuts_[tt].queued=this.connected_,this.sendRequest(rt,nt,ot=>{this.log_(rt+" response",ot),delete this.outstandingPuts_[tt],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),it&&it(ot.s,ot.d)})}reportStats(tt){if(this.connected_){const rt={c:tt};this.log_("reportStats",rt),this.sendRequest("s",rt,nt=>{if(nt.s!=="ok"){const it=nt.d;this.log_("reportStats","Error sending stats: "+it)}})}}onDataMessage_(tt){if("r"in tt){this.log_("from server: "+stringify(tt));const rt=tt.r,nt=this.requestCBHash_[rt];nt&&(delete this.requestCBHash_[rt],nt(tt.b))}else{if("error"in tt)throw"A server-side error has occurred: "+tt.error;"a"in tt&&this.onDataPush_(tt.a,tt.b)}}onDataPush_(tt,rt){this.log_("handleServerMessage",tt,rt),tt==="d"?this.onDataUpdate_(rt.p,rt.d,!1,rt.t):tt==="m"?this.onDataUpdate_(rt.p,rt.d,!0,rt.t):tt==="c"?this.onListenRevoked_(rt.p,rt.q):tt==="ac"?this.onAuthRevoked_(rt.s,rt.d):tt==="apc"?this.onAppCheckRevoked_(rt.s,rt.d):tt==="sd"?this.onSecurityDebugPacket_(rt):error$1("Unrecognized action received from server: "+stringify(tt)+`
Are you using the latest client?`)}onReady_(tt,rt){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(tt),this.lastSessionId=rt,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(tt){assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(tt))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(tt){tt&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0)),this.visible_=tt}onOnline_(tt){tt?(this.log_("Browser went online."),this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>RECONNECT_DELAY_RESET_TIMEOUT&&(this.reconnectDelay_=RECONNECT_MIN_DELAY),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const tt=new Date().getTime()-this.lastConnectionAttemptTime_;let rt=Math.max(0,this.reconnectDelay_-tt);rt=Math.random()*rt,this.log_("Trying to reconnect in "+rt+"ms"),this.scheduleConnect_(rt),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*RECONNECT_DELAY_MULTIPLIER)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const tt=this.onDataMessage_.bind(this),rt=this.onReady_.bind(this),nt=this.onRealtimeDisconnect_.bind(this),it=this.id+":"+PersistentConnection.nextConnectionId_++,ot=this.lastSessionId;let st=!1,at=null;const ct=function(){at?at.close():(st=!0,nt())},ut=function(ht){assert(at,"sendRequest call when we're not connected not allowed."),at.sendRequest(ht)};this.realtime_={close:ct,sendRequest:ut};const lt=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[ht,ft]=await Promise.all([this.authTokenProvider_.getToken(lt),this.appCheckTokenProvider_.getToken(lt)]);st?log$e("getToken() completed but was canceled"):(log$e("getToken() completed. Creating connection."),this.authToken_=ht&&ht.accessToken,this.appCheckToken_=ft&&ft.token,at=new Connection(it,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,tt,rt,nt,dt=>{warn$1(dt+" ("+this.repoInfo_.toString()+")"),this.interrupt(SERVER_KILL_INTERRUPT_REASON)},ot))}catch(ht){this.log_("Failed to get token: "+ht),st||(this.repoInfo_.nodeAdmin&&warn$1(ht),ct())}}}interrupt(tt){log$e("Interrupting connection for reason: "+tt),this.interruptReasons_[tt]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(tt){log$e("Resuming connection for reason: "+tt),delete this.interruptReasons_[tt],isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=RECONNECT_MIN_DELAY,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(tt){const rt=tt-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:rt})}cancelSentTransactions_(){for(let tt=0;tt<this.outstandingPuts_.length;tt++){const rt=this.outstandingPuts_[tt];rt&&"h"in rt.request&&rt.queued&&(rt.onComplete&&rt.onComplete("disconnect"),delete this.outstandingPuts_[tt],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(tt,rt){let nt;rt?nt=rt.map(ot=>ObjectToUniqueKey(ot)).join("$"):nt="default";const it=this.removeListen_(tt,nt);it&&it.onComplete&&it.onComplete("permission_denied")}removeListen_(tt,rt){const nt=new Path(tt).toString();let it;if(this.listens.has(nt)){const ot=this.listens.get(nt);it=ot.get(rt),ot.delete(rt),ot.size===0&&this.listens.delete(nt)}else it=void 0;return it}onAuthRevoked_(tt,rt){log$e("Auth token revoked: "+tt+"/"+rt),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(tt==="invalid_token"||tt==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=INVALID_TOKEN_THRESHOLD&&(this.reconnectDelay_=RECONNECT_MAX_DELAY_FOR_ADMINS,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(tt,rt){log$e("App check token revoked: "+tt+"/"+rt),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(tt==="invalid_token"||tt==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=INVALID_TOKEN_THRESHOLD&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(tt){this.securityDebugCallback_?this.securityDebugCallback_(tt):"msg"in tt&&console.log("FIREBASE: "+tt.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const tt of this.listens.values())for(const rt of tt.values())this.sendListen_(rt);for(let tt=0;tt<this.outstandingPuts_.length;tt++)this.outstandingPuts_[tt]&&this.sendPut_(tt);for(;this.onDisconnectRequestQueue_.length;){const tt=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(tt.action,tt.pathString,tt.data,tt.onComplete)}for(let tt=0;tt<this.outstandingGets_.length;tt++)this.outstandingGets_[tt]&&this.sendGet_(tt)}sendConnectStats_(){const tt={};let rt="js";tt["sdk."+rt+"."+SDK_VERSION.replace(/\./g,"-")]=1,isMobileCordova()?tt["framework.cordova"]=1:isReactNative$1()&&(tt["framework.reactnative"]=1),this.reportStats(tt)}shouldReconnect_(){const tt=OnlineMonitor.getInstance().currentlyOnline();return isEmpty(this.interruptReasons_)&&tt}}PersistentConnection.nextPersistentConnectionId_=0,PersistentConnection.nextConnectionId_=0;class NamedNode{constructor(tt,rt){this.name=tt,this.node=rt}static Wrap(tt,rt){return new NamedNode(tt,rt)}}class Index{getCompare(){return this.compare.bind(this)}indexedValueChanged(tt,rt){const nt=new NamedNode(MIN_NAME,tt),it=new NamedNode(MIN_NAME,rt);return this.compare(nt,it)!==0}minPost(){return NamedNode.MIN}}let __EMPTY_NODE;class KeyIndex extends Index{static get __EMPTY_NODE(){return __EMPTY_NODE}static set __EMPTY_NODE(tt){__EMPTY_NODE=tt}compare(tt,rt){return nameCompare(tt.name,rt.name)}isDefinedOn(tt){throw assertionError("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(tt,rt){return!1}minPost(){return NamedNode.MIN}maxPost(){return new NamedNode(MAX_NAME,__EMPTY_NODE)}makePost(tt,rt){return assert(typeof tt=="string","KeyIndex indexValue must always be a string."),new NamedNode(tt,__EMPTY_NODE)}toString(){return".key"}}const KEY_INDEX=new KeyIndex;class SortedMapIterator{constructor(tt,rt,nt,it,ot=null){this.isReverse_=it,this.resultGenerator_=ot,this.nodeStack_=[];let st=1;for(;!tt.isEmpty();)if(tt=tt,st=rt?nt(tt.key,rt):1,it&&(st*=-1),st<0)this.isReverse_?tt=tt.left:tt=tt.right;else if(st===0){this.nodeStack_.push(tt);break}else this.nodeStack_.push(tt),this.isReverse_?tt=tt.right:tt=tt.left}getNext(){if(this.nodeStack_.length===0)return null;let tt=this.nodeStack_.pop(),rt;if(this.resultGenerator_?rt=this.resultGenerator_(tt.key,tt.value):rt={key:tt.key,value:tt.value},this.isReverse_)for(tt=tt.left;!tt.isEmpty();)this.nodeStack_.push(tt),tt=tt.right;else for(tt=tt.right;!tt.isEmpty();)this.nodeStack_.push(tt),tt=tt.left;return rt}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const tt=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(tt.key,tt.value):{key:tt.key,value:tt.value}}}class LLRBNode{constructor(tt,rt,nt,it,ot){this.key=tt,this.value=rt,this.color=nt??LLRBNode.RED,this.left=it??SortedMap.EMPTY_NODE,this.right=ot??SortedMap.EMPTY_NODE}copy(tt,rt,nt,it,ot){return new LLRBNode(tt??this.key,rt??this.value,nt??this.color,it??this.left,ot??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(tt){return this.left.inorderTraversal(tt)||!!tt(this.key,this.value)||this.right.inorderTraversal(tt)}reverseTraversal(tt){return this.right.reverseTraversal(tt)||tt(this.key,this.value)||this.left.reverseTraversal(tt)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(tt,rt,nt){let it=this;const ot=nt(tt,it.key);return ot<0?it=it.copy(null,null,null,it.left.insert(tt,rt,nt),null):ot===0?it=it.copy(null,rt,null,null,null):it=it.copy(null,null,null,null,it.right.insert(tt,rt,nt)),it.fixUp_()}removeMin_(){if(this.left.isEmpty())return SortedMap.EMPTY_NODE;let tt=this;return!tt.left.isRed_()&&!tt.left.left.isRed_()&&(tt=tt.moveRedLeft_()),tt=tt.copy(null,null,null,tt.left.removeMin_(),null),tt.fixUp_()}remove(tt,rt){let nt,it;if(nt=this,rt(tt,nt.key)<0)!nt.left.isEmpty()&&!nt.left.isRed_()&&!nt.left.left.isRed_()&&(nt=nt.moveRedLeft_()),nt=nt.copy(null,null,null,nt.left.remove(tt,rt),null);else{if(nt.left.isRed_()&&(nt=nt.rotateRight_()),!nt.right.isEmpty()&&!nt.right.isRed_()&&!nt.right.left.isRed_()&&(nt=nt.moveRedRight_()),rt(tt,nt.key)===0){if(nt.right.isEmpty())return SortedMap.EMPTY_NODE;it=nt.right.min_(),nt=nt.copy(it.key,it.value,null,null,nt.right.removeMin_())}nt=nt.copy(null,null,null,null,nt.right.remove(tt,rt))}return nt.fixUp_()}isRed_(){return this.color}fixUp_(){let tt=this;return tt.right.isRed_()&&!tt.left.isRed_()&&(tt=tt.rotateLeft_()),tt.left.isRed_()&&tt.left.left.isRed_()&&(tt=tt.rotateRight_()),tt.left.isRed_()&&tt.right.isRed_()&&(tt=tt.colorFlip_()),tt}moveRedLeft_(){let tt=this.colorFlip_();return tt.right.left.isRed_()&&(tt=tt.copy(null,null,null,null,tt.right.rotateRight_()),tt=tt.rotateLeft_(),tt=tt.colorFlip_()),tt}moveRedRight_(){let tt=this.colorFlip_();return tt.left.left.isRed_()&&(tt=tt.rotateRight_(),tt=tt.colorFlip_()),tt}rotateLeft_(){const tt=this.copy(null,null,LLRBNode.RED,null,this.right.left);return this.right.copy(null,null,this.color,tt,null)}rotateRight_(){const tt=this.copy(null,null,LLRBNode.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,tt)}colorFlip_(){const tt=this.left.copy(null,null,!this.left.color,null,null),rt=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,tt,rt)}checkMaxDepth_(){const tt=this.check_();return Math.pow(2,tt)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const tt=this.left.check_();if(tt!==this.right.check_())throw new Error("Black depths differ");return tt+(this.isRed_()?0:1)}}LLRBNode.RED=!0,LLRBNode.BLACK=!1;class LLRBEmptyNode{copy(tt,rt,nt,it,ot){return this}insert(tt,rt,nt){return new LLRBNode(tt,rt,null)}remove(tt,rt){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(tt){return!1}reverseTraversal(tt){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class SortedMap{constructor(tt,rt=SortedMap.EMPTY_NODE){this.comparator_=tt,this.root_=rt}insert(tt,rt){return new SortedMap(this.comparator_,this.root_.insert(tt,rt,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))}remove(tt){return new SortedMap(this.comparator_,this.root_.remove(tt,this.comparator_).copy(null,null,LLRBNode.BLACK,null,null))}get(tt){let rt,nt=this.root_;for(;!nt.isEmpty();){if(rt=this.comparator_(tt,nt.key),rt===0)return nt.value;rt<0?nt=nt.left:rt>0&&(nt=nt.right)}return null}getPredecessorKey(tt){let rt,nt=this.root_,it=null;for(;!nt.isEmpty();)if(rt=this.comparator_(tt,nt.key),rt===0){if(nt.left.isEmpty())return it?it.key:null;for(nt=nt.left;!nt.right.isEmpty();)nt=nt.right;return nt.key}else rt<0?nt=nt.left:rt>0&&(it=nt,nt=nt.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(tt){return this.root_.inorderTraversal(tt)}reverseTraversal(tt){return this.root_.reverseTraversal(tt)}getIterator(tt){return new SortedMapIterator(this.root_,null,this.comparator_,!1,tt)}getIteratorFrom(tt,rt){return new SortedMapIterator(this.root_,tt,this.comparator_,!1,rt)}getReverseIteratorFrom(tt,rt){return new SortedMapIterator(this.root_,tt,this.comparator_,!0,rt)}getReverseIterator(tt){return new SortedMapIterator(this.root_,null,this.comparator_,!0,tt)}}SortedMap.EMPTY_NODE=new LLRBEmptyNode;function NAME_ONLY_COMPARATOR(et,tt){return nameCompare(et.name,tt.name)}function NAME_COMPARATOR(et,tt){return nameCompare(et,tt)}let MAX_NODE$2;function setMaxNode$1(et){MAX_NODE$2=et}const priorityHashText=function(et){return typeof et=="number"?"number:"+doubleToIEEE754String(et):"string:"+et},validatePriorityNode=function(et){if(et.isLeafNode()){const tt=et.val();assert(typeof tt=="string"||typeof tt=="number"||typeof tt=="object"&&contains(tt,".sv"),"Priority must be a string or number.")}else assert(et===MAX_NODE$2||et.isEmpty(),"priority of unexpected type.");assert(et===MAX_NODE$2||et.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let __childrenNodeConstructor;class LeafNode{constructor(tt,rt=LeafNode.__childrenNodeConstructor.EMPTY_NODE){this.value_=tt,this.priorityNode_=rt,this.lazyHash_=null,assert(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),validatePriorityNode(this.priorityNode_)}static set __childrenNodeConstructor(tt){__childrenNodeConstructor=tt}static get __childrenNodeConstructor(){return __childrenNodeConstructor}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(tt){return new LeafNode(this.value_,tt)}getImmediateChild(tt){return tt===".priority"?this.priorityNode_:LeafNode.__childrenNodeConstructor.EMPTY_NODE}getChild(tt){return pathIsEmpty(tt)?this:pathGetFront(tt)===".priority"?this.priorityNode_:LeafNode.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(tt,rt){return null}updateImmediateChild(tt,rt){return tt===".priority"?this.updatePriority(rt):rt.isEmpty()&&tt!==".priority"?this:LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(tt,rt).updatePriority(this.priorityNode_)}updateChild(tt,rt){const nt=pathGetFront(tt);return nt===null?rt:rt.isEmpty()&&nt!==".priority"?this:(assert(nt!==".priority"||pathGetLength(tt)===1,".priority must be the last token in a path"),this.updateImmediateChild(nt,LeafNode.__childrenNodeConstructor.EMPTY_NODE.updateChild(pathPopFront(tt),rt)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(tt,rt){return!1}val(tt){return tt&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let tt="";this.priorityNode_.isEmpty()||(tt+="priority:"+priorityHashText(this.priorityNode_.val())+":");const rt=typeof this.value_;tt+=rt+":",rt==="number"?tt+=doubleToIEEE754String(this.value_):tt+=this.value_,this.lazyHash_=sha1$2(tt)}return this.lazyHash_}getValue(){return this.value_}compareTo(tt){return tt===LeafNode.__childrenNodeConstructor.EMPTY_NODE?1:tt instanceof LeafNode.__childrenNodeConstructor?-1:(assert(tt.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(tt))}compareToLeafNode_(tt){const rt=typeof tt.value_,nt=typeof this.value_,it=LeafNode.VALUE_TYPE_ORDER.indexOf(rt),ot=LeafNode.VALUE_TYPE_ORDER.indexOf(nt);return assert(it>=0,"Unknown leaf type: "+rt),assert(ot>=0,"Unknown leaf type: "+nt),it===ot?nt==="object"?0:this.value_<tt.value_?-1:this.value_===tt.value_?0:1:ot-it}withIndex(){return this}isIndexed(){return!0}equals(tt){if(tt===this)return!0;if(tt.isLeafNode()){const rt=tt;return this.value_===rt.value_&&this.priorityNode_.equals(rt.priorityNode_)}else return!1}}LeafNode.VALUE_TYPE_ORDER=["object","boolean","number","string"];let nodeFromJSON$1,MAX_NODE$1;function setNodeFromJSON(et){nodeFromJSON$1=et}function setMaxNode(et){MAX_NODE$1=et}class PriorityIndex extends Index{compare(tt,rt){const nt=tt.node.getPriority(),it=rt.node.getPriority(),ot=nt.compareTo(it);return ot===0?nameCompare(tt.name,rt.name):ot}isDefinedOn(tt){return!tt.getPriority().isEmpty()}indexedValueChanged(tt,rt){return!tt.getPriority().equals(rt.getPriority())}minPost(){return NamedNode.MIN}maxPost(){return new NamedNode(MAX_NAME,new LeafNode("[PRIORITY-POST]",MAX_NODE$1))}makePost(tt,rt){const nt=nodeFromJSON$1(tt);return new NamedNode(rt,new LeafNode("[PRIORITY-POST]",nt))}toString(){return".priority"}}const PRIORITY_INDEX=new PriorityIndex,LOG_2=Math.log(2);class Base12Num{constructor(tt){const rt=ot=>parseInt(Math.log(ot)/LOG_2,10),nt=ot=>parseInt(Array(ot+1).join("1"),2);this.count=rt(tt+1),this.current_=this.count-1;const it=nt(this.count);this.bits_=tt+1&it}nextBitIsOne(){const tt=!(this.bits_&1<<this.current_);return this.current_--,tt}}const buildChildSet=function(et,tt,rt,nt){et.sort(tt);const it=function(ct,ut){const lt=ut-ct;let ht,ft;if(lt===0)return null;if(lt===1)return ht=et[ct],ft=rt?rt(ht):ht,new LLRBNode(ft,ht.node,LLRBNode.BLACK,null,null);{const dt=parseInt(lt/2,10)+ct,pt=it(ct,dt),gt=it(dt+1,ut);return ht=et[dt],ft=rt?rt(ht):ht,new LLRBNode(ft,ht.node,LLRBNode.BLACK,pt,gt)}},ot=function(ct){let ut=null,lt=null,ht=et.length;const ft=function(pt,gt){const _t=ht-pt,mt=ht;ht-=pt;const At=it(_t+1,mt),It=et[_t],Mt=rt?rt(It):It;dt(new LLRBNode(Mt,It.node,gt,null,At))},dt=function(pt){ut?(ut.left=pt,ut=pt):(lt=pt,ut=pt)};for(let pt=0;pt<ct.count;++pt){const gt=ct.nextBitIsOne(),_t=Math.pow(2,ct.count-(pt+1));gt?ft(_t,LLRBNode.BLACK):(ft(_t,LLRBNode.BLACK),ft(_t,LLRBNode.RED))}return lt},st=new Base12Num(et.length),at=ot(st);return new SortedMap(nt||tt,at)};let _defaultIndexMap;const fallbackObject={};class IndexMap{constructor(tt,rt){this.indexes_=tt,this.indexSet_=rt}static get Default(){return assert(fallbackObject&&PRIORITY_INDEX,"ChildrenNode.ts has not been loaded"),_defaultIndexMap=_defaultIndexMap||new IndexMap({".priority":fallbackObject},{".priority":PRIORITY_INDEX}),_defaultIndexMap}get(tt){const rt=safeGet(this.indexes_,tt);if(!rt)throw new Error("No index defined for "+tt);return rt instanceof SortedMap?rt:null}hasIndex(tt){return contains(this.indexSet_,tt.toString())}addIndex(tt,rt){assert(tt!==KEY_INDEX,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const nt=[];let it=!1;const ot=rt.getIterator(NamedNode.Wrap);let st=ot.getNext();for(;st;)it=it||tt.isDefinedOn(st.node),nt.push(st),st=ot.getNext();let at;it?at=buildChildSet(nt,tt.getCompare()):at=fallbackObject;const ct=tt.toString(),ut=Object.assign({},this.indexSet_);ut[ct]=tt;const lt=Object.assign({},this.indexes_);return lt[ct]=at,new IndexMap(lt,ut)}addToIndexes(tt,rt){const nt=map$4(this.indexes_,(it,ot)=>{const st=safeGet(this.indexSet_,ot);if(assert(st,"Missing index implementation for "+ot),it===fallbackObject)if(st.isDefinedOn(tt.node)){const at=[],ct=rt.getIterator(NamedNode.Wrap);let ut=ct.getNext();for(;ut;)ut.name!==tt.name&&at.push(ut),ut=ct.getNext();return at.push(tt),buildChildSet(at,st.getCompare())}else return fallbackObject;else{const at=rt.get(tt.name);let ct=it;return at&&(ct=ct.remove(new NamedNode(tt.name,at))),ct.insert(tt,tt.node)}});return new IndexMap(nt,this.indexSet_)}removeFromIndexes(tt,rt){const nt=map$4(this.indexes_,it=>{if(it===fallbackObject)return it;{const ot=rt.get(tt.name);return ot?it.remove(new NamedNode(tt.name,ot)):it}});return new IndexMap(nt,this.indexSet_)}}let EMPTY_NODE;class ChildrenNode{constructor(tt,rt,nt){this.children_=tt,this.priorityNode_=rt,this.indexMap_=nt,this.lazyHash_=null,this.priorityNode_&&validatePriorityNode(this.priorityNode_),this.children_.isEmpty()&&assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return EMPTY_NODE||(EMPTY_NODE=new ChildrenNode(new SortedMap(NAME_COMPARATOR),null,IndexMap.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||EMPTY_NODE}updatePriority(tt){return this.children_.isEmpty()?this:new ChildrenNode(this.children_,tt,this.indexMap_)}getImmediateChild(tt){if(tt===".priority")return this.getPriority();{const rt=this.children_.get(tt);return rt===null?EMPTY_NODE:rt}}getChild(tt){const rt=pathGetFront(tt);return rt===null?this:this.getImmediateChild(rt).getChild(pathPopFront(tt))}hasChild(tt){return this.children_.get(tt)!==null}updateImmediateChild(tt,rt){if(assert(rt,"We should always be passing snapshot nodes"),tt===".priority")return this.updatePriority(rt);{const nt=new NamedNode(tt,rt);let it,ot;rt.isEmpty()?(it=this.children_.remove(tt),ot=this.indexMap_.removeFromIndexes(nt,this.children_)):(it=this.children_.insert(tt,rt),ot=this.indexMap_.addToIndexes(nt,this.children_));const st=it.isEmpty()?EMPTY_NODE:this.priorityNode_;return new ChildrenNode(it,st,ot)}}updateChild(tt,rt){const nt=pathGetFront(tt);if(nt===null)return rt;{assert(pathGetFront(tt)!==".priority"||pathGetLength(tt)===1,".priority must be the last token in a path");const it=this.getImmediateChild(nt).updateChild(pathPopFront(tt),rt);return this.updateImmediateChild(nt,it)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(tt){if(this.isEmpty())return null;const rt={};let nt=0,it=0,ot=!0;if(this.forEachChild(PRIORITY_INDEX,(st,at)=>{rt[st]=at.val(tt),nt++,ot&&ChildrenNode.INTEGER_REGEXP_.test(st)?it=Math.max(it,Number(st)):ot=!1}),!tt&&ot&&it<2*nt){const st=[];for(const at in rt)st[at]=rt[at];return st}else return tt&&!this.getPriority().isEmpty()&&(rt[".priority"]=this.getPriority().val()),rt}hash(){if(this.lazyHash_===null){let tt="";this.getPriority().isEmpty()||(tt+="priority:"+priorityHashText(this.getPriority().val())+":"),this.forEachChild(PRIORITY_INDEX,(rt,nt)=>{const it=nt.hash();it!==""&&(tt+=":"+rt+":"+it)}),this.lazyHash_=tt===""?"":sha1$2(tt)}return this.lazyHash_}getPredecessorChildName(tt,rt,nt){const it=this.resolveIndex_(nt);if(it){const ot=it.getPredecessorKey(new NamedNode(tt,rt));return ot?ot.name:null}else return this.children_.getPredecessorKey(tt)}getFirstChildName(tt){const rt=this.resolveIndex_(tt);if(rt){const nt=rt.minKey();return nt&&nt.name}else return this.children_.minKey()}getFirstChild(tt){const rt=this.getFirstChildName(tt);return rt?new NamedNode(rt,this.children_.get(rt)):null}getLastChildName(tt){const rt=this.resolveIndex_(tt);if(rt){const nt=rt.maxKey();return nt&&nt.name}else return this.children_.maxKey()}getLastChild(tt){const rt=this.getLastChildName(tt);return rt?new NamedNode(rt,this.children_.get(rt)):null}forEachChild(tt,rt){const nt=this.resolveIndex_(tt);return nt?nt.inorderTraversal(it=>rt(it.name,it.node)):this.children_.inorderTraversal(rt)}getIterator(tt){return this.getIteratorFrom(tt.minPost(),tt)}getIteratorFrom(tt,rt){const nt=this.resolveIndex_(rt);if(nt)return nt.getIteratorFrom(tt,it=>it);{const it=this.children_.getIteratorFrom(tt.name,NamedNode.Wrap);let ot=it.peek();for(;ot!=null&&rt.compare(ot,tt)<0;)it.getNext(),ot=it.peek();return it}}getReverseIterator(tt){return this.getReverseIteratorFrom(tt.maxPost(),tt)}getReverseIteratorFrom(tt,rt){const nt=this.resolveIndex_(rt);if(nt)return nt.getReverseIteratorFrom(tt,it=>it);{const it=this.children_.getReverseIteratorFrom(tt.name,NamedNode.Wrap);let ot=it.peek();for(;ot!=null&&rt.compare(ot,tt)>0;)it.getNext(),ot=it.peek();return it}}compareTo(tt){return this.isEmpty()?tt.isEmpty()?0:-1:tt.isLeafNode()||tt.isEmpty()?1:tt===MAX_NODE?-1:0}withIndex(tt){if(tt===KEY_INDEX||this.indexMap_.hasIndex(tt))return this;{const rt=this.indexMap_.addIndex(tt,this.children_);return new ChildrenNode(this.children_,this.priorityNode_,rt)}}isIndexed(tt){return tt===KEY_INDEX||this.indexMap_.hasIndex(tt)}equals(tt){if(tt===this)return!0;if(tt.isLeafNode())return!1;{const rt=tt;if(this.getPriority().equals(rt.getPriority()))if(this.children_.count()===rt.children_.count()){const nt=this.getIterator(PRIORITY_INDEX),it=rt.getIterator(PRIORITY_INDEX);let ot=nt.getNext(),st=it.getNext();for(;ot&&st;){if(ot.name!==st.name||!ot.node.equals(st.node))return!1;ot=nt.getNext(),st=it.getNext()}return ot===null&&st===null}else return!1;else return!1}}resolveIndex_(tt){return tt===KEY_INDEX?null:this.indexMap_.get(tt.toString())}}ChildrenNode.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class MaxNode extends ChildrenNode{constructor(){super(new SortedMap(NAME_COMPARATOR),ChildrenNode.EMPTY_NODE,IndexMap.Default)}compareTo(tt){return tt===this?0:1}equals(tt){return tt===this}getPriority(){return this}getImmediateChild(tt){return ChildrenNode.EMPTY_NODE}isEmpty(){return!1}}const MAX_NODE=new MaxNode;Object.defineProperties(NamedNode,{MIN:{value:new NamedNode(MIN_NAME,ChildrenNode.EMPTY_NODE)},MAX:{value:new NamedNode(MAX_NAME,MAX_NODE)}}),KeyIndex.__EMPTY_NODE=ChildrenNode.EMPTY_NODE,LeafNode.__childrenNodeConstructor=ChildrenNode,setMaxNode$1(MAX_NODE),setMaxNode(MAX_NODE);const USE_HINZE=!0;function nodeFromJSON(et,tt=null){if(et===null)return ChildrenNode.EMPTY_NODE;if(typeof et=="object"&&".priority"in et&&(tt=et[".priority"]),assert(tt===null||typeof tt=="string"||typeof tt=="number"||typeof tt=="object"&&".sv"in tt,"Invalid priority type found: "+typeof tt),typeof et=="object"&&".value"in et&&et[".value"]!==null&&(et=et[".value"]),typeof et!="object"||".sv"in et){const rt=et;return new LeafNode(rt,nodeFromJSON(tt))}if(!(et instanceof Array)&&USE_HINZE){const rt=[];let nt=!1;if(each(et,(ot,st)=>{if(ot.substring(0,1)!=="."){const at=nodeFromJSON(st);at.isEmpty()||(nt=nt||!at.getPriority().isEmpty(),rt.push(new NamedNode(ot,at)))}}),rt.length===0)return ChildrenNode.EMPTY_NODE;const it=buildChildSet(rt,NAME_ONLY_COMPARATOR,ot=>ot.name,NAME_COMPARATOR);if(nt){const ot=buildChildSet(rt,PRIORITY_INDEX.getCompare());return new ChildrenNode(it,nodeFromJSON(tt),new IndexMap({".priority":ot},{".priority":PRIORITY_INDEX}))}else return new ChildrenNode(it,nodeFromJSON(tt),IndexMap.Default)}else{let rt=ChildrenNode.EMPTY_NODE;return each(et,(nt,it)=>{if(contains(et,nt)&&nt.substring(0,1)!=="."){const ot=nodeFromJSON(it);(ot.isLeafNode()||!ot.isEmpty())&&(rt=rt.updateImmediateChild(nt,ot))}}),rt.updatePriority(nodeFromJSON(tt))}}setNodeFromJSON(nodeFromJSON);class PathIndex extends Index{constructor(tt){super(),this.indexPath_=tt,assert(!pathIsEmpty(tt)&&pathGetFront(tt)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(tt){return tt.getChild(this.indexPath_)}isDefinedOn(tt){return!tt.getChild(this.indexPath_).isEmpty()}compare(tt,rt){const nt=this.extractChild(tt.node),it=this.extractChild(rt.node),ot=nt.compareTo(it);return ot===0?nameCompare(tt.name,rt.name):ot}makePost(tt,rt){const nt=nodeFromJSON(tt),it=ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,nt);return new NamedNode(rt,it)}maxPost(){const tt=ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,MAX_NODE);return new NamedNode(MAX_NAME,tt)}toString(){return pathSlice(this.indexPath_,0).join("/")}}class ValueIndex extends Index{compare(tt,rt){const nt=tt.node.compareTo(rt.node);return nt===0?nameCompare(tt.name,rt.name):nt}isDefinedOn(tt){return!0}indexedValueChanged(tt,rt){return!tt.equals(rt)}minPost(){return NamedNode.MIN}maxPost(){return NamedNode.MAX}makePost(tt,rt){const nt=nodeFromJSON(tt);return new NamedNode(rt,nt)}toString(){return".value"}}const VALUE_INDEX=new ValueIndex;function changeValue(et){return{type:"value",snapshotNode:et}}function changeChildAdded(et,tt){return{type:"child_added",snapshotNode:tt,childName:et}}function changeChildRemoved(et,tt){return{type:"child_removed",snapshotNode:tt,childName:et}}function changeChildChanged(et,tt,rt){return{type:"child_changed",snapshotNode:tt,childName:et,oldSnap:rt}}function changeChildMoved(et,tt){return{type:"child_moved",snapshotNode:tt,childName:et}}class QueryParams{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=PRIORITY_INDEX}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:MIN_NAME}hasEnd(){return this.endSet_}getIndexEndValue(){return assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:MAX_NAME}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return assert(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===PRIORITY_INDEX}copy(){const tt=new QueryParams;return tt.limitSet_=this.limitSet_,tt.limit_=this.limit_,tt.startSet_=this.startSet_,tt.startAfterSet_=this.startAfterSet_,tt.indexStartValue_=this.indexStartValue_,tt.startNameSet_=this.startNameSet_,tt.indexStartName_=this.indexStartName_,tt.endSet_=this.endSet_,tt.endBeforeSet_=this.endBeforeSet_,tt.indexEndValue_=this.indexEndValue_,tt.endNameSet_=this.endNameSet_,tt.indexEndName_=this.indexEndName_,tt.index_=this.index_,tt.viewFrom_=this.viewFrom_,tt}}function queryParamsToRestQueryStringParameters(et){const tt={};if(et.isDefault())return tt;let rt;if(et.index_===PRIORITY_INDEX?rt="$priority":et.index_===VALUE_INDEX?rt="$value":et.index_===KEY_INDEX?rt="$key":(assert(et.index_ instanceof PathIndex,"Unrecognized index type!"),rt=et.index_.toString()),tt.orderBy=stringify(rt),et.startSet_){const nt=et.startAfterSet_?"startAfter":"startAt";tt[nt]=stringify(et.indexStartValue_),et.startNameSet_&&(tt[nt]+=","+stringify(et.indexStartName_))}if(et.endSet_){const nt=et.endBeforeSet_?"endBefore":"endAt";tt[nt]=stringify(et.indexEndValue_),et.endNameSet_&&(tt[nt]+=","+stringify(et.indexEndName_))}return et.limitSet_&&(et.isViewFromLeft()?tt.limitToFirst=et.limit_:tt.limitToLast=et.limit_),tt}function queryParamsGetQueryObject(et){const tt={};if(et.startSet_&&(tt.sp=et.indexStartValue_,et.startNameSet_&&(tt.sn=et.indexStartName_),tt.sin=!et.startAfterSet_),et.endSet_&&(tt.ep=et.indexEndValue_,et.endNameSet_&&(tt.en=et.indexEndName_),tt.ein=!et.endBeforeSet_),et.limitSet_){tt.l=et.limit_;let rt=et.viewFrom_;rt===""&&(et.isViewFromLeft()?rt="l":rt="r"),tt.vf=rt}return et.index_!==PRIORITY_INDEX&&(tt.i=et.index_.toString()),tt}class ReadonlyRestClient extends ServerActions{constructor(tt,rt,nt,it){super(),this.repoInfo_=tt,this.onDataUpdate_=rt,this.authTokenProvider_=nt,this.appCheckTokenProvider_=it,this.log_=logWrapper("p:rest:"),this.listens_={}}reportStats(tt){throw new Error("Method not implemented.")}static getListenId_(tt,rt){return rt!==void 0?"tag$"+rt:(assert(tt._queryParams.isDefault(),"should have a tag if it's not a default query."),tt._path.toString())}listen(tt,rt,nt,it){const ot=tt._path.toString();this.log_("Listen called for "+ot+" "+tt._queryIdentifier);const st=ReadonlyRestClient.getListenId_(tt,nt),at={};this.listens_[st]=at;const ct=queryParamsToRestQueryStringParameters(tt._queryParams);this.restRequest_(ot+".json",ct,(ut,lt)=>{let ht=lt;if(ut===404&&(ht=null,ut=null),ut===null&&this.onDataUpdate_(ot,ht,!1,nt),safeGet(this.listens_,st)===at){let ft;ut?ut===401?ft="permission_denied":ft="rest_error:"+ut:ft="ok",it(ft,null)}})}unlisten(tt,rt){const nt=ReadonlyRestClient.getListenId_(tt,rt);delete this.listens_[nt]}get(tt){const rt=queryParamsToRestQueryStringParameters(tt._queryParams),nt=tt._path.toString(),it=new Deferred;return this.restRequest_(nt+".json",rt,(ot,st)=>{let at=st;ot===404&&(at=null,ot=null),ot===null?(this.onDataUpdate_(nt,at,!1,null),it.resolve(at)):it.reject(new Error(at))}),it.promise}refreshAuthToken(tt){}restRequest_(tt,rt={},nt){return rt.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([it,ot])=>{it&&it.accessToken&&(rt.auth=it.accessToken),ot&&ot.token&&(rt.ac=ot.token);const st=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+tt+"?ns="+this.repoInfo_.namespace+querystring(rt);this.log_("Sending REST request for "+st);const at=new XMLHttpRequest;at.onreadystatechange=()=>{if(nt&&at.readyState===4){this.log_("REST Response for "+st+" received. status:",at.status,"response:",at.responseText);let ct=null;if(at.status>=200&&at.status<300){try{ct=jsonEval(at.responseText)}catch{warn$1("Failed to parse JSON response for "+st+": "+at.responseText)}nt(null,ct)}else at.status!==401&&at.status!==404&&warn$1("Got unsuccessful REST response for "+st+" Status: "+at.status),nt(at.status);nt=null}},at.open("GET",st,!0),at.send()})}}class SnapshotHolder{constructor(){this.rootNode_=ChildrenNode.EMPTY_NODE}getNode(tt){return this.rootNode_.getChild(tt)}updateSnapshot(tt,rt){this.rootNode_=this.rootNode_.updateChild(tt,rt)}}function newSparseSnapshotTree(){return{value:null,children:new Map}}function sparseSnapshotTreeRemember(et,tt,rt){if(pathIsEmpty(tt))et.value=rt,et.children.clear();else if(et.value!==null)et.value=et.value.updateChild(tt,rt);else{const nt=pathGetFront(tt);et.children.has(nt)||et.children.set(nt,newSparseSnapshotTree());const it=et.children.get(nt);tt=pathPopFront(tt),sparseSnapshotTreeRemember(it,tt,rt)}}function sparseSnapshotTreeForEachTree(et,tt,rt){et.value!==null?rt(tt,et.value):sparseSnapshotTreeForEachChild(et,(nt,it)=>{const ot=new Path(tt.toString()+"/"+nt);sparseSnapshotTreeForEachTree(it,ot,rt)})}function sparseSnapshotTreeForEachChild(et,tt){et.children.forEach((rt,nt)=>{tt(nt,rt)})}class StatsListener{constructor(tt){this.collection_=tt,this.last_=null}get(){const tt=this.collection_.get(),rt=Object.assign({},tt);return this.last_&&each(this.last_,(nt,it)=>{rt[nt]=rt[nt]-it}),this.last_=tt,rt}}const FIRST_STATS_MIN_TIME=10*1e3,FIRST_STATS_MAX_TIME=30*1e3,REPORT_STATS_INTERVAL=5*60*1e3;class StatsReporter{constructor(tt,rt){this.server_=rt,this.statsToReport_={},this.statsListener_=new StatsListener(tt);const nt=FIRST_STATS_MIN_TIME+(FIRST_STATS_MAX_TIME-FIRST_STATS_MIN_TIME)*Math.random();setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(nt))}reportStats_(){const tt=this.statsListener_.get(),rt={};let nt=!1;each(tt,(it,ot)=>{ot>0&&contains(this.statsToReport_,it)&&(rt[it]=ot,nt=!0)}),nt&&this.server_.reportStats(rt),setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(Math.random()*2*REPORT_STATS_INTERVAL))}}var OperationType;(function(et){et[et.OVERWRITE=0]="OVERWRITE",et[et.MERGE=1]="MERGE",et[et.ACK_USER_WRITE=2]="ACK_USER_WRITE",et[et.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(OperationType||(OperationType={}));function newOperationSourceUser(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function newOperationSourceServer(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function newOperationSourceServerTaggedQuery(et){return{fromUser:!1,fromServer:!0,queryId:et,tagged:!0}}class AckUserWrite{constructor(tt,rt,nt){this.path=tt,this.affectedTree=rt,this.revert=nt,this.type=OperationType.ACK_USER_WRITE,this.source=newOperationSourceUser()}operationForChild(tt){if(pathIsEmpty(this.path)){if(this.affectedTree.value!=null)return assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const rt=this.affectedTree.subtree(new Path(tt));return new AckUserWrite(newEmptyPath(),rt,this.revert)}}else return assert(pathGetFront(this.path)===tt,"operationForChild called for unrelated child."),new AckUserWrite(pathPopFront(this.path),this.affectedTree,this.revert)}}class Overwrite{constructor(tt,rt,nt){this.source=tt,this.path=rt,this.snap=nt,this.type=OperationType.OVERWRITE}operationForChild(tt){return pathIsEmpty(this.path)?new Overwrite(this.source,newEmptyPath(),this.snap.getImmediateChild(tt)):new Overwrite(this.source,pathPopFront(this.path),this.snap)}}class Merge{constructor(tt,rt,nt){this.source=tt,this.path=rt,this.children=nt,this.type=OperationType.MERGE}operationForChild(tt){if(pathIsEmpty(this.path)){const rt=this.children.subtree(new Path(tt));return rt.isEmpty()?null:rt.value?new Overwrite(this.source,newEmptyPath(),rt.value):new Merge(this.source,newEmptyPath(),rt)}else return assert(pathGetFront(this.path)===tt,"Can't get a merge for a child not on the path of the operation"),new Merge(this.source,pathPopFront(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class CacheNode{constructor(tt,rt,nt){this.node_=tt,this.fullyInitialized_=rt,this.filtered_=nt}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(tt){if(pathIsEmpty(tt))return this.isFullyInitialized()&&!this.filtered_;const rt=pathGetFront(tt);return this.isCompleteForChild(rt)}isCompleteForChild(tt){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(tt)}getNode(){return this.node_}}function eventGeneratorGenerateEventsForChanges(et,tt,rt,nt){const it=[],ot=[];return tt.forEach(st=>{st.type==="child_changed"&&et.index_.indexedValueChanged(st.oldSnap,st.snapshotNode)&&ot.push(changeChildMoved(st.childName,st.snapshotNode))}),eventGeneratorGenerateEventsForType(et,it,"child_removed",tt,nt,rt),eventGeneratorGenerateEventsForType(et,it,"child_added",tt,nt,rt),eventGeneratorGenerateEventsForType(et,it,"child_moved",ot,nt,rt),eventGeneratorGenerateEventsForType(et,it,"child_changed",tt,nt,rt),eventGeneratorGenerateEventsForType(et,it,"value",tt,nt,rt),it}function eventGeneratorGenerateEventsForType(et,tt,rt,nt,it,ot){const st=nt.filter(at=>at.type===rt);st.sort((at,ct)=>eventGeneratorCompareChanges(et,at,ct)),st.forEach(at=>{const ct=eventGeneratorMaterializeSingleChange(et,at,ot);it.forEach(ut=>{ut.respondsTo(at.type)&&tt.push(ut.createEvent(ct,et.query_))})})}function eventGeneratorMaterializeSingleChange(et,tt,rt){return tt.type==="value"||tt.type==="child_removed"||(tt.prevName=rt.getPredecessorChildName(tt.childName,tt.snapshotNode,et.index_)),tt}function eventGeneratorCompareChanges(et,tt,rt){if(tt.childName==null||rt.childName==null)throw assertionError("Should only compare child_ events.");const nt=new NamedNode(tt.childName,tt.snapshotNode),it=new NamedNode(rt.childName,rt.snapshotNode);return et.index_.compare(nt,it)}function newViewCache(et,tt){return{eventCache:et,serverCache:tt}}function viewCacheUpdateEventSnap(et,tt,rt,nt){return newViewCache(new CacheNode(tt,rt,nt),et.serverCache)}function viewCacheUpdateServerSnap(et,tt,rt,nt){return newViewCache(et.eventCache,new CacheNode(tt,rt,nt))}function viewCacheGetCompleteEventSnap(et){return et.eventCache.isFullyInitialized()?et.eventCache.getNode():null}function viewCacheGetCompleteServerSnap(et){return et.serverCache.isFullyInitialized()?et.serverCache.getNode():null}let emptyChildrenSingleton;const EmptyChildren=()=>(emptyChildrenSingleton||(emptyChildrenSingleton=new SortedMap(stringCompare)),emptyChildrenSingleton);class ImmutableTree{constructor(tt,rt=EmptyChildren()){this.value=tt,this.children=rt}static fromObject(tt){let rt=new ImmutableTree(null);return each(tt,(nt,it)=>{rt=rt.set(new Path(nt),it)}),rt}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(tt,rt){if(this.value!=null&&rt(this.value))return{path:newEmptyPath(),value:this.value};if(pathIsEmpty(tt))return null;{const nt=pathGetFront(tt),it=this.children.get(nt);if(it!==null){const ot=it.findRootMostMatchingPathAndValue(pathPopFront(tt),rt);return ot!=null?{path:pathChild(new Path(nt),ot.path),value:ot.value}:null}else return null}}findRootMostValueAndPath(tt){return this.findRootMostMatchingPathAndValue(tt,()=>!0)}subtree(tt){if(pathIsEmpty(tt))return this;{const rt=pathGetFront(tt),nt=this.children.get(rt);return nt!==null?nt.subtree(pathPopFront(tt)):new ImmutableTree(null)}}set(tt,rt){if(pathIsEmpty(tt))return new ImmutableTree(rt,this.children);{const nt=pathGetFront(tt),it=(this.children.get(nt)||new ImmutableTree(null)).set(pathPopFront(tt),rt),ot=this.children.insert(nt,it);return new ImmutableTree(this.value,ot)}}remove(tt){if(pathIsEmpty(tt))return this.children.isEmpty()?new ImmutableTree(null):new ImmutableTree(null,this.children);{const rt=pathGetFront(tt),nt=this.children.get(rt);if(nt){const it=nt.remove(pathPopFront(tt));let ot;return it.isEmpty()?ot=this.children.remove(rt):ot=this.children.insert(rt,it),this.value===null&&ot.isEmpty()?new ImmutableTree(null):new ImmutableTree(this.value,ot)}else return this}}get(tt){if(pathIsEmpty(tt))return this.value;{const rt=pathGetFront(tt),nt=this.children.get(rt);return nt?nt.get(pathPopFront(tt)):null}}setTree(tt,rt){if(pathIsEmpty(tt))return rt;{const nt=pathGetFront(tt),it=(this.children.get(nt)||new ImmutableTree(null)).setTree(pathPopFront(tt),rt);let ot;return it.isEmpty()?ot=this.children.remove(nt):ot=this.children.insert(nt,it),new ImmutableTree(this.value,ot)}}fold(tt){return this.fold_(newEmptyPath(),tt)}fold_(tt,rt){const nt={};return this.children.inorderTraversal((it,ot)=>{nt[it]=ot.fold_(pathChild(tt,it),rt)}),rt(tt,this.value,nt)}findOnPath(tt,rt){return this.findOnPath_(tt,newEmptyPath(),rt)}findOnPath_(tt,rt,nt){const it=this.value?nt(rt,this.value):!1;if(it)return it;if(pathIsEmpty(tt))return null;{const ot=pathGetFront(tt),st=this.children.get(ot);return st?st.findOnPath_(pathPopFront(tt),pathChild(rt,ot),nt):null}}foreachOnPath(tt,rt){return this.foreachOnPath_(tt,newEmptyPath(),rt)}foreachOnPath_(tt,rt,nt){if(pathIsEmpty(tt))return this;{this.value&&nt(rt,this.value);const it=pathGetFront(tt),ot=this.children.get(it);return ot?ot.foreachOnPath_(pathPopFront(tt),pathChild(rt,it),nt):new ImmutableTree(null)}}foreach(tt){this.foreach_(newEmptyPath(),tt)}foreach_(tt,rt){this.children.inorderTraversal((nt,it)=>{it.foreach_(pathChild(tt,nt),rt)}),this.value&&rt(tt,this.value)}foreachChild(tt){this.children.inorderTraversal((rt,nt)=>{nt.value&&tt(rt,nt.value)})}}class CompoundWrite{constructor(tt){this.writeTree_=tt}static empty(){return new CompoundWrite(new ImmutableTree(null))}}function compoundWriteAddWrite(et,tt,rt){if(pathIsEmpty(tt))return new CompoundWrite(new ImmutableTree(rt));{const nt=et.writeTree_.findRootMostValueAndPath(tt);if(nt!=null){const it=nt.path;let ot=nt.value;const st=newRelativePath(it,tt);return ot=ot.updateChild(st,rt),new CompoundWrite(et.writeTree_.set(it,ot))}else{const it=new ImmutableTree(rt),ot=et.writeTree_.setTree(tt,it);return new CompoundWrite(ot)}}}function compoundWriteAddWrites(et,tt,rt){let nt=et;return each(rt,(it,ot)=>{nt=compoundWriteAddWrite(nt,pathChild(tt,it),ot)}),nt}function compoundWriteRemoveWrite(et,tt){if(pathIsEmpty(tt))return CompoundWrite.empty();{const rt=et.writeTree_.setTree(tt,new ImmutableTree(null));return new CompoundWrite(rt)}}function compoundWriteHasCompleteWrite(et,tt){return compoundWriteGetCompleteNode(et,tt)!=null}function compoundWriteGetCompleteNode(et,tt){const rt=et.writeTree_.findRootMostValueAndPath(tt);return rt!=null?et.writeTree_.get(rt.path).getChild(newRelativePath(rt.path,tt)):null}function compoundWriteGetCompleteChildren(et){const tt=[],rt=et.writeTree_.value;return rt!=null?rt.isLeafNode()||rt.forEachChild(PRIORITY_INDEX,(nt,it)=>{tt.push(new NamedNode(nt,it))}):et.writeTree_.children.inorderTraversal((nt,it)=>{it.value!=null&&tt.push(new NamedNode(nt,it.value))}),tt}function compoundWriteChildCompoundWrite(et,tt){if(pathIsEmpty(tt))return et;{const rt=compoundWriteGetCompleteNode(et,tt);return rt!=null?new CompoundWrite(new ImmutableTree(rt)):new CompoundWrite(et.writeTree_.subtree(tt))}}function compoundWriteIsEmpty(et){return et.writeTree_.isEmpty()}function compoundWriteApply(et,tt){return applySubtreeWrite(newEmptyPath(),et.writeTree_,tt)}function applySubtreeWrite(et,tt,rt){if(tt.value!=null)return rt.updateChild(et,tt.value);{let nt=null;return tt.children.inorderTraversal((it,ot)=>{it===".priority"?(assert(ot.value!==null,"Priority writes must always be leaf nodes"),nt=ot.value):rt=applySubtreeWrite(pathChild(et,it),ot,rt)}),!rt.getChild(et).isEmpty()&&nt!==null&&(rt=rt.updateChild(pathChild(et,".priority"),nt)),rt}}function writeTreeChildWrites(et,tt){return newWriteTreeRef(tt,et)}function writeTreeAddOverwrite(et,tt,rt,nt,it){assert(nt>et.lastWriteId,"Stacking an older write on top of newer ones"),it===void 0&&(it=!0),et.allWrites.push({path:tt,snap:rt,writeId:nt,visible:it}),it&&(et.visibleWrites=compoundWriteAddWrite(et.visibleWrites,tt,rt)),et.lastWriteId=nt}function writeTreeGetWrite(et,tt){for(let rt=0;rt<et.allWrites.length;rt++){const nt=et.allWrites[rt];if(nt.writeId===tt)return nt}return null}function writeTreeRemoveWrite(et,tt){const rt=et.allWrites.findIndex(at=>at.writeId===tt);assert(rt>=0,"removeWrite called with nonexistent writeId.");const nt=et.allWrites[rt];et.allWrites.splice(rt,1);let it=nt.visible,ot=!1,st=et.allWrites.length-1;for(;it&&st>=0;){const at=et.allWrites[st];at.visible&&(st>=rt&&writeTreeRecordContainsPath_(at,nt.path)?it=!1:pathContains(nt.path,at.path)&&(ot=!0)),st--}if(it){if(ot)return writeTreeResetTree_(et),!0;if(nt.snap)et.visibleWrites=compoundWriteRemoveWrite(et.visibleWrites,nt.path);else{const at=nt.children;each(at,ct=>{et.visibleWrites=compoundWriteRemoveWrite(et.visibleWrites,pathChild(nt.path,ct))})}return!0}else return!1}function writeTreeRecordContainsPath_(et,tt){if(et.snap)return pathContains(et.path,tt);for(const rt in et.children)if(et.children.hasOwnProperty(rt)&&pathContains(pathChild(et.path,rt),tt))return!0;return!1}function writeTreeResetTree_(et){et.visibleWrites=writeTreeLayerTree_(et.allWrites,writeTreeDefaultFilter_,newEmptyPath()),et.allWrites.length>0?et.lastWriteId=et.allWrites[et.allWrites.length-1].writeId:et.lastWriteId=-1}function writeTreeDefaultFilter_(et){return et.visible}function writeTreeLayerTree_(et,tt,rt){let nt=CompoundWrite.empty();for(let it=0;it<et.length;++it){const ot=et[it];if(tt(ot)){const st=ot.path;let at;if(ot.snap)pathContains(rt,st)?(at=newRelativePath(rt,st),nt=compoundWriteAddWrite(nt,at,ot.snap)):pathContains(st,rt)&&(at=newRelativePath(st,rt),nt=compoundWriteAddWrite(nt,newEmptyPath(),ot.snap.getChild(at)));else if(ot.children){if(pathContains(rt,st))at=newRelativePath(rt,st),nt=compoundWriteAddWrites(nt,at,ot.children);else if(pathContains(st,rt))if(at=newRelativePath(st,rt),pathIsEmpty(at))nt=compoundWriteAddWrites(nt,newEmptyPath(),ot.children);else{const ct=safeGet(ot.children,pathGetFront(at));if(ct){const ut=ct.getChild(pathPopFront(at));nt=compoundWriteAddWrite(nt,newEmptyPath(),ut)}}}else throw assertionError("WriteRecord should have .snap or .children")}}return nt}function writeTreeCalcCompleteEventCache(et,tt,rt,nt,it){if(!nt&&!it){const ot=compoundWriteGetCompleteNode(et.visibleWrites,tt);if(ot!=null)return ot;{const st=compoundWriteChildCompoundWrite(et.visibleWrites,tt);if(compoundWriteIsEmpty(st))return rt;if(rt==null&&!compoundWriteHasCompleteWrite(st,newEmptyPath()))return null;{const at=rt||ChildrenNode.EMPTY_NODE;return compoundWriteApply(st,at)}}}else{const ot=compoundWriteChildCompoundWrite(et.visibleWrites,tt);if(!it&&compoundWriteIsEmpty(ot))return rt;if(!it&&rt==null&&!compoundWriteHasCompleteWrite(ot,newEmptyPath()))return null;{const st=function(ut){return(ut.visible||it)&&(!nt||!~nt.indexOf(ut.writeId))&&(pathContains(ut.path,tt)||pathContains(tt,ut.path))},at=writeTreeLayerTree_(et.allWrites,st,tt),ct=rt||ChildrenNode.EMPTY_NODE;return compoundWriteApply(at,ct)}}}function writeTreeCalcCompleteEventChildren(et,tt,rt){let nt=ChildrenNode.EMPTY_NODE;const it=compoundWriteGetCompleteNode(et.visibleWrites,tt);if(it)return it.isLeafNode()||it.forEachChild(PRIORITY_INDEX,(ot,st)=>{nt=nt.updateImmediateChild(ot,st)}),nt;if(rt){const ot=compoundWriteChildCompoundWrite(et.visibleWrites,tt);return rt.forEachChild(PRIORITY_INDEX,(st,at)=>{const ct=compoundWriteApply(compoundWriteChildCompoundWrite(ot,new Path(st)),at);nt=nt.updateImmediateChild(st,ct)}),compoundWriteGetCompleteChildren(ot).forEach(st=>{nt=nt.updateImmediateChild(st.name,st.node)}),nt}else{const ot=compoundWriteChildCompoundWrite(et.visibleWrites,tt);return compoundWriteGetCompleteChildren(ot).forEach(st=>{nt=nt.updateImmediateChild(st.name,st.node)}),nt}}function writeTreeCalcEventCacheAfterServerOverwrite(et,tt,rt,nt,it){assert(nt||it,"Either existingEventSnap or existingServerSnap must exist");const ot=pathChild(tt,rt);if(compoundWriteHasCompleteWrite(et.visibleWrites,ot))return null;{const st=compoundWriteChildCompoundWrite(et.visibleWrites,ot);return compoundWriteIsEmpty(st)?it.getChild(rt):compoundWriteApply(st,it.getChild(rt))}}function writeTreeCalcCompleteChild(et,tt,rt,nt){const it=pathChild(tt,rt),ot=compoundWriteGetCompleteNode(et.visibleWrites,it);if(ot!=null)return ot;if(nt.isCompleteForChild(rt)){const st=compoundWriteChildCompoundWrite(et.visibleWrites,it);return compoundWriteApply(st,nt.getNode().getImmediateChild(rt))}else return null}function writeTreeShadowingWrite(et,tt){return compoundWriteGetCompleteNode(et.visibleWrites,tt)}function writeTreeCalcIndexedSlice(et,tt,rt,nt,it,ot,st){let at;const ct=compoundWriteChildCompoundWrite(et.visibleWrites,tt),ut=compoundWriteGetCompleteNode(ct,newEmptyPath());if(ut!=null)at=ut;else if(rt!=null)at=compoundWriteApply(ct,rt);else return[];if(at=at.withIndex(st),!at.isEmpty()&&!at.isLeafNode()){const lt=[],ht=st.getCompare(),ft=ot?at.getReverseIteratorFrom(nt,st):at.getIteratorFrom(nt,st);let dt=ft.getNext();for(;dt&&lt.length<it;)ht(dt,nt)!==0&&lt.push(dt),dt=ft.getNext();return lt}else return[]}function newWriteTree(){return{visibleWrites:CompoundWrite.empty(),allWrites:[],lastWriteId:-1}}function writeTreeRefCalcCompleteEventCache(et,tt,rt,nt){return writeTreeCalcCompleteEventCache(et.writeTree,et.treePath,tt,rt,nt)}function writeTreeRefCalcCompleteEventChildren(et,tt){return writeTreeCalcCompleteEventChildren(et.writeTree,et.treePath,tt)}function writeTreeRefCalcEventCacheAfterServerOverwrite(et,tt,rt,nt){return writeTreeCalcEventCacheAfterServerOverwrite(et.writeTree,et.treePath,tt,rt,nt)}function writeTreeRefShadowingWrite(et,tt){return writeTreeShadowingWrite(et.writeTree,pathChild(et.treePath,tt))}function writeTreeRefCalcIndexedSlice(et,tt,rt,nt,it,ot){return writeTreeCalcIndexedSlice(et.writeTree,et.treePath,tt,rt,nt,it,ot)}function writeTreeRefCalcCompleteChild(et,tt,rt){return writeTreeCalcCompleteChild(et.writeTree,et.treePath,tt,rt)}function writeTreeRefChild(et,tt){return newWriteTreeRef(pathChild(et.treePath,tt),et.writeTree)}function newWriteTreeRef(et,tt){return{treePath:et,writeTree:tt}}class ChildChangeAccumulator{constructor(){this.changeMap=new Map}trackChildChange(tt){const rt=tt.type,nt=tt.childName;assert(rt==="child_added"||rt==="child_changed"||rt==="child_removed","Only child changes supported for tracking"),assert(nt!==".priority","Only non-priority child changes can be tracked.");const it=this.changeMap.get(nt);if(it){const ot=it.type;if(rt==="child_added"&&ot==="child_removed")this.changeMap.set(nt,changeChildChanged(nt,tt.snapshotNode,it.snapshotNode));else if(rt==="child_removed"&&ot==="child_added")this.changeMap.delete(nt);else if(rt==="child_removed"&&ot==="child_changed")this.changeMap.set(nt,changeChildRemoved(nt,it.oldSnap));else if(rt==="child_changed"&&ot==="child_added")this.changeMap.set(nt,changeChildAdded(nt,tt.snapshotNode));else if(rt==="child_changed"&&ot==="child_changed")this.changeMap.set(nt,changeChildChanged(nt,tt.snapshotNode,it.oldSnap));else throw assertionError("Illegal combination of changes: "+tt+" occurred after "+it)}else this.changeMap.set(nt,tt)}getChanges(){return Array.from(this.changeMap.values())}}class NoCompleteChildSource_{getCompleteChild(tt){return null}getChildAfterChild(tt,rt,nt){return null}}const NO_COMPLETE_CHILD_SOURCE=new NoCompleteChildSource_;class WriteTreeCompleteChildSource{constructor(tt,rt,nt=null){this.writes_=tt,this.viewCache_=rt,this.optCompleteServerCache_=nt}getCompleteChild(tt){const rt=this.viewCache_.eventCache;if(rt.isCompleteForChild(tt))return rt.getNode().getImmediateChild(tt);{const nt=this.optCompleteServerCache_!=null?new CacheNode(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return writeTreeRefCalcCompleteChild(this.writes_,tt,nt)}}getChildAfterChild(tt,rt,nt){const it=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:viewCacheGetCompleteServerSnap(this.viewCache_),ot=writeTreeRefCalcIndexedSlice(this.writes_,it,rt,1,nt,tt);return ot.length===0?null:ot[0]}}function viewProcessorAssertIndexed(et,tt){assert(tt.eventCache.getNode().isIndexed(et.filter.getIndex()),"Event snap not indexed"),assert(tt.serverCache.getNode().isIndexed(et.filter.getIndex()),"Server snap not indexed")}function viewProcessorApplyOperation(et,tt,rt,nt,it){const ot=new ChildChangeAccumulator;let st,at;if(rt.type===OperationType.OVERWRITE){const ut=rt;ut.source.fromUser?st=viewProcessorApplyUserOverwrite(et,tt,ut.path,ut.snap,nt,it,ot):(assert(ut.source.fromServer,"Unknown source."),at=ut.source.tagged||tt.serverCache.isFiltered()&&!pathIsEmpty(ut.path),st=viewProcessorApplyServerOverwrite(et,tt,ut.path,ut.snap,nt,it,at,ot))}else if(rt.type===OperationType.MERGE){const ut=rt;ut.source.fromUser?st=viewProcessorApplyUserMerge(et,tt,ut.path,ut.children,nt,it,ot):(assert(ut.source.fromServer,"Unknown source."),at=ut.source.tagged||tt.serverCache.isFiltered(),st=viewProcessorApplyServerMerge(et,tt,ut.path,ut.children,nt,it,at,ot))}else if(rt.type===OperationType.ACK_USER_WRITE){const ut=rt;ut.revert?st=viewProcessorRevertUserWrite(et,tt,ut.path,nt,it,ot):st=viewProcessorAckUserWrite(et,tt,ut.path,ut.affectedTree,nt,it,ot)}else if(rt.type===OperationType.LISTEN_COMPLETE)st=viewProcessorListenComplete(et,tt,rt.path,nt,ot);else throw assertionError("Unknown operation type: "+rt.type);const ct=ot.getChanges();return viewProcessorMaybeAddValueEvent(tt,st,ct),{viewCache:st,changes:ct}}function viewProcessorMaybeAddValueEvent(et,tt,rt){const nt=tt.eventCache;if(nt.isFullyInitialized()){const it=nt.getNode().isLeafNode()||nt.getNode().isEmpty(),ot=viewCacheGetCompleteEventSnap(et);(rt.length>0||!et.eventCache.isFullyInitialized()||it&&!nt.getNode().equals(ot)||!nt.getNode().getPriority().equals(ot.getPriority()))&&rt.push(changeValue(viewCacheGetCompleteEventSnap(tt)))}}function viewProcessorGenerateEventCacheAfterServerEvent(et,tt,rt,nt,it,ot){const st=tt.eventCache;if(writeTreeRefShadowingWrite(nt,rt)!=null)return tt;{let at,ct;if(pathIsEmpty(rt))if(assert(tt.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),tt.serverCache.isFiltered()){const ut=viewCacheGetCompleteServerSnap(tt),lt=ut instanceof ChildrenNode?ut:ChildrenNode.EMPTY_NODE,ht=writeTreeRefCalcCompleteEventChildren(nt,lt);at=et.filter.updateFullNode(tt.eventCache.getNode(),ht,ot)}else{const ut=writeTreeRefCalcCompleteEventCache(nt,viewCacheGetCompleteServerSnap(tt));at=et.filter.updateFullNode(tt.eventCache.getNode(),ut,ot)}else{const ut=pathGetFront(rt);if(ut===".priority"){assert(pathGetLength(rt)===1,"Can't have a priority with additional path components");const lt=st.getNode();ct=tt.serverCache.getNode();const ht=writeTreeRefCalcEventCacheAfterServerOverwrite(nt,rt,lt,ct);ht!=null?at=et.filter.updatePriority(lt,ht):at=st.getNode()}else{const lt=pathPopFront(rt);let ht;if(st.isCompleteForChild(ut)){ct=tt.serverCache.getNode();const ft=writeTreeRefCalcEventCacheAfterServerOverwrite(nt,rt,st.getNode(),ct);ft!=null?ht=st.getNode().getImmediateChild(ut).updateChild(lt,ft):ht=st.getNode().getImmediateChild(ut)}else ht=writeTreeRefCalcCompleteChild(nt,ut,tt.serverCache);ht!=null?at=et.filter.updateChild(st.getNode(),ut,ht,lt,it,ot):at=st.getNode()}}return viewCacheUpdateEventSnap(tt,at,st.isFullyInitialized()||pathIsEmpty(rt),et.filter.filtersNodes())}}function viewProcessorApplyServerOverwrite(et,tt,rt,nt,it,ot,st,at){const ct=tt.serverCache;let ut;const lt=st?et.filter:et.filter.getIndexedFilter();if(pathIsEmpty(rt))ut=lt.updateFullNode(ct.getNode(),nt,null);else if(lt.filtersNodes()&&!ct.isFiltered()){const dt=ct.getNode().updateChild(rt,nt);ut=lt.updateFullNode(ct.getNode(),dt,null)}else{const dt=pathGetFront(rt);if(!ct.isCompleteForPath(rt)&&pathGetLength(rt)>1)return tt;const pt=pathPopFront(rt),gt=ct.getNode().getImmediateChild(dt).updateChild(pt,nt);dt===".priority"?ut=lt.updatePriority(ct.getNode(),gt):ut=lt.updateChild(ct.getNode(),dt,gt,pt,NO_COMPLETE_CHILD_SOURCE,null)}const ht=viewCacheUpdateServerSnap(tt,ut,ct.isFullyInitialized()||pathIsEmpty(rt),lt.filtersNodes()),ft=new WriteTreeCompleteChildSource(it,ht,ot);return viewProcessorGenerateEventCacheAfterServerEvent(et,ht,rt,it,ft,at)}function viewProcessorApplyUserOverwrite(et,tt,rt,nt,it,ot,st){const at=tt.eventCache;let ct,ut;const lt=new WriteTreeCompleteChildSource(it,tt,ot);if(pathIsEmpty(rt))ut=et.filter.updateFullNode(tt.eventCache.getNode(),nt,st),ct=viewCacheUpdateEventSnap(tt,ut,!0,et.filter.filtersNodes());else{const ht=pathGetFront(rt);if(ht===".priority")ut=et.filter.updatePriority(tt.eventCache.getNode(),nt),ct=viewCacheUpdateEventSnap(tt,ut,at.isFullyInitialized(),at.isFiltered());else{const ft=pathPopFront(rt),dt=at.getNode().getImmediateChild(ht);let pt;if(pathIsEmpty(ft))pt=nt;else{const gt=lt.getCompleteChild(ht);gt!=null?pathGetBack(ft)===".priority"&&gt.getChild(pathParent(ft)).isEmpty()?pt=gt:pt=gt.updateChild(ft,nt):pt=ChildrenNode.EMPTY_NODE}if(dt.equals(pt))ct=tt;else{const gt=et.filter.updateChild(at.getNode(),ht,pt,ft,lt,st);ct=viewCacheUpdateEventSnap(tt,gt,at.isFullyInitialized(),et.filter.filtersNodes())}}}return ct}function viewProcessorCacheHasChild(et,tt){return et.eventCache.isCompleteForChild(tt)}function viewProcessorApplyUserMerge(et,tt,rt,nt,it,ot,st){let at=tt;return nt.foreach((ct,ut)=>{const lt=pathChild(rt,ct);viewProcessorCacheHasChild(tt,pathGetFront(lt))&&(at=viewProcessorApplyUserOverwrite(et,at,lt,ut,it,ot,st))}),nt.foreach((ct,ut)=>{const lt=pathChild(rt,ct);viewProcessorCacheHasChild(tt,pathGetFront(lt))||(at=viewProcessorApplyUserOverwrite(et,at,lt,ut,it,ot,st))}),at}function viewProcessorApplyMerge(et,tt,rt){return rt.foreach((nt,it)=>{tt=tt.updateChild(nt,it)}),tt}function viewProcessorApplyServerMerge(et,tt,rt,nt,it,ot,st,at){if(tt.serverCache.getNode().isEmpty()&&!tt.serverCache.isFullyInitialized())return tt;let ct=tt,ut;pathIsEmpty(rt)?ut=nt:ut=new ImmutableTree(null).setTree(rt,nt);const lt=tt.serverCache.getNode();return ut.children.inorderTraversal((ht,ft)=>{if(lt.hasChild(ht)){const dt=tt.serverCache.getNode().getImmediateChild(ht),pt=viewProcessorApplyMerge(et,dt,ft);ct=viewProcessorApplyServerOverwrite(et,ct,new Path(ht),pt,it,ot,st,at)}}),ut.children.inorderTraversal((ht,ft)=>{const dt=!tt.serverCache.isCompleteForChild(ht)&&ft.value===null;if(!lt.hasChild(ht)&&!dt){const pt=tt.serverCache.getNode().getImmediateChild(ht),gt=viewProcessorApplyMerge(et,pt,ft);ct=viewProcessorApplyServerOverwrite(et,ct,new Path(ht),gt,it,ot,st,at)}}),ct}function viewProcessorAckUserWrite(et,tt,rt,nt,it,ot,st){if(writeTreeRefShadowingWrite(it,rt)!=null)return tt;const at=tt.serverCache.isFiltered(),ct=tt.serverCache;if(nt.value!=null){if(pathIsEmpty(rt)&&ct.isFullyInitialized()||ct.isCompleteForPath(rt))return viewProcessorApplyServerOverwrite(et,tt,rt,ct.getNode().getChild(rt),it,ot,at,st);if(pathIsEmpty(rt)){let ut=new ImmutableTree(null);return ct.getNode().forEachChild(KEY_INDEX,(lt,ht)=>{ut=ut.set(new Path(lt),ht)}),viewProcessorApplyServerMerge(et,tt,rt,ut,it,ot,at,st)}else return tt}else{let ut=new ImmutableTree(null);return nt.foreach((lt,ht)=>{const ft=pathChild(rt,lt);ct.isCompleteForPath(ft)&&(ut=ut.set(lt,ct.getNode().getChild(ft)))}),viewProcessorApplyServerMerge(et,tt,rt,ut,it,ot,at,st)}}function viewProcessorListenComplete(et,tt,rt,nt,it){const ot=tt.serverCache,st=viewCacheUpdateServerSnap(tt,ot.getNode(),ot.isFullyInitialized()||pathIsEmpty(rt),ot.isFiltered());return viewProcessorGenerateEventCacheAfterServerEvent(et,st,rt,nt,NO_COMPLETE_CHILD_SOURCE,it)}function viewProcessorRevertUserWrite(et,tt,rt,nt,it,ot){let st;if(writeTreeRefShadowingWrite(nt,rt)!=null)return tt;{const at=new WriteTreeCompleteChildSource(nt,tt,it),ct=tt.eventCache.getNode();let ut;if(pathIsEmpty(rt)||pathGetFront(rt)===".priority"){let lt;if(tt.serverCache.isFullyInitialized())lt=writeTreeRefCalcCompleteEventCache(nt,viewCacheGetCompleteServerSnap(tt));else{const ht=tt.serverCache.getNode();assert(ht instanceof ChildrenNode,"serverChildren would be complete if leaf node"),lt=writeTreeRefCalcCompleteEventChildren(nt,ht)}lt=lt,ut=et.filter.updateFullNode(ct,lt,ot)}else{const lt=pathGetFront(rt);let ht=writeTreeRefCalcCompleteChild(nt,lt,tt.serverCache);ht==null&&tt.serverCache.isCompleteForChild(lt)&&(ht=ct.getImmediateChild(lt)),ht!=null?ut=et.filter.updateChild(ct,lt,ht,pathPopFront(rt),at,ot):tt.eventCache.getNode().hasChild(lt)?ut=et.filter.updateChild(ct,lt,ChildrenNode.EMPTY_NODE,pathPopFront(rt),at,ot):ut=ct,ut.isEmpty()&&tt.serverCache.isFullyInitialized()&&(st=writeTreeRefCalcCompleteEventCache(nt,viewCacheGetCompleteServerSnap(tt)),st.isLeafNode()&&(ut=et.filter.updateFullNode(ut,st,ot)))}return st=tt.serverCache.isFullyInitialized()||writeTreeRefShadowingWrite(nt,newEmptyPath())!=null,viewCacheUpdateEventSnap(tt,ut,st,et.filter.filtersNodes())}}function viewGetCompleteServerCache(et,tt){const rt=viewCacheGetCompleteServerSnap(et.viewCache_);return rt&&(et.query._queryParams.loadsAllData()||!pathIsEmpty(tt)&&!rt.getImmediateChild(pathGetFront(tt)).isEmpty())?rt.getChild(tt):null}function viewApplyOperation(et,tt,rt,nt){tt.type===OperationType.MERGE&&tt.source.queryId!==null&&(assert(viewCacheGetCompleteServerSnap(et.viewCache_),"We should always have a full cache before handling merges"),assert(viewCacheGetCompleteEventSnap(et.viewCache_),"Missing event cache, even though we have a server cache"));const it=et.viewCache_,ot=viewProcessorApplyOperation(et.processor_,it,tt,rt,nt);return viewProcessorAssertIndexed(et.processor_,ot.viewCache),assert(ot.viewCache.serverCache.isFullyInitialized()||!it.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),et.viewCache_=ot.viewCache,viewGenerateEventsForChanges_(et,ot.changes,ot.viewCache.eventCache.getNode(),null)}function viewGenerateEventsForChanges_(et,tt,rt,nt){const it=nt?[nt]:et.eventRegistrations_;return eventGeneratorGenerateEventsForChanges(et.eventGenerator_,tt,rt,it)}let referenceConstructor$1;function syncPointSetReferenceConstructor(et){assert(!referenceConstructor$1,"__referenceConstructor has already been defined"),referenceConstructor$1=et}function syncPointApplyOperation(et,tt,rt,nt){const it=tt.source.queryId;if(it!==null){const ot=et.views.get(it);return assert(ot!=null,"SyncTree gave us an op for an invalid query."),viewApplyOperation(ot,tt,rt,nt)}else{let ot=[];for(const st of et.views.values())ot=ot.concat(viewApplyOperation(st,tt,rt,nt));return ot}}function syncPointGetCompleteServerCache(et,tt){let rt=null;for(const nt of et.views.values())rt=rt||viewGetCompleteServerCache(nt,tt);return rt}let referenceConstructor;function syncTreeSetReferenceConstructor(et){assert(!referenceConstructor,"__referenceConstructor has already been defined"),referenceConstructor=et}class SyncTree{constructor(tt){this.listenProvider_=tt,this.syncPointTree_=new ImmutableTree(null),this.pendingWriteTree_=newWriteTree(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function syncTreeApplyUserOverwrite(et,tt,rt,nt,it){return writeTreeAddOverwrite(et.pendingWriteTree_,tt,rt,nt,it),it?syncTreeApplyOperationToSyncPoints_(et,new Overwrite(newOperationSourceUser(),tt,rt)):[]}function syncTreeAckUserWrite(et,tt,rt=!1){const nt=writeTreeGetWrite(et.pendingWriteTree_,tt);if(writeTreeRemoveWrite(et.pendingWriteTree_,tt)){let it=new ImmutableTree(null);return nt.snap!=null?it=it.set(newEmptyPath(),!0):each(nt.children,ot=>{it=it.set(new Path(ot),!0)}),syncTreeApplyOperationToSyncPoints_(et,new AckUserWrite(nt.path,it,rt))}else return[]}function syncTreeApplyServerOverwrite(et,tt,rt){return syncTreeApplyOperationToSyncPoints_(et,new Overwrite(newOperationSourceServer(),tt,rt))}function syncTreeApplyServerMerge(et,tt,rt){const nt=ImmutableTree.fromObject(rt);return syncTreeApplyOperationToSyncPoints_(et,new Merge(newOperationSourceServer(),tt,nt))}function syncTreeApplyTaggedQueryOverwrite(et,tt,rt,nt){const it=syncTreeQueryKeyForTag_(et,nt);if(it!=null){const ot=syncTreeParseQueryKey_(it),st=ot.path,at=ot.queryId,ct=newRelativePath(st,tt),ut=new Overwrite(newOperationSourceServerTaggedQuery(at),ct,rt);return syncTreeApplyTaggedOperation_(et,st,ut)}else return[]}function syncTreeApplyTaggedQueryMerge(et,tt,rt,nt){const it=syncTreeQueryKeyForTag_(et,nt);if(it){const ot=syncTreeParseQueryKey_(it),st=ot.path,at=ot.queryId,ct=newRelativePath(st,tt),ut=ImmutableTree.fromObject(rt),lt=new Merge(newOperationSourceServerTaggedQuery(at),ct,ut);return syncTreeApplyTaggedOperation_(et,st,lt)}else return[]}function syncTreeCalcCompleteEventCache(et,tt,rt){const nt=et.pendingWriteTree_,it=et.syncPointTree_.findOnPath(tt,(ot,st)=>{const at=newRelativePath(ot,tt),ct=syncPointGetCompleteServerCache(st,at);if(ct)return ct});return writeTreeCalcCompleteEventCache(nt,tt,it,rt,!0)}function syncTreeApplyOperationToSyncPoints_(et,tt){return syncTreeApplyOperationHelper_(tt,et.syncPointTree_,null,writeTreeChildWrites(et.pendingWriteTree_,newEmptyPath()))}function syncTreeApplyOperationHelper_(et,tt,rt,nt){if(pathIsEmpty(et.path))return syncTreeApplyOperationDescendantsHelper_(et,tt,rt,nt);{const it=tt.get(newEmptyPath());rt==null&&it!=null&&(rt=syncPointGetCompleteServerCache(it,newEmptyPath()));let ot=[];const st=pathGetFront(et.path),at=et.operationForChild(st),ct=tt.children.get(st);if(ct&&at){const ut=rt?rt.getImmediateChild(st):null,lt=writeTreeRefChild(nt,st);ot=ot.concat(syncTreeApplyOperationHelper_(at,ct,ut,lt))}return it&&(ot=ot.concat(syncPointApplyOperation(it,et,nt,rt))),ot}}function syncTreeApplyOperationDescendantsHelper_(et,tt,rt,nt){const it=tt.get(newEmptyPath());rt==null&&it!=null&&(rt=syncPointGetCompleteServerCache(it,newEmptyPath()));let ot=[];return tt.children.inorderTraversal((st,at)=>{const ct=rt?rt.getImmediateChild(st):null,ut=writeTreeRefChild(nt,st),lt=et.operationForChild(st);lt&&(ot=ot.concat(syncTreeApplyOperationDescendantsHelper_(lt,at,ct,ut)))}),it&&(ot=ot.concat(syncPointApplyOperation(it,et,nt,rt))),ot}function syncTreeQueryKeyForTag_(et,tt){return et.tagToQueryMap.get(tt)}function syncTreeParseQueryKey_(et){const tt=et.indexOf("$");return assert(tt!==-1&&tt<et.length-1,"Bad queryKey."),{queryId:et.substr(tt+1),path:new Path(et.substr(0,tt))}}function syncTreeApplyTaggedOperation_(et,tt,rt){const nt=et.syncPointTree_.get(tt);assert(nt,"Missing sync point for query tag that we're tracking");const it=writeTreeChildWrites(et.pendingWriteTree_,tt);return syncPointApplyOperation(nt,rt,it,null)}class ExistingValueProvider{constructor(tt){this.node_=tt}getImmediateChild(tt){const rt=this.node_.getImmediateChild(tt);return new ExistingValueProvider(rt)}node(){return this.node_}}class DeferredValueProvider{constructor(tt,rt){this.syncTree_=tt,this.path_=rt}getImmediateChild(tt){const rt=pathChild(this.path_,tt);return new DeferredValueProvider(this.syncTree_,rt)}node(){return syncTreeCalcCompleteEventCache(this.syncTree_,this.path_)}}const generateWithValues=function(et){return et=et||{},et.timestamp=et.timestamp||new Date().getTime(),et},resolveDeferredLeafValue=function(et,tt,rt){if(!et||typeof et!="object")return et;if(assert(".sv"in et,"Unexpected leaf node or priority contents"),typeof et[".sv"]=="string")return resolveScalarDeferredValue(et[".sv"],tt,rt);if(typeof et[".sv"]=="object")return resolveComplexDeferredValue(et[".sv"],tt);assert(!1,"Unexpected server value: "+JSON.stringify(et,null,2))},resolveScalarDeferredValue=function(et,tt,rt){switch(et){case"timestamp":return rt.timestamp;default:assert(!1,"Unexpected server value: "+et)}},resolveComplexDeferredValue=function(et,tt,rt){et.hasOwnProperty("increment")||assert(!1,"Unexpected server value: "+JSON.stringify(et,null,2));const nt=et.increment;typeof nt!="number"&&assert(!1,"Unexpected increment value: "+nt);const it=tt.node();if(assert(it!==null&&typeof it<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!it.isLeafNode())return nt;const ot=it.getValue();return typeof ot!="number"?nt:ot+nt},resolveDeferredValueTree=function(et,tt,rt,nt){return resolveDeferredValue(tt,new DeferredValueProvider(rt,et),nt)},resolveDeferredValueSnapshot=function(et,tt,rt){return resolveDeferredValue(et,new ExistingValueProvider(tt),rt)};function resolveDeferredValue(et,tt,rt){const nt=et.getPriority().val(),it=resolveDeferredLeafValue(nt,tt.getImmediateChild(".priority"),rt);let ot;if(et.isLeafNode()){const st=et,at=resolveDeferredLeafValue(st.getValue(),tt,rt);return at!==st.getValue()||it!==st.getPriority().val()?new LeafNode(at,nodeFromJSON(it)):et}else{const st=et;return ot=st,it!==st.getPriority().val()&&(ot=ot.updatePriority(new LeafNode(it))),st.forEachChild(PRIORITY_INDEX,(at,ct)=>{const ut=resolveDeferredValue(ct,tt.getImmediateChild(at),rt);ut!==ct&&(ot=ot.updateImmediateChild(at,ut))}),ot}}class Tree{constructor(tt="",rt=null,nt={children:{},childCount:0}){this.name=tt,this.parent=rt,this.node=nt}}function treeSubTree(et,tt){let rt=tt instanceof Path?tt:new Path(tt),nt=et,it=pathGetFront(rt);for(;it!==null;){const ot=safeGet(nt.node.children,it)||{children:{},childCount:0};nt=new Tree(it,nt,ot),rt=pathPopFront(rt),it=pathGetFront(rt)}return nt}function treeGetValue(et){return et.node.value}function treeSetValue(et,tt){et.node.value=tt,treeUpdateParents(et)}function treeHasChildren(et){return et.node.childCount>0}function treeIsEmpty(et){return treeGetValue(et)===void 0&&!treeHasChildren(et)}function treeForEachChild(et,tt){each(et.node.children,(rt,nt)=>{tt(new Tree(rt,et,nt))})}function treeForEachDescendant(et,tt,rt,nt){rt&&!nt&&tt(et),treeForEachChild(et,it=>{treeForEachDescendant(it,tt,!0,nt)}),rt&&nt&&tt(et)}function treeForEachAncestor(et,tt,rt){let nt=rt?et:et.parent;for(;nt!==null;){if(tt(nt))return!0;nt=nt.parent}return!1}function treeGetPath(et){return new Path(et.parent===null?et.name:treeGetPath(et.parent)+"/"+et.name)}function treeUpdateParents(et){et.parent!==null&&treeUpdateChild(et.parent,et.name,et)}function treeUpdateChild(et,tt,rt){const nt=treeIsEmpty(rt),it=contains(et.node.children,tt);nt&&it?(delete et.node.children[tt],et.node.childCount--,treeUpdateParents(et)):!nt&&!it&&(et.node.children[tt]=rt.node,et.node.childCount++,treeUpdateParents(et))}const INVALID_KEY_REGEX_=/[\[\].#$\/\u0000-\u001F\u007F]/,INVALID_PATH_REGEX_=/[\[\].#$\u0000-\u001F\u007F]/,MAX_LEAF_SIZE_=10*1024*1024,isValidKey=function(et){return typeof et=="string"&&et.length!==0&&!INVALID_KEY_REGEX_.test(et)},isValidPathString=function(et){return typeof et=="string"&&et.length!==0&&!INVALID_PATH_REGEX_.test(et)},isValidRootPathString=function(et){return et&&(et=et.replace(/^\/*\.info(\/|$)/,"/")),isValidPathString(et)},validateFirebaseData=function(et,tt,rt){const nt=rt instanceof Path?new ValidationPath(rt,et):rt;if(tt===void 0)throw new Error(et+"contains undefined "+validationPathToErrorString(nt));if(typeof tt=="function")throw new Error(et+"contains a function "+validationPathToErrorString(nt)+" with contents = "+tt.toString());if(isInvalidJSONNumber(tt))throw new Error(et+"contains "+tt.toString()+" "+validationPathToErrorString(nt));if(typeof tt=="string"&&tt.length>MAX_LEAF_SIZE_/3&&stringLength(tt)>MAX_LEAF_SIZE_)throw new Error(et+"contains a string greater than "+MAX_LEAF_SIZE_+" utf8 bytes "+validationPathToErrorString(nt)+" ('"+tt.substring(0,50)+"...')");if(tt&&typeof tt=="object"){let it=!1,ot=!1;if(each(tt,(st,at)=>{if(st===".value")it=!0;else if(st!==".priority"&&st!==".sv"&&(ot=!0,!isValidKey(st)))throw new Error(et+" contains an invalid key ("+st+") "+validationPathToErrorString(nt)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);validationPathPush(nt,st),validateFirebaseData(et,at,nt),validationPathPop(nt)}),it&&ot)throw new Error(et+' contains ".value" child '+validationPathToErrorString(nt)+" in addition to actual children.")}},validateUrl=function(et,tt){const rt=tt.path.toString();if(typeof tt.repoInfo.host!="string"||tt.repoInfo.host.length===0||!isValidKey(tt.repoInfo.namespace)&&tt.repoInfo.host.split(":")[0]!=="localhost"||rt.length!==0&&!isValidRootPathString(rt))throw new Error(errorPrefix(et,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};class EventQueue{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function eventQueueQueueEvents(et,tt){let rt=null;for(let nt=0;nt<tt.length;nt++){const it=tt[nt],ot=it.getPath();rt!==null&&!pathEquals(ot,rt.path)&&(et.eventLists_.push(rt),rt=null),rt===null&&(rt={events:[],path:ot}),rt.events.push(it)}rt&&et.eventLists_.push(rt)}function eventQueueRaiseEventsForChangedPath(et,tt,rt){eventQueueQueueEvents(et,rt),eventQueueRaiseQueuedEventsMatchingPredicate(et,nt=>pathContains(nt,tt)||pathContains(tt,nt))}function eventQueueRaiseQueuedEventsMatchingPredicate(et,tt){et.recursionDepth_++;let rt=!0;for(let nt=0;nt<et.eventLists_.length;nt++){const it=et.eventLists_[nt];if(it){const ot=it.path;tt(ot)?(eventListRaise(et.eventLists_[nt]),et.eventLists_[nt]=null):rt=!1}}rt&&(et.eventLists_=[]),et.recursionDepth_--}function eventListRaise(et){for(let tt=0;tt<et.events.length;tt++){const rt=et.events[tt];if(rt!==null){et.events[tt]=null;const nt=rt.getEventRunner();logger&&log$e("event: "+rt.toString()),exceptionGuard(nt)}}}const INTERRUPT_REASON="repo_interrupt",MAX_TRANSACTION_RETRIES=25;let Repo$1=class{constructor(et,tt,rt,nt){this.repoInfo_=et,this.forceRestClient_=tt,this.authTokenProvider_=rt,this.appCheckProvider_=nt,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new EventQueue,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=newSparseSnapshotTree(),this.transactionQueueTree_=new Tree,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function repoStart(et,tt,rt){if(et.stats_=statsManagerGetCollection(et.repoInfo_),et.forceRestClient_||beingCrawled())et.server_=new ReadonlyRestClient(et.repoInfo_,(nt,it,ot,st)=>{repoOnDataUpdate(et,nt,it,ot,st)},et.authTokenProvider_,et.appCheckProvider_),setTimeout(()=>repoOnConnectStatus(et,!0),0);else{if(typeof rt<"u"&&rt!==null){if(typeof rt!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{stringify(rt)}catch(nt){throw new Error("Invalid authOverride provided: "+nt)}}et.persistentConnection_=new PersistentConnection(et.repoInfo_,tt,(nt,it,ot,st)=>{repoOnDataUpdate(et,nt,it,ot,st)},nt=>{repoOnConnectStatus(et,nt)},nt=>{repoOnServerInfoUpdate(et,nt)},et.authTokenProvider_,et.appCheckProvider_,rt),et.server_=et.persistentConnection_}et.authTokenProvider_.addTokenChangeListener(nt=>{et.server_.refreshAuthToken(nt)}),et.appCheckProvider_.addTokenChangeListener(nt=>{et.server_.refreshAppCheckToken(nt.token)}),et.statsReporter_=statsManagerGetOrCreateReporter(et.repoInfo_,()=>new StatsReporter(et.stats_,et.server_)),et.infoData_=new SnapshotHolder,et.infoSyncTree_=new SyncTree({startListening:(nt,it,ot,st)=>{let at=[];const ct=et.infoData_.getNode(nt._path);return ct.isEmpty()||(at=syncTreeApplyServerOverwrite(et.infoSyncTree_,nt._path,ct),setTimeout(()=>{st("ok")},0)),at},stopListening:()=>{}}),repoUpdateInfo(et,"connected",!1),et.serverSyncTree_=new SyncTree({startListening:(nt,it,ot,st)=>(et.server_.listen(nt,ot,it,(at,ct)=>{const ut=st(at,ct);eventQueueRaiseEventsForChangedPath(et.eventQueue_,nt._path,ut)}),[]),stopListening:(nt,it)=>{et.server_.unlisten(nt,it)}})}function repoServerTime(et){const tt=et.infoData_.getNode(new Path(".info/serverTimeOffset")).val()||0;return new Date().getTime()+tt}function repoGenerateServerValues(et){return generateWithValues({timestamp:repoServerTime(et)})}function repoOnDataUpdate(et,tt,rt,nt,it){et.dataUpdateCount++;const ot=new Path(tt);rt=et.interceptServerDataCallback_?et.interceptServerDataCallback_(tt,rt):rt;let st=[];if(it)if(nt){const ct=map$4(rt,ut=>nodeFromJSON(ut));st=syncTreeApplyTaggedQueryMerge(et.serverSyncTree_,ot,ct,it)}else{const ct=nodeFromJSON(rt);st=syncTreeApplyTaggedQueryOverwrite(et.serverSyncTree_,ot,ct,it)}else if(nt){const ct=map$4(rt,ut=>nodeFromJSON(ut));st=syncTreeApplyServerMerge(et.serverSyncTree_,ot,ct)}else{const ct=nodeFromJSON(rt);st=syncTreeApplyServerOverwrite(et.serverSyncTree_,ot,ct)}let at=ot;st.length>0&&(at=repoRerunTransactions(et,ot)),eventQueueRaiseEventsForChangedPath(et.eventQueue_,at,st)}function repoOnConnectStatus(et,tt){repoUpdateInfo(et,"connected",tt),tt===!1&&repoRunOnDisconnectEvents(et)}function repoOnServerInfoUpdate(et,tt){each(tt,(rt,nt)=>{repoUpdateInfo(et,rt,nt)})}function repoUpdateInfo(et,tt,rt){const nt=new Path("/.info/"+tt),it=nodeFromJSON(rt);et.infoData_.updateSnapshot(nt,it);const ot=syncTreeApplyServerOverwrite(et.infoSyncTree_,nt,it);eventQueueRaiseEventsForChangedPath(et.eventQueue_,nt,ot)}function repoGetNextWriteId(et){return et.nextWriteId_++}function repoRunOnDisconnectEvents(et){repoLog(et,"onDisconnectEvents");const tt=repoGenerateServerValues(et),rt=newSparseSnapshotTree();sparseSnapshotTreeForEachTree(et.onDisconnect_,newEmptyPath(),(it,ot)=>{const st=resolveDeferredValueTree(it,ot,et.serverSyncTree_,tt);sparseSnapshotTreeRemember(rt,it,st)});let nt=[];sparseSnapshotTreeForEachTree(rt,newEmptyPath(),(it,ot)=>{nt=nt.concat(syncTreeApplyServerOverwrite(et.serverSyncTree_,it,ot));const st=repoAbortTransactions(et,it);repoRerunTransactions(et,st)}),et.onDisconnect_=newSparseSnapshotTree(),eventQueueRaiseEventsForChangedPath(et.eventQueue_,newEmptyPath(),nt)}function repoInterrupt(et){et.persistentConnection_&&et.persistentConnection_.interrupt(INTERRUPT_REASON)}function repoLog(et,...tt){let rt="";et.persistentConnection_&&(rt=et.persistentConnection_.id+":"),log$e(rt,...tt)}function repoGetLatestState(et,tt,rt){return syncTreeCalcCompleteEventCache(et.serverSyncTree_,tt,rt)||ChildrenNode.EMPTY_NODE}function repoSendReadyTransactions(et,tt=et.transactionQueueTree_){if(tt||repoPruneCompletedTransactionsBelowNode(et,tt),treeGetValue(tt)){const rt=repoBuildTransactionQueue(et,tt);assert(rt.length>0,"Sending zero length transaction queue"),rt.every(nt=>nt.status===0)&&repoSendTransactionQueue(et,treeGetPath(tt),rt)}else treeHasChildren(tt)&&treeForEachChild(tt,rt=>{repoSendReadyTransactions(et,rt)})}function repoSendTransactionQueue(et,tt,rt){const nt=rt.map(ut=>ut.currentWriteId),it=repoGetLatestState(et,tt,nt);let ot=it;const st=it.hash();for(let ut=0;ut<rt.length;ut++){const lt=rt[ut];assert(lt.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),lt.status=1,lt.retryCount++;const ht=newRelativePath(tt,lt.path);ot=ot.updateChild(ht,lt.currentOutputSnapshotRaw)}const at=ot.val(!0),ct=tt;et.server_.put(ct.toString(),at,ut=>{repoLog(et,"transaction put response",{path:ct.toString(),status:ut});let lt=[];if(ut==="ok"){const ht=[];for(let ft=0;ft<rt.length;ft++)rt[ft].status=2,lt=lt.concat(syncTreeAckUserWrite(et.serverSyncTree_,rt[ft].currentWriteId)),rt[ft].onComplete&&ht.push(()=>rt[ft].onComplete(null,!0,rt[ft].currentOutputSnapshotResolved)),rt[ft].unwatcher();repoPruneCompletedTransactionsBelowNode(et,treeSubTree(et.transactionQueueTree_,tt)),repoSendReadyTransactions(et,et.transactionQueueTree_),eventQueueRaiseEventsForChangedPath(et.eventQueue_,tt,lt);for(let ft=0;ft<ht.length;ft++)exceptionGuard(ht[ft])}else{if(ut==="datastale")for(let ht=0;ht<rt.length;ht++)rt[ht].status===3?rt[ht].status=4:rt[ht].status=0;else{warn$1("transaction at "+ct.toString()+" failed: "+ut);for(let ht=0;ht<rt.length;ht++)rt[ht].status=4,rt[ht].abortReason=ut}repoRerunTransactions(et,tt)}},st)}function repoRerunTransactions(et,tt){const rt=repoGetAncestorTransactionNode(et,tt),nt=treeGetPath(rt),it=repoBuildTransactionQueue(et,rt);return repoRerunTransactionQueue(et,it,nt),nt}function repoRerunTransactionQueue(et,tt,rt){if(tt.length===0)return;const nt=[];let it=[];const ot=tt.filter(st=>st.status===0).map(st=>st.currentWriteId);for(let st=0;st<tt.length;st++){const at=tt[st],ct=newRelativePath(rt,at.path);let ut=!1,lt;if(assert(ct!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),at.status===4)ut=!0,lt=at.abortReason,it=it.concat(syncTreeAckUserWrite(et.serverSyncTree_,at.currentWriteId,!0));else if(at.status===0)if(at.retryCount>=MAX_TRANSACTION_RETRIES)ut=!0,lt="maxretry",it=it.concat(syncTreeAckUserWrite(et.serverSyncTree_,at.currentWriteId,!0));else{const ht=repoGetLatestState(et,at.path,ot);at.currentInputSnapshot=ht;const ft=tt[st].update(ht.val());if(ft!==void 0){validateFirebaseData("transaction failed: Data returned ",ft,at.path);let dt=nodeFromJSON(ft);typeof ft=="object"&&ft!=null&&contains(ft,".priority")||(dt=dt.updatePriority(ht.getPriority()));const pt=at.currentWriteId,gt=repoGenerateServerValues(et),_t=resolveDeferredValueSnapshot(dt,ht,gt);at.currentOutputSnapshotRaw=dt,at.currentOutputSnapshotResolved=_t,at.currentWriteId=repoGetNextWriteId(et),ot.splice(ot.indexOf(pt),1),it=it.concat(syncTreeApplyUserOverwrite(et.serverSyncTree_,at.path,_t,at.currentWriteId,at.applyLocally)),it=it.concat(syncTreeAckUserWrite(et.serverSyncTree_,pt,!0))}else ut=!0,lt="nodata",it=it.concat(syncTreeAckUserWrite(et.serverSyncTree_,at.currentWriteId,!0))}eventQueueRaiseEventsForChangedPath(et.eventQueue_,rt,it),it=[],ut&&(tt[st].status=2,function(ht){setTimeout(ht,Math.floor(0))}(tt[st].unwatcher),tt[st].onComplete&&(lt==="nodata"?nt.push(()=>tt[st].onComplete(null,!1,tt[st].currentInputSnapshot)):nt.push(()=>tt[st].onComplete(new Error(lt),!1,null))))}repoPruneCompletedTransactionsBelowNode(et,et.transactionQueueTree_);for(let st=0;st<nt.length;st++)exceptionGuard(nt[st]);repoSendReadyTransactions(et,et.transactionQueueTree_)}function repoGetAncestorTransactionNode(et,tt){let rt,nt=et.transactionQueueTree_;for(rt=pathGetFront(tt);rt!==null&&treeGetValue(nt)===void 0;)nt=treeSubTree(nt,rt),tt=pathPopFront(tt),rt=pathGetFront(tt);return nt}function repoBuildTransactionQueue(et,tt){const rt=[];return repoAggregateTransactionQueuesForNode(et,tt,rt),rt.sort((nt,it)=>nt.order-it.order),rt}function repoAggregateTransactionQueuesForNode(et,tt,rt){const nt=treeGetValue(tt);if(nt)for(let it=0;it<nt.length;it++)rt.push(nt[it]);treeForEachChild(tt,it=>{repoAggregateTransactionQueuesForNode(et,it,rt)})}function repoPruneCompletedTransactionsBelowNode(et,tt){const rt=treeGetValue(tt);if(rt){let nt=0;for(let it=0;it<rt.length;it++)rt[it].status!==2&&(rt[nt]=rt[it],nt++);rt.length=nt,treeSetValue(tt,rt.length>0?rt:void 0)}treeForEachChild(tt,nt=>{repoPruneCompletedTransactionsBelowNode(et,nt)})}function repoAbortTransactions(et,tt){const rt=treeGetPath(repoGetAncestorTransactionNode(et,tt)),nt=treeSubTree(et.transactionQueueTree_,tt);return treeForEachAncestor(nt,it=>{repoAbortTransactionsOnNode(et,it)}),repoAbortTransactionsOnNode(et,nt),treeForEachDescendant(nt,it=>{repoAbortTransactionsOnNode(et,it)}),rt}function repoAbortTransactionsOnNode(et,tt){const rt=treeGetValue(tt);if(rt){const nt=[];let it=[],ot=-1;for(let st=0;st<rt.length;st++)rt[st].status===3||(rt[st].status===1?(assert(ot===st-1,"All SENT items should be at beginning of queue."),ot=st,rt[st].status=3,rt[st].abortReason="set"):(assert(rt[st].status===0,"Unexpected transaction status in abort"),rt[st].unwatcher(),it=it.concat(syncTreeAckUserWrite(et.serverSyncTree_,rt[st].currentWriteId,!0)),rt[st].onComplete&&nt.push(rt[st].onComplete.bind(null,new Error("set"),!1,null))));ot===-1?treeSetValue(tt,void 0):rt.length=ot+1,eventQueueRaiseEventsForChangedPath(et.eventQueue_,treeGetPath(tt),it);for(let st=0;st<nt.length;st++)exceptionGuard(nt[st])}}function decodePath(et){let tt="";const rt=et.split("/");for(let nt=0;nt<rt.length;nt++)if(rt[nt].length>0){let it=rt[nt];try{it=decodeURIComponent(it.replace(/\+/g," "))}catch{}tt+="/"+it}return tt}function decodeQuery(et){const tt={};et.charAt(0)==="?"&&(et=et.substring(1));for(const rt of et.split("&")){if(rt.length===0)continue;const nt=rt.split("=");nt.length===2?tt[decodeURIComponent(nt[0])]=decodeURIComponent(nt[1]):warn$1(`Invalid query segment '${rt}' in query '${et}'`)}return tt}const parseRepoInfo=function(et,tt){const rt=parseDatabaseURL(et),nt=rt.namespace;rt.domain==="firebase.com"&&fatal(rt.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!nt||nt==="undefined")&&rt.domain!=="localhost"&&fatal("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),rt.secure||warnIfPageIsSecure();const it=rt.scheme==="ws"||rt.scheme==="wss";return{repoInfo:new RepoInfo(rt.host,rt.secure,nt,it,tt,"",nt!==rt.subdomain),path:new Path(rt.pathString)}},parseDatabaseURL=function(et){let tt="",rt="",nt="",it="",ot="",st=!0,at="https",ct=443;if(typeof et=="string"){let ut=et.indexOf("//");ut>=0&&(at=et.substring(0,ut-1),et=et.substring(ut+2));let lt=et.indexOf("/");lt===-1&&(lt=et.length);let ht=et.indexOf("?");ht===-1&&(ht=et.length),tt=et.substring(0,Math.min(lt,ht)),lt<ht&&(it=decodePath(et.substring(lt,ht)));const ft=decodeQuery(et.substring(Math.min(et.length,ht)));ut=tt.indexOf(":"),ut>=0?(st=at==="https"||at==="wss",ct=parseInt(tt.substring(ut+1),10)):ut=tt.length;const dt=tt.slice(0,ut);if(dt.toLowerCase()==="localhost")rt="localhost";else if(dt.split(".").length<=2)rt=dt;else{const pt=tt.indexOf(".");nt=tt.substring(0,pt).toLowerCase(),rt=tt.substring(pt+1),ot=nt}"ns"in ft&&(ot=ft.ns)}return{host:tt,port:ct,domain:rt,subdomain:nt,secure:st,scheme:at,pathString:it,namespace:ot}};class QueryImpl{constructor(tt,rt,nt,it){this._repo=tt,this._path=rt,this._queryParams=nt,this._orderByCalled=it}get key(){return pathIsEmpty(this._path)?null:pathGetBack(this._path)}get ref(){return new ReferenceImpl(this._repo,this._path)}get _queryIdentifier(){const tt=queryParamsGetQueryObject(this._queryParams),rt=ObjectToUniqueKey(tt);return rt==="{}"?"default":rt}get _queryObject(){return queryParamsGetQueryObject(this._queryParams)}isEqual(tt){if(tt=getModularInstance(tt),!(tt instanceof QueryImpl))return!1;const rt=this._repo===tt._repo,nt=pathEquals(this._path,tt._path),it=this._queryIdentifier===tt._queryIdentifier;return rt&&nt&&it}toJSON(){return this.toString()}toString(){return this._repo.toString()+pathToUrlEncodedString(this._path)}}class ReferenceImpl extends QueryImpl{constructor(tt,rt){super(tt,rt,new QueryParams,!1)}get parent(){const tt=pathParent(this._path);return tt===null?null:new ReferenceImpl(this._repo,tt)}get root(){let tt=this;for(;tt.parent!==null;)tt=tt.parent;return tt}}syncPointSetReferenceConstructor(ReferenceImpl),syncTreeSetReferenceConstructor(ReferenceImpl);const FIREBASE_DATABASE_EMULATOR_HOST_VAR="FIREBASE_DATABASE_EMULATOR_HOST",repos={};let useRestClient=!1;function repoManagerDatabaseFromApp(et,tt,rt,nt,it){let ot=nt||et.options.databaseURL;ot===void 0&&(et.options.projectId||fatal("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),log$e("Using default host for project ",et.options.projectId),ot=`${et.options.projectId}-default-rtdb.firebaseio.com`);let st=parseRepoInfo(ot,it),at=st.repoInfo,ct,ut;typeof process<"u"&&process.env&&(ut=process.env[FIREBASE_DATABASE_EMULATOR_HOST_VAR]),ut?(ct=!0,ot=`http://${ut}?ns=${at.namespace}`,st=parseRepoInfo(ot,it),at=st.repoInfo):ct=!st.repoInfo.secure;const lt=it&&ct?new EmulatorTokenProvider(EmulatorTokenProvider.OWNER):new FirebaseAuthTokenProvider(et.name,et.options,tt);validateUrl("Invalid Firebase Database URL",st),pathIsEmpty(st.path)||fatal("Database URL must point to the root of a Firebase Database (not including a child path).");const ht=repoManagerCreateRepo(at,et,lt,new AppCheckTokenProvider(et.name,rt));return new Database(ht,et)}function repoManagerDeleteRepo(et,tt){const rt=repos[tt];(!rt||rt[et.key]!==et)&&fatal(`Database ${tt}(${et.repoInfo_}) has already been deleted.`),repoInterrupt(et),delete rt[et.key]}function repoManagerCreateRepo(et,tt,rt,nt){let it=repos[tt.name];it||(it={},repos[tt.name]=it);let ot=it[et.toURLString()];return ot&&fatal("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),ot=new Repo$1(et,useRestClient,rt,nt),it[et.toURLString()]=ot,ot}class Database{constructor(tt,rt){this._repoInternal=tt,this.app=rt,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(repoStart(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new ReferenceImpl(this._repo,newEmptyPath())),this._rootInternal}_delete(){return this._rootInternal!==null&&(repoManagerDeleteRepo(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(tt){this._rootInternal===null&&fatal("Cannot call "+tt+" on a deleted database.")}}function registerDatabase(et){setSDKVersion(SDK_VERSION$1),_registerComponent(new Component("database",(tt,{instanceIdentifier:rt})=>{const nt=tt.getProvider("app").getImmediate(),it=tt.getProvider("auth-internal"),ot=tt.getProvider("app-check-internal");return repoManagerDatabaseFromApp(nt,it,ot,rt)},"PUBLIC").setMultipleInstances(!0)),registerVersion(name$6,version$5,et),registerVersion(name$6,version$5,"esm2017")}PersistentConnection.prototype.simpleListen=function(et,tt){this.sendRequest("q",{p:et},tt)},PersistentConnection.prototype.echo=function(et,tt){this.sendRequest("echo",{d:et},tt)},registerDatabase();const MAX_BUFFERED_AMOUNT=64*1024,ICECOMPLETE_TIMEOUT=5*1e3,CHANNEL_CLOSING_TIMEOUT=5*1e3;function randombytes(et){const tt=new Uint8Array(et);for(let rt=0;rt<et;rt++)tt[rt]=Math.random()*256|0;return tt}function getBrowserRTC(){if(typeof globalThis>"u")return null;const et={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return et.RTCPeerConnection?et:null}function errCode$j(et,tt){return Object.defineProperty(et,"code",{value:tt,enumerable:!0,configurable:!0}),et}function filterTrickle(et){return et.replace(/a=ice-options:trickle\s\n/g,"")}function warn(et){console.warn(et)}class Peer{constructor(tt={}){if(this._map=new Map,this._id=randombytes(4).toString("hex").slice(0,7),this._doDebug=tt.debug,this._debug("new peer %o",tt),this.channelName=tt.initiator?tt.channelName||randombytes(20).toString("hex"):null,this.initiator=tt.initiator||!1,this.channelConfig=tt.channelConfig||Peer.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},Peer.config,tt.config),this.offerOptions=tt.offerOptions||{},this.answerOptions=tt.answerOptions||{},this.sdpTransform=tt.sdpTransform||(rt=>rt),this.streams=tt.streams||(tt.stream?[tt.stream]:[]),this.trickle=tt.trickle!==void 0?tt.trickle:!0,this.allowHalfTrickle=tt.allowHalfTrickle!==void 0?tt.allowHalfTrickle:!1,this.iceCompleteTimeout=tt.iceCompleteTimeout||ICECOMPLETE_TIMEOUT,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=tt.wrtc&&typeof tt.wrtc=="object"?tt.wrtc:getBrowserRTC(),!this._wrtc)throw errCode$j(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(rt){this.destroy(errCode$j(rt,"ERR_PC_CONSTRUCTOR"));return}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=rt=>{this._onIceCandidate(rt)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(rt=>{this.destroy(errCode$j(rt,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=rt=>{this._setupData(rt)},this.streams&&this.streams.forEach(rt=>{this.addStream(rt)}),this._pc.ontrack=rt=>{this._onTrack(rt)},this._debug("initial negotiation"),this._needsNegotiation()}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(tt){if(!this.destroying){if(this.destroyed)throw errCode$j(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof tt=="string")try{tt=JSON.parse(tt)}catch{tt={}}this._debug("signal()"),tt.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),tt.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(tt.transceiverRequest.kind,tt.transceiverRequest.init)),tt.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(tt.candidate):this._pendingCandidates.push(tt.candidate)),tt.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(tt)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(rt=>{this._addIceCandidate(rt)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(rt=>{this.destroy(errCode$j(rt,"ERR_SET_REMOTE_DESCRIPTION"))}),!tt.sdp&&!tt.candidate&&!tt.renegotiate&&!tt.transceiverRequest&&this.destroy(errCode$j(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(tt){const rt=new this._wrtc.RTCIceCandidate(tt);this._pc.addIceCandidate(rt).catch(nt=>{!rt.address||rt.address.endsWith(".local")?warn("Ignoring unsupported ICE candidate."):this.destroy(errCode$j(nt,"ERR_ADD_ICE_CANDIDATE"))})}send(tt){if(!this.destroying){if(this.destroyed)throw errCode$j(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(tt)}}addTransceiver(tt,rt){if(!this.destroying){if(this.destroyed)throw errCode$j(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(tt,rt),this._needsNegotiation()}catch(nt){this.destroy(errCode$j(nt,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:tt,init:rt}})}}addStream(tt){if(!this.destroying){if(this.destroyed)throw errCode$j(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),tt.getTracks().forEach(rt=>{this.addTrack(rt,tt)})}}addTrack(tt,rt){if(this.destroying)return;if(this.destroyed)throw errCode$j(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const nt=this._senderMap.get(tt)||new Map;let it=nt.get(rt);if(!it)it=this._pc.addTrack(tt,rt),nt.set(rt,it),this._senderMap.set(tt,nt),this._needsNegotiation();else throw it.removed?errCode$j(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):errCode$j(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(tt,rt,nt){if(this.destroying)return;if(this.destroyed)throw errCode$j(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const it=this._senderMap.get(tt),ot=it?it.get(nt):null;if(!ot)throw errCode$j(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");rt&&this._senderMap.set(rt,it),ot.replaceTrack!=null?ot.replaceTrack(rt):this.destroy(errCode$j(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(tt,rt){if(this.destroying)return;if(this.destroyed)throw errCode$j(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const nt=this._senderMap.get(tt),it=nt?nt.get(rt):null;if(!it)throw errCode$j(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{it.removed=!0,this._pc.removeTrack(it)}catch(ot){ot.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(it):this.destroy(errCode$j(ot,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(tt){if(!this.destroying){if(this.destroyed)throw errCode$j(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),tt.getTracks().forEach(rt=>{this.removeTrack(rt,tt)})}}_needsNegotiation(){this._debug("_needsNegotiation"),!this._batchedNegotiation&&(this._batchedNegotiation=!0,queueMicrotask(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw errCode$j(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(tt){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",tt&&(tt.message||tt)),queueMicrotask(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",tt&&(tt.message||tt)),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,tt&&this.emit("error",tt),this.emit("close")}))}_setupData(tt){if(!tt.channel)return this.destroy(errCode$j(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=tt.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=MAX_BUFFERED_AMOUNT),this.channelName=this._channel.label,this._channel.onmessage=nt=>{this._onChannelMessage(nt)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=nt=>{this.destroy(errCode$j(nt,"ERR_DATA_CHANNEL"))};let rt=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(rt&&this._onChannelClose(),rt=!0):rt=!1},CHANNEL_CLOSING_TIMEOUT)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(tt=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(tt.sdp=filterTrickle(tt.sdp)),tt.sdp=this.sdpTransform(tt.sdp);const rt=()=>{if(this.destroyed)return;const ot=this._pc.localDescription||tt;this._debug("signal"),this.emit("signal",{type:ot.type,sdp:ot.sdp})},nt=()=>{this._debug("createOffer success"),!this.destroyed&&(this.trickle||this._iceComplete?rt():this.once("_iceComplete",rt))},it=ot=>{this.destroy(errCode$j(ot,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(tt).then(nt).catch(it)}).catch(tt=>{this.destroy(errCode$j(tt,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(tt=>{!tt.mid&&tt.sender.track&&!tt.requested&&(tt.requested=!0,this.addTransceiver(tt.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(tt=>{if(this.destroyed)return;!this.trickle&&!this.allowHalfTrickle&&(tt.sdp=filterTrickle(tt.sdp)),tt.sdp=this.sdpTransform(tt.sdp);const rt=()=>{if(this.destroyed)return;const ot=this._pc.localDescription||tt;this._debug("signal"),this.emit("signal",{type:ot.type,sdp:ot.sdp}),this.initiator||this._requestMissingTransceivers()},nt=()=>{this.destroyed||(this.trickle||this._iceComplete?rt():this.once("_iceComplete",rt))},it=ot=>{this.destroy(errCode$j(ot,"ERR_SET_LOCAL_DESCRIPTION"))};this._pc.setLocalDescription(tt).then(nt).catch(it)}).catch(tt=>{this.destroy(errCode$j(tt,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(errCode$j(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const tt=this._pc.iceConnectionState,rt=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",tt,rt),this.emit("iceStateChange",tt,rt),(tt==="connected"||tt==="completed")&&(this._pcReady=!0,this._maybeReady()),tt==="failed"&&this.destroy(errCode$j(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),tt==="closed"&&this.destroy(errCode$j(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(tt){const rt=nt=>(Object.prototype.toString.call(nt.values)==="[object Array]"&&nt.values.forEach(it=>{Object.assign(nt,it)}),nt);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(nt=>{const it=[];nt.forEach(ot=>{it.push(rt(ot))}),tt(null,it)},nt=>tt(nt)):this._pc.getStats.length>0?this._pc.getStats(nt=>{if(this.destroyed)return;const it=[];nt.result().forEach(ot=>{const st={};ot.names().forEach(at=>{st[at]=ot.stat(at)}),st.id=ot.id,st.type=ot.type,st.timestamp=ot.timestamp,it.push(rt(st))}),tt(null,it)},nt=>tt(nt)):tt(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const tt=()=>{this.destroyed||this.getStats((rt,nt)=>{if(this.destroyed)return;rt&&(nt=[]);const it={},ot={},st={};let at=!1;nt.forEach(ut=>{(ut.type==="remotecandidate"||ut.type==="remote-candidate")&&(it[ut.id]=ut),(ut.type==="localcandidate"||ut.type==="local-candidate")&&(ot[ut.id]=ut),(ut.type==="candidatepair"||ut.type==="candidate-pair")&&(st[ut.id]=ut)});const ct=ut=>{at=!0;let lt=ot[ut.localCandidateId];lt&&(lt.ip||lt.address)?(this.localAddress=lt.ip||lt.address,this.localPort=Number(lt.port)):lt&&lt.ipAddress?(this.localAddress=lt.ipAddress,this.localPort=Number(lt.portNumber)):typeof ut.googLocalAddress=="string"&&(lt=ut.googLocalAddress.split(":"),this.localAddress=lt[0],this.localPort=Number(lt[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let ht=it[ut.remoteCandidateId];ht&&(ht.ip||ht.address)?(this.remoteAddress=ht.ip||ht.address,this.remotePort=Number(ht.port)):ht&&ht.ipAddress?(this.remoteAddress=ht.ipAddress,this.remotePort=Number(ht.portNumber)):typeof ut.googRemoteAddress=="string"&&(ht=ut.googRemoteAddress.split(":"),this.remoteAddress=ht[0],this.remotePort=Number(ht[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(nt.forEach(ut=>{ut.type==="transport"&&ut.selectedCandidatePairId&&ct(st[ut.selectedCandidatePairId]),(ut.type==="googCandidatePair"&&ut.googActiveConnection==="true"||(ut.type==="candidatepair"||ut.type==="candidate-pair")&&ut.selected)&&ct(ut)}),!at&&(!Object.keys(st).length||Object.keys(ot).length)){setTimeout(tt,100);return}else this._connecting=!1,this._connected=!0;if(this._chunk){try{this.send(this._chunk)}catch(lt){return this.destroy(errCode$j(lt,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const ut=this._cb;this._cb=null,ut(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};tt()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>MAX_BUFFERED_AMOUNT||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(tt=>{this._pc.removeTrack(tt),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(tt){this.destroyed||(tt.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:tt.candidate.candidate,sdpMLineIndex:tt.candidate.sdpMLineIndex,sdpMid:tt.candidate.sdpMid}}):!tt.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),tt.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(tt){if(this.destroyed)return;let rt=tt.data;rt instanceof ArrayBuffer&&(rt=new Uint8Array(rt)),this.emit("data",rt)}_onChannelBufferedAmountLow(){if(this.destroyed||!this._cb)return;this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const tt=this._cb;this._cb=null,tt(null)}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(tt){this.destroyed||tt.streams.forEach(rt=>{this._debug("on track"),this.emit("track",tt.track,rt),this._remoteTracks.push({track:tt.track,stream:rt}),!this._remoteStreams.some(nt=>nt.id===rt.id)&&(this._remoteStreams.push(rt),queueMicrotask(()=>{this._debug("on stream"),this.emit("stream",rt)}))})}_debug(...tt){this._doDebug&&(tt[0]="["+this._id+"] "+tt[0],console.log(...tt))}on(tt,rt){const nt=this._map;nt.has(tt)||nt.set(tt,new Set),nt.get(tt).add(rt)}off(tt,rt){const nt=this._map,it=nt.get(tt);it&&(it.delete(rt),it.size===0&&nt.delete(tt))}once(tt,rt){const nt=(...it)=>{this.off(tt,nt),rt(...it)};this.on(tt,nt)}emit(tt,...rt){const nt=this._map;if(nt.has(tt))for(const it of nt.get(tt))try{it(...rt)}catch(ot){console.error(ot)}}}Peer.WEBRTC_SUPPORT=!!getBrowserRTC(),Peer.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:window.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},Peer.channelConfig={};const charSet="0123456789AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz",libName="Trystero",{keys:keys$7,values,entries:entries$1,fromEntries}=Object,events$2=fromEntries(["close","connect","data","error","signal","stream","track"].map(et=>[et,et])),initPeer=(et,tt,rt)=>{const nt=new Peer({initiator:et,trickle:tt,config:rt}),it=ot=>nt.__earlyDataBuffer.push(ot);return nt.on(events$2.data,it),nt.__earlyDataBuffer=[],nt.__drainEarlyData=ot=>{nt.off(events$2.data,it),nt.__earlyDataBuffer.forEach(ot),delete nt.__earlyDataBuffer,nt.__drainEarlyData=noOp},nt},genId=et=>new Array(et).fill("").map(()=>charSet[Math.floor(Math.random()*charSet.length)]).join(""),mkErr=et=>new Error(`${libName}: ${et}`),initGuard=(et,tt)=>async(rt,nt)=>{if(et[nt])throw mkErr(`already joined room ${nt}`);if(!rt)throw mkErr("requires a config map as the first argument");if(!nt)throw mkErr("namespace argument required");return await tt(rt,nt)},selfId=genId(20),noOp=()=>{},encodeBytes$1=et=>new TextEncoder().encode(et),decodeBytes$1=et=>new TextDecoder().decode(et),combineChunks=et=>{const tt=new Uint8Array(et.reduce((rt,nt)=>rt+nt.byteLength,0));return et.reduce((rt,nt)=>(tt.set(nt,rt),rt+nt.byteLength),0),tt},algo$1="AES-GCM",IV_LENGTH$1=16,pack$1=et=>btoa(String.fromCharCode(...new Uint8Array(et))),unpack=et=>{const tt=window.atob(et);return new Uint8Array(tt.length).map((rt,nt)=>tt.charCodeAt(nt)).buffer},generateKeyPair$a=async et=>crypto.subtle.importKey("raw",await crypto.subtle.digest({name:"SHA-256"},et),{name:algo$1},!1,["encrypt","decrypt"]),genKey=async(et,tt)=>generateKeyPair$a(encodeBytes$1(`${et}:${tt}`)),encrypt=async(et,tt)=>{const rt=crypto.getRandomValues(new Uint8Array(IV_LENGTH$1));return JSON.stringify({c:pack$1(await crypto.subtle.encrypt({name:algo$1,iv:rt},await et,encodeBytes$1(tt))),iv:[...rt]})},decrypt=async(et,tt)=>{const{c:rt,iv:nt}=JSON.parse(tt);return decodeBytes$1(await crypto.subtle.decrypt({name:algo$1,iv:new Uint8Array(nt)},await et,unpack(rt)))};var StreamSaver={exports:{}};(function(et){((tt,rt)=>{et.exports=rt()})("streamSaver",()=>{window.HTMLElement||console.warn("streamsaver is meant to run on browsers main thread");let tt=null,rt=!1;const nt=dt=>{try{dt()}catch{}},it=window.WebStreamsPolyfill||{},ot=window.isSecureContext;let st=/constructor/i.test(window.HTMLElement)||!!window.safari||!!window.WebKitPoint;const at=ot||"MozAppearance"in document.documentElement.style?"iframe":"navigate",ct={createWriteStream:ft,WritableStream:window.WritableStream||it.WritableStream,supported:!0,version:{full:"2.0.5",major:2,minor:0,dot:5},mitm:"https://jimmywarting.github.io/StreamSaver.js/mitm.html?version=2.0.0"};function ut(dt){if(!dt)throw new Error("meh");const pt=document.createElement("iframe");return pt.hidden=!0,pt.src=dt,pt.loaded=!1,pt.name="iframe",pt.isIframe=!0,pt.postMessage=(...gt)=>pt.contentWindow.postMessage(...gt),pt.addEventListener("load",()=>{pt.loaded=!0},{once:!0}),document.body.appendChild(pt),pt}function lt(dt){const pt="width=200,height=100",gt=document.createDocumentFragment(),_t={frame:window.open(dt,"popup",pt),loaded:!1,isIframe:!1,isPopup:!0,remove(){_t.frame.close()},addEventListener(...At){gt.addEventListener(...At)},dispatchEvent(...At){gt.dispatchEvent(...At)},removeEventListener(...At){gt.removeEventListener(...At)},postMessage(...At){_t.frame.postMessage(...At)}},mt=At=>{At.source===_t.frame&&(_t.loaded=!0,window.removeEventListener("message",mt),_t.dispatchEvent(new Event("load")))};return window.addEventListener("message",mt),_t}try{new Response(new ReadableStream),ot&&!("serviceWorker"in navigator)&&(st=!0)}catch{st=!0}nt(()=>{const{readable:dt}=new TransformStream,pt=new MessageChannel;pt.port1.postMessage(dt,[dt]),pt.port1.close(),pt.port2.close(),rt=!0,Object.defineProperty(ct,"TransformStream",{configurable:!1,writable:!1,value:TransformStream})});function ht(){tt||(tt=ot?ut(ct.mitm):lt(ct.mitm))}function ft(dt,pt,gt){let _t={size:null,pathname:null,writableStrategy:void 0,readableStrategy:void 0},mt=0,At=null,It=null,Mt=null;if(Number.isFinite(pt)?([gt,pt]=[pt,gt],console.warn("[StreamSaver] Deprecated pass an object as 2nd argument when creating a write stream"),_t.size=gt,_t.writableStrategy=pt):pt&&pt.highWaterMark?(console.warn("[StreamSaver] Deprecated pass an object as 2nd argument when creating a write stream"),_t.size=gt,_t.writableStrategy=pt):_t=pt||{},!st){ht(),It=new MessageChannel,dt=encodeURIComponent(dt.replace(/\//g,":")).replace(/['()]/g,escape).replace(/\*/g,"%2A");const Ct={transferringReadable:rt,pathname:_t.pathname||Math.random().toString().slice(-6)+"/"+dt,headers:{"Content-Type":"application/octet-stream; charset=utf-8","Content-Disposition":"attachment; filename*=UTF-8''"+dt}};_t.size&&(Ct.headers["Content-Length"]=_t.size);const Ut=[Ct,"*",[It.port2]];if(rt){const Wt=at==="iframe"?void 0:{transform(Ce,bt){if(!(Ce instanceof Uint8Array))throw new TypeError("Can only write Uint8Arrays");mt+=Ce.length,bt.enqueue(Ce),At&&(location.href=At,At=null)},flush(){At&&(location.href=At)}};Mt=new ct.TransformStream(Wt,_t.writableStrategy,_t.readableStrategy);const Ft=Mt.readable;It.port1.postMessage({readableStream:Ft},[Ft])}It.port1.onmessage=Wt=>{Wt.data.download?at==="navigate"?(tt.remove(),tt=null,mt?location.href=Wt.data.download:At=Wt.data.download):(tt.isPopup&&(tt.remove(),tt=null,at==="iframe"&&ut(ct.mitm)),ut(Wt.data.download)):Wt.data.abort&&(kt=[],It.port1.postMessage("abort"),It.port1.onmessage=null,It.port1.close(),It.port2.close(),It=null)},tt.loaded?tt.postMessage(...Ut):tt.addEventListener("load",()=>{tt.postMessage(...Ut)},{once:!0})}let kt=[];return!st&&Mt&&Mt.writable||new ct.WritableStream({write(Ct){if(!(Ct instanceof Uint8Array))throw new TypeError("Can only write Uint8Arrays");if(st){kt.push(Ct);return}It.port1.postMessage(Ct),mt+=Ct.length,At&&(location.href=At,At=null)},close(){if(st){const Ct=new Blob(kt,{type:"application/octet-stream; charset=utf-8"}),Ut=document.createElement("a");Ut.href=URL.createObjectURL(Ct),Ut.download=dt,Ut.click()}else It.port1.postMessage("end")},abort(){kt=[],It.port1.postMessage("abort"),It.port1.onmessage=null,It.port1.close(),It.port2.close(),It=null}},_t.writableStrategy)}return ct})})(StreamSaver);var StreamSaverExports=StreamSaver.exports;const streamSaver=getDefaultExportFromCjs(StreamSaverExports),TypedArray=Object.getPrototypeOf(Uint8Array),typeByteLimit=12,typeIndex=0,nonceIndex=typeIndex+typeByteLimit,tagIndex=nonceIndex+1,progressIndex=tagIndex+1,payloadIndex=progressIndex+1,chunkSize=16*2**10-payloadIndex,oneByteMax=255,buffLowEvent="bufferedamountlow",room=async(et,tt,rt)=>{const nt={},it={},ot={},st={},at={},ct={},ut=(bt,yt)=>(bt?Array.isArray(bt)?bt:[bt]:keys$7(nt)).flatMap($t=>{const Et=nt[$t];return Et?yt($t,Et):(console.warn(`${libName}: no peer with id ${$t} found`),[])}),lt=bt=>{nt[bt]&&(delete nt[bt],delete ot[bt],delete st[bt],Wt(bt))},ht=bt=>{if(!bt)throw mkErr("action type argument is required");const yt=encodeBytes$1(bt);if(yt.byteLength>typeByteLimit)throw mkErr(`action type string "${bt}" (${yt.byteLength}b) exceeds byte limit (${typeByteLimit}). Hint: choose a shorter name.`);const $t=new Uint8Array(typeByteLimit);$t.set(yt);const Et=decodeBytes$1($t);if(it[Et])throw mkErr(`action '${bt}' already registered`);let Tt=0;return it[Et]={onComplete:noOp,onProgress:noOp},[async(Pt,St,Dt,wt)=>{if(Dt&&typeof Dt!="object")throw mkErr("action meta argument must be an object");if(Pt===void 0)throw mkErr("action data cannot be undefined");St||(St=keys$7(nt));const xt=typeof Pt!="string",Ke=Pt instanceof File,Pe=Pt instanceof Blob,Ht=Pe||Pt instanceof ArrayBuffer||Pt instanceof TypedArray;if(Dt&&!Ht)throw mkErr("action meta argument can only be used with binary data");const zt=await(async()=>Ke?encodeBytes$1(""):Ht?new Uint8Array(Pe?await Pt.arrayBuffer():Pt):encodeBytes$1(xt?JSON.stringify(Pt):Pt))(),jt=(Ke?Math.ceil(Pt.size/chunkSize)+(Dt?1:0):Math.ceil(zt.byteLength/chunkSize))+(Dt?1:0),qt=encodeBytes$1(JSON.stringify(Dt)),Ge=(Je,Qe,We)=>{const ur=Qe===jt-1,ar=new Uint8Array(payloadIndex+(We?qt.byteLength:ur?zt.byteLength:chunkSize));return ar.set($t),ar.set([Tt],nonceIndex),ar.set([ur|We<<1|Ht<<2|xt<<3|Ke<<4],tagIndex),ar.set([Math.round((Qe+1)/jt*oneByteMax)],progressIndex),ar.set(Je,payloadIndex),new Uint8Array(ar)},Ie=!Ke&&new Array(jt).fill(new Uint8Array(chunkSize)).map((Je,Qe)=>Dt&&Qe===0?Ge(qt,Qe,!0):Ge(Dt?zt.subarray((Qe-1)*chunkSize,Qe*chunkSize):zt.subarray(Qe*chunkSize,(Qe+1)*chunkSize),Qe,!1)),Xe=Je=>new Promise(Qe=>{const We=new FileReader;if(Dt&&Je===0)Qe(Ge(qt,Je,!0));else{We.onload=()=>Qe(Ge(new Uint8Array(We.result),Je,!1));const ur=Dt?(Je-1)*chunkSize:Je*chunkSize,ar=Dt?Je*chunkSize:(Je+1)*chunkSize;We.readAsArrayBuffer(Pt.slice(ur,ar)),We.onerror=()=>{throw mkErr("error reading file")},We.onabort=()=>{throw mkErr("file read aborted")}}});return Tt=Tt+1&oneByteMax,Promise.all(ut(St,async(Je,Qe)=>{const We=Qe._channel;let ur=0;for(;ur<jt;){const ar=Ie?Ie[ur]:await Xe(ur);if(We.bufferedAmount>We.bufferedAmountLowThreshold&&await new Promise(cr=>{const $r=()=>{We.removeEventListener(buffLowEvent,$r),cr()};We.addEventListener(buffLowEvent,$r)}),!nt[Je])break;if(rt&&rt.hasKey(Je)){const cr=await rt.encrypt(Je,ar);Qe.send(cr)}else Qe.send(ar);ur++,wt&&wt(ar[progressIndex]/oneByteMax,Je,Dt)}}))},Pt=>it[Et]={...it[Et],onComplete:Pt},Pt=>it[Et]={...it[Et],onProgress:Pt}]},ft=async(bt,yt)=>{const $t=await(async()=>{const jt=new Uint8Array(yt);return rt&&rt.hasKey(bt)?await rt.decrypt(bt,jt).catch(qt=>{throw console.error(qt)}):jt})(),Et=decodeBytes$1($t.subarray(typeIndex,nonceIndex)),[Tt]=$t.subarray(nonceIndex,tagIndex),[Pt]=$t.subarray(tagIndex,progressIndex),[St]=$t.subarray(progressIndex,payloadIndex),Dt=!!(Pt&1),wt=!!(Pt&2),xt=!!(Pt&4),Ke=!!(Pt&8),Pe=!!(Pt&16),Ht=$t.subarray(rt&&rt.hasKey(bt)&&!Pe?payloadIndex+2:payloadIndex,$t.length);if(!it[Et])throw mkErr(`received message with unregistered type (${Et})`);ot[bt]||(ot[bt]={}),ot[bt][Et]||(ot[bt][Et]={});let zt=ot[bt][Et][Tt];if(zt||(Pe?zt=ot[bt][Et][Tt]={fileWriter:void 0}:zt=ot[bt][Et][Tt]={chunks:[]}),wt){if(zt.meta=JSON.parse(decodeBytes$1(Ht)),!zt.fileWriter){const jt=streamSaver.createWriteStream(zt.meta.name,{size:zt.meta.size}).getWriter();zt.fileWriter=jt}}else Pe?zt.fileWriter&&await zt.fileWriter.write(Ht):zt.chunks.push(Ht);if(it[Et].onProgress(St/oneByteMax,bt,zt.meta),!!Dt){if(Pe)await zt.fileWriter.close(),it[Et].onComplete({success:!0},bt,zt.meta);else{const jt=combineChunks(zt.chunks);if(xt)it[Et].onComplete(jt,bt,zt.meta);else{const qt=decodeBytes$1(jt);it[Et].onComplete(Ke?JSON.parse(qt):qt,bt)}}delete ot[bt][Et][Tt]}},[dt,pt]=ht("__91n6__"),[gt,_t]=ht("__90n6__"),[mt,At]=ht("__516n4L__"),[It,Mt]=ht("__57r34m__"),[kt,Ct]=ht("__7r4ck__");let Ut=noOp,Wt=noOp,Ft=noOp,Ce=noOp;return et((bt,yt)=>{if(nt[yt])return;const $t=ft.bind(null,yt);nt[yt]=bt,bt.on(events$2.signal,Et=>mt(Et,yt)),bt.on(events$2.close,()=>lt(yt)),bt.on(events$2.data,$t),bt.on(events$2.stream,Et=>{Ft(Et,yt,at[yt]),delete at[yt]}),bt.on(events$2.track,(Et,Tt)=>{Ce(Et,Tt,yt,ct[yt]),delete ct[yt]}),bt.on(events$2.error,Et=>{Et.code!=="ERR_DATA_CHANNEL"&&console.error(Et)}),Ut(yt),bt.__drainEarlyData($t)}),pt((bt,yt)=>gt(null,yt)),_t((bt,yt)=>{st[yt]&&(st[yt](),delete st[yt])}),At((bt,yt)=>{nt[yt]&&nt[yt].signal(bt)}),Mt((bt,yt)=>at[yt]=bt),Ct((bt,yt)=>ct[yt]=bt),{makeAction:ht,ping:async bt=>{if(!bt)throw mkErr("ping() must be called with target peer ID");const yt=Date.now();return dt(null,bt),await new Promise($t=>st[bt]=$t),Date.now()-yt},leave:()=>{entries$1(nt).forEach(([bt,yt])=>{yt.destroy(),delete nt[bt]}),tt()},getPeers:()=>fromEntries(entries$1(nt).map(([bt,yt])=>[bt,yt._pc])),addStream:(bt,yt,$t)=>yt?ut(yt,async(Et,Tt)=>{$t&&await It($t,Et),Tt.addStream(bt)}):[],removeStream:(bt,yt)=>yt&&ut(yt,($t,Et)=>new Promise(Tt=>{Et.removeStream(bt),Tt()})),addTrack:(bt,yt,$t,Et)=>$t?ut($t,async(Tt,Pt)=>{Et&&await kt(Et,Tt),Pt.addTrack(bt,yt)}):[],removeTrack:(bt,yt,$t)=>$t&&ut($t,(Et,Tt)=>new Promise(Pt=>{Tt.removeTrack(bt,yt),Pt()})),replaceTrack:(bt,yt,$t,Et,Tt)=>Et?ut(Et,async(Pt,St)=>{Tt&&await kt(Tt,Pt),St.replaceTrack(bt,yt,$t)}):[],onPeerJoin:bt=>Ut=bt,onPeerLeave:bt=>Wt=bt,onPeerStream:bt=>Ft=bt,onPeerTrack:bt=>Ce=bt}},__viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$0$3=getAugmentedNamespace(__viteBrowserExternal$1);var error={};let TimeoutError$6=class extends Error{constructor(et="Request timed out"){super(et),this.name="TimeoutError"}};error.TimeoutError=TimeoutError$6;let AbortError$1=class extends Error{constructor(et="The operation was aborted."){super(et),this.name="AbortError"}};error.AbortError=AbortError$1;let HTTPError$1=class extends Error{constructor(et){super(et.statusText),this.name="HTTPError",this.response=et}};error.HTTPError=HTTPError$1;var fetch$3={exports:{}};function commonjsRequire(et){throw new Error('Could not dynamically require "'+et+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}function isElectron$1(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}var isElectron_1=isElectron$1;const isElectron=isElectron_1,IS_ENV_WITH_DOM=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,IS_ELECTRON=isElectron(),IS_BROWSER=IS_ENV_WITH_DOM&&!IS_ELECTRON,IS_ELECTRON_MAIN=IS_ELECTRON&&!IS_ENV_WITH_DOM,IS_ELECTRON_RENDERER=IS_ELECTRON&&IS_ENV_WITH_DOM,IS_NODE=typeof commonjsRequire=="function"&&typeof process<"u"&&typeof process.release<"u"&&process.release.name==="node"&&!IS_ELECTRON,IS_WEBWORKER=typeof importScripts=="function"&&typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,IS_TEST=typeof process<"u"&&typeof process.env<"u"&&!1,IS_REACT_NATIVE=typeof navigator<"u"&&navigator.product==="ReactNative";var env={isTest:IS_TEST,isElectron:IS_ELECTRON,isElectronMain:IS_ELECTRON_MAIN,isElectronRenderer:IS_ELECTRON_RENDERER,isNode:IS_NODE,isBrowser:IS_BROWSER,isWebWorker:IS_WEBWORKER,isEnvWithDom:IS_ENV_WITH_DOM,isReactNative:IS_REACT_NATIVE},src$l={exports:{}},browser$4={exports:{}},hasRequiredBrowser$1;function requireBrowser$1(){return hasRequiredBrowser$1||(hasRequiredBrowser$1=1,function(et,tt){var rt=function(){if(typeof self<"u")return self;if(typeof window<"u"||typeof window<"u")return window;throw new Error("unable to locate window object")};rt(),et.exports=tt=window.fetch,window.fetch&&(tt.default=window.fetch.bind(window)),tt.Headers=window.Headers,tt.Request=window.Request,tt.Response=window.Response}(browser$4,browser$4.exports)),browser$4.exports}var hasRequiredSrc;function requireSrc(){return hasRequiredSrc||(hasRequiredSrc=1,globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?src$l.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:src$l.exports={default:requireBrowser$1().default,Headers:requireBrowser$1().Headers,Request:requireBrowser$1().Request,Response:requireBrowser$1().Response}),src$l.exports}const{isElectronMain}=env;isElectronMain?fetch$3.exports=require$$0$3:fetch$3.exports=requireSrc();var fetchExports=fetch$3.exports;const{TimeoutError:TimeoutError$5,AbortError}=error,{Response:Response$1,Request:Request$1,Headers:Headers$1,default:fetch$2}=fetchExports,fetchWithProgress=(et,tt={})=>{const rt=new XMLHttpRequest;rt.open(tt.method||"GET",et.toString(),!0);const{timeout:nt,headers:it}=tt;if(nt&&nt>0&&nt<1/0&&(rt.timeout=nt),tt.overrideMimeType!=null&&rt.overrideMimeType(tt.overrideMimeType),it)for(const[ot,st]of new Headers$1(it))rt.setRequestHeader(ot,st);return tt.signal&&(tt.signal.onabort=()=>rt.abort()),tt.onUploadProgress&&(rt.upload.onprogress=tt.onUploadProgress),rt.responseType="arraybuffer",new Promise((ot,st)=>{const at=ct=>{switch(ct.type){case"error":{ot(Response$1.error());break}case"load":{ot(new ResponseWithURL(rt.responseURL,rt.response,{status:rt.status,statusText:rt.statusText,headers:parseHeaders(rt.getAllResponseHeaders())}));break}case"timeout":{st(new TimeoutError$5);break}case"abort":{st(new AbortError);break}}};rt.onerror=at,rt.onload=at,rt.ontimeout=at,rt.onabort=at,rt.send(tt.body)})},fetchWithStreaming=fetch$2,fetchWith=(et,tt={})=>tt.onUploadProgress!=null?fetchWithProgress(et,tt):fetchWithStreaming(et,tt),parseHeaders=et=>{const tt=new Headers$1;for(const rt of et.trim().split(/[\r\n]+/)){const nt=rt.indexOf(": ");nt>0&&tt.set(rt.slice(0,nt),rt.slice(nt+1))}return tt};class ResponseWithURL extends Response$1{constructor(tt,rt,nt){super(rt,nt),Object.defineProperty(this,"url",{value:tt})}}var fetch_browser={fetch:fetchWith,Request:Request$1,Headers:Headers$1},isPlainObj=et=>{if(Object.prototype.toString.call(et)!=="[object Object]")return!1;const tt=Object.getPrototypeOf(et);return tt===null||tt===Object.prototype};const isOptionObject=isPlainObj,{hasOwnProperty}=Object.prototype,{propertyIsEnumerable}=Object,defineProperty$1=(et,tt,rt)=>Object.defineProperty(et,tt,{value:rt,writable:!0,enumerable:!0,configurable:!0}),globalThis$1=commonjsGlobal,defaultMergeOptions={concatArrays:!1,ignoreUndefined:!1},getEnumerableOwnPropertyKeys=et=>{const tt=[];for(const rt in et)hasOwnProperty.call(et,rt)&&tt.push(rt);if(Object.getOwnPropertySymbols){const rt=Object.getOwnPropertySymbols(et);for(const nt of rt)propertyIsEnumerable.call(et,nt)&&tt.push(nt)}return tt};function clone$1(et){return Array.isArray(et)?cloneArray(et):isOptionObject(et)?cloneOptionObject(et):et}function cloneArray(et){const tt=et.slice(0,0);return getEnumerableOwnPropertyKeys(et).forEach(rt=>{defineProperty$1(tt,rt,clone$1(et[rt]))}),tt}function cloneOptionObject(et){const tt=Object.getPrototypeOf(et)===null?Object.create(null):{};return getEnumerableOwnPropertyKeys(et).forEach(rt=>{defineProperty$1(tt,rt,clone$1(et[rt]))}),tt}const mergeKeys=(et,tt,rt,nt)=>(rt.forEach(it=>{typeof tt[it]>"u"&&nt.ignoreUndefined||(it in et&&et[it]!==Object.getPrototypeOf(et)?defineProperty$1(et,it,merge$4(et[it],tt[it],nt)):defineProperty$1(et,it,clone$1(tt[it])))}),et),concatArrays=(et,tt,rt)=>{let nt=et.slice(0,0),it=0;return[et,tt].forEach(ot=>{const st=[];for(let at=0;at<ot.length;at++)hasOwnProperty.call(ot,at)&&(st.push(String(at)),ot===et?defineProperty$1(nt,it++,ot[at]):defineProperty$1(nt,it++,clone$1(ot[at])));nt=mergeKeys(nt,ot,getEnumerableOwnPropertyKeys(ot).filter(at=>!st.includes(at)),rt)}),nt};function merge$4(et,tt,rt){return rt.concatArrays&&Array.isArray(et)&&Array.isArray(tt)?concatArrays(et,tt,rt):!isOptionObject(tt)||!isOptionObject(et)?clone$1(tt):mergeKeys(et,tt,getEnumerableOwnPropertyKeys(tt),rt)}var mergeOptions=function(...et){const tt=merge$4(clone$1(defaultMergeOptions),this!==globalThis$1&&this||{},defaultMergeOptions);let rt={_:{}};for(const nt of et)if(nt!==void 0){if(!isOptionObject(nt))throw new TypeError("`"+nt+"` is not an Option Object");rt=merge$4(rt,{_:nt},tt)}return rt._};const isReactNative=typeof navigator<"u"&&navigator.product==="ReactNative";function getDefaultBase(){return isReactNative?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:""}const URL$3=self.URL,defaultBase$1=getDefaultBase();let URLWithLegacySupport$2=class{constructor(et="",tt=defaultBase$1){this.super=new URL$3(et,tt),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(et){this.super.hash=et}set host(et){this.super.host=et}set hostname(et){this.super.hostname=et}set href(et){this.super.href=et}set password(et){this.super.password=et}set pathname(et){this.super.pathname=et}set port(et){this.super.port=et}set protocol(et){this.super.protocol=et}set search(et){this.super.search=et}set username(et){this.super.username=et}static createObjectURL(et){return URL$3.createObjectURL(et)}static revokeObjectURL(et){URL$3.revokeObjectURL(et)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function format$3(et){if(typeof et=="string")return new URL$3(et).toString();if(!(et instanceof URL$3)){const tt=et.username&&et.password?`${et.username}:${et.password}@`:"",rt=et.auth?et.auth+"@":"",nt=et.port?":"+et.port:"",it=et.protocol?et.protocol+"//":"",ot=et.host||"",st=et.hostname||"",at=et.search||(et.query?"?"+et.query:""),ct=et.hash||"",ut=et.pathname||"",lt=et.path||ut+at;return`${it}${tt||rt}${ot||st+nt}${lt}${ct}`}}var urlBrowser={URLWithLegacySupport:URLWithLegacySupport$2,URLSearchParams:self.URLSearchParams,defaultBase:defaultBase$1,format:format$3};const{URLWithLegacySupport:URLWithLegacySupport$1,format:format$2}=urlBrowser;var relative$1=(et,tt={},rt={},nt)=>{let it=tt.protocol?tt.protocol.replace(":",""):"http";it=(rt[it]||nt||it)+":";let ot;try{ot=new URLWithLegacySupport$1(et)}catch{ot={}}const st=Object.assign({},tt,{protocol:it||ot.protocol,host:tt.host||ot.host});return new URLWithLegacySupport$1(et,format$2(st)).toString()};const{URLWithLegacySupport,format:format$1,URLSearchParams:URLSearchParams$1,defaultBase}=urlBrowser,relative=relative$1;var isoUrl={URL:URLWithLegacySupport,URLSearchParams:URLSearchParams$1,format:format$1,relative,defaultBase},src$k={},browser$3={exports:{}},hasRequiredBrowser;function requireBrowser(){if(hasRequiredBrowser)return browser$3.exports;hasRequiredBrowser=1;const{AbortController:et,AbortSignal:tt}=typeof self<"u"?self:typeof window<"u"?window:void 0;return browser$3.exports=et,browser$3.exports.AbortSignal=tt,browser$3.exports.default=et,browser$3.exports}let impl;globalThis.AbortController&&globalThis.AbortSignal?impl=globalThis:impl=requireBrowser(),src$k.AbortSignal=impl.AbortSignal,src$k.AbortController=impl.AbortController;var anySignal$3={exports:{}};const{AbortController:AbortController$3}=src$k;function anySignal$2(et){const tt=new AbortController$3;function rt(){tt.abort();for(const nt of et)!nt||!nt.removeEventListener||nt.removeEventListener("abort",rt)}for(const nt of et)if(!(!nt||!nt.addEventListener)){if(nt.aborted){rt();break}nt.addEventListener("abort",rt)}return tt.signal}anySignal$3.exports=anySignal$2,anySignal$3.exports.anySignal=anySignal$2;var anySignalExports=anySignal$3.exports;const{fetch:fetch$1,Request,Headers}=fetch_browser,{TimeoutError:TimeoutError$4,HTTPError}=error,merge$3=mergeOptions.bind({ignoreUndefined:!0}),{URL:URL$2,URLSearchParams}=isoUrl,{AbortController:AbortController$2}=src$k,anySignal$1=anySignalExports,timeout$1=(et,tt,rt)=>{if(tt===void 0)return et;const nt=Date.now(),it=()=>Date.now()-nt>=tt;return new Promise((ot,st)=>{const at=setTimeout(()=>{it()&&(st(new TimeoutError$4),rt.abort())},tt),ct=ut=>lt=>{if(clearTimeout(at),it()){st(new TimeoutError$4);return}ut(lt)};et.then(ct(ot),ct(st))})},defaults={throwHttpErrors:!0,credentials:"same-origin"};let HTTP$1=class{constructor(et={}){this.opts=merge$3(defaults,et)}async fetch(et,tt={}){const rt=merge$3(this.opts,tt),nt=new Headers(rt.headers);if(typeof et!="string"&&!(et instanceof URL$2||et instanceof Request))throw new TypeError("`resource` must be a string, URL, or Request");const it=new URL$2(et.toString(),rt.base),{searchParams:ot,transformSearchParams:st,json:at}=rt;ot&&(typeof st=="function"?it.search=st(new URLSearchParams(rt.searchParams)):it.search=new URLSearchParams(rt.searchParams)),at&&(rt.body=JSON.stringify(rt.json),nt.set("content-type","application/json"));const ct=new AbortController$2,ut=anySignal$1([ct.signal,rt.signal]),lt=await timeout$1(fetch$1(it.toString(),{...rt,signal:ut,timeout:void 0,headers:nt}),rt.timeout,ct);if(!lt.ok&&rt.throwHttpErrors)throw rt.handleError&&await rt.handleError(lt),new HTTPError(lt);return lt.iterator=function(){return fromStream(lt.body)},lt.ndjson=async function*(){for await(const ht of ndjson(lt.iterator()))tt.transform?yield tt.transform(ht):yield ht},lt}post(et,tt={}){return this.fetch(et,{...tt,method:"POST"})}get(et,tt={}){return this.fetch(et,{...tt,method:"GET"})}put(et,tt={}){return this.fetch(et,{...tt,method:"PUT"})}delete(et,tt={}){return this.fetch(et,{...tt,method:"DELETE"})}options(et,tt={}){return this.fetch(et,{...tt,method:"OPTIONS"})}};const ndjson=async function*(et){const tt=new TextDecoder;let rt="";for await(const nt of et){rt+=tt.decode(nt,{stream:!0});const it=rt.split(/\r?\n/);for(let ot=0;ot<it.length-1;ot++){const st=it[ot].trim();st.length>0&&(yield JSON.parse(st))}rt=it[it.length-1]}rt+=tt.decode(),rt=rt.trim(),rt.length!==0&&(yield JSON.parse(rt))},fromStream=et=>{if(isNodeReadableStream(et)){const tt=et[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:tt.next.bind(tt),return(rt){return et.destroy(),typeof tt.return=="function"?tt.return():Promise.resolve({done:!0,value:rt})}}}}}if(isWebReadableStream(et)){const tt=et.getReader();return async function*(){try{for(;;){const{done:rt,value:nt}=await tt.read();if(rt)return;nt&&(yield nt)}}finally{tt.releaseLock()}}()}if(isAsyncIterable(et))return et;throw new TypeError("Body can't be converted to AsyncIterable")},isAsyncIterable=et=>typeof et=="object"&&et!==null&&typeof et[Symbol.asyncIterator]=="function",isWebReadableStream=et=>et&&typeof et.getReader=="function",isNodeReadableStream=et=>Object.prototype.hasOwnProperty.call(et,"readable")&&Object.prototype.hasOwnProperty.call(et,"writable");HTTP$1.HTTPError=HTTPError,HTTP$1.TimeoutError=TimeoutError$4,HTTP$1.streamToAsyncIterator=fromStream,HTTP$1.post=(et,tt)=>new HTTP$1(tt).post(et,tt),HTTP$1.get=(et,tt)=>new HTTP$1(tt).get(et,tt),HTTP$1.put=(et,tt)=>new HTTP$1(tt).put(et,tt),HTTP$1.delete=(et,tt)=>new HTTP$1(tt).delete(et,tt),HTTP$1.options=(et,tt)=>new HTTP$1(tt).options(et,tt);var src$j={exports:{}},encode_1$2=encode$d,MSB$4=128,REST$4=127,MSBALL$2=~REST$4,INT$2=Math.pow(2,31);function encode$d(et,tt,rt){tt=tt||[],rt=rt||0;for(var nt=rt;et>=INT$2;)tt[rt++]=et&255|MSB$4,et/=128;for(;et&MSBALL$2;)tt[rt++]=et&255|MSB$4,et>>>=7;return tt[rt]=et|0,encode$d.bytes=rt-nt+1,tt}var decode$h=read$2,MSB$1$1=128,REST$1$1=127;function read$2(et,nt){var rt=0,nt=nt||0,it=0,ot=nt,st,at=et.length;do{if(ot>=at)throw read$2.bytes=0,new RangeError("Could not decode varint");st=et[ot++],rt+=it<28?(st&REST$1$1)<<it:(st&REST$1$1)*Math.pow(2,it),it+=7}while(st>=MSB$1$1);return read$2.bytes=ot-nt,rt}var N1$2=Math.pow(2,7),N2$2=Math.pow(2,14),N3$2=Math.pow(2,21),N4$2=Math.pow(2,28),N5$2=Math.pow(2,35),N6$2=Math.pow(2,42),N7$2=Math.pow(2,49),N8$2=Math.pow(2,56),N9$2=Math.pow(2,63),length$5=function(et){return et<N1$2?1:et<N2$2?2:et<N3$2?3:et<N4$2?4:et<N5$2?5:et<N6$2?6:et<N7$2?7:et<N8$2?8:et<N9$2?9:10},varint$9={encode:encode_1$2,decode:decode$h,encodingLength:length$5},_brrp_varint=varint$9;const decode$g=(et,tt=0)=>[_brrp_varint.decode(et,tt),_brrp_varint.decode.bytes],encodeTo=(et,tt,rt=0)=>(_brrp_varint.encode(et,tt,rt),tt),encodingLength=et=>_brrp_varint.encodingLength(et),varint$8=Object.freeze(Object.defineProperty({__proto__:null,decode:decode$g,encodeTo,encodingLength},Symbol.toStringTag,{value:"Module"})),empty$1=new Uint8Array(0),toHex=et=>et.reduce((tt,rt)=>tt+rt.toString(16).padStart(2,"0"),""),fromHex=et=>{const tt=et.match(/../g);return tt?new Uint8Array(tt.map(rt=>parseInt(rt,16))):empty$1},equals$3=(et,tt)=>{if(et===tt)return!0;if(et.byteLength!==tt.byteLength)return!1;for(let rt=0;rt<et.byteLength;rt++)if(et[rt]!==tt[rt])return!1;return!0},coerce=et=>{if(et instanceof Uint8Array&&et.constructor.name==="Uint8Array")return et;if(et instanceof ArrayBuffer)return new Uint8Array(et);if(ArrayBuffer.isView(et))return new Uint8Array(et.buffer,et.byteOffset,et.byteLength);throw new Error("Unknown type, must be binary type")},isBinary=et=>et instanceof ArrayBuffer||ArrayBuffer.isView(et),fromString$b=et=>new TextEncoder().encode(et),toString$8=et=>new TextDecoder().decode(et),bytes$3=Object.freeze(Object.defineProperty({__proto__:null,coerce,empty:empty$1,equals:equals$3,fromHex,fromString:fromString$b,isBinary,toHex,toString:toString$8},Symbol.toStringTag,{value:"Module"})),create$9=(et,tt)=>{const rt=tt.byteLength,nt=encodingLength(et),it=nt+encodingLength(rt),ot=new Uint8Array(it+rt);return encodeTo(et,ot,0),encodeTo(rt,ot,nt),ot.set(tt,it),new Digest$4(et,rt,tt,ot)},decode$f=et=>{const tt=coerce(et),[rt,nt]=decode$g(tt),[it,ot]=decode$g(tt.subarray(nt)),st=tt.subarray(nt+ot);if(st.byteLength!==it)throw new Error("Incorrect length");return new Digest$4(rt,it,st,tt)},equals$2=(et,tt)=>et===tt?!0:et.code===tt.code&&et.size===tt.size&&equals$3(et.bytes,tt.bytes);let Digest$4=class{constructor(et,tt,rt,nt){this.code=et,this.size=tt,this.digest=rt,this.bytes=nt}};const digest$1=Object.freeze(Object.defineProperty({__proto__:null,Digest:Digest$4,create:create$9,decode:decode$f,equals:equals$2},Symbol.toStringTag,{value:"Module"}));function base$2(et,tt){if(et.length>=255)throw new TypeError("Alphabet too long");for(var rt=new Uint8Array(256),nt=0;nt<rt.length;nt++)rt[nt]=255;for(var it=0;it<et.length;it++){var ot=et.charAt(it),st=ot.charCodeAt(0);if(rt[st]!==255)throw new TypeError(ot+" is ambiguous");rt[st]=it}var at=et.length,ct=et.charAt(0),ut=Math.log(at)/Math.log(256),lt=Math.log(256)/Math.log(at);function ht(pt){if(pt instanceof Uint8Array||(ArrayBuffer.isView(pt)?pt=new Uint8Array(pt.buffer,pt.byteOffset,pt.byteLength):Array.isArray(pt)&&(pt=Uint8Array.from(pt))),!(pt instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(pt.length===0)return"";for(var gt=0,_t=0,mt=0,At=pt.length;mt!==At&&pt[mt]===0;)mt++,gt++;for(var It=(At-mt)*lt+1>>>0,Mt=new Uint8Array(It);mt!==At;){for(var kt=pt[mt],Ct=0,Ut=It-1;(kt!==0||Ct<_t)&&Ut!==-1;Ut--,Ct++)kt+=256*Mt[Ut]>>>0,Mt[Ut]=kt%at>>>0,kt=kt/at>>>0;if(kt!==0)throw new Error("Non-zero carry");_t=Ct,mt++}for(var Wt=It-_t;Wt!==It&&Mt[Wt]===0;)Wt++;for(var Ft=ct.repeat(gt);Wt<It;++Wt)Ft+=et.charAt(Mt[Wt]);return Ft}function ft(pt){if(typeof pt!="string")throw new TypeError("Expected String");if(pt.length===0)return new Uint8Array;var gt=0;if(pt[gt]!==" "){for(var _t=0,mt=0;pt[gt]===ct;)_t++,gt++;for(var At=(pt.length-gt)*ut+1>>>0,It=new Uint8Array(At);pt[gt];){var Mt=rt[pt.charCodeAt(gt)];if(Mt===255)return;for(var kt=0,Ct=At-1;(Mt!==0||kt<mt)&&Ct!==-1;Ct--,kt++)Mt+=at*It[Ct]>>>0,It[Ct]=Mt%256>>>0,Mt=Mt/256>>>0;if(Mt!==0)throw new Error("Non-zero carry");mt=kt,gt++}if(pt[gt]!==" "){for(var Ut=At-mt;Ut!==At&&It[Ut]===0;)Ut++;for(var Wt=new Uint8Array(_t+(At-Ut)),Ft=_t;Ut!==At;)Wt[Ft++]=It[Ut++];return Wt}}}function dt(pt){var gt=ft(pt);if(gt)return gt;throw new Error(`Non-${tt} character`)}return{encode:ht,decodeUnsafe:ft,decode:dt}}var src$i=base$2,_brrp__multiformats_scope_baseX=src$i;class Encoder{constructor(tt,rt,nt){this.name=tt,this.prefix=rt,this.baseEncode=nt}encode(tt){if(tt instanceof Uint8Array)return`${this.prefix}${this.baseEncode(tt)}`;throw Error("Unknown type, must be binary type")}}class Decoder{constructor(tt,rt,nt){if(this.name=tt,this.prefix=rt,rt.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=rt.codePointAt(0),this.baseDecode=nt}decode(tt){if(typeof tt=="string"){if(tt.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(tt)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(tt.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(tt){return or$1(this,tt)}}class ComposedDecoder{constructor(tt){this.decoders=tt}or(tt){return or$1(this,tt)}decode(tt){const rt=tt[0],nt=this.decoders[rt];if(nt)return nt.decode(tt);throw RangeError(`Unable to decode multibase string ${JSON.stringify(tt)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const or$1=(et,tt)=>new ComposedDecoder({...et.decoders||{[et.prefix]:et},...tt.decoders||{[tt.prefix]:tt}});class Codec{constructor(tt,rt,nt,it){this.name=tt,this.prefix=rt,this.baseEncode=nt,this.baseDecode=it,this.encoder=new Encoder(tt,rt,nt),this.decoder=new Decoder(tt,rt,it)}encode(tt){return this.encoder.encode(tt)}decode(tt){return this.decoder.decode(tt)}}const from$1=({name:et,prefix:tt,encode:rt,decode:nt})=>new Codec(et,tt,rt,nt),baseX=({prefix:et,name:tt,alphabet:rt})=>{const{encode:nt,decode:it}=_brrp__multiformats_scope_baseX(rt,tt);return from$1({prefix:et,name:tt,encode:nt,decode:ot=>coerce(it(ot))})},decode$e=(et,tt,rt,nt)=>{const it={};for(let lt=0;lt<tt.length;++lt)it[tt[lt]]=lt;let ot=et.length;for(;et[ot-1]==="=";)--ot;const st=new Uint8Array(ot*rt/8|0);let at=0,ct=0,ut=0;for(let lt=0;lt<ot;++lt){const ht=it[et[lt]];if(ht===void 0)throw new SyntaxError(`Non-${nt} character`);ct=ct<<rt|ht,at+=rt,at>=8&&(at-=8,st[ut++]=255&ct>>at)}if(at>=rt||255&ct<<8-at)throw new SyntaxError("Unexpected end of data");return st},encode$c=(et,tt,rt)=>{const nt=tt[tt.length-1]==="=",it=(1<<rt)-1;let ot="",st=0,at=0;for(let ct=0;ct<et.length;++ct)for(at=at<<8|et[ct],st+=8;st>rt;)st-=rt,ot+=tt[it&at>>st];if(st&&(ot+=tt[it&at<<rt-st]),nt)for(;ot.length*rt&7;)ot+="=";return ot},rfc4648=({name:et,prefix:tt,bitsPerChar:rt,alphabet:nt})=>from$1({prefix:tt,name:et,encode(it){return encode$c(it,nt,rt)},decode(it){return decode$e(it,nt,rt,et)}}),base58btc$7=baseX({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr=baseX({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58=Object.freeze(Object.defineProperty({__proto__:null,base58btc:base58btc$7,base58flickr},Symbol.toStringTag,{value:"Module"})),base32$7=rfc4648({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper$1=rfc4648({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad=rfc4648({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper=rfc4648({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex=rfc4648({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper=rfc4648({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad=rfc4648({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper=rfc4648({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z=rfc4648({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$8=Object.freeze(Object.defineProperty({__proto__:null,base32:base32$7,base32hex,base32hexpad,base32hexpadupper,base32hexupper,base32pad,base32padupper,base32upper:base32upper$1,base32z},Symbol.toStringTag,{value:"Module"}));let CID$f=class Lr{constructor(tt,rt,nt,it){this.code=rt,this.version=tt,this.multihash=nt,this.bytes=it,this.byteOffset=it.byteOffset,this.byteLength=it.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:hidden,byteLength:hidden,code:readonly$1,version:readonly$1,multihash:readonly$1,bytes:readonly$1,_baseCache:hidden,asCID:hidden})}toV0(){switch(this.version){case 0:return this;default:{const{code:tt,multihash:rt}=this;if(tt!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(rt.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return Lr.createV0(rt)}}}toV1(){switch(this.version){case 0:{const{code:tt,digest:rt}=this.multihash,nt=create$9(tt,rt);return Lr.createV1(this.code,nt)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(tt){return tt&&this.code===tt.code&&this.version===tt.version&&equals$2(this.multihash,tt.multihash)}toString(tt){const{bytes:rt,version:nt,_baseCache:it}=this;switch(nt){case 0:return toStringV0(rt,it,tt||base58btc$7.encoder);default:return toStringV1(rt,it,tt||base32$7.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(tt){return deprecate(/^0\.0/,IS_CID_DEPRECATION),!!(tt&&(tt[cidSymbol]||tt.asCID===tt))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(tt){if(tt instanceof Lr)return tt;if(tt!=null&&tt.asCID===tt){const{version:rt,code:nt,multihash:it,bytes:ot}=tt;return new Lr(rt,nt,it,ot||encodeCID(rt,nt,it.bytes))}else if(tt!=null&&tt[cidSymbol]===!0){const{version:rt,multihash:nt,code:it}=tt,ot=decode$f(nt);return Lr.create(rt,it,ot)}else return null}static create(tt,rt,nt){if(typeof rt!="number")throw new Error("String codecs are no longer supported");switch(tt){case 0:{if(rt!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new Lr(tt,rt,nt,nt.bytes)}case 1:{const it=encodeCID(tt,rt,nt.bytes);return new Lr(tt,rt,nt,it)}default:throw new Error("Invalid version")}}static createV0(tt){return Lr.create(0,DAG_PB_CODE,tt)}static createV1(tt,rt){return Lr.create(1,tt,rt)}static decode(tt){const[rt,nt]=Lr.decodeFirst(tt);if(nt.length)throw new Error("Incorrect length");return rt}static decodeFirst(tt){const rt=Lr.inspectBytes(tt),nt=rt.size-rt.multihashSize,it=coerce(tt.subarray(nt,nt+rt.multihashSize));if(it.byteLength!==rt.multihashSize)throw new Error("Incorrect length");const ot=it.subarray(rt.multihashSize-rt.digestSize),st=new Digest$4(rt.multihashCode,rt.digestSize,ot,it);return[rt.version===0?Lr.createV0(st):Lr.createV1(rt.codec,st),tt.subarray(rt.size)]}static inspectBytes(tt){let rt=0;const nt=()=>{const[ht,ft]=decode$g(tt.subarray(rt));return rt+=ft,ht};let it=nt(),ot=DAG_PB_CODE;if(it===18?(it=0,rt=0):it===1&&(ot=nt()),it!==0&&it!==1)throw new RangeError(`Invalid CID version ${it}`);const st=rt,at=nt(),ct=nt(),ut=rt+ct,lt=ut-st;return{version:it,codec:ot,multihashCode:at,digestSize:ct,multihashSize:lt,size:ut}}static parse(tt,rt){const[nt,it]=parseCIDtoBytes(tt,rt),ot=Lr.decode(it);return ot._baseCache.set(nt,tt),ot}};const parseCIDtoBytes=(et,tt)=>{switch(et[0]){case"Q":{const rt=tt||base58btc$7;return[base58btc$7.prefix,rt.decode(`${base58btc$7.prefix}${et}`)]}case base58btc$7.prefix:{const rt=tt||base58btc$7;return[base58btc$7.prefix,rt.decode(et)]}case base32$7.prefix:{const rt=tt||base32$7;return[base32$7.prefix,rt.decode(et)]}default:{if(tt==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[et[0],tt.decode(et)]}}},toStringV0=(et,tt,rt)=>{const{prefix:nt}=rt;if(nt!==base58btc$7.prefix)throw Error(`Cannot string encode V0 in ${rt.name} encoding`);const it=tt.get(nt);if(it==null){const ot=rt.encode(et).slice(1);return tt.set(nt,ot),ot}else return it},toStringV1=(et,tt,rt)=>{const{prefix:nt}=rt,it=tt.get(nt);if(it==null){const ot=rt.encode(et);return tt.set(nt,ot),ot}else return it},DAG_PB_CODE=112,SHA_256_CODE=18,encodeCID=(et,tt,rt)=>{const nt=encodingLength(et),it=nt+encodingLength(tt),ot=new Uint8Array(it+rt.byteLength);return encodeTo(et,ot,0),encodeTo(tt,ot,nt),ot.set(rt,it),ot},cidSymbol=Symbol.for("@ipld/js-cid/CID"),readonly$1={writable:!1,configurable:!1,enumerable:!0},hidden={writable:!1,enumerable:!1,configurable:!1},version$4="0.0.0-dev",deprecate=(et,tt)=>{if(et.test(version$4))console.warn(tt);else throw new Error(tt)},IS_CID_DEPRECATION=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`,cid=Object.freeze(Object.defineProperty({__proto__:null,CID:CID$f},Symbol.toStringTag,{value:"Module"})),require$$6$2=getAugmentedNamespace(cid),require$$4$1=getAugmentedNamespace(base32$8),base36=baseX({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper=baseX({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$1=Object.freeze(Object.defineProperty({__proto__:null,base36,base36upper},Symbol.toStringTag,{value:"Module"})),require$$2=getAugmentedNamespace(base36$1),require$$1$5=getAugmentedNamespace(base58),base64$8=rfc4648({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad=rfc4648({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url=rfc4648({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad=rfc4648({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$9=Object.freeze(Object.defineProperty({__proto__:null,base64:base64$8,base64pad,base64url,base64urlpad},Symbol.toStringTag,{value:"Module"})),require$$4=getAugmentedNamespace(base64$9),base16=rfc4648({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper=rfc4648({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$1=Object.freeze(Object.defineProperty({__proto__:null,base16,base16upper},Symbol.toStringTag,{value:"Module"})),require$$5$1=getAugmentedNamespace(base16$1),require$$6$1=getAugmentedNamespace(digest$1);var indexMinimal={},minimal$1={},aspromise=asPromise;function asPromise(et,tt){for(var rt=new Array(arguments.length-1),nt=0,it=2,ot=!0;it<arguments.length;)rt[nt++]=arguments[it++];return new Promise(function(st,at){rt[nt]=function(ct){if(ot)if(ot=!1,ct)at(ct);else{for(var ut=new Array(arguments.length-1),lt=0;lt<ut.length;)ut[lt++]=arguments[lt];st.apply(null,ut)}};try{et.apply(tt||null,rt)}catch(ct){ot&&(ot=!1,at(ct))}})}var base64$7={};(function(et){var tt=et;tt.length=function(st){var at=st.length;if(!at)return 0;for(var ct=0;--at%4>1&&st.charAt(at)==="=";)++ct;return Math.ceil(st.length*3)/4-ct};for(var rt=new Array(64),nt=new Array(123),it=0;it<64;)nt[rt[it]=it<26?it+65:it<52?it+71:it<62?it-4:it-59|43]=it++;tt.encode=function(st,at,ct){for(var ut=null,lt=[],ht=0,ft=0,dt;at<ct;){var pt=st[at++];switch(ft){case 0:lt[ht++]=rt[pt>>2],dt=(pt&3)<<4,ft=1;break;case 1:lt[ht++]=rt[dt|pt>>4],dt=(pt&15)<<2,ft=2;break;case 2:lt[ht++]=rt[dt|pt>>6],lt[ht++]=rt[pt&63],ft=0;break}ht>8191&&((ut||(ut=[])).push(String.fromCharCode.apply(String,lt)),ht=0)}return ft&&(lt[ht++]=rt[dt],lt[ht++]=61,ft===1&&(lt[ht++]=61)),ut?(ht&&ut.push(String.fromCharCode.apply(String,lt.slice(0,ht))),ut.join("")):String.fromCharCode.apply(String,lt.slice(0,ht))};var ot="invalid encoding";tt.decode=function(st,at,ct){for(var ut=ct,lt=0,ht,ft=0;ft<st.length;){var dt=st.charCodeAt(ft++);if(dt===61&&lt>1)break;if((dt=nt[dt])===void 0)throw Error(ot);switch(lt){case 0:ht=dt,lt=1;break;case 1:at[ct++]=ht<<2|(dt&48)>>4,ht=dt,lt=2;break;case 2:at[ct++]=(ht&15)<<4|(dt&60)>>2,ht=dt,lt=3;break;case 3:at[ct++]=(ht&3)<<6|dt,lt=0;break}}if(lt===1)throw Error(ot);return ct-ut},tt.test=function(st){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(st)}})(base64$7);var eventemitter=EventEmitter$6;function EventEmitter$6(){this._listeners={}}EventEmitter$6.prototype.on=function(et,tt,rt){return(this._listeners[et]||(this._listeners[et]=[])).push({fn:tt,ctx:rt||this}),this},EventEmitter$6.prototype.off=function(et,tt){if(et===void 0)this._listeners={};else if(tt===void 0)this._listeners[et]=[];else for(var rt=this._listeners[et],nt=0;nt<rt.length;)rt[nt].fn===tt?rt.splice(nt,1):++nt;return this},EventEmitter$6.prototype.emit=function(et){var tt=this._listeners[et];if(tt){for(var rt=[],nt=1;nt<arguments.length;)rt.push(arguments[nt++]);for(nt=0;nt<tt.length;)tt[nt].fn.apply(tt[nt++].ctx,rt)}return this};var float=factory(factory);function factory(et){return typeof Float32Array<"u"?function(){var tt=new Float32Array([-0]),rt=new Uint8Array(tt.buffer),nt=rt[3]===128;function it(ct,ut,lt){tt[0]=ct,ut[lt]=rt[0],ut[lt+1]=rt[1],ut[lt+2]=rt[2],ut[lt+3]=rt[3]}function ot(ct,ut,lt){tt[0]=ct,ut[lt]=rt[3],ut[lt+1]=rt[2],ut[lt+2]=rt[1],ut[lt+3]=rt[0]}et.writeFloatLE=nt?it:ot,et.writeFloatBE=nt?ot:it;function st(ct,ut){return rt[0]=ct[ut],rt[1]=ct[ut+1],rt[2]=ct[ut+2],rt[3]=ct[ut+3],tt[0]}function at(ct,ut){return rt[3]=ct[ut],rt[2]=ct[ut+1],rt[1]=ct[ut+2],rt[0]=ct[ut+3],tt[0]}et.readFloatLE=nt?st:at,et.readFloatBE=nt?at:st}():function(){function tt(nt,it,ot,st){var at=it<0?1:0;if(at&&(it=-it),it===0)nt(1/it>0?0:2147483648,ot,st);else if(isNaN(it))nt(2143289344,ot,st);else if(it>3402823466385289e23)nt((at<<31|2139095040)>>>0,ot,st);else if(it<11754943508222875e-54)nt((at<<31|Math.round(it/1401298464324817e-60))>>>0,ot,st);else{var ct=Math.floor(Math.log(it)/Math.LN2),ut=Math.round(it*Math.pow(2,-ct)*8388608)&8388607;nt((at<<31|ct+127<<23|ut)>>>0,ot,st)}}et.writeFloatLE=tt.bind(null,writeUintLE),et.writeFloatBE=tt.bind(null,writeUintBE);function rt(nt,it,ot){var st=nt(it,ot),at=(st>>31)*2+1,ct=st>>>23&255,ut=st&8388607;return ct===255?ut?NaN:at*(1/0):ct===0?at*1401298464324817e-60*ut:at*Math.pow(2,ct-150)*(ut+8388608)}et.readFloatLE=rt.bind(null,readUintLE),et.readFloatBE=rt.bind(null,readUintBE)}(),typeof Float64Array<"u"?function(){var tt=new Float64Array([-0]),rt=new Uint8Array(tt.buffer),nt=rt[7]===128;function it(ct,ut,lt){tt[0]=ct,ut[lt]=rt[0],ut[lt+1]=rt[1],ut[lt+2]=rt[2],ut[lt+3]=rt[3],ut[lt+4]=rt[4],ut[lt+5]=rt[5],ut[lt+6]=rt[6],ut[lt+7]=rt[7]}function ot(ct,ut,lt){tt[0]=ct,ut[lt]=rt[7],ut[lt+1]=rt[6],ut[lt+2]=rt[5],ut[lt+3]=rt[4],ut[lt+4]=rt[3],ut[lt+5]=rt[2],ut[lt+6]=rt[1],ut[lt+7]=rt[0]}et.writeDoubleLE=nt?it:ot,et.writeDoubleBE=nt?ot:it;function st(ct,ut){return rt[0]=ct[ut],rt[1]=ct[ut+1],rt[2]=ct[ut+2],rt[3]=ct[ut+3],rt[4]=ct[ut+4],rt[5]=ct[ut+5],rt[6]=ct[ut+6],rt[7]=ct[ut+7],tt[0]}function at(ct,ut){return rt[7]=ct[ut],rt[6]=ct[ut+1],rt[5]=ct[ut+2],rt[4]=ct[ut+3],rt[3]=ct[ut+4],rt[2]=ct[ut+5],rt[1]=ct[ut+6],rt[0]=ct[ut+7],tt[0]}et.readDoubleLE=nt?st:at,et.readDoubleBE=nt?at:st}():function(){function tt(nt,it,ot,st,at,ct){var ut=st<0?1:0;if(ut&&(st=-st),st===0)nt(0,at,ct+it),nt(1/st>0?0:2147483648,at,ct+ot);else if(isNaN(st))nt(0,at,ct+it),nt(2146959360,at,ct+ot);else if(st>17976931348623157e292)nt(0,at,ct+it),nt((ut<<31|2146435072)>>>0,at,ct+ot);else{var lt;if(st<22250738585072014e-324)lt=st/5e-324,nt(lt>>>0,at,ct+it),nt((ut<<31|lt/4294967296)>>>0,at,ct+ot);else{var ht=Math.floor(Math.log(st)/Math.LN2);ht===1024&&(ht=1023),lt=st*Math.pow(2,-ht),nt(lt*4503599627370496>>>0,at,ct+it),nt((ut<<31|ht+1023<<20|lt*1048576&1048575)>>>0,at,ct+ot)}}}et.writeDoubleLE=tt.bind(null,writeUintLE,0,4),et.writeDoubleBE=tt.bind(null,writeUintBE,4,0);function rt(nt,it,ot,st,at){var ct=nt(st,at+it),ut=nt(st,at+ot),lt=(ut>>31)*2+1,ht=ut>>>20&2047,ft=4294967296*(ut&1048575)+ct;return ht===2047?ft?NaN:lt*(1/0):ht===0?lt*5e-324*ft:lt*Math.pow(2,ht-1075)*(ft+4503599627370496)}et.readDoubleLE=rt.bind(null,readUintLE,0,4),et.readDoubleBE=rt.bind(null,readUintBE,4,0)}(),et}function writeUintLE(et,tt,rt){tt[rt]=et&255,tt[rt+1]=et>>>8&255,tt[rt+2]=et>>>16&255,tt[rt+3]=et>>>24}function writeUintBE(et,tt,rt){tt[rt]=et>>>24,tt[rt+1]=et>>>16&255,tt[rt+2]=et>>>8&255,tt[rt+3]=et&255}function readUintLE(et,tt){return(et[tt]|et[tt+1]<<8|et[tt+2]<<16|et[tt+3]<<24)>>>0}function readUintBE(et,tt){return(et[tt]<<24|et[tt+1]<<16|et[tt+2]<<8|et[tt+3])>>>0}var inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(et){}return null}var utf8$2={};(function(et){var tt=et;tt.length=function(rt){for(var nt=0,it=0,ot=0;ot<rt.length;++ot)it=rt.charCodeAt(ot),it<128?nt+=1:it<2048?nt+=2:(it&64512)===55296&&(rt.charCodeAt(ot+1)&64512)===56320?(++ot,nt+=4):nt+=3;return nt},tt.read=function(rt,nt,it){var ot=it-nt;if(ot<1)return"";for(var st=null,at=[],ct=0,ut;nt<it;)ut=rt[nt++],ut<128?at[ct++]=ut:ut>191&&ut<224?at[ct++]=(ut&31)<<6|rt[nt++]&63:ut>239&&ut<365?(ut=((ut&7)<<18|(rt[nt++]&63)<<12|(rt[nt++]&63)<<6|rt[nt++]&63)-65536,at[ct++]=55296+(ut>>10),at[ct++]=56320+(ut&1023)):at[ct++]=(ut&15)<<12|(rt[nt++]&63)<<6|rt[nt++]&63,ct>8191&&((st||(st=[])).push(String.fromCharCode.apply(String,at)),ct=0);return st?(ct&&st.push(String.fromCharCode.apply(String,at.slice(0,ct))),st.join("")):String.fromCharCode.apply(String,at.slice(0,ct))},tt.write=function(rt,nt,it){for(var ot=it,st,at,ct=0;ct<rt.length;++ct)st=rt.charCodeAt(ct),st<128?nt[it++]=st:st<2048?(nt[it++]=st>>6|192,nt[it++]=st&63|128):(st&64512)===55296&&((at=rt.charCodeAt(ct+1))&64512)===56320?(st=65536+((st&1023)<<10)+(at&1023),++ct,nt[it++]=st>>18|240,nt[it++]=st>>12&63|128,nt[it++]=st>>6&63|128,nt[it++]=st&63|128):(nt[it++]=st>>12|224,nt[it++]=st>>6&63|128,nt[it++]=st&63|128);return it-ot}})(utf8$2);var pool_1=pool;function pool(et,tt,rt){var nt=rt||8192,it=nt>>>1,ot=null,st=nt;return function(at){if(at<1||at>it)return et(at);st+at>nt&&(ot=et(nt),st=0);var ct=tt.call(ot,st,st+=at);return st&7&&(st=(st|7)+1),ct}}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=tt;var et=requireMinimal();function tt(ot,st){this.lo=ot>>>0,this.hi=st>>>0}var rt=tt.zero=new tt(0,0);rt.toNumber=function(){return 0},rt.zzEncode=rt.zzDecode=function(){return this},rt.length=function(){return 1};var nt=tt.zeroHash="\0\0\0\0\0\0\0\0";tt.fromNumber=function(ot){if(ot===0)return rt;var st=ot<0;st&&(ot=-ot);var at=ot>>>0,ct=(ot-at)/4294967296>>>0;return st&&(ct=~ct>>>0,at=~at>>>0,++at>4294967295&&(at=0,++ct>4294967295&&(ct=0))),new tt(at,ct)},tt.from=function(ot){if(typeof ot=="number")return tt.fromNumber(ot);if(et.isString(ot))if(et.Long)ot=et.Long.fromString(ot);else return tt.fromNumber(parseInt(ot,10));return ot.low||ot.high?new tt(ot.low>>>0,ot.high>>>0):rt},tt.prototype.toNumber=function(ot){if(!ot&&this.hi>>>31){var st=~this.lo+1>>>0,at=~this.hi>>>0;return st||(at=at+1>>>0),-(st+at*4294967296)}return this.lo+this.hi*4294967296},tt.prototype.toLong=function(ot){return et.Long?new et.Long(this.lo|0,this.hi|0,!!ot):{low:this.lo|0,high:this.hi|0,unsigned:!!ot}};var it=String.prototype.charCodeAt;return tt.fromHash=function(ot){return ot===nt?rt:new tt((it.call(ot,0)|it.call(ot,1)<<8|it.call(ot,2)<<16|it.call(ot,3)<<24)>>>0,(it.call(ot,4)|it.call(ot,5)<<8|it.call(ot,6)<<16|it.call(ot,7)<<24)>>>0)},tt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},tt.prototype.zzEncode=function(){var ot=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^ot)>>>0,this.lo=(this.lo<<1^ot)>>>0,this},tt.prototype.zzDecode=function(){var ot=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^ot)>>>0,this.hi=(this.hi>>>1^ot)>>>0,this},tt.prototype.length=function(){var ot=this.lo,st=(this.lo>>>28|this.hi<<4)>>>0,at=this.hi>>>24;return at===0?st===0?ot<16384?ot<128?1:2:ot<2097152?3:4:st<16384?st<128?5:6:st<2097152?7:8:at<128?9:10},longbits}var hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,function(et){var tt=et;tt.asPromise=aspromise,tt.base64=base64$7,tt.EventEmitter=eventemitter,tt.float=float,tt.inquire=inquire_1,tt.utf8=utf8$2,tt.pool=pool_1,tt.LongBits=requireLongbits(),tt.isNode=!!(typeof window<"u"&&window&&window.process&&window.process.versions&&window.process.versions.node),tt.global=tt.isNode&&window||typeof window<"u"&&window||typeof self<"u"&&self||commonjsGlobal,tt.emptyArray=Object.freeze?Object.freeze([]):[],tt.emptyObject=Object.freeze?Object.freeze({}):{},tt.isInteger=Number.isInteger||function(it){return typeof it=="number"&&isFinite(it)&&Math.floor(it)===it},tt.isString=function(it){return typeof it=="string"||it instanceof String},tt.isObject=function(it){return it&&typeof it=="object"},tt.isset=tt.isSet=function(it,ot){var st=it[ot];return st!=null&&it.hasOwnProperty(ot)?typeof st!="object"||(Array.isArray(st)?st.length:Object.keys(st).length)>0:!1},tt.Buffer=function(){try{var it=tt.inquire("buffer").Buffer;return it.prototype.utf8Write?it:null}catch{return null}}(),tt._Buffer_from=null,tt._Buffer_allocUnsafe=null,tt.newBuffer=function(it){return typeof it=="number"?tt.Buffer?tt._Buffer_allocUnsafe(it):new tt.Array(it):tt.Buffer?tt._Buffer_from(it):typeof Uint8Array>"u"?it:new Uint8Array(it)},tt.Array=typeof Uint8Array<"u"?Uint8Array:Array,tt.Long=tt.global.dcodeIO&&tt.global.dcodeIO.Long||tt.global.Long||tt.inquire("long"),tt.key2Re=/^true|false|0|1$/,tt.key32Re=/^-?(?:0|[1-9][0-9]*)$/,tt.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,tt.longToHash=function(it){return it?tt.LongBits.from(it).toHash():tt.LongBits.zeroHash},tt.longFromHash=function(it,ot){var st=tt.LongBits.fromHash(it);return tt.Long?tt.Long.fromBits(st.lo,st.hi,ot):st.toNumber(!!ot)};function rt(it,ot,st){for(var at=Object.keys(ot),ct=0;ct<at.length;++ct)(it[at[ct]]===void 0||!st)&&(it[at[ct]]=ot[at[ct]]);return it}tt.merge=rt,tt.lcFirst=function(it){return it.charAt(0).toLowerCase()+it.substring(1)};function nt(it){function ot(st,at){if(!(this instanceof ot))return new ot(st,at);Object.defineProperty(this,"message",{get:function(){return st}}),Error.captureStackTrace?Error.captureStackTrace(this,ot):Object.defineProperty(this,"stack",{value:new Error().stack||""}),at&&rt(this,at)}return(ot.prototype=Object.create(Error.prototype)).constructor=ot,Object.defineProperty(ot.prototype,"name",{get:function(){return it}}),ot.prototype.toString=function(){return this.name+": "+this.message},ot}tt.newError=nt,tt.ProtocolError=nt("ProtocolError"),tt.oneOfGetter=function(it){for(var ot={},st=0;st<it.length;++st)ot[it[st]]=1;return function(){for(var at=Object.keys(this),ct=at.length-1;ct>-1;--ct)if(ot[at[ct]]===1&&this[at[ct]]!==void 0&&this[at[ct]]!==null)return at[ct]}},tt.oneOfSetter=function(it){return function(ot){for(var st=0;st<it.length;++st)it[st]!==ot&&delete this[it[st]]}},tt.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},tt._configure=function(){var it=tt.Buffer;if(!it){tt._Buffer_from=tt._Buffer_allocUnsafe=null;return}tt._Buffer_from=it.from!==Uint8Array.from&&it.from||function(ot,st){return new it(ot,st)},tt._Buffer_allocUnsafe=it.allocUnsafe||function(ot){return new it(ot)}}}(minimal$1)),minimal$1}var writer=Writer$1,util$c=requireMinimal(),BufferWriter$1,LongBits$1=util$c.LongBits,base64$6=util$c.base64,utf8$1=util$c.utf8;function Op(et,tt,rt){this.fn=et,this.len=tt,this.next=void 0,this.val=rt}function noop(){}function State(et){this.head=et.head,this.tail=et.tail,this.len=et.len,this.next=et.states}function Writer$1(){this.len=0,this.head=new Op(noop,0,0),this.tail=this.head,this.states=null}var create$8=function et(){return util$c.Buffer?function(){return(Writer$1.create=function(){return new BufferWriter$1})()}:function(){return new Writer$1}};Writer$1.create=create$8(),Writer$1.alloc=function et(tt){return new util$c.Array(tt)},util$c.Array!==Array&&(Writer$1.alloc=util$c.pool(Writer$1.alloc,util$c.Array.prototype.subarray)),Writer$1.prototype._push=function et(tt,rt,nt){return this.tail=this.tail.next=new Op(tt,rt,nt),this.len+=rt,this};function writeByte(et,tt,rt){tt[rt]=et&255}function writeVarint32(et,tt,rt){for(;et>127;)tt[rt++]=et&127|128,et>>>=7;tt[rt]=et}function VarintOp(et,tt){this.len=et,this.next=void 0,this.val=tt}VarintOp.prototype=Object.create(Op.prototype),VarintOp.prototype.fn=writeVarint32,Writer$1.prototype.uint32=function et(tt){return this.len+=(this.tail=this.tail.next=new VarintOp((tt=tt>>>0)<128?1:tt<16384?2:tt<2097152?3:tt<268435456?4:5,tt)).len,this},Writer$1.prototype.int32=function et(tt){return tt<0?this._push(writeVarint64,10,LongBits$1.fromNumber(tt)):this.uint32(tt)},Writer$1.prototype.sint32=function et(tt){return this.uint32((tt<<1^tt>>31)>>>0)};function writeVarint64(et,tt,rt){for(;et.hi;)tt[rt++]=et.lo&127|128,et.lo=(et.lo>>>7|et.hi<<25)>>>0,et.hi>>>=7;for(;et.lo>127;)tt[rt++]=et.lo&127|128,et.lo=et.lo>>>7;tt[rt++]=et.lo}Writer$1.prototype.uint64=function et(tt){var rt=LongBits$1.from(tt);return this._push(writeVarint64,rt.length(),rt)},Writer$1.prototype.int64=Writer$1.prototype.uint64,Writer$1.prototype.sint64=function et(tt){var rt=LongBits$1.from(tt).zzEncode();return this._push(writeVarint64,rt.length(),rt)},Writer$1.prototype.bool=function et(tt){return this._push(writeByte,1,tt?1:0)};function writeFixed32(et,tt,rt){tt[rt]=et&255,tt[rt+1]=et>>>8&255,tt[rt+2]=et>>>16&255,tt[rt+3]=et>>>24}Writer$1.prototype.fixed32=function et(tt){return this._push(writeFixed32,4,tt>>>0)},Writer$1.prototype.sfixed32=Writer$1.prototype.fixed32,Writer$1.prototype.fixed64=function et(tt){var rt=LongBits$1.from(tt);return this._push(writeFixed32,4,rt.lo)._push(writeFixed32,4,rt.hi)},Writer$1.prototype.sfixed64=Writer$1.prototype.fixed64,Writer$1.prototype.float=function et(tt){return this._push(util$c.float.writeFloatLE,4,tt)},Writer$1.prototype.double=function et(tt){return this._push(util$c.float.writeDoubleLE,8,tt)};var writeBytes=util$c.Array.prototype.set?function et(tt,rt,nt){rt.set(tt,nt)}:function et(tt,rt,nt){for(var it=0;it<tt.length;++it)rt[nt+it]=tt[it]};Writer$1.prototype.bytes=function et(tt){var rt=tt.length>>>0;if(!rt)return this._push(writeByte,1,0);if(util$c.isString(tt)){var nt=Writer$1.alloc(rt=base64$6.length(tt));base64$6.decode(tt,nt,0),tt=nt}return this.uint32(rt)._push(writeBytes,rt,tt)},Writer$1.prototype.string=function et(tt){var rt=utf8$1.length(tt);return rt?this.uint32(rt)._push(utf8$1.write,rt,tt):this._push(writeByte,1,0)},Writer$1.prototype.fork=function et(){return this.states=new State(this),this.head=this.tail=new Op(noop,0,0),this.len=0,this},Writer$1.prototype.reset=function et(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Op(noop,0,0),this.len=0),this},Writer$1.prototype.ldelim=function et(){var tt=this.head,rt=this.tail,nt=this.len;return this.reset().uint32(nt),nt&&(this.tail.next=tt.next,this.tail=rt,this.len+=nt),this},Writer$1.prototype.finish=function et(){for(var tt=this.head.next,rt=this.constructor.alloc(this.len),nt=0;tt;)tt.fn(tt.val,rt,nt),nt+=tt.len,tt=tt.next;return rt},Writer$1._configure=function(et){BufferWriter$1=et,Writer$1.create=create$8(),BufferWriter$1._configure()};var writer_buffer=BufferWriter,Writer=writer;(BufferWriter.prototype=Object.create(Writer.prototype)).constructor=BufferWriter;var util$b=requireMinimal();function BufferWriter(){Writer.call(this)}BufferWriter._configure=function(){BufferWriter.alloc=util$b._Buffer_allocUnsafe,BufferWriter.writeBytesBuffer=util$b.Buffer&&util$b.Buffer.prototype instanceof Uint8Array&&util$b.Buffer.prototype.set.name==="set"?function(et,tt,rt){tt.set(et,rt)}:function(et,tt,rt){if(et.copy)et.copy(tt,rt,0,et.length);else for(var nt=0;nt<et.length;)tt[rt++]=et[nt++]}},BufferWriter.prototype.bytes=function et(tt){util$b.isString(tt)&&(tt=util$b._Buffer_from(tt,"base64"));var rt=tt.length>>>0;return this.uint32(rt),rt&&this._push(BufferWriter.writeBytesBuffer,rt,tt),this};function writeStringBuffer(et,tt,rt){et.length<40?util$b.utf8.write(et,tt,rt):tt.utf8Write?tt.utf8Write(et,rt):tt.write(et,rt)}BufferWriter.prototype.string=function et(tt){var rt=util$b.Buffer.byteLength(tt);return this.uint32(rt),rt&&this._push(writeStringBuffer,rt,tt),this},BufferWriter._configure();var reader=Reader$1,util$a=requireMinimal(),BufferReader$1,LongBits=util$a.LongBits,utf8=util$a.utf8;function indexOutOfRange(et,tt){return RangeError("index out of range: "+et.pos+" + "+(tt||1)+" > "+et.len)}function Reader$1(et){this.buf=et,this.pos=0,this.len=et.length}var create_array=typeof Uint8Array<"u"?function et(tt){if(tt instanceof Uint8Array||Array.isArray(tt))return new Reader$1(tt);throw Error("illegal buffer")}:function et(tt){if(Array.isArray(tt))return new Reader$1(tt);throw Error("illegal buffer")},create$7=function et(){return util$a.Buffer?function(tt){return(Reader$1.create=function(rt){return util$a.Buffer.isBuffer(rt)?new BufferReader$1(rt):create_array(rt)})(tt)}:create_array};Reader$1.create=create$7(),Reader$1.prototype._slice=util$a.Array.prototype.subarray||util$a.Array.prototype.slice,Reader$1.prototype.uint32=function et(){var tt=4294967295;return function(){if(tt=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(tt=(tt|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(tt=(tt|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(tt=(tt|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(tt=(tt|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return tt;if((this.pos+=5)>this.len)throw this.pos=this.len,indexOutOfRange(this,10);return tt}}(),Reader$1.prototype.int32=function et(){return this.uint32()|0},Reader$1.prototype.sint32=function et(){var tt=this.uint32();return tt>>>1^-(tt&1)|0};function readLongVarint(){var et=new LongBits(0,0),tt=0;if(this.len-this.pos>4){for(;tt<4;++tt)if(et.lo=(et.lo|(this.buf[this.pos]&127)<<tt*7)>>>0,this.buf[this.pos++]<128)return et;if(et.lo=(et.lo|(this.buf[this.pos]&127)<<28)>>>0,et.hi=(et.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return et;tt=0}else{for(;tt<3;++tt){if(this.pos>=this.len)throw indexOutOfRange(this);if(et.lo=(et.lo|(this.buf[this.pos]&127)<<tt*7)>>>0,this.buf[this.pos++]<128)return et}return et.lo=(et.lo|(this.buf[this.pos++]&127)<<tt*7)>>>0,et}if(this.len-this.pos>4){for(;tt<5;++tt)if(et.hi=(et.hi|(this.buf[this.pos]&127)<<tt*7+3)>>>0,this.buf[this.pos++]<128)return et}else for(;tt<5;++tt){if(this.pos>=this.len)throw indexOutOfRange(this);if(et.hi=(et.hi|(this.buf[this.pos]&127)<<tt*7+3)>>>0,this.buf[this.pos++]<128)return et}throw Error("invalid varint encoding")}Reader$1.prototype.bool=function et(){return this.uint32()!==0};function readFixed32_end(et,tt){return(et[tt-4]|et[tt-3]<<8|et[tt-2]<<16|et[tt-1]<<24)>>>0}Reader$1.prototype.fixed32=function et(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)},Reader$1.prototype.sfixed32=function et(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);return readFixed32_end(this.buf,this.pos+=4)|0};function readFixed64(){if(this.pos+8>this.len)throw indexOutOfRange(this,8);return new LongBits(readFixed32_end(this.buf,this.pos+=4),readFixed32_end(this.buf,this.pos+=4))}Reader$1.prototype.float=function et(){if(this.pos+4>this.len)throw indexOutOfRange(this,4);var tt=util$a.float.readFloatLE(this.buf,this.pos);return this.pos+=4,tt},Reader$1.prototype.double=function et(){if(this.pos+8>this.len)throw indexOutOfRange(this,4);var tt=util$a.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,tt},Reader$1.prototype.bytes=function et(){var tt=this.uint32(),rt=this.pos,nt=this.pos+tt;if(nt>this.len)throw indexOutOfRange(this,tt);return this.pos+=tt,Array.isArray(this.buf)?this.buf.slice(rt,nt):rt===nt?new this.buf.constructor(0):this._slice.call(this.buf,rt,nt)},Reader$1.prototype.string=function et(){var tt=this.bytes();return utf8.read(tt,0,tt.length)},Reader$1.prototype.skip=function et(tt){if(typeof tt=="number"){if(this.pos+tt>this.len)throw indexOutOfRange(this,tt);this.pos+=tt}else do if(this.pos>=this.len)throw indexOutOfRange(this);while(this.buf[this.pos++]&128);return this},Reader$1.prototype.skipType=function(et){switch(et){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(et=this.uint32()&7)!==4;)this.skipType(et);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+et+" at offset "+this.pos)}return this},Reader$1._configure=function(et){BufferReader$1=et,Reader$1.create=create$7(),BufferReader$1._configure();var tt=util$a.Long?"toLong":"toNumber";util$a.merge(Reader$1.prototype,{int64:function(){return readLongVarint.call(this)[tt](!1)},uint64:function(){return readLongVarint.call(this)[tt](!0)},sint64:function(){return readLongVarint.call(this).zzDecode()[tt](!1)},fixed64:function(){return readFixed64.call(this)[tt](!0)},sfixed64:function(){return readFixed64.call(this)[tt](!1)}})};var reader_buffer=BufferReader,Reader=reader;(BufferReader.prototype=Object.create(Reader.prototype)).constructor=BufferReader;var util$9=requireMinimal();function BufferReader(et){Reader.call(this,et)}BufferReader._configure=function(){util$9.Buffer&&(BufferReader.prototype._slice=util$9.Buffer.prototype.slice)},BufferReader.prototype.string=function et(){var tt=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+tt,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+tt,this.len))},BufferReader._configure();var rpc$2={},service=Service,util$8=requireMinimal();(Service.prototype=Object.create(util$8.EventEmitter.prototype)).constructor=Service;function Service(et,tt,rt){if(typeof et!="function")throw TypeError("rpcImpl must be a function");util$8.EventEmitter.call(this),this.rpcImpl=et,this.requestDelimited=!!tt,this.responseDelimited=!!rt}Service.prototype.rpcCall=function et(tt,rt,nt,it,ot){if(!it)throw TypeError("request must be specified");var st=this;if(!ot)return util$8.asPromise(et,st,tt,rt,nt,it);if(!st.rpcImpl){setTimeout(function(){ot(Error("already ended"))},0);return}try{return st.rpcImpl(tt,rt[st.requestDelimited?"encodeDelimited":"encode"](it).finish(),function(at,ct){if(at)return st.emit("error",at,tt),ot(at);if(ct===null){st.end(!0);return}if(!(ct instanceof nt))try{ct=nt[st.responseDelimited?"decodeDelimited":"decode"](ct)}catch(ut){return st.emit("error",ut,tt),ot(ut)}return st.emit("data",ct,tt),ot(null,ct)})}catch(at){st.emit("error",at,tt),setTimeout(function(){ot(at)},0);return}},Service.prototype.end=function et(tt){return this.rpcImpl&&(tt||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},function(et){var tt=et;tt.Service=service}(rpc$2);var roots={};(function(et){var tt=et;tt.build="minimal",tt.Writer=writer,tt.BufferWriter=writer_buffer,tt.Reader=reader,tt.BufferReader=reader_buffer,tt.util=requireMinimal(),tt.rpc=rpc$2,tt.roots=roots,tt.configure=rt;function rt(){tt.util._configure(),tt.Writer._configure(tt.BufferWriter),tt.Reader._configure(tt.BufferReader)}rt()})(indexMinimal);var minimal=indexMinimal,$protobuf$a=minimal,$Reader$a=$protobuf$a.Reader,$Writer$a=$protobuf$a.Writer,$util$9=$protobuf$a.util,$root$a=$protobuf$a.roots["libp2p-crypto-keys"]||($protobuf$a.roots["libp2p-crypto-keys"]={});$root$a.KeyType=function(){var et={},tt=Object.create(et);return tt[et[0]="RSA"]=0,tt[et[1]="Ed25519"]=1,tt[et[2]="Secp256k1"]=2,tt}(),$root$a.PublicKey=function(){function et(tt){if(tt)for(var rt=Object.keys(tt),nt=0;nt<rt.length;++nt)tt[rt[nt]]!=null&&(this[rt[nt]]=tt[rt[nt]])}return et.prototype.Type=0,et.prototype.Data=$util$9.newBuffer([]),et.encode=function(tt,rt){return rt||(rt=$Writer$a.create()),rt.uint32(8).int32(tt.Type),rt.uint32(18).bytes(tt.Data),rt},et.decode=function(tt,rt){tt instanceof $Reader$a||(tt=$Reader$a.create(tt));for(var nt=rt===void 0?tt.len:tt.pos+rt,it=new $root$a.PublicKey;tt.pos<nt;){var ot=tt.uint32();switch(ot>>>3){case 1:it.Type=tt.int32();break;case 2:it.Data=tt.bytes();break;default:tt.skipType(ot&7);break}}if(!it.hasOwnProperty("Type"))throw $util$9.ProtocolError("missing required 'Type'",{instance:it});if(!it.hasOwnProperty("Data"))throw $util$9.ProtocolError("missing required 'Data'",{instance:it});return it},et.fromObject=function(tt){if(tt instanceof $root$a.PublicKey)return tt;var rt=new $root$a.PublicKey;switch(tt.Type){case"RSA":case 0:rt.Type=0;break;case"Ed25519":case 1:rt.Type=1;break;case"Secp256k1":case 2:rt.Type=2;break}return tt.Data!=null&&(typeof tt.Data=="string"?$util$9.base64.decode(tt.Data,rt.Data=$util$9.newBuffer($util$9.base64.length(tt.Data)),0):tt.Data.length&&(rt.Data=tt.Data)),rt},et.toObject=function(tt,rt){rt||(rt={});var nt={};return rt.defaults&&(nt.Type=rt.enums===String?"RSA":0,rt.bytes===String?nt.Data="":(nt.Data=[],rt.bytes!==Array&&(nt.Data=$util$9.newBuffer(nt.Data)))),tt.Type!=null&&tt.hasOwnProperty("Type")&&(nt.Type=rt.enums===String?$root$a.KeyType[tt.Type]:tt.Type),tt.Data!=null&&tt.hasOwnProperty("Data")&&(nt.Data=rt.bytes===String?$util$9.base64.encode(tt.Data,0,tt.Data.length):rt.bytes===Array?Array.prototype.slice.call(tt.Data):tt.Data),nt},et.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf$a.util.toJSONOptions)},et}(),$root$a.PrivateKey=function(){function et(tt){if(tt)for(var rt=Object.keys(tt),nt=0;nt<rt.length;++nt)tt[rt[nt]]!=null&&(this[rt[nt]]=tt[rt[nt]])}return et.prototype.Type=0,et.prototype.Data=$util$9.newBuffer([]),et.encode=function(tt,rt){return rt||(rt=$Writer$a.create()),rt.uint32(8).int32(tt.Type),rt.uint32(18).bytes(tt.Data),rt},et.decode=function(tt,rt){tt instanceof $Reader$a||(tt=$Reader$a.create(tt));for(var nt=rt===void 0?tt.len:tt.pos+rt,it=new $root$a.PrivateKey;tt.pos<nt;){var ot=tt.uint32();switch(ot>>>3){case 1:it.Type=tt.int32();break;case 2:it.Data=tt.bytes();break;default:tt.skipType(ot&7);break}}if(!it.hasOwnProperty("Type"))throw $util$9.ProtocolError("missing required 'Type'",{instance:it});if(!it.hasOwnProperty("Data"))throw $util$9.ProtocolError("missing required 'Data'",{instance:it});return it},et.fromObject=function(tt){if(tt instanceof $root$a.PrivateKey)return tt;var rt=new $root$a.PrivateKey;switch(tt.Type){case"RSA":case 0:rt.Type=0;break;case"Ed25519":case 1:rt.Type=1;break;case"Secp256k1":case 2:rt.Type=2;break}return tt.Data!=null&&(typeof tt.Data=="string"?$util$9.base64.decode(tt.Data,rt.Data=$util$9.newBuffer($util$9.base64.length(tt.Data)),0):tt.Data.length&&(rt.Data=tt.Data)),rt},et.toObject=function(tt,rt){rt||(rt={});var nt={};return rt.defaults&&(nt.Type=rt.enums===String?"RSA":0,rt.bytes===String?nt.Data="":(nt.Data=[],rt.bytes!==Array&&(nt.Data=$util$9.newBuffer(nt.Data)))),tt.Type!=null&&tt.hasOwnProperty("Type")&&(nt.Type=rt.enums===String?$root$a.KeyType[tt.Type]:tt.Type),tt.Data!=null&&tt.hasOwnProperty("Data")&&(nt.Data=rt.bytes===String?$util$9.base64.encode(tt.Data,0,tt.Data.length):rt.bytes===Array?Array.prototype.slice.call(tt.Data):tt.Data),nt},et.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf$a.util.toJSONOptions)},et}();var keys$6=$root$a,forge$W={options:{usePureJavaScript:!1}},util$7={exports:{}},api$1={},baseN$3=api$1,_reverseAlphabets$1={};api$1.encode=function(et,tt,rt){if(typeof tt!="string")throw new TypeError('"alphabet" must be a string.');if(rt!==void 0&&typeof rt!="number")throw new TypeError('"maxline" must be a number.');var nt="";if(!(et instanceof Uint8Array))nt=_encodeWithByteBuffer$1(et,tt);else{var it=0,ot=tt.length,st=tt.charAt(0),at=[0];for(it=0;it<et.length;++it){for(var ct=0,ut=et[it];ct<at.length;++ct)ut+=at[ct]<<8,at[ct]=ut%ot,ut=ut/ot|0;for(;ut>0;)at.push(ut%ot),ut=ut/ot|0}for(it=0;et[it]===0&&it<et.length-1;++it)nt+=st;for(it=at.length-1;it>=0;--it)nt+=tt[at[it]]}if(rt){var lt=new RegExp(".{1,"+rt+"}","g");nt=nt.match(lt).join(`\r
`)}return nt},api$1.decode=function(et,tt){if(typeof et!="string")throw new TypeError('"input" must be a string.');if(typeof tt!="string")throw new TypeError('"alphabet" must be a string.');var rt=_reverseAlphabets$1[tt];if(!rt){rt=_reverseAlphabets$1[tt]=[];for(var nt=0;nt<tt.length;++nt)rt[tt.charCodeAt(nt)]=nt}et=et.replace(/\s/g,"");for(var it=tt.length,ot=tt.charAt(0),st=[0],nt=0;nt<et.length;nt++){var at=rt[et.charCodeAt(nt)];if(at===void 0)return;for(var ct=0,ut=at;ct<st.length;++ct)ut+=st[ct]*it,st[ct]=ut&255,ut>>=8;for(;ut>0;)st.push(ut&255),ut>>=8}for(var lt=0;et[lt]===ot&&lt<et.length-1;++lt)st.push(0);return typeof Buffer<"u"?Buffer.from(st.reverse()):new Uint8Array(st.reverse())};function _encodeWithByteBuffer$1(et,tt){var rt=0,nt=tt.length,it=tt.charAt(0),ot=[0];for(rt=0;rt<et.length();++rt){for(var st=0,at=et.at(rt);st<ot.length;++st)at+=ot[st]<<8,ot[st]=at%nt,at=at/nt|0;for(;at>0;)ot.push(at%nt),at=at/nt|0}var ct="";for(rt=0;et.at(rt)===0&&rt<et.length()-1;++rt)ct+=it;for(rt=ot.length-1;rt>=0;--rt)ct+=tt[ot[rt]];return ct}var forge$V=forge$W,baseN$2=baseN$3,util$6=util$7.exports=forge$V.util=forge$V.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){util$6.nextTick=process.nextTick,typeof setImmediate=="function"?util$6.setImmediate=setImmediate:util$6.setImmediate=util$6.nextTick;return}if(typeof setImmediate=="function"){util$6.setImmediate=function(){return setImmediate.apply(void 0,arguments)},util$6.nextTick=function(st){return setImmediate(st)};return}if(util$6.setImmediate=function(st){setTimeout(st,0)},typeof window<"u"&&typeof window.postMessage=="function"){let st=function(at){if(at.source===window&&at.data===et){at.stopPropagation();var ct=tt.slice();tt.length=0,ct.forEach(function(ut){ut()})}};var et="forge.setImmediate",tt=[];util$6.setImmediate=function(at){tt.push(at),tt.length===1&&window.postMessage(et,"*")},window.addEventListener("message",st,!0)}if(typeof MutationObserver<"u"){var rt=Date.now(),nt=!0,it=document.createElement("div"),tt=[];new MutationObserver(function(){var at=tt.slice();tt.length=0,at.forEach(function(ct){ct()})}).observe(it,{attributes:!0});var ot=util$6.setImmediate;util$6.setImmediate=function(at){Date.now()-rt>15?(rt=Date.now(),ot(at)):(tt.push(at),tt.length===1&&it.setAttribute("a",nt=!nt))}}util$6.nextTick=util$6.setImmediate})(),util$6.isNodejs=typeof process<"u"&&process.versions&&process.versions.node,util$6.globalScope=function(){return util$6.isNodejs||typeof self>"u"?window:self}(),util$6.isArray=Array.isArray||function(et){return Object.prototype.toString.call(et)==="[object Array]"},util$6.isArrayBuffer=function(et){return typeof ArrayBuffer<"u"&&et instanceof ArrayBuffer},util$6.isArrayBufferView=function(et){return et&&util$6.isArrayBuffer(et.buffer)&&et.byteLength!==void 0};function _checkBitsParam$1(et){if(!(et===8||et===16||et===24||et===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+et)}util$6.ByteBuffer=ByteStringBuffer$1;function ByteStringBuffer$1(et){if(this.data="",this.read=0,typeof et=="string")this.data=et;else if(util$6.isArrayBuffer(et)||util$6.isArrayBufferView(et))if(typeof Buffer<"u"&&et instanceof Buffer)this.data=et.toString("binary");else{var tt=new Uint8Array(et);try{this.data=String.fromCharCode.apply(null,tt)}catch{for(var rt=0;rt<tt.length;++rt)this.putByte(tt[rt])}}else(et instanceof ByteStringBuffer$1||typeof et=="object"&&typeof et.data=="string"&&typeof et.read=="number")&&(this.data=et.data,this.read=et.read);this._constructedStringLength=0}util$6.ByteStringBuffer=ByteStringBuffer$1;var _MAX_CONSTRUCTED_STRING_LENGTH$1=4096;util$6.ByteStringBuffer.prototype._optimizeConstructedString=function(et){this._constructedStringLength+=et,this._constructedStringLength>_MAX_CONSTRUCTED_STRING_LENGTH$1&&(this.data.substr(0,1),this._constructedStringLength=0)},util$6.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},util$6.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},util$6.ByteStringBuffer.prototype.putByte=function(et){return this.putBytes(String.fromCharCode(et))},util$6.ByteStringBuffer.prototype.fillWithByte=function(et,tt){et=String.fromCharCode(et);for(var rt=this.data;tt>0;)tt&1&&(rt+=et),tt>>>=1,tt>0&&(et+=et);return this.data=rt,this._optimizeConstructedString(tt),this},util$6.ByteStringBuffer.prototype.putBytes=function(et){return this.data+=et,this._optimizeConstructedString(et.length),this},util$6.ByteStringBuffer.prototype.putString=function(et){return this.putBytes(util$6.encodeUtf8(et))},util$6.ByteStringBuffer.prototype.putInt16=function(et){return this.putBytes(String.fromCharCode(et>>8&255)+String.fromCharCode(et&255))},util$6.ByteStringBuffer.prototype.putInt24=function(et){return this.putBytes(String.fromCharCode(et>>16&255)+String.fromCharCode(et>>8&255)+String.fromCharCode(et&255))},util$6.ByteStringBuffer.prototype.putInt32=function(et){return this.putBytes(String.fromCharCode(et>>24&255)+String.fromCharCode(et>>16&255)+String.fromCharCode(et>>8&255)+String.fromCharCode(et&255))},util$6.ByteStringBuffer.prototype.putInt16Le=function(et){return this.putBytes(String.fromCharCode(et&255)+String.fromCharCode(et>>8&255))},util$6.ByteStringBuffer.prototype.putInt24Le=function(et){return this.putBytes(String.fromCharCode(et&255)+String.fromCharCode(et>>8&255)+String.fromCharCode(et>>16&255))},util$6.ByteStringBuffer.prototype.putInt32Le=function(et){return this.putBytes(String.fromCharCode(et&255)+String.fromCharCode(et>>8&255)+String.fromCharCode(et>>16&255)+String.fromCharCode(et>>24&255))},util$6.ByteStringBuffer.prototype.putInt=function(et,tt){_checkBitsParam$1(tt);var rt="";do tt-=8,rt+=String.fromCharCode(et>>tt&255);while(tt>0);return this.putBytes(rt)},util$6.ByteStringBuffer.prototype.putSignedInt=function(et,tt){return et<0&&(et+=2<<tt-1),this.putInt(et,tt)},util$6.ByteStringBuffer.prototype.putBuffer=function(et){return this.putBytes(et.getBytes())},util$6.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},util$6.ByteStringBuffer.prototype.getInt16=function(){var et=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,et},util$6.ByteStringBuffer.prototype.getInt24=function(){var et=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,et},util$6.ByteStringBuffer.prototype.getInt32=function(){var et=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,et},util$6.ByteStringBuffer.prototype.getInt16Le=function(){var et=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,et},util$6.ByteStringBuffer.prototype.getInt24Le=function(){var et=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,et},util$6.ByteStringBuffer.prototype.getInt32Le=function(){var et=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,et},util$6.ByteStringBuffer.prototype.getInt=function(et){_checkBitsParam$1(et);var tt=0;do tt=(tt<<8)+this.data.charCodeAt(this.read++),et-=8;while(et>0);return tt},util$6.ByteStringBuffer.prototype.getSignedInt=function(et){var tt=this.getInt(et),rt=2<<et-2;return tt>=rt&&(tt-=rt<<1),tt},util$6.ByteStringBuffer.prototype.getBytes=function(et){var tt;return et?(et=Math.min(this.length(),et),tt=this.data.slice(this.read,this.read+et),this.read+=et):et===0?tt="":(tt=this.read===0?this.data:this.data.slice(this.read),this.clear()),tt},util$6.ByteStringBuffer.prototype.bytes=function(et){return typeof et>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+et)},util$6.ByteStringBuffer.prototype.at=function(et){return this.data.charCodeAt(this.read+et)},util$6.ByteStringBuffer.prototype.setAt=function(et,tt){return this.data=this.data.substr(0,this.read+et)+String.fromCharCode(tt)+this.data.substr(this.read+et+1),this},util$6.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},util$6.ByteStringBuffer.prototype.copy=function(){var et=util$6.createBuffer(this.data);return et.read=this.read,et},util$6.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},util$6.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},util$6.ByteStringBuffer.prototype.truncate=function(et){var tt=Math.max(0,this.length()-et);return this.data=this.data.substr(this.read,tt),this.read=0,this},util$6.ByteStringBuffer.prototype.toHex=function(){for(var et="",tt=this.read;tt<this.data.length;++tt){var rt=this.data.charCodeAt(tt);rt<16&&(et+="0"),et+=rt.toString(16)}return et},util$6.ByteStringBuffer.prototype.toString=function(){return util$6.decodeUtf8(this.bytes())};function DataBuffer$1(et,tt){tt=tt||{},this.read=tt.readOffset||0,this.growSize=tt.growSize||1024;var rt=util$6.isArrayBuffer(et),nt=util$6.isArrayBufferView(et);if(rt||nt){rt?this.data=new DataView(et):this.data=new DataView(et.buffer,et.byteOffset,et.byteLength),this.write="writeOffset"in tt?tt.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,et!=null&&this.putBytes(et),"writeOffset"in tt&&(this.write=tt.writeOffset)}util$6.DataBuffer=DataBuffer$1,util$6.DataBuffer.prototype.length=function(){return this.write-this.read},util$6.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},util$6.DataBuffer.prototype.accommodate=function(et,tt){if(this.length()>=et)return this;tt=Math.max(tt||this.growSize,et);var rt=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),nt=new Uint8Array(this.length()+tt);return nt.set(rt),this.data=new DataView(nt.buffer),this},util$6.DataBuffer.prototype.putByte=function(et){return this.accommodate(1),this.data.setUint8(this.write++,et),this},util$6.DataBuffer.prototype.fillWithByte=function(et,tt){this.accommodate(tt);for(var rt=0;rt<tt;++rt)this.data.setUint8(et);return this},util$6.DataBuffer.prototype.putBytes=function(et,tt){if(util$6.isArrayBufferView(et)){var rt=new Uint8Array(et.buffer,et.byteOffset,et.byteLength),nt=rt.byteLength-rt.byteOffset;this.accommodate(nt);var it=new Uint8Array(this.data.buffer,this.write);return it.set(rt),this.write+=nt,this}if(util$6.isArrayBuffer(et)){var rt=new Uint8Array(et);this.accommodate(rt.byteLength);var it=new Uint8Array(this.data.buffer);return it.set(rt,this.write),this.write+=rt.byteLength,this}if(et instanceof util$6.DataBuffer||typeof et=="object"&&typeof et.read=="number"&&typeof et.write=="number"&&util$6.isArrayBufferView(et.data)){var rt=new Uint8Array(et.data.byteLength,et.read,et.length());this.accommodate(rt.byteLength);var it=new Uint8Array(et.data.byteLength,this.write);return it.set(rt),this.write+=rt.byteLength,this}if(et instanceof util$6.ByteStringBuffer&&(et=et.data,tt="binary"),tt=tt||"binary",typeof et=="string"){var ot;if(tt==="hex")return this.accommodate(Math.ceil(et.length/2)),ot=new Uint8Array(this.data.buffer,this.write),this.write+=util$6.binary.hex.decode(et,ot,this.write),this;if(tt==="base64")return this.accommodate(Math.ceil(et.length/4)*3),ot=new Uint8Array(this.data.buffer,this.write),this.write+=util$6.binary.base64.decode(et,ot,this.write),this;if(tt==="utf8"&&(et=util$6.encodeUtf8(et),tt="binary"),tt==="binary"||tt==="raw")return this.accommodate(et.length),ot=new Uint8Array(this.data.buffer,this.write),this.write+=util$6.binary.raw.decode(ot),this;if(tt==="utf16")return this.accommodate(et.length*2),ot=new Uint16Array(this.data.buffer,this.write),this.write+=util$6.text.utf16.encode(ot),this;throw new Error("Invalid encoding: "+tt)}throw Error("Invalid parameter: "+et)},util$6.DataBuffer.prototype.putBuffer=function(et){return this.putBytes(et),et.clear(),this},util$6.DataBuffer.prototype.putString=function(et){return this.putBytes(et,"utf16")},util$6.DataBuffer.prototype.putInt16=function(et){return this.accommodate(2),this.data.setInt16(this.write,et),this.write+=2,this},util$6.DataBuffer.prototype.putInt24=function(et){return this.accommodate(3),this.data.setInt16(this.write,et>>8&65535),this.data.setInt8(this.write,et>>16&255),this.write+=3,this},util$6.DataBuffer.prototype.putInt32=function(et){return this.accommodate(4),this.data.setInt32(this.write,et),this.write+=4,this},util$6.DataBuffer.prototype.putInt16Le=function(et){return this.accommodate(2),this.data.setInt16(this.write,et,!0),this.write+=2,this},util$6.DataBuffer.prototype.putInt24Le=function(et){return this.accommodate(3),this.data.setInt8(this.write,et>>16&255),this.data.setInt16(this.write,et>>8&65535,!0),this.write+=3,this},util$6.DataBuffer.prototype.putInt32Le=function(et){return this.accommodate(4),this.data.setInt32(this.write,et,!0),this.write+=4,this},util$6.DataBuffer.prototype.putInt=function(et,tt){_checkBitsParam$1(tt),this.accommodate(tt/8);do tt-=8,this.data.setInt8(this.write++,et>>tt&255);while(tt>0);return this},util$6.DataBuffer.prototype.putSignedInt=function(et,tt){return _checkBitsParam$1(tt),this.accommodate(tt/8),et<0&&(et+=2<<tt-1),this.putInt(et,tt)},util$6.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},util$6.DataBuffer.prototype.getInt16=function(){var et=this.data.getInt16(this.read);return this.read+=2,et},util$6.DataBuffer.prototype.getInt24=function(){var et=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,et},util$6.DataBuffer.prototype.getInt32=function(){var et=this.data.getInt32(this.read);return this.read+=4,et},util$6.DataBuffer.prototype.getInt16Le=function(){var et=this.data.getInt16(this.read,!0);return this.read+=2,et},util$6.DataBuffer.prototype.getInt24Le=function(){var et=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,et},util$6.DataBuffer.prototype.getInt32Le=function(){var et=this.data.getInt32(this.read,!0);return this.read+=4,et},util$6.DataBuffer.prototype.getInt=function(et){_checkBitsParam$1(et);var tt=0;do tt=(tt<<8)+this.data.getInt8(this.read++),et-=8;while(et>0);return tt},util$6.DataBuffer.prototype.getSignedInt=function(et){var tt=this.getInt(et),rt=2<<et-2;return tt>=rt&&(tt-=rt<<1),tt},util$6.DataBuffer.prototype.getBytes=function(et){var tt;return et?(et=Math.min(this.length(),et),tt=this.data.slice(this.read,this.read+et),this.read+=et):et===0?tt="":(tt=this.read===0?this.data:this.data.slice(this.read),this.clear()),tt},util$6.DataBuffer.prototype.bytes=function(et){return typeof et>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+et)},util$6.DataBuffer.prototype.at=function(et){return this.data.getUint8(this.read+et)},util$6.DataBuffer.prototype.setAt=function(et,tt){return this.data.setUint8(et,tt),this},util$6.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},util$6.DataBuffer.prototype.copy=function(){return new util$6.DataBuffer(this)},util$6.DataBuffer.prototype.compact=function(){if(this.read>0){var et=new Uint8Array(this.data.buffer,this.read),tt=new Uint8Array(et.byteLength);tt.set(et),this.data=new DataView(tt),this.write-=this.read,this.read=0}return this},util$6.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},util$6.DataBuffer.prototype.truncate=function(et){return this.write=Math.max(0,this.length()-et),this.read=Math.min(this.read,this.write),this},util$6.DataBuffer.prototype.toHex=function(){for(var et="",tt=this.read;tt<this.data.byteLength;++tt){var rt=this.data.getUint8(tt);rt<16&&(et+="0"),et+=rt.toString(16)}return et},util$6.DataBuffer.prototype.toString=function(et){var tt=new Uint8Array(this.data,this.read,this.length());if(et=et||"utf8",et==="binary"||et==="raw")return util$6.binary.raw.encode(tt);if(et==="hex")return util$6.binary.hex.encode(tt);if(et==="base64")return util$6.binary.base64.encode(tt);if(et==="utf8")return util$6.text.utf8.decode(tt);if(et==="utf16")return util$6.text.utf16.decode(tt);throw new Error("Invalid encoding: "+et)},util$6.createBuffer=function(et,tt){return tt=tt||"raw",et!==void 0&&tt==="utf8"&&(et=util$6.encodeUtf8(et)),new util$6.ByteBuffer(et)},util$6.fillString=function(et,tt){for(var rt="";tt>0;)tt&1&&(rt+=et),tt>>>=1,tt>0&&(et+=et);return rt},util$6.xorBytes=function(et,tt,rt){for(var nt="",it="",ot="",st=0,at=0;rt>0;--rt,++st)it=et.charCodeAt(st)^tt.charCodeAt(st),at>=10&&(nt+=ot,ot="",at=0),ot+=String.fromCharCode(it),++at;return nt+=ot,nt},util$6.hexToBytes=function(et){var tt="",rt=0;for(et.length&!0&&(rt=1,tt+=String.fromCharCode(parseInt(et[0],16)));rt<et.length;rt+=2)tt+=String.fromCharCode(parseInt(et.substr(rt,2),16));return tt},util$6.bytesToHex=function(et){return util$6.createBuffer(et).toHex()},util$6.int32ToBytes=function(et){return String.fromCharCode(et>>24&255)+String.fromCharCode(et>>16&255)+String.fromCharCode(et>>8&255)+String.fromCharCode(et&255)};var _base64$1="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_base64Idx$1=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],_base58$1="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";util$6.encode64=function(et,tt){for(var rt="",nt="",it,ot,st,at=0;at<et.length;)it=et.charCodeAt(at++),ot=et.charCodeAt(at++),st=et.charCodeAt(at++),rt+=_base64$1.charAt(it>>2),rt+=_base64$1.charAt((it&3)<<4|ot>>4),isNaN(ot)?rt+="==":(rt+=_base64$1.charAt((ot&15)<<2|st>>6),rt+=isNaN(st)?"=":_base64$1.charAt(st&63)),tt&&rt.length>tt&&(nt+=rt.substr(0,tt)+`\r
`,rt=rt.substr(tt));return nt+=rt,nt},util$6.decode64=function(et){et=et.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var tt="",rt,nt,it,ot,st=0;st<et.length;)rt=_base64Idx$1[et.charCodeAt(st++)-43],nt=_base64Idx$1[et.charCodeAt(st++)-43],it=_base64Idx$1[et.charCodeAt(st++)-43],ot=_base64Idx$1[et.charCodeAt(st++)-43],tt+=String.fromCharCode(rt<<2|nt>>4),it!==64&&(tt+=String.fromCharCode((nt&15)<<4|it>>2),ot!==64&&(tt+=String.fromCharCode((it&3)<<6|ot)));return tt},util$6.encodeUtf8=function(et){return unescape(encodeURIComponent(et))},util$6.decodeUtf8=function(et){return decodeURIComponent(escape(et))},util$6.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:baseN$2.encode,decode:baseN$2.decode}},util$6.binary.raw.encode=function(et){return String.fromCharCode.apply(null,et)},util$6.binary.raw.decode=function(et,tt,rt){var nt=tt;nt||(nt=new Uint8Array(et.length)),rt=rt||0;for(var it=rt,ot=0;ot<et.length;++ot)nt[it++]=et.charCodeAt(ot);return tt?it-rt:nt},util$6.binary.hex.encode=util$6.bytesToHex,util$6.binary.hex.decode=function(et,tt,rt){var nt=tt;nt||(nt=new Uint8Array(Math.ceil(et.length/2))),rt=rt||0;var it=0,ot=rt;for(et.length&1&&(it=1,nt[ot++]=parseInt(et[0],16));it<et.length;it+=2)nt[ot++]=parseInt(et.substr(it,2),16);return tt?ot-rt:nt},util$6.binary.base64.encode=function(et,tt){for(var rt="",nt="",it,ot,st,at=0;at<et.byteLength;)it=et[at++],ot=et[at++],st=et[at++],rt+=_base64$1.charAt(it>>2),rt+=_base64$1.charAt((it&3)<<4|ot>>4),isNaN(ot)?rt+="==":(rt+=_base64$1.charAt((ot&15)<<2|st>>6),rt+=isNaN(st)?"=":_base64$1.charAt(st&63)),tt&&rt.length>tt&&(nt+=rt.substr(0,tt)+`\r
`,rt=rt.substr(tt));return nt+=rt,nt},util$6.binary.base64.decode=function(et,tt,rt){var nt=tt;nt||(nt=new Uint8Array(Math.ceil(et.length/4)*3)),et=et.replace(/[^A-Za-z0-9\+\/\=]/g,""),rt=rt||0;for(var it,ot,st,at,ct=0,ut=rt;ct<et.length;)it=_base64Idx$1[et.charCodeAt(ct++)-43],ot=_base64Idx$1[et.charCodeAt(ct++)-43],st=_base64Idx$1[et.charCodeAt(ct++)-43],at=_base64Idx$1[et.charCodeAt(ct++)-43],nt[ut++]=it<<2|ot>>4,st!==64&&(nt[ut++]=(ot&15)<<4|st>>2,at!==64&&(nt[ut++]=(st&3)<<6|at));return tt?ut-rt:nt.subarray(0,ut)},util$6.binary.base58.encode=function(et,tt){return util$6.binary.baseN.encode(et,_base58$1,tt)},util$6.binary.base58.decode=function(et,tt){return util$6.binary.baseN.decode(et,_base58$1,tt)},util$6.text={utf8:{},utf16:{}},util$6.text.utf8.encode=function(et,tt,rt){et=util$6.encodeUtf8(et);var nt=tt;nt||(nt=new Uint8Array(et.length)),rt=rt||0;for(var it=rt,ot=0;ot<et.length;++ot)nt[it++]=et.charCodeAt(ot);return tt?it-rt:nt},util$6.text.utf8.decode=function(et){return util$6.decodeUtf8(String.fromCharCode.apply(null,et))},util$6.text.utf16.encode=function(et,tt,rt){var nt=tt;nt||(nt=new Uint8Array(et.length*2));var it=new Uint16Array(nt.buffer);rt=rt||0;for(var ot=rt,st=rt,at=0;at<et.length;++at)it[st++]=et.charCodeAt(at),ot+=2;return tt?ot-rt:nt},util$6.text.utf16.decode=function(et){return String.fromCharCode.apply(null,new Uint16Array(et.buffer))},util$6.deflate=function(et,tt,rt){if(tt=util$6.decode64(et.deflate(util$6.encode64(tt)).rval),rt){var nt=2,it=tt.charCodeAt(1);it&32&&(nt=6),tt=tt.substring(nt,tt.length-4)}return tt},util$6.inflate=function(et,tt,rt){var nt=et.inflate(util$6.encode64(tt)).rval;return nt===null?null:util$6.decode64(nt)};var _setStorageObject$1=function(et,tt,rt){if(!et)throw new Error("WebStorage not available.");var nt;if(rt===null?nt=et.removeItem(tt):(rt=util$6.encode64(JSON.stringify(rt)),nt=et.setItem(tt,rt)),typeof nt<"u"&&nt.rval!==!0){var it=new Error(nt.error.message);throw it.id=nt.error.id,it.name=nt.error.name,it}},_getStorageObject$1=function(et,tt){if(!et)throw new Error("WebStorage not available.");var rt=et.getItem(tt);if(et.init)if(rt.rval===null){if(rt.error){var nt=new Error(rt.error.message);throw nt.id=rt.error.id,nt.name=rt.error.name,nt}rt=null}else rt=rt.rval;return rt!==null&&(rt=JSON.parse(util$6.decode64(rt))),rt},_setItem$1=function(et,tt,rt,nt){var it=_getStorageObject$1(et,tt);it===null&&(it={}),it[rt]=nt,_setStorageObject$1(et,tt,it)},_getItem$1=function(et,tt,rt){var nt=_getStorageObject$1(et,tt);return nt!==null&&(nt=rt in nt?nt[rt]:null),nt},_removeItem$1=function(et,tt,rt){var nt=_getStorageObject$1(et,tt);if(nt!==null&&rt in nt){delete nt[rt];var it=!0;for(var ot in nt){it=!1;break}it&&(nt=null),_setStorageObject$1(et,tt,nt)}},_clearItems$1=function(et,tt){_setStorageObject$1(et,tt,null)},_callStorageFunction$1=function(et,tt,rt){var nt=null;typeof rt>"u"&&(rt=["web","flash"]);var it,ot=!1,st=null;for(var at in rt){it=rt[at];try{if(it==="flash"||it==="both"){if(tt[0]===null)throw new Error("Flash local storage not available.");nt=et.apply(this,tt),ot=it==="flash"}(it==="web"||it==="both")&&(tt[0]=localStorage,nt=et.apply(this,tt),ot=!0)}catch(ct){st=ct}if(ot)break}if(!ot)throw st;return nt};util$6.setItem=function(et,tt,rt,nt,it){_callStorageFunction$1(_setItem$1,arguments,it)},util$6.getItem=function(et,tt,rt,nt){return _callStorageFunction$1(_getItem$1,arguments,nt)},util$6.removeItem=function(et,tt,rt,nt){_callStorageFunction$1(_removeItem$1,arguments,nt)},util$6.clearItems=function(et,tt,rt){_callStorageFunction$1(_clearItems$1,arguments,rt)},util$6.parseUrl=function(et){var tt=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;tt.lastIndex=0;var rt=tt.exec(et),nt=rt===null?null:{full:et,scheme:rt[1],host:rt[2],port:rt[3],path:rt[4]};return nt&&(nt.fullHost=nt.host,nt.port?(nt.port!==80&&nt.scheme==="http"||nt.port!==443&&nt.scheme==="https")&&(nt.fullHost+=":"+nt.port):nt.scheme==="http"?nt.port=80:nt.scheme==="https"&&(nt.port=443),nt.full=nt.scheme+"://"+nt.fullHost),nt};var _queryVariables=null;util$6.getQueryVariables=function(et){var tt=function(nt){for(var it={},ot=nt.split("&"),st=0;st<ot.length;st++){var at=ot[st].indexOf("="),ct,ut;at>0?(ct=ot[st].substring(0,at),ut=ot[st].substring(at+1)):(ct=ot[st],ut=null),ct in it||(it[ct]=[]),!(ct in Object.prototype)&&ut!==null&&it[ct].push(unescape(ut))}return it},rt;return typeof et>"u"?(_queryVariables===null&&(typeof window<"u"&&window.location&&window.location.search?_queryVariables=tt(window.location.search.substring(1)):_queryVariables={}),rt=_queryVariables):rt=tt(et),rt},util$6.parseFragment=function(et){var tt=et,rt="",nt=et.indexOf("?");nt>0&&(tt=et.substring(0,nt),rt=et.substring(nt+1));var it=tt.split("/");it.length>0&&it[0]===""&&it.shift();var ot=rt===""?{}:util$6.getQueryVariables(rt);return{pathString:tt,queryString:rt,path:it,query:ot}},util$6.makeRequest=function(et){var tt=util$6.parseFragment(et),rt={path:tt.pathString,query:tt.queryString,getPath:function(nt){return typeof nt>"u"?tt.path:tt.path[nt]},getQuery:function(nt,it){var ot;return typeof nt>"u"?ot=tt.query:(ot=tt.query[nt],ot&&typeof it<"u"&&(ot=ot[it])),ot},getQueryLast:function(nt,it){var ot,st=rt.getQuery(nt);return st?ot=st[st.length-1]:ot=it,ot}};return rt},util$6.makeLink=function(et,tt,rt){et=jQuery.isArray(et)?et.join("/"):et;var nt=jQuery.param(tt||{});return rt=rt||"",et+(nt.length>0?"?"+nt:"")+(rt.length>0?"#"+rt:"")},util$6.isEmpty=function(et){for(var tt in et)if(et.hasOwnProperty(tt))return!1;return!0},util$6.format=function(et){for(var tt=/%./g,rt,nt,it=0,ot=[],st=0;rt=tt.exec(et);){nt=et.substring(st,tt.lastIndex-2),nt.length>0&&ot.push(nt),st=tt.lastIndex;var at=rt[0][1];switch(at){case"s":case"o":it<arguments.length?ot.push(arguments[it+++1]):ot.push("<?>");break;case"%":ot.push("%");break;default:ot.push("<%"+at+"?>")}}return ot.push(et.substring(st)),ot.join("")},util$6.formatNumber=function(et,tt,rt,nt){var it=et,ot=isNaN(tt=Math.abs(tt))?2:tt,st=rt===void 0?",":rt,at=nt===void 0?".":nt,ct=it<0?"-":"",ut=parseInt(it=Math.abs(+it||0).toFixed(ot),10)+"",lt=ut.length>3?ut.length%3:0;return ct+(lt?ut.substr(0,lt)+at:"")+ut.substr(lt).replace(/(\d{3})(?=\d)/g,"$1"+at)+(ot?st+Math.abs(it-ut).toFixed(ot).slice(2):"")},util$6.formatSize=function(et){return et>=1073741824?et=util$6.formatNumber(et/1073741824,2,".","")+" GiB":et>=1048576?et=util$6.formatNumber(et/1048576,2,".","")+" MiB":et>=1024?et=util$6.formatNumber(et/1024,0)+" KiB":et=util$6.formatNumber(et,0)+" bytes",et},util$6.bytesFromIP=function(et){return et.indexOf(".")!==-1?util$6.bytesFromIPv4(et):et.indexOf(":")!==-1?util$6.bytesFromIPv6(et):null},util$6.bytesFromIPv4=function(et){if(et=et.split("."),et.length!==4)return null;for(var tt=util$6.createBuffer(),rt=0;rt<et.length;++rt){var nt=parseInt(et[rt],10);if(isNaN(nt))return null;tt.putByte(nt)}return tt.getBytes()},util$6.bytesFromIPv6=function(et){var tt=0;et=et.split(":").filter(function(st){return st.length===0&&++tt,!0});for(var rt=(8-et.length+tt)*2,nt=util$6.createBuffer(),it=0;it<8;++it){if(!et[it]||et[it].length===0){nt.fillWithByte(0,rt),rt=0;continue}var ot=util$6.hexToBytes(et[it]);ot.length<2&&nt.putByte(0),nt.putBytes(ot)}return nt.getBytes()},util$6.bytesToIP=function(et){return et.length===4?util$6.bytesToIPv4(et):et.length===16?util$6.bytesToIPv6(et):null},util$6.bytesToIPv4=function(et){if(et.length!==4)return null;for(var tt=[],rt=0;rt<et.length;++rt)tt.push(et.charCodeAt(rt));return tt.join(".")},util$6.bytesToIPv6=function(et){if(et.length!==16)return null;for(var tt=[],rt=[],nt=0,it=0;it<et.length;it+=2){for(var ot=util$6.bytesToHex(et[it]+et[it+1]);ot[0]==="0"&&ot!=="0";)ot=ot.substr(1);if(ot==="0"){var st=rt[rt.length-1],at=tt.length;!st||at!==st.end+1?rt.push({start:at,end:at}):(st.end=at,st.end-st.start>rt[nt].end-rt[nt].start&&(nt=rt.length-1))}tt.push(ot)}if(rt.length>0){var ct=rt[nt];ct.end-ct.start>0&&(tt.splice(ct.start,ct.end-ct.start+1,""),ct.start===0&&tt.unshift(""),ct.end===7&&tt.push(""))}return tt.join(":")},util$6.estimateCores=function(et,tt){if(typeof et=="function"&&(tt=et,et={}),et=et||{},"cores"in util$6&&!et.update)return tt(null,util$6.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return util$6.cores=navigator.hardwareConcurrency,tt(null,util$6.cores);if(typeof Worker>"u")return util$6.cores=1,tt(null,util$6.cores);if(typeof Blob>"u")return util$6.cores=2,tt(null,util$6.cores);var rt=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(st){var at=Date.now(),ct=at+4;self.postMessage({st:at,et:ct})})}.toString(),")()"],{type:"application/javascript"}));nt([],5,16);function nt(st,at,ct){if(at===0){var ut=Math.floor(st.reduce(function(lt,ht){return lt+ht},0)/st.length);return util$6.cores=Math.max(1,ut),URL.revokeObjectURL(rt),tt(null,util$6.cores)}it(ct,function(lt,ht){st.push(ot(ct,ht)),nt(st,at-1,ct)})}function it(st,at){for(var ct=[],ut=[],lt=0;lt<st;++lt){var ht=new Worker(rt);ht.addEventListener("message",function(ft){if(ut.push(ft.data),ut.length===st){for(var dt=0;dt<st;++dt)ct[dt].terminate();at(null,ut)}}),ct.push(ht)}for(var lt=0;lt<st;++lt)ct[lt].postMessage(lt)}function ot(st,at){for(var ct=[],ut=0;ut<st;++ut)for(var lt=at[ut],ht=ct[ut]=[],ft=0;ft<st;++ft)if(ut!==ft){var dt=at[ft];(lt.st>dt.st&&lt.st<dt.et||dt.st>lt.st&&dt.st<lt.et)&&ht.push(ft)}return ct.reduce(function(pt,gt){return Math.max(pt,gt.length)},0)}};var utilExports=util$7.exports,forge$U=forge$W;forge$U.pki=forge$U.pki||{};var oids$3=forge$U.pki.oids=forge$U.oids=forge$U.oids||{};function _IN$1(et,tt){oids$3[et]=tt,oids$3[tt]=et}function _I_$1(et,tt){oids$3[et]=tt}_IN$1("1.2.840.113549.1.1.1","rsaEncryption"),_IN$1("1.2.840.113549.1.1.4","md5WithRSAEncryption"),_IN$1("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),_IN$1("1.2.840.113549.1.1.7","RSAES-OAEP"),_IN$1("1.2.840.113549.1.1.8","mgf1"),_IN$1("1.2.840.113549.1.1.9","pSpecified"),_IN$1("1.2.840.113549.1.1.10","RSASSA-PSS"),_IN$1("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),_IN$1("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),_IN$1("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),_IN$1("1.3.101.112","EdDSA25519"),_IN$1("1.2.840.10040.4.3","dsa-with-sha1"),_IN$1("1.3.14.3.2.7","desCBC"),_IN$1("1.3.14.3.2.26","sha1"),_IN$1("2.16.840.1.101.3.4.2.1","sha256"),_IN$1("2.16.840.1.101.3.4.2.2","sha384"),_IN$1("2.16.840.1.101.3.4.2.3","sha512"),_IN$1("1.2.840.113549.2.5","md5"),_IN$1("1.2.840.113549.1.7.1","data"),_IN$1("1.2.840.113549.1.7.2","signedData"),_IN$1("1.2.840.113549.1.7.3","envelopedData"),_IN$1("1.2.840.113549.1.7.4","signedAndEnvelopedData"),_IN$1("1.2.840.113549.1.7.5","digestedData"),_IN$1("1.2.840.113549.1.7.6","encryptedData"),_IN$1("1.2.840.113549.1.9.1","emailAddress"),_IN$1("1.2.840.113549.1.9.2","unstructuredName"),_IN$1("1.2.840.113549.1.9.3","contentType"),_IN$1("1.2.840.113549.1.9.4","messageDigest"),_IN$1("1.2.840.113549.1.9.5","signingTime"),_IN$1("1.2.840.113549.1.9.6","counterSignature"),_IN$1("1.2.840.113549.1.9.7","challengePassword"),_IN$1("1.2.840.113549.1.9.8","unstructuredAddress"),_IN$1("1.2.840.113549.1.9.14","extensionRequest"),_IN$1("1.2.840.113549.1.9.20","friendlyName"),_IN$1("1.2.840.113549.1.9.21","localKeyId"),_IN$1("1.2.840.113549.1.9.22.1","x509Certificate"),_IN$1("1.2.840.113549.1.12.10.1.1","keyBag"),_IN$1("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),_IN$1("1.2.840.113549.1.12.10.1.3","certBag"),_IN$1("1.2.840.113549.1.12.10.1.4","crlBag"),_IN$1("1.2.840.113549.1.12.10.1.5","secretBag"),_IN$1("1.2.840.113549.1.12.10.1.6","safeContentsBag"),_IN$1("1.2.840.113549.1.5.13","pkcs5PBES2"),_IN$1("1.2.840.113549.1.5.12","pkcs5PBKDF2"),_IN$1("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),_IN$1("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),_IN$1("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),_IN$1("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),_IN$1("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),_IN$1("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),_IN$1("1.2.840.113549.2.7","hmacWithSHA1"),_IN$1("1.2.840.113549.2.8","hmacWithSHA224"),_IN$1("1.2.840.113549.2.9","hmacWithSHA256"),_IN$1("1.2.840.113549.2.10","hmacWithSHA384"),_IN$1("1.2.840.113549.2.11","hmacWithSHA512"),_IN$1("1.2.840.113549.3.7","des-EDE3-CBC"),_IN$1("2.16.840.1.101.3.4.1.2","aes128-CBC"),_IN$1("2.16.840.1.101.3.4.1.22","aes192-CBC"),_IN$1("2.16.840.1.101.3.4.1.42","aes256-CBC"),_IN$1("2.5.4.3","commonName"),_IN$1("2.5.4.5","serialName"),_IN$1("2.5.4.6","countryName"),_IN$1("2.5.4.7","localityName"),_IN$1("2.5.4.8","stateOrProvinceName"),_IN$1("2.5.4.9","streetAddress"),_IN$1("2.5.4.10","organizationName"),_IN$1("2.5.4.11","organizationalUnitName"),_IN$1("2.5.4.13","description"),_IN$1("2.5.4.15","businessCategory"),_IN$1("2.5.4.17","postalCode"),_IN$1("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),_IN$1("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),_IN$1("2.16.840.1.113730.1.1","nsCertType"),_IN$1("2.16.840.1.113730.1.13","nsComment"),_I_$1("2.5.29.1","authorityKeyIdentifier"),_I_$1("2.5.29.2","keyAttributes"),_I_$1("2.5.29.3","certificatePolicies"),_I_$1("2.5.29.4","keyUsageRestriction"),_I_$1("2.5.29.5","policyMapping"),_I_$1("2.5.29.6","subtreesConstraint"),_I_$1("2.5.29.7","subjectAltName"),_I_$1("2.5.29.8","issuerAltName"),_I_$1("2.5.29.9","subjectDirectoryAttributes"),_I_$1("2.5.29.10","basicConstraints"),_I_$1("2.5.29.11","nameConstraints"),_I_$1("2.5.29.12","policyConstraints"),_I_$1("2.5.29.13","basicConstraints"),_IN$1("2.5.29.14","subjectKeyIdentifier"),_IN$1("2.5.29.15","keyUsage"),_I_$1("2.5.29.16","privateKeyUsagePeriod"),_IN$1("2.5.29.17","subjectAltName"),_IN$1("2.5.29.18","issuerAltName"),_IN$1("2.5.29.19","basicConstraints"),_I_$1("2.5.29.20","cRLNumber"),_I_$1("2.5.29.21","cRLReason"),_I_$1("2.5.29.22","expirationDate"),_I_$1("2.5.29.23","instructionCode"),_I_$1("2.5.29.24","invalidityDate"),_I_$1("2.5.29.25","cRLDistributionPoints"),_I_$1("2.5.29.26","issuingDistributionPoint"),_I_$1("2.5.29.27","deltaCRLIndicator"),_I_$1("2.5.29.28","issuingDistributionPoint"),_I_$1("2.5.29.29","certificateIssuer"),_I_$1("2.5.29.30","nameConstraints"),_IN$1("2.5.29.31","cRLDistributionPoints"),_IN$1("2.5.29.32","certificatePolicies"),_I_$1("2.5.29.33","policyMappings"),_I_$1("2.5.29.34","policyConstraints"),_IN$1("2.5.29.35","authorityKeyIdentifier"),_I_$1("2.5.29.36","policyConstraints"),_IN$1("2.5.29.37","extKeyUsage"),_I_$1("2.5.29.46","freshestCRL"),_I_$1("2.5.29.54","inhibitAnyPolicy"),_IN$1("1.3.6.1.4.1.11129.2.4.2","timestampList"),_IN$1("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),_IN$1("1.3.6.1.5.5.7.3.1","serverAuth"),_IN$1("1.3.6.1.5.5.7.3.2","clientAuth"),_IN$1("1.3.6.1.5.5.7.3.3","codeSigning"),_IN$1("1.3.6.1.5.5.7.3.4","emailProtection"),_IN$1("1.3.6.1.5.5.7.3.8","timeStamping");var forge$T=forge$W,asn1$6=forge$T.asn1=forge$T.asn1||{};asn1$6.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},asn1$6.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},asn1$6.create=function(et,tt,rt,nt,it){if(forge$T.util.isArray(nt)){for(var ot=[],st=0;st<nt.length;++st)nt[st]!==void 0&&ot.push(nt[st]);nt=ot}var at={tagClass:et,type:tt,constructed:rt,composed:rt||forge$T.util.isArray(nt),value:nt};return it&&"bitStringContents"in it&&(at.bitStringContents=it.bitStringContents,at.original=asn1$6.copy(at)),at},asn1$6.copy=function(et,tt){var rt;if(forge$T.util.isArray(et)){rt=[];for(var nt=0;nt<et.length;++nt)rt.push(asn1$6.copy(et[nt],tt));return rt}return typeof et=="string"?et:(rt={tagClass:et.tagClass,type:et.type,constructed:et.constructed,composed:et.composed,value:asn1$6.copy(et.value,tt)},tt&&!tt.excludeBitStringContents&&(rt.bitStringContents=et.bitStringContents),rt)},asn1$6.equals=function(et,tt,rt){if(forge$T.util.isArray(et)){if(!forge$T.util.isArray(tt)||et.length!==tt.length)return!1;for(var nt=0;nt<et.length;++nt)if(!asn1$6.equals(et[nt],tt[nt]))return!1;return!0}if(typeof et!=typeof tt)return!1;if(typeof et=="string")return et===tt;var it=et.tagClass===tt.tagClass&&et.type===tt.type&&et.constructed===tt.constructed&&et.composed===tt.composed&&asn1$6.equals(et.value,tt.value);return rt&&rt.includeBitStringContents&&(it=it&&et.bitStringContents===tt.bitStringContents),it},asn1$6.getBerValueLength=function(et){var tt=et.getByte();if(tt!==128){var rt,nt=tt&128;return nt?rt=et.getInt((tt&127)<<3):rt=tt,rt}};function _checkBufferLength$1(et,tt,rt){if(rt>tt){var nt=new Error("Too few bytes to parse DER.");throw nt.available=et.length(),nt.remaining=tt,nt.requested=rt,nt}}var _getValueLength$1=function(et,tt){var rt=et.getByte();if(tt--,rt!==128){var nt,it=rt&128;if(!it)nt=rt;else{var ot=rt&127;_checkBufferLength$1(et,tt,ot),nt=et.getInt(ot<<3)}if(nt<0)throw new Error("Negative length: "+nt);return nt}};asn1$6.fromDer=function(et,tt){return tt===void 0&&(tt={strict:!0,decodeBitStrings:!0}),typeof tt=="boolean"&&(tt={strict:tt,decodeBitStrings:!0}),"strict"in tt||(tt.strict=!0),"decodeBitStrings"in tt||(tt.decodeBitStrings=!0),typeof et=="string"&&(et=forge$T.util.createBuffer(et)),_fromDer$1(et,et.length(),0,tt)};function _fromDer$1(et,tt,rt,nt){var it;_checkBufferLength$1(et,tt,2);var ot=et.getByte();tt--;var st=ot&192,at=ot&31;it=et.length();var ct=_getValueLength$1(et,tt);if(tt-=it-et.length(),ct!==void 0&&ct>tt){if(nt.strict){var ut=new Error("Too few bytes to read ASN.1 value.");throw ut.available=et.length(),ut.remaining=tt,ut.requested=ct,ut}ct=tt}var lt,ht,ft=(ot&32)===32;if(ft)if(lt=[],ct===void 0)for(;;){if(_checkBufferLength$1(et,tt,2),et.bytes(2)===String.fromCharCode(0,0)){et.getBytes(2),tt-=2;break}it=et.length(),lt.push(_fromDer$1(et,tt,rt+1,nt)),tt-=it-et.length()}else for(;ct>0;)it=et.length(),lt.push(_fromDer$1(et,ct,rt+1,nt)),tt-=it-et.length(),ct-=it-et.length();if(lt===void 0&&st===asn1$6.Class.UNIVERSAL&&at===asn1$6.Type.BITSTRING&&(ht=et.bytes(ct)),lt===void 0&&nt.decodeBitStrings&&st===asn1$6.Class.UNIVERSAL&&at===asn1$6.Type.BITSTRING&&ct>1){var dt=et.read,pt=tt,gt=0;if(at===asn1$6.Type.BITSTRING&&(_checkBufferLength$1(et,tt,1),gt=et.getByte(),tt--),gt===0)try{it=et.length();var _t={verbose:nt.verbose,strict:!0,decodeBitStrings:!0},mt=_fromDer$1(et,tt,rt+1,_t),At=it-et.length();tt-=At,at==asn1$6.Type.BITSTRING&&At++;var It=mt.tagClass;At===ct&&(It===asn1$6.Class.UNIVERSAL||It===asn1$6.Class.CONTEXT_SPECIFIC)&&(lt=[mt])}catch{}lt===void 0&&(et.read=dt,tt=pt)}if(lt===void 0){if(ct===void 0){if(nt.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");ct=tt}if(at===asn1$6.Type.BMPSTRING)for(lt="";ct>0;ct-=2)_checkBufferLength$1(et,tt,2),lt+=String.fromCharCode(et.getInt16()),tt-=2;else lt=et.getBytes(ct)}var Mt=ht===void 0?null:{bitStringContents:ht};return asn1$6.create(st,at,ft,lt,Mt)}asn1$6.toDer=function(et){var tt=forge$T.util.createBuffer(),rt=et.tagClass|et.type,nt=forge$T.util.createBuffer(),it=!1;if("bitStringContents"in et&&(it=!0,et.original&&(it=asn1$6.equals(et,et.original))),it)nt.putBytes(et.bitStringContents);else if(et.composed){et.constructed?rt|=32:nt.putByte(0);for(var ot=0;ot<et.value.length;++ot)et.value[ot]!==void 0&&nt.putBuffer(asn1$6.toDer(et.value[ot]))}else if(et.type===asn1$6.Type.BMPSTRING)for(var ot=0;ot<et.value.length;++ot)nt.putInt16(et.value.charCodeAt(ot));else et.type===asn1$6.Type.INTEGER&&et.value.length>1&&(et.value.charCodeAt(0)===0&&!(et.value.charCodeAt(1)&128)||et.value.charCodeAt(0)===255&&(et.value.charCodeAt(1)&128)===128)?nt.putBytes(et.value.substr(1)):nt.putBytes(et.value);if(tt.putByte(rt),nt.length()<=127)tt.putByte(nt.length()&127);else{var st=nt.length(),at="";do at+=String.fromCharCode(st&255),st=st>>>8;while(st>0);tt.putByte(at.length|128);for(var ot=at.length-1;ot>=0;--ot)tt.putByte(at.charCodeAt(ot))}return tt.putBuffer(nt),tt},asn1$6.oidToDer=function(et){var tt=et.split("."),rt=forge$T.util.createBuffer();rt.putByte(40*parseInt(tt[0],10)+parseInt(tt[1],10));for(var nt,it,ot,st,at=2;at<tt.length;++at){nt=!0,it=[],ot=parseInt(tt[at],10);do st=ot&127,ot=ot>>>7,nt||(st|=128),it.push(st),nt=!1;while(ot>0);for(var ct=it.length-1;ct>=0;--ct)rt.putByte(it[ct])}return rt},asn1$6.derToOid=function(et){var tt;typeof et=="string"&&(et=forge$T.util.createBuffer(et));var rt=et.getByte();tt=Math.floor(rt/40)+"."+rt%40;for(var nt=0;et.length()>0;)rt=et.getByte(),nt=nt<<7,rt&128?nt+=rt&127:(tt+="."+(nt+rt),nt=0);return tt},asn1$6.utcTimeToDate=function(et){var tt=new Date,rt=parseInt(et.substr(0,2),10);rt=rt>=50?1900+rt:2e3+rt;var nt=parseInt(et.substr(2,2),10)-1,it=parseInt(et.substr(4,2),10),ot=parseInt(et.substr(6,2),10),st=parseInt(et.substr(8,2),10),at=0;if(et.length>11){var ct=et.charAt(10),ut=10;ct!=="+"&&ct!=="-"&&(at=parseInt(et.substr(10,2),10),ut+=2)}if(tt.setUTCFullYear(rt,nt,it),tt.setUTCHours(ot,st,at,0),ut&&(ct=et.charAt(ut),ct==="+"||ct==="-")){var lt=parseInt(et.substr(ut+1,2),10),ht=parseInt(et.substr(ut+4,2),10),ft=lt*60+ht;ft*=6e4,ct==="+"?tt.setTime(+tt-ft):tt.setTime(+tt+ft)}return tt},asn1$6.generalizedTimeToDate=function(et){var tt=new Date,rt=parseInt(et.substr(0,4),10),nt=parseInt(et.substr(4,2),10)-1,it=parseInt(et.substr(6,2),10),ot=parseInt(et.substr(8,2),10),st=parseInt(et.substr(10,2),10),at=parseInt(et.substr(12,2),10),ct=0,ut=0,lt=!1;et.charAt(et.length-1)==="Z"&&(lt=!0);var ht=et.length-5,ft=et.charAt(ht);if(ft==="+"||ft==="-"){var dt=parseInt(et.substr(ht+1,2),10),pt=parseInt(et.substr(ht+4,2),10);ut=dt*60+pt,ut*=6e4,ft==="+"&&(ut*=-1),lt=!0}return et.charAt(14)==="."&&(ct=parseFloat(et.substr(14),10)*1e3),lt?(tt.setUTCFullYear(rt,nt,it),tt.setUTCHours(ot,st,at,ct),tt.setTime(+tt+ut)):(tt.setFullYear(rt,nt,it),tt.setHours(ot,st,at,ct)),tt},asn1$6.dateToUtcTime=function(et){if(typeof et=="string")return et;var tt="",rt=[];rt.push((""+et.getUTCFullYear()).substr(2)),rt.push(""+(et.getUTCMonth()+1)),rt.push(""+et.getUTCDate()),rt.push(""+et.getUTCHours()),rt.push(""+et.getUTCMinutes()),rt.push(""+et.getUTCSeconds());for(var nt=0;nt<rt.length;++nt)rt[nt].length<2&&(tt+="0"),tt+=rt[nt];return tt+="Z",tt},asn1$6.dateToGeneralizedTime=function(et){if(typeof et=="string")return et;var tt="",rt=[];rt.push(""+et.getUTCFullYear()),rt.push(""+(et.getUTCMonth()+1)),rt.push(""+et.getUTCDate()),rt.push(""+et.getUTCHours()),rt.push(""+et.getUTCMinutes()),rt.push(""+et.getUTCSeconds());for(var nt=0;nt<rt.length;++nt)rt[nt].length<2&&(tt+="0"),tt+=rt[nt];return tt+="Z",tt},asn1$6.integerToDer=function(et){var tt=forge$T.util.createBuffer();if(et>=-128&&et<128)return tt.putSignedInt(et,8);if(et>=-32768&&et<32768)return tt.putSignedInt(et,16);if(et>=-8388608&&et<8388608)return tt.putSignedInt(et,24);if(et>=-2147483648&&et<2147483648)return tt.putSignedInt(et,32);var rt=new Error("Integer too large; max is 32-bits.");throw rt.integer=et,rt},asn1$6.derToInteger=function(et){typeof et=="string"&&(et=forge$T.util.createBuffer(et));var tt=et.length()*8;if(tt>32)throw new Error("Integer too large; max is 32-bits.");return et.getSignedInt(tt)},asn1$6.validate=function(et,tt,rt,nt){var it=!1;if((et.tagClass===tt.tagClass||typeof tt.tagClass>"u")&&(et.type===tt.type||typeof tt.type>"u"))if(et.constructed===tt.constructed||typeof tt.constructed>"u"){if(it=!0,tt.value&&forge$T.util.isArray(tt.value))for(var ot=0,st=0;it&&st<tt.value.length;++st)it=tt.value[st].optional||!1,et.value[ot]&&(it=asn1$6.validate(et.value[ot],tt.value[st],rt,nt),it?++ot:tt.value[st].optional&&(it=!0)),!it&&nt&&nt.push("["+tt.name+'] Tag class "'+tt.tagClass+'", type "'+tt.type+'" expected value length "'+tt.value.length+'", got "'+et.value.length+'"');if(it&&rt&&(tt.capture&&(rt[tt.capture]=et.value),tt.captureAsn1&&(rt[tt.captureAsn1]=et),tt.captureBitStringContents&&"bitStringContents"in et&&(rt[tt.captureBitStringContents]=et.bitStringContents),tt.captureBitStringValue&&"bitStringContents"in et))if(et.bitStringContents.length<2)rt[tt.captureBitStringValue]="";else{var at=et.bitStringContents.charCodeAt(0);if(at!==0)throw new Error("captureBitStringValue only supported for zero unused bits");rt[tt.captureBitStringValue]=et.bitStringContents.slice(1)}}else nt&&nt.push("["+tt.name+'] Expected constructed "'+tt.constructed+'", got "'+et.constructed+'"');else nt&&(et.tagClass!==tt.tagClass&&nt.push("["+tt.name+'] Expected tag class "'+tt.tagClass+'", got "'+et.tagClass+'"'),et.type!==tt.type&&nt.push("["+tt.name+'] Expected type "'+tt.type+'", got "'+et.type+'"'));return it};var _nonLatinRegex$1=/[^\\u0000-\\u00ff]/;asn1$6.prettyPrint=function(et,tt,rt){var nt="";tt=tt||0,rt=rt||2,tt>0&&(nt+=`
`);for(var it="",ot=0;ot<tt*rt;++ot)it+=" ";switch(nt+=it+"Tag: ",et.tagClass){case asn1$6.Class.UNIVERSAL:nt+="Universal:";break;case asn1$6.Class.APPLICATION:nt+="Application:";break;case asn1$6.Class.CONTEXT_SPECIFIC:nt+="Context-Specific:";break;case asn1$6.Class.PRIVATE:nt+="Private:";break}if(et.tagClass===asn1$6.Class.UNIVERSAL)switch(nt+=et.type,et.type){case asn1$6.Type.NONE:nt+=" (None)";break;case asn1$6.Type.BOOLEAN:nt+=" (Boolean)";break;case asn1$6.Type.INTEGER:nt+=" (Integer)";break;case asn1$6.Type.BITSTRING:nt+=" (Bit string)";break;case asn1$6.Type.OCTETSTRING:nt+=" (Octet string)";break;case asn1$6.Type.NULL:nt+=" (Null)";break;case asn1$6.Type.OID:nt+=" (Object Identifier)";break;case asn1$6.Type.ODESC:nt+=" (Object Descriptor)";break;case asn1$6.Type.EXTERNAL:nt+=" (External or Instance of)";break;case asn1$6.Type.REAL:nt+=" (Real)";break;case asn1$6.Type.ENUMERATED:nt+=" (Enumerated)";break;case asn1$6.Type.EMBEDDED:nt+=" (Embedded PDV)";break;case asn1$6.Type.UTF8:nt+=" (UTF8)";break;case asn1$6.Type.ROID:nt+=" (Relative Object Identifier)";break;case asn1$6.Type.SEQUENCE:nt+=" (Sequence)";break;case asn1$6.Type.SET:nt+=" (Set)";break;case asn1$6.Type.PRINTABLESTRING:nt+=" (Printable String)";break;case asn1$6.Type.IA5String:nt+=" (IA5String (ASCII))";break;case asn1$6.Type.UTCTIME:nt+=" (UTC time)";break;case asn1$6.Type.GENERALIZEDTIME:nt+=" (Generalized time)";break;case asn1$6.Type.BMPSTRING:nt+=" (BMP String)";break}else nt+=et.type;if(nt+=`
`,nt+=it+"Constructed: "+et.constructed+`
`,et.composed){for(var st=0,at="",ot=0;ot<et.value.length;++ot)et.value[ot]!==void 0&&(st+=1,at+=asn1$6.prettyPrint(et.value[ot],tt+1,rt),ot+1<et.value.length&&(at+=","));nt+=it+"Sub values: "+st+at}else{if(nt+=it+"Value: ",et.type===asn1$6.Type.OID){var ct=asn1$6.derToOid(et.value);nt+=ct,forge$T.pki&&forge$T.pki.oids&&ct in forge$T.pki.oids&&(nt+=" ("+forge$T.pki.oids[ct]+") ")}if(et.type===asn1$6.Type.INTEGER)try{nt+=asn1$6.derToInteger(et.value)}catch{nt+="0x"+forge$T.util.bytesToHex(et.value)}else if(et.type===asn1$6.Type.BITSTRING){if(et.value.length>1?nt+="0x"+forge$T.util.bytesToHex(et.value.slice(1)):nt+="(none)",et.value.length>0){var ut=et.value.charCodeAt(0);ut==1?nt+=" (1 unused bit shown)":ut>1&&(nt+=" ("+ut+" unused bits shown)")}}else et.type===asn1$6.Type.OCTETSTRING?(_nonLatinRegex$1.test(et.value)||(nt+="("+et.value+") "),nt+="0x"+forge$T.util.bytesToHex(et.value)):et.type===asn1$6.Type.UTF8?nt+=forge$T.util.decodeUtf8(et.value):et.type===asn1$6.Type.PRINTABLESTRING||et.type===asn1$6.Type.IA5String?nt+=et.value:_nonLatinRegex$1.test(et.value)?nt+="0x"+forge$T.util.bytesToHex(et.value):et.value.length===0?nt+="[null]":nt+=et.value}return nt};var forge$S=forge$W;forge$S.cipher=forge$S.cipher||{},forge$S.cipher.algorithms=forge$S.cipher.algorithms||{},forge$S.cipher.createCipher=function(et,tt){var rt=et;if(typeof rt=="string"&&(rt=forge$S.cipher.getAlgorithm(rt),rt&&(rt=rt())),!rt)throw new Error("Unsupported algorithm: "+et);return new forge$S.cipher.BlockCipher({algorithm:rt,key:tt,decrypt:!1})},forge$S.cipher.createDecipher=function(et,tt){var rt=et;if(typeof rt=="string"&&(rt=forge$S.cipher.getAlgorithm(rt),rt&&(rt=rt())),!rt)throw new Error("Unsupported algorithm: "+et);return new forge$S.cipher.BlockCipher({algorithm:rt,key:tt,decrypt:!0})},forge$S.cipher.registerAlgorithm=function(et,tt){et=et.toUpperCase(),forge$S.cipher.algorithms[et]=tt},forge$S.cipher.getAlgorithm=function(et){return et=et.toUpperCase(),et in forge$S.cipher.algorithms?forge$S.cipher.algorithms[et]:null};var BlockCipher$1=forge$S.cipher.BlockCipher=function(et){this.algorithm=et.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=et.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=et.decrypt,this.algorithm.initialize(et)};BlockCipher$1.prototype.start=function(et){et=et||{};var tt={};for(var rt in et)tt[rt]=et[rt];tt.decrypt=this._decrypt,this._finish=!1,this._input=forge$S.util.createBuffer(),this.output=et.output||forge$S.util.createBuffer(),this.mode.start(tt)},BlockCipher$1.prototype.update=function(et){for(et&&this._input.putBuffer(et);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},BlockCipher$1.prototype.finish=function(et){et&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(rt){return et(this.blockSize,rt,!1)},this.mode.unpad=function(rt){return et(this.blockSize,rt,!0)});var tt={};return tt.decrypt=this._decrypt,tt.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,tt)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,tt))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,tt))};var forge$R=forge$W;forge$R.cipher=forge$R.cipher||{};var modes$1=forge$R.cipher.modes=forge$R.cipher.modes||{};modes$1.ecb=function(et){et=et||{},this.name="ECB",this.cipher=et.cipher,this.blockSize=et.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},modes$1.ecb.prototype.start=function(et){},modes$1.ecb.prototype.encrypt=function(et,tt,rt){if(et.length()<this.blockSize&&!(rt&&et.length()>0))return!0;for(var nt=0;nt<this._ints;++nt)this._inBlock[nt]=et.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var nt=0;nt<this._ints;++nt)tt.putInt32(this._outBlock[nt])},modes$1.ecb.prototype.decrypt=function(et,tt,rt){if(et.length()<this.blockSize&&!(rt&&et.length()>0))return!0;for(var nt=0;nt<this._ints;++nt)this._inBlock[nt]=et.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var nt=0;nt<this._ints;++nt)tt.putInt32(this._outBlock[nt])},modes$1.ecb.prototype.pad=function(et,tt){var rt=et.length()===this.blockSize?this.blockSize:this.blockSize-et.length();return et.fillWithByte(rt,rt),!0},modes$1.ecb.prototype.unpad=function(et,tt){if(tt.overflow>0)return!1;var rt=et.length(),nt=et.at(rt-1);return nt>this.blockSize<<2?!1:(et.truncate(nt),!0)},modes$1.cbc=function(et){et=et||{},this.name="CBC",this.cipher=et.cipher,this.blockSize=et.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},modes$1.cbc.prototype.start=function(et){if(et.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in et)this._iv=transformIV$1(et.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")},modes$1.cbc.prototype.encrypt=function(et,tt,rt){if(et.length()<this.blockSize&&!(rt&&et.length()>0))return!0;for(var nt=0;nt<this._ints;++nt)this._inBlock[nt]=this._prev[nt]^et.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var nt=0;nt<this._ints;++nt)tt.putInt32(this._outBlock[nt]);this._prev=this._outBlock},modes$1.cbc.prototype.decrypt=function(et,tt,rt){if(et.length()<this.blockSize&&!(rt&&et.length()>0))return!0;for(var nt=0;nt<this._ints;++nt)this._inBlock[nt]=et.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var nt=0;nt<this._ints;++nt)tt.putInt32(this._prev[nt]^this._outBlock[nt]);this._prev=this._inBlock.slice(0)},modes$1.cbc.prototype.pad=function(et,tt){var rt=et.length()===this.blockSize?this.blockSize:this.blockSize-et.length();return et.fillWithByte(rt,rt),!0},modes$1.cbc.prototype.unpad=function(et,tt){if(tt.overflow>0)return!1;var rt=et.length(),nt=et.at(rt-1);return nt>this.blockSize<<2?!1:(et.truncate(nt),!0)},modes$1.cfb=function(et){et=et||{},this.name="CFB",this.cipher=et.cipher,this.blockSize=et.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=forge$R.util.createBuffer(),this._partialBytes=0},modes$1.cfb.prototype.start=function(et){if(!("iv"in et))throw new Error("Invalid IV parameter.");this._iv=transformIV$1(et.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},modes$1.cfb.prototype.encrypt=function(et,tt,rt){var nt=et.length();if(nt===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&nt>=this.blockSize){for(var it=0;it<this._ints;++it)this._inBlock[it]=et.getInt32()^this._outBlock[it],tt.putInt32(this._inBlock[it]);return}var ot=(this.blockSize-nt)%this.blockSize;ot>0&&(ot=this.blockSize-ot),this._partialOutput.clear();for(var it=0;it<this._ints;++it)this._partialBlock[it]=et.getInt32()^this._outBlock[it],this._partialOutput.putInt32(this._partialBlock[it]);if(ot>0)et.read-=this.blockSize;else for(var it=0;it<this._ints;++it)this._inBlock[it]=this._partialBlock[it];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),ot>0&&!rt)return tt.putBytes(this._partialOutput.getBytes(ot-this._partialBytes)),this._partialBytes=ot,!0;tt.putBytes(this._partialOutput.getBytes(nt-this._partialBytes)),this._partialBytes=0},modes$1.cfb.prototype.decrypt=function(et,tt,rt){var nt=et.length();if(nt===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&nt>=this.blockSize){for(var it=0;it<this._ints;++it)this._inBlock[it]=et.getInt32(),tt.putInt32(this._inBlock[it]^this._outBlock[it]);return}var ot=(this.blockSize-nt)%this.blockSize;ot>0&&(ot=this.blockSize-ot),this._partialOutput.clear();for(var it=0;it<this._ints;++it)this._partialBlock[it]=et.getInt32(),this._partialOutput.putInt32(this._partialBlock[it]^this._outBlock[it]);if(ot>0)et.read-=this.blockSize;else for(var it=0;it<this._ints;++it)this._inBlock[it]=this._partialBlock[it];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),ot>0&&!rt)return tt.putBytes(this._partialOutput.getBytes(ot-this._partialBytes)),this._partialBytes=ot,!0;tt.putBytes(this._partialOutput.getBytes(nt-this._partialBytes)),this._partialBytes=0},modes$1.ofb=function(et){et=et||{},this.name="OFB",this.cipher=et.cipher,this.blockSize=et.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=forge$R.util.createBuffer(),this._partialBytes=0},modes$1.ofb.prototype.start=function(et){if(!("iv"in et))throw new Error("Invalid IV parameter.");this._iv=transformIV$1(et.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},modes$1.ofb.prototype.encrypt=function(et,tt,rt){var nt=et.length();if(et.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&nt>=this.blockSize){for(var it=0;it<this._ints;++it)tt.putInt32(et.getInt32()^this._outBlock[it]),this._inBlock[it]=this._outBlock[it];return}var ot=(this.blockSize-nt)%this.blockSize;ot>0&&(ot=this.blockSize-ot),this._partialOutput.clear();for(var it=0;it<this._ints;++it)this._partialOutput.putInt32(et.getInt32()^this._outBlock[it]);if(ot>0)et.read-=this.blockSize;else for(var it=0;it<this._ints;++it)this._inBlock[it]=this._outBlock[it];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),ot>0&&!rt)return tt.putBytes(this._partialOutput.getBytes(ot-this._partialBytes)),this._partialBytes=ot,!0;tt.putBytes(this._partialOutput.getBytes(nt-this._partialBytes)),this._partialBytes=0},modes$1.ofb.prototype.decrypt=modes$1.ofb.prototype.encrypt,modes$1.ctr=function(et){et=et||{},this.name="CTR",this.cipher=et.cipher,this.blockSize=et.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=forge$R.util.createBuffer(),this._partialBytes=0},modes$1.ctr.prototype.start=function(et){if(!("iv"in et))throw new Error("Invalid IV parameter.");this._iv=transformIV$1(et.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},modes$1.ctr.prototype.encrypt=function(et,tt,rt){var nt=et.length();if(nt===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&nt>=this.blockSize)for(var it=0;it<this._ints;++it)tt.putInt32(et.getInt32()^this._outBlock[it]);else{var ot=(this.blockSize-nt)%this.blockSize;ot>0&&(ot=this.blockSize-ot),this._partialOutput.clear();for(var it=0;it<this._ints;++it)this._partialOutput.putInt32(et.getInt32()^this._outBlock[it]);if(ot>0&&(et.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),ot>0&&!rt)return tt.putBytes(this._partialOutput.getBytes(ot-this._partialBytes)),this._partialBytes=ot,!0;tt.putBytes(this._partialOutput.getBytes(nt-this._partialBytes)),this._partialBytes=0}inc32$1(this._inBlock)},modes$1.ctr.prototype.decrypt=modes$1.ctr.prototype.encrypt,modes$1.gcm=function(et){et=et||{},this.name="GCM",this.cipher=et.cipher,this.blockSize=et.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=forge$R.util.createBuffer(),this._partialBytes=0,this._R=3774873600},modes$1.gcm.prototype.start=function(et){if(!("iv"in et))throw new Error("Invalid IV parameter.");var tt=forge$R.util.createBuffer(et.iv);this._cipherLength=0;var rt;if("additionalData"in et?rt=forge$R.util.createBuffer(et.additionalData):rt=forge$R.util.createBuffer(),"tagLength"in et?this._tagLength=et.tagLength:this._tagLength=128,this._tag=null,et.decrypt&&(this._tag=forge$R.util.createBuffer(et.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var nt=tt.length();if(nt===12)this._j0=[tt.getInt32(),tt.getInt32(),tt.getInt32(),1];else{for(this._j0=[0,0,0,0];tt.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[tt.getInt32(),tt.getInt32(),tt.getInt32(),tt.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(from64To32$1(nt*8)))}this._inBlock=this._j0.slice(0),inc32$1(this._inBlock),this._partialBytes=0,rt=forge$R.util.createBuffer(rt),this._aDataLength=from64To32$1(rt.length()*8);var it=rt.length()%this.blockSize;for(it&&rt.fillWithByte(0,this.blockSize-it),this._s=[0,0,0,0];rt.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[rt.getInt32(),rt.getInt32(),rt.getInt32(),rt.getInt32()])},modes$1.gcm.prototype.encrypt=function(et,tt,rt){var nt=et.length();if(nt===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&nt>=this.blockSize){for(var it=0;it<this._ints;++it)tt.putInt32(this._outBlock[it]^=et.getInt32());this._cipherLength+=this.blockSize}else{var ot=(this.blockSize-nt)%this.blockSize;ot>0&&(ot=this.blockSize-ot),this._partialOutput.clear();for(var it=0;it<this._ints;++it)this._partialOutput.putInt32(et.getInt32()^this._outBlock[it]);if(ot<=0||rt){if(rt){var st=nt%this.blockSize;this._cipherLength+=st,this._partialOutput.truncate(this.blockSize-st)}else this._cipherLength+=this.blockSize;for(var it=0;it<this._ints;++it)this._outBlock[it]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),ot>0&&!rt)return et.read-=this.blockSize,tt.putBytes(this._partialOutput.getBytes(ot-this._partialBytes)),this._partialBytes=ot,!0;tt.putBytes(this._partialOutput.getBytes(nt-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),inc32$1(this._inBlock)},modes$1.gcm.prototype.decrypt=function(et,tt,rt){var nt=et.length();if(nt<this.blockSize&&!(rt&&nt>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),inc32$1(this._inBlock),this._hashBlock[0]=et.getInt32(),this._hashBlock[1]=et.getInt32(),this._hashBlock[2]=et.getInt32(),this._hashBlock[3]=et.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var it=0;it<this._ints;++it)tt.putInt32(this._outBlock[it]^this._hashBlock[it]);nt<this.blockSize?this._cipherLength+=nt%this.blockSize:this._cipherLength+=this.blockSize},modes$1.gcm.prototype.afterFinish=function(et,tt){var rt=!0;tt.decrypt&&tt.overflow&&et.truncate(this.blockSize-tt.overflow),this.tag=forge$R.util.createBuffer();var nt=this._aDataLength.concat(from64To32$1(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,nt);var it=[];this.cipher.encrypt(this._j0,it);for(var ot=0;ot<this._ints;++ot)this.tag.putInt32(this._s[ot]^it[ot]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),tt.decrypt&&this.tag.bytes()!==this._tag&&(rt=!1),rt},modes$1.gcm.prototype.multiply=function(et,tt){for(var rt=[0,0,0,0],nt=tt.slice(0),it=0;it<128;++it){var ot=et[it/32|0]&1<<31-it%32;ot&&(rt[0]^=nt[0],rt[1]^=nt[1],rt[2]^=nt[2],rt[3]^=nt[3]),this.pow(nt,nt)}return rt},modes$1.gcm.prototype.pow=function(et,tt){for(var rt=et[3]&1,nt=3;nt>0;--nt)tt[nt]=et[nt]>>>1|(et[nt-1]&1)<<31;tt[0]=et[0]>>>1,rt&&(tt[0]^=this._R)},modes$1.gcm.prototype.tableMultiply=function(et){for(var tt=[0,0,0,0],rt=0;rt<32;++rt){var nt=rt/8|0,it=et[nt]>>>(7-rt%8)*4&15,ot=this._m[rt][it];tt[0]^=ot[0],tt[1]^=ot[1],tt[2]^=ot[2],tt[3]^=ot[3]}return tt},modes$1.gcm.prototype.ghash=function(et,tt,rt){return tt[0]^=rt[0],tt[1]^=rt[1],tt[2]^=rt[2],tt[3]^=rt[3],this.tableMultiply(tt)},modes$1.gcm.prototype.generateHashTable=function(et,tt){for(var rt=8/tt,nt=4*rt,it=16*rt,ot=new Array(it),st=0;st<it;++st){var at=[0,0,0,0],ct=st/nt|0,ut=(nt-1-st%nt)*tt;at[ct]=1<<tt-1<<ut,ot[st]=this.generateSubHashTable(this.multiply(at,et),tt)}return ot},modes$1.gcm.prototype.generateSubHashTable=function(et,tt){var rt=1<<tt,nt=rt>>>1,it=new Array(rt);it[nt]=et.slice(0);for(var ot=nt>>>1;ot>0;)this.pow(it[2*ot],it[ot]=[]),ot>>=1;for(ot=2;ot<nt;){for(var st=1;st<ot;++st){var at=it[ot],ct=it[st];it[ot+st]=[at[0]^ct[0],at[1]^ct[1],at[2]^ct[2],at[3]^ct[3]]}ot*=2}for(it[0]=[0,0,0,0],ot=nt+1;ot<rt;++ot){var ut=it[ot^nt];it[ot]=[et[0]^ut[0],et[1]^ut[1],et[2]^ut[2],et[3]^ut[3]]}return it};function transformIV$1(et,tt){if(typeof et=="string"&&(et=forge$R.util.createBuffer(et)),forge$R.util.isArray(et)&&et.length>4){var rt=et;et=forge$R.util.createBuffer();for(var nt=0;nt<rt.length;++nt)et.putByte(rt[nt])}if(et.length()<tt)throw new Error("Invalid IV length; got "+et.length()+" bytes and expected "+tt+" bytes.");if(!forge$R.util.isArray(et)){for(var it=[],ot=tt/4,nt=0;nt<ot;++nt)it.push(et.getInt32());et=it}return et}function inc32$1(et){et[et.length-1]=et[et.length-1]+1&4294967295}function from64To32$1(et){return[et/4294967296|0,et&4294967295]}var forge$Q=forge$W;forge$Q.aes=forge$Q.aes||{},forge$Q.aes.startEncrypting=function(et,tt,rt,nt){var it=_createCipher$3({key:et,output:rt,decrypt:!1,mode:nt});return it.start(tt),it},forge$Q.aes.createEncryptionCipher=function(et,tt){return _createCipher$3({key:et,output:null,decrypt:!1,mode:tt})},forge$Q.aes.startDecrypting=function(et,tt,rt,nt){var it=_createCipher$3({key:et,output:rt,decrypt:!0,mode:nt});return it.start(tt),it},forge$Q.aes.createDecryptionCipher=function(et,tt){return _createCipher$3({key:et,output:null,decrypt:!0,mode:tt})},forge$Q.aes.Algorithm=function(et,tt){init$2||initialize$1();var rt=this;rt.name=et,rt.mode=new tt({blockSize:16,cipher:{encrypt:function(nt,it){return _updateBlock$3(rt._w,nt,it,!1)},decrypt:function(nt,it){return _updateBlock$3(rt._w,nt,it,!0)}}}),rt._init=!1},forge$Q.aes.Algorithm.prototype.initialize=function(et){if(!this._init){var tt=et.key,rt;if(typeof tt=="string"&&(tt.length===16||tt.length===24||tt.length===32))tt=forge$Q.util.createBuffer(tt);else if(forge$Q.util.isArray(tt)&&(tt.length===16||tt.length===24||tt.length===32)){rt=tt,tt=forge$Q.util.createBuffer();for(var nt=0;nt<rt.length;++nt)tt.putByte(rt[nt])}if(!forge$Q.util.isArray(tt)){rt=tt,tt=[];var it=rt.length();if(it===16||it===24||it===32){it=it>>>2;for(var nt=0;nt<it;++nt)tt.push(rt.getInt32())}}if(!forge$Q.util.isArray(tt)||!(tt.length===4||tt.length===6||tt.length===8))throw new Error("Invalid key parameter.");var ot=this.mode.name,st=["CFB","OFB","CTR","GCM"].indexOf(ot)!==-1;this._w=_expandKey$1(tt,et.decrypt&&!st),this._init=!0}},forge$Q.aes._expandKey=function(et,tt){return init$2||initialize$1(),_expandKey$1(et,tt)},forge$Q.aes._updateBlock=_updateBlock$3,registerAlgorithm$3("AES-ECB",forge$Q.cipher.modes.ecb),registerAlgorithm$3("AES-CBC",forge$Q.cipher.modes.cbc),registerAlgorithm$3("AES-CFB",forge$Q.cipher.modes.cfb),registerAlgorithm$3("AES-OFB",forge$Q.cipher.modes.ofb),registerAlgorithm$3("AES-CTR",forge$Q.cipher.modes.ctr),registerAlgorithm$3("AES-GCM",forge$Q.cipher.modes.gcm);function registerAlgorithm$3(et,tt){var rt=function(){return new forge$Q.aes.Algorithm(et,tt)};forge$Q.cipher.registerAlgorithm(et,rt)}var init$2=!1,Nb$1=4,sbox$1,isbox$1,rcon$1,mix$1,imix$1;function initialize$1(){init$2=!0,rcon$1=[0,1,2,4,8,16,32,64,128,27,54];for(var et=new Array(256),tt=0;tt<128;++tt)et[tt]=tt<<1,et[tt+128]=tt+128<<1^283;sbox$1=new Array(256),isbox$1=new Array(256),mix$1=new Array(4),imix$1=new Array(4);for(var tt=0;tt<4;++tt)mix$1[tt]=new Array(256),imix$1[tt]=new Array(256);for(var rt=0,nt=0,it,ot,st,at,ct,ut,lt,tt=0;tt<256;++tt){at=nt^nt<<1^nt<<2^nt<<3^nt<<4,at=at>>8^at&255^99,sbox$1[rt]=at,isbox$1[at]=rt,ct=et[at],it=et[rt],ot=et[it],st=et[ot],ut=ct<<24^at<<16^at<<8^(at^ct),lt=(it^ot^st)<<24^(rt^st)<<16^(rt^ot^st)<<8^(rt^it^st);for(var ht=0;ht<4;++ht)mix$1[ht][rt]=ut,imix$1[ht][at]=lt,ut=ut<<24|ut>>>8,lt=lt<<24|lt>>>8;rt===0?rt=nt=1:(rt=it^et[et[et[it^st]]],nt^=et[et[nt]])}}function _expandKey$1(et,tt){for(var rt=et.slice(0),nt,it=1,ot=rt.length,st=ot+6+1,at=Nb$1*st,ct=ot;ct<at;++ct)nt=rt[ct-1],ct%ot===0?(nt=sbox$1[nt>>>16&255]<<24^sbox$1[nt>>>8&255]<<16^sbox$1[nt&255]<<8^sbox$1[nt>>>24]^rcon$1[it]<<24,it++):ot>6&&ct%ot===4&&(nt=sbox$1[nt>>>24]<<24^sbox$1[nt>>>16&255]<<16^sbox$1[nt>>>8&255]<<8^sbox$1[nt&255]),rt[ct]=rt[ct-ot]^nt;if(tt){var ut,lt=imix$1[0],ht=imix$1[1],ft=imix$1[2],dt=imix$1[3],pt=rt.slice(0);at=rt.length;for(var ct=0,gt=at-Nb$1;ct<at;ct+=Nb$1,gt-=Nb$1)if(ct===0||ct===at-Nb$1)pt[ct]=rt[gt],pt[ct+1]=rt[gt+3],pt[ct+2]=rt[gt+2],pt[ct+3]=rt[gt+1];else for(var _t=0;_t<Nb$1;++_t)ut=rt[gt+_t],pt[ct+(3&-_t)]=lt[sbox$1[ut>>>24]]^ht[sbox$1[ut>>>16&255]]^ft[sbox$1[ut>>>8&255]]^dt[sbox$1[ut&255]];rt=pt}return rt}function _updateBlock$3(et,tt,rt,nt){var it=et.length/4-1,ot,st,at,ct,ut;nt?(ot=imix$1[0],st=imix$1[1],at=imix$1[2],ct=imix$1[3],ut=isbox$1):(ot=mix$1[0],st=mix$1[1],at=mix$1[2],ct=mix$1[3],ut=sbox$1);var lt,ht,ft,dt,pt,gt,_t;lt=tt[0]^et[0],ht=tt[nt?3:1]^et[1],ft=tt[2]^et[2],dt=tt[nt?1:3]^et[3];for(var mt=3,At=1;At<it;++At)pt=ot[lt>>>24]^st[ht>>>16&255]^at[ft>>>8&255]^ct[dt&255]^et[++mt],gt=ot[ht>>>24]^st[ft>>>16&255]^at[dt>>>8&255]^ct[lt&255]^et[++mt],_t=ot[ft>>>24]^st[dt>>>16&255]^at[lt>>>8&255]^ct[ht&255]^et[++mt],dt=ot[dt>>>24]^st[lt>>>16&255]^at[ht>>>8&255]^ct[ft&255]^et[++mt],lt=pt,ht=gt,ft=_t;rt[0]=ut[lt>>>24]<<24^ut[ht>>>16&255]<<16^ut[ft>>>8&255]<<8^ut[dt&255]^et[++mt],rt[nt?3:1]=ut[ht>>>24]<<24^ut[ft>>>16&255]<<16^ut[dt>>>8&255]<<8^ut[lt&255]^et[++mt],rt[2]=ut[ft>>>24]<<24^ut[dt>>>16&255]<<16^ut[lt>>>8&255]<<8^ut[ht&255]^et[++mt],rt[nt?1:3]=ut[dt>>>24]<<24^ut[lt>>>16&255]<<16^ut[ht>>>8&255]<<8^ut[ft&255]^et[++mt]}function _createCipher$3(et){et=et||{};var tt=(et.mode||"CBC").toUpperCase(),rt="AES-"+tt,nt;et.decrypt?nt=forge$Q.cipher.createDecipher(rt,et.key):nt=forge$Q.cipher.createCipher(rt,et.key);var it=nt.start;return nt.start=function(ot,st){var at=null;st instanceof forge$Q.util.ByteBuffer&&(at=st,st={}),st=st||{},st.output=at,st.iv=ot,it.call(nt,st)},nt}var forge$P=forge$W;forge$P.des=forge$P.des||{},forge$P.des.startEncrypting=function(et,tt,rt,nt){var it=_createCipher$2({key:et,output:rt,decrypt:!1,mode:nt||(tt===null?"ECB":"CBC")});return it.start(tt),it},forge$P.des.createEncryptionCipher=function(et,tt){return _createCipher$2({key:et,output:null,decrypt:!1,mode:tt})},forge$P.des.startDecrypting=function(et,tt,rt,nt){var it=_createCipher$2({key:et,output:rt,decrypt:!0,mode:nt||(tt===null?"ECB":"CBC")});return it.start(tt),it},forge$P.des.createDecryptionCipher=function(et,tt){return _createCipher$2({key:et,output:null,decrypt:!0,mode:tt})},forge$P.des.Algorithm=function(et,tt){var rt=this;rt.name=et,rt.mode=new tt({blockSize:8,cipher:{encrypt:function(nt,it){return _updateBlock$2(rt._keys,nt,it,!1)},decrypt:function(nt,it){return _updateBlock$2(rt._keys,nt,it,!0)}}}),rt._init=!1},forge$P.des.Algorithm.prototype.initialize=function(et){if(!this._init){var tt=forge$P.util.createBuffer(et.key);if(this.name.indexOf("3DES")===0&&tt.length()!==24)throw new Error("Invalid Triple-DES key size: "+tt.length()*8);this._keys=_createKeys$1(tt),this._init=!0}},registerAlgorithm$2("DES-ECB",forge$P.cipher.modes.ecb),registerAlgorithm$2("DES-CBC",forge$P.cipher.modes.cbc),registerAlgorithm$2("DES-CFB",forge$P.cipher.modes.cfb),registerAlgorithm$2("DES-OFB",forge$P.cipher.modes.ofb),registerAlgorithm$2("DES-CTR",forge$P.cipher.modes.ctr),registerAlgorithm$2("3DES-ECB",forge$P.cipher.modes.ecb),registerAlgorithm$2("3DES-CBC",forge$P.cipher.modes.cbc),registerAlgorithm$2("3DES-CFB",forge$P.cipher.modes.cfb),registerAlgorithm$2("3DES-OFB",forge$P.cipher.modes.ofb),registerAlgorithm$2("3DES-CTR",forge$P.cipher.modes.ctr);function registerAlgorithm$2(et,tt){var rt=function(){return new forge$P.des.Algorithm(et,tt)};forge$P.cipher.registerAlgorithm(et,rt)}var spfunction1$1=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],spfunction2$1=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],spfunction3$1=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],spfunction4$1=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],spfunction5$1=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],spfunction6$1=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],spfunction7$1=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],spfunction8$1=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function _createKeys$1(et){for(var tt=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],rt=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],nt=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],it=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],ot=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],st=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],at=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],ct=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],ut=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],lt=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],ht=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],ft=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],dt=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],pt=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],gt=et.length()>8?3:1,_t=[],mt=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],At=0,It,Mt=0;Mt<gt;Mt++){var kt=et.getInt32(),Ct=et.getInt32();It=(kt>>>4^Ct)&252645135,Ct^=It,kt^=It<<4,It=(Ct>>>-16^kt)&65535,kt^=It,Ct^=It<<-16,It=(kt>>>2^Ct)&858993459,Ct^=It,kt^=It<<2,It=(Ct>>>-16^kt)&65535,kt^=It,Ct^=It<<-16,It=(kt>>>1^Ct)&1431655765,Ct^=It,kt^=It<<1,It=(Ct>>>8^kt)&16711935,kt^=It,Ct^=It<<8,It=(kt>>>1^Ct)&1431655765,Ct^=It,kt^=It<<1,It=kt<<8|Ct>>>20&240,kt=Ct<<24|Ct<<8&16711680|Ct>>>8&65280|Ct>>>24&240,Ct=It;for(var Ut=0;Ut<mt.length;++Ut){mt[Ut]?(kt=kt<<2|kt>>>26,Ct=Ct<<2|Ct>>>26):(kt=kt<<1|kt>>>27,Ct=Ct<<1|Ct>>>27),kt&=-15,Ct&=-15;var Wt=tt[kt>>>28]|rt[kt>>>24&15]|nt[kt>>>20&15]|it[kt>>>16&15]|ot[kt>>>12&15]|st[kt>>>8&15]|at[kt>>>4&15],Ft=ct[Ct>>>28]|ut[Ct>>>24&15]|lt[Ct>>>20&15]|ht[Ct>>>16&15]|ft[Ct>>>12&15]|dt[Ct>>>8&15]|pt[Ct>>>4&15];It=(Ft>>>16^Wt)&65535,_t[At++]=Wt^It,_t[At++]=Ft^It<<16}}return _t}function _updateBlock$2(et,tt,rt,nt){var it=et.length===32?3:9,ot;it===3?ot=nt?[30,-2,-2]:[0,32,2]:ot=nt?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var st,at=tt[0],ct=tt[1];st=(at>>>4^ct)&252645135,ct^=st,at^=st<<4,st=(at>>>16^ct)&65535,ct^=st,at^=st<<16,st=(ct>>>2^at)&858993459,at^=st,ct^=st<<2,st=(ct>>>8^at)&16711935,at^=st,ct^=st<<8,st=(at>>>1^ct)&1431655765,ct^=st,at^=st<<1,at=at<<1|at>>>31,ct=ct<<1|ct>>>31;for(var ut=0;ut<it;ut+=3){for(var lt=ot[ut+1],ht=ot[ut+2],ft=ot[ut];ft!=lt;ft+=ht){var dt=ct^et[ft],pt=(ct>>>4|ct<<28)^et[ft+1];st=at,at=ct,ct=st^(spfunction2$1[dt>>>24&63]|spfunction4$1[dt>>>16&63]|spfunction6$1[dt>>>8&63]|spfunction8$1[dt&63]|spfunction1$1[pt>>>24&63]|spfunction3$1[pt>>>16&63]|spfunction5$1[pt>>>8&63]|spfunction7$1[pt&63])}st=at,at=ct,ct=st}at=at>>>1|at<<31,ct=ct>>>1|ct<<31,st=(at>>>1^ct)&1431655765,ct^=st,at^=st<<1,st=(ct>>>8^at)&16711935,at^=st,ct^=st<<8,st=(ct>>>2^at)&858993459,at^=st,ct^=st<<2,st=(at>>>16^ct)&65535,ct^=st,at^=st<<16,st=(at>>>4^ct)&252645135,ct^=st,at^=st<<4,rt[0]=at,rt[1]=ct}function _createCipher$2(et){et=et||{};var tt=(et.mode||"CBC").toUpperCase(),rt="DES-"+tt,nt;et.decrypt?nt=forge$P.cipher.createDecipher(rt,et.key):nt=forge$P.cipher.createCipher(rt,et.key);var it=nt.start;return nt.start=function(ot,st){var at=null;st instanceof forge$P.util.ByteBuffer&&(at=st,st={}),st=st||{},st.output=at,st.iv=ot,it.call(nt,st)},nt}var forge$O=forge$W;forge$O.md=forge$O.md||{},forge$O.md.algorithms=forge$O.md.algorithms||{};var forge$N=forge$W,hmac$3=forge$N.hmac=forge$N.hmac||{};hmac$3.create=function(){var et=null,tt=null,rt=null,nt=null,it={};return it.start=function(ot,st){if(ot!==null)if(typeof ot=="string")if(ot=ot.toLowerCase(),ot in forge$N.md.algorithms)tt=forge$N.md.algorithms[ot].create();else throw new Error('Unknown hash algorithm "'+ot+'"');else tt=ot;if(st===null)st=et;else{if(typeof st=="string")st=forge$N.util.createBuffer(st);else if(forge$N.util.isArray(st)){var at=st;st=forge$N.util.createBuffer();for(var ct=0;ct<at.length;++ct)st.putByte(at[ct])}var ut=st.length();ut>tt.blockLength&&(tt.start(),tt.update(st.bytes()),st=tt.digest()),rt=forge$N.util.createBuffer(),nt=forge$N.util.createBuffer(),ut=st.length();for(var ct=0;ct<ut;++ct){var at=st.at(ct);rt.putByte(54^at),nt.putByte(92^at)}if(ut<tt.blockLength)for(var at=tt.blockLength-ut,ct=0;ct<at;++ct)rt.putByte(54),nt.putByte(92);et=st,rt=rt.bytes(),nt=nt.bytes()}tt.start(),tt.update(rt)},it.update=function(ot){tt.update(ot)},it.getMac=function(){var ot=tt.digest().bytes();return tt.start(),tt.update(nt),tt.update(ot),tt.digest()},it.digest=it.getMac,it};var forge$M=forge$W,pkcs5$1=forge$M.pkcs5=forge$M.pkcs5||{},crypto$9;forge$M.util.isNodejs&&!forge$M.options.usePureJavaScript&&(crypto$9=require$$0$3);var pbkdf2$1=forge$M.pbkdf2=pkcs5$1.pbkdf2=function(et,tt,rt,nt,it,ot){if(typeof it=="function"&&(ot=it,it=null),forge$M.util.isNodejs&&!forge$M.options.usePureJavaScript&&crypto$9.pbkdf2&&(it===null||typeof it!="object")&&(crypto$9.pbkdf2Sync.length>4||!it||it==="sha1"))return typeof it!="string"&&(it="sha1"),et=Buffer.from(et,"binary"),tt=Buffer.from(tt,"binary"),ot?crypto$9.pbkdf2Sync.length===4?crypto$9.pbkdf2(et,tt,rt,nt,function(It,Mt){if(It)return ot(It);ot(null,Mt.toString("binary"))}):crypto$9.pbkdf2(et,tt,rt,nt,it,function(It,Mt){if(It)return ot(It);ot(null,Mt.toString("binary"))}):crypto$9.pbkdf2Sync.length===4?crypto$9.pbkdf2Sync(et,tt,rt,nt).toString("binary"):crypto$9.pbkdf2Sync(et,tt,rt,nt,it).toString("binary");if((typeof it>"u"||it===null)&&(it="sha1"),typeof it=="string"){if(!(it in forge$M.md.algorithms))throw new Error("Unknown hash algorithm: "+it);it=forge$M.md[it].create()}var st=it.digestLength;if(nt>4294967295*st){var at=new Error("Derived key is too long.");if(ot)return ot(at);throw at}var ct=Math.ceil(nt/st),ut=nt-(ct-1)*st,lt=forge$M.hmac.create();lt.start(it,et);var ht="",ft,dt,pt;if(!ot){for(var gt=1;gt<=ct;++gt){lt.start(null,null),lt.update(tt),lt.update(forge$M.util.int32ToBytes(gt)),ft=pt=lt.digest().getBytes();for(var _t=2;_t<=rt;++_t)lt.start(null,null),lt.update(pt),dt=lt.digest().getBytes(),ft=forge$M.util.xorBytes(ft,dt,st),pt=dt;ht+=gt<ct?ft:ft.substr(0,ut)}return ht}var gt=1,_t;function mt(){if(gt>ct)return ot(null,ht);lt.start(null,null),lt.update(tt),lt.update(forge$M.util.int32ToBytes(gt)),ft=pt=lt.digest().getBytes(),_t=2,At()}function At(){if(_t<=rt)return lt.start(null,null),lt.update(pt),dt=lt.digest().getBytes(),ft=forge$M.util.xorBytes(ft,dt,st),pt=dt,++_t,forge$M.util.setImmediate(At);ht+=gt<ct?ft:ft.substr(0,ut),++gt,mt()}mt()},forge$L=forge$W,pem$1=forge$L.pem=forge$L.pem||{};pem$1.encode=function(et,tt){tt=tt||{};var rt="-----BEGIN "+et.type+`-----\r
`,nt;if(et.procType&&(nt={name:"Proc-Type",values:[String(et.procType.version),et.procType.type]},rt+=foldHeader$1(nt)),et.contentDomain&&(nt={name:"Content-Domain",values:[et.contentDomain]},rt+=foldHeader$1(nt)),et.dekInfo&&(nt={name:"DEK-Info",values:[et.dekInfo.algorithm]},et.dekInfo.parameters&&nt.values.push(et.dekInfo.parameters),rt+=foldHeader$1(nt)),et.headers)for(var it=0;it<et.headers.length;++it)rt+=foldHeader$1(et.headers[it]);return et.procType&&(rt+=`\r
`),rt+=forge$L.util.encode64(et.body,tt.maxline||64)+`\r
`,rt+="-----END "+et.type+`-----\r
`,rt},pem$1.decode=function(et){for(var tt=[],rt=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,nt=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,it=/\r?\n/,ot;ot=rt.exec(et),!!ot;){var st={type:ot[1],procType:null,contentDomain:null,dekInfo:null,headers:[],body:forge$L.util.decode64(ot[3])};if(tt.push(st),!!ot[2]){for(var at=ot[2].split(it),ct=0;ot&&ct<at.length;){for(var ut=at[ct].replace(/\s+$/,""),lt=ct+1;lt<at.length;++lt){var ht=at[lt];if(!/\s/.test(ht[0]))break;ut+=ht,ct=lt}if(ot=ut.match(nt),ot){for(var ft={name:ot[1],values:[]},dt=ot[2].split(","),pt=0;pt<dt.length;++pt)ft.values.push(ltrim$1(dt[pt]));if(st.procType)if(!st.contentDomain&&ft.name==="Content-Domain")st.contentDomain=dt[0]||"";else if(!st.dekInfo&&ft.name==="DEK-Info"){if(ft.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');st.dekInfo={algorithm:dt[0],parameters:dt[1]||null}}else st.headers.push(ft);else{if(ft.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(ft.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');st.procType={version:dt[0],type:dt[1]}}}++ct}if(st.procType==="ENCRYPTED"&&!st.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(tt.length===0)throw new Error("Invalid PEM formatted message.");return tt};function foldHeader$1(et){for(var tt=et.name+": ",rt=[],nt=function(ct,ut){return" "+ut},it=0;it<et.values.length;++it)rt.push(et.values[it].replace(/^(\S+\r\n)/,nt));tt+=rt.join(",")+`\r
`;for(var ot=0,st=-1,it=0;it<tt.length;++it,++ot)if(ot>65&&st!==-1){var at=tt[st];at===","?(++st,tt=tt.substr(0,st)+`\r
 `+tt.substr(st)):tt=tt.substr(0,st)+`\r
`+at+tt.substr(st+1),ot=it-st-1,st=-1,++it}else(tt[it]===" "||tt[it]==="	"||tt[it]===",")&&(st=it);return tt}function ltrim$1(et){return et.replace(/^\s+/,"")}var forge$K=forge$W,sha256$e=forge$K.sha256=forge$K.sha256||{};forge$K.md.sha256=forge$K.md.algorithms.sha256=sha256$e,sha256$e.create=function(){_initialized$5||_init$5();var et=null,tt=forge$K.util.createBuffer(),rt=new Array(64),nt={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return nt.start=function(){nt.messageLength=0,nt.fullMessageLength=nt.messageLength64=[];for(var it=nt.messageLengthSize/4,ot=0;ot<it;++ot)nt.fullMessageLength.push(0);return tt=forge$K.util.createBuffer(),et={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},nt},nt.start(),nt.update=function(it,ot){ot==="utf8"&&(it=forge$K.util.encodeUtf8(it));var st=it.length;nt.messageLength+=st,st=[st/4294967296>>>0,st>>>0];for(var at=nt.fullMessageLength.length-1;at>=0;--at)nt.fullMessageLength[at]+=st[1],st[1]=st[0]+(nt.fullMessageLength[at]/4294967296>>>0),nt.fullMessageLength[at]=nt.fullMessageLength[at]>>>0,st[0]=st[1]/4294967296>>>0;return tt.putBytes(it),_update$5(et,rt,tt),(tt.read>2048||tt.length()===0)&&tt.compact(),nt},nt.digest=function(){var it=forge$K.util.createBuffer();it.putBytes(tt.bytes());var ot=nt.fullMessageLength[nt.fullMessageLength.length-1]+nt.messageLengthSize,st=ot&nt.blockLength-1;it.putBytes(_padding$5.substr(0,nt.blockLength-st));for(var at,ct,ut=nt.fullMessageLength[0]*8,lt=0;lt<nt.fullMessageLength.length-1;++lt)at=nt.fullMessageLength[lt+1]*8,ct=at/4294967296>>>0,ut+=ct,it.putInt32(ut>>>0),ut=at>>>0;it.putInt32(ut);var ht={h0:et.h0,h1:et.h1,h2:et.h2,h3:et.h3,h4:et.h4,h5:et.h5,h6:et.h6,h7:et.h7};_update$5(ht,rt,it);var ft=forge$K.util.createBuffer();return ft.putInt32(ht.h0),ft.putInt32(ht.h1),ft.putInt32(ht.h2),ft.putInt32(ht.h3),ft.putInt32(ht.h4),ft.putInt32(ht.h5),ft.putInt32(ht.h6),ft.putInt32(ht.h7),ft},nt};var _padding$5=null,_initialized$5=!1,_k$3=null;function _init$5(){_padding$5=String.fromCharCode(128),_padding$5+=forge$K.util.fillString(String.fromCharCode(0),64),_k$3=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],_initialized$5=!0}function _update$5(et,tt,rt){for(var nt,it,ot,st,at,ct,ut,lt,ht,ft,dt,pt,gt,_t,mt,At=rt.length();At>=64;){for(ut=0;ut<16;++ut)tt[ut]=rt.getInt32();for(;ut<64;++ut)nt=tt[ut-2],nt=(nt>>>17|nt<<15)^(nt>>>19|nt<<13)^nt>>>10,it=tt[ut-15],it=(it>>>7|it<<25)^(it>>>18|it<<14)^it>>>3,tt[ut]=nt+tt[ut-7]+it+tt[ut-16]|0;for(lt=et.h0,ht=et.h1,ft=et.h2,dt=et.h3,pt=et.h4,gt=et.h5,_t=et.h6,mt=et.h7,ut=0;ut<64;++ut)st=(pt>>>6|pt<<26)^(pt>>>11|pt<<21)^(pt>>>25|pt<<7),at=_t^pt&(gt^_t),ot=(lt>>>2|lt<<30)^(lt>>>13|lt<<19)^(lt>>>22|lt<<10),ct=lt&ht|ft&(lt^ht),nt=mt+st+at+_k$3[ut]+tt[ut],it=ot+ct,mt=_t,_t=gt,gt=pt,pt=dt+nt>>>0,dt=ft,ft=ht,ht=lt,lt=nt+it>>>0;et.h0=et.h0+lt|0,et.h1=et.h1+ht|0,et.h2=et.h2+ft|0,et.h3=et.h3+dt|0,et.h4=et.h4+pt|0,et.h5=et.h5+gt|0,et.h6=et.h6+_t|0,et.h7=et.h7+mt|0,At-=64}}var forge$J=forge$W,_crypto$3=null;forge$J.util.isNodejs&&!forge$J.options.usePureJavaScript&&!process.versions["node-webkit"]&&(_crypto$3=require$$0$3);var prng$1=forge$J.prng=forge$J.prng||{};prng$1.create=function(et){for(var tt={plugin:et,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},rt=et.md,nt=new Array(32),it=0;it<32;++it)nt[it]=rt.create();tt.pools=nt,tt.pool=0,tt.generate=function(ut,lt){if(!lt)return tt.generateSync(ut);var ht=tt.plugin.cipher,ft=tt.plugin.increment,dt=tt.plugin.formatKey,pt=tt.plugin.formatSeed,gt=forge$J.util.createBuffer();tt.key=null,_t();function _t(mt){if(mt)return lt(mt);if(gt.length()>=ut)return lt(null,gt.getBytes(ut));if(tt.generated>1048575&&(tt.key=null),tt.key===null)return forge$J.util.nextTick(function(){ot(_t)});var At=ht(tt.key,tt.seed);tt.generated+=At.length,gt.putBytes(At),tt.key=dt(ht(tt.key,ft(tt.seed))),tt.seed=pt(ht(tt.key,tt.seed)),forge$J.util.setImmediate(_t)}},tt.generateSync=function(ut){var lt=tt.plugin.cipher,ht=tt.plugin.increment,ft=tt.plugin.formatKey,dt=tt.plugin.formatSeed;tt.key=null;for(var pt=forge$J.util.createBuffer();pt.length()<ut;){tt.generated>1048575&&(tt.key=null),tt.key===null&&st();var gt=lt(tt.key,tt.seed);tt.generated+=gt.length,pt.putBytes(gt),tt.key=ft(lt(tt.key,ht(tt.seed))),tt.seed=dt(lt(tt.key,tt.seed))}return pt.getBytes(ut)};function ot(ut){if(tt.pools[0].messageLength>=32)return at(),ut();var lt=32-tt.pools[0].messageLength<<5;tt.seedFile(lt,function(ht,ft){if(ht)return ut(ht);tt.collect(ft),at(),ut()})}function st(){if(tt.pools[0].messageLength>=32)return at();var ut=32-tt.pools[0].messageLength<<5;tt.collect(tt.seedFileSync(ut)),at()}function at(){tt.reseeds=tt.reseeds===4294967295?0:tt.reseeds+1;var ut=tt.plugin.md.create();ut.update(tt.keyBytes);for(var lt=1,ht=0;ht<32;++ht)tt.reseeds%lt===0&&(ut.update(tt.pools[ht].digest().getBytes()),tt.pools[ht].start()),lt=lt<<1;tt.keyBytes=ut.digest().getBytes(),ut.start(),ut.update(tt.keyBytes);var ft=ut.digest().getBytes();tt.key=tt.plugin.formatKey(tt.keyBytes),tt.seed=tt.plugin.formatSeed(ft),tt.generated=0}function ct(ut){var lt=null,ht=forge$J.util.globalScope,ft=ht.crypto||ht.msCrypto;ft&&ft.getRandomValues&&(lt=function(kt){return ft.getRandomValues(kt)});var dt=forge$J.util.createBuffer();if(lt)for(;dt.length()<ut;){var pt=Math.max(1,Math.min(ut-dt.length(),65536)/4),gt=new Uint32Array(Math.floor(pt));try{lt(gt);for(var _t=0;_t<gt.length;++_t)dt.putInt32(gt[_t])}catch(kt){if(!(typeof QuotaExceededError<"u"&&kt instanceof QuotaExceededError))throw kt}}if(dt.length()<ut)for(var mt,At,It,Mt=Math.floor(Math.random()*65536);dt.length()<ut;){At=16807*(Mt&65535),mt=16807*(Mt>>16),At+=(mt&32767)<<16,At+=mt>>15,At=(At&2147483647)+(At>>31),Mt=At&4294967295;for(var _t=0;_t<3;++_t)It=Mt>>>(_t<<3),It^=Math.floor(Math.random()*256),dt.putByte(String.fromCharCode(It&255))}return dt.getBytes(ut)}return _crypto$3?(tt.seedFile=function(ut,lt){_crypto$3.randomBytes(ut,function(ht,ft){if(ht)return lt(ht);lt(null,ft.toString())})},tt.seedFileSync=function(ut){return _crypto$3.randomBytes(ut).toString()}):(tt.seedFile=function(ut,lt){try{lt(null,ct(ut))}catch(ht){lt(ht)}},tt.seedFileSync=ct),tt.collect=function(ut){for(var lt=ut.length,ht=0;ht<lt;++ht)tt.pools[tt.pool].update(ut.substr(ht,1)),tt.pool=tt.pool===31?0:tt.pool+1},tt.collectInt=function(ut,lt){for(var ht="",ft=0;ft<lt;ft+=8)ht+=String.fromCharCode(ut>>ft&255);tt.collect(ht)},tt.registerWorker=function(ut){if(ut===self)tt.seedFile=function(ht,ft){function dt(pt){var gt=pt.data;gt.forge&&gt.forge.prng&&(self.removeEventListener("message",dt),ft(gt.forge.prng.err,gt.forge.prng.bytes))}self.addEventListener("message",dt),self.postMessage({forge:{prng:{needed:ht}}})};else{var lt=function(ht){var ft=ht.data;ft.forge&&ft.forge.prng&&tt.seedFile(ft.forge.prng.needed,function(dt,pt){ut.postMessage({forge:{prng:{err:dt,bytes:pt}}})})};ut.addEventListener("message",lt)}},tt};var forge$I=forge$W;(function(){if(forge$I.random&&forge$I.random.getBytes){forge$I.random;return}(function(et){var tt={},rt=new Array(4),nt=forge$I.util.createBuffer();tt.formatKey=function(ht){var ft=forge$I.util.createBuffer(ht);return ht=new Array(4),ht[0]=ft.getInt32(),ht[1]=ft.getInt32(),ht[2]=ft.getInt32(),ht[3]=ft.getInt32(),forge$I.aes._expandKey(ht,!1)},tt.formatSeed=function(ht){var ft=forge$I.util.createBuffer(ht);return ht=new Array(4),ht[0]=ft.getInt32(),ht[1]=ft.getInt32(),ht[2]=ft.getInt32(),ht[3]=ft.getInt32(),ht},tt.cipher=function(ht,ft){return forge$I.aes._updateBlock(ht,ft,rt,!1),nt.putInt32(rt[0]),nt.putInt32(rt[1]),nt.putInt32(rt[2]),nt.putInt32(rt[3]),nt.getBytes()},tt.increment=function(ht){return++ht[3],ht},tt.md=forge$I.md.sha256;function it(){var ht=forge$I.prng.create(tt);return ht.getBytes=function(ft,dt){return ht.generate(ft,dt)},ht.getBytesSync=function(ft){return ht.generate(ft)},ht}var ot=it(),st=null,at=forge$I.util.globalScope,ct=at.crypto||at.msCrypto;if(ct&&ct.getRandomValues&&(st=function(ht){return ct.getRandomValues(ht)}),forge$I.options.usePureJavaScript||!forge$I.util.isNodejs&&!st){if(ot.collectInt(+new Date,32),typeof navigator<"u"){var ut="";for(var lt in navigator)try{typeof navigator[lt]=="string"&&(ut+=navigator[lt])}catch{}ot.collect(ut),ut=null}et&&(et().mousemove(function(ht){ot.collectInt(ht.clientX,16),ot.collectInt(ht.clientY,16)}),et().keypress(function(ht){ot.collectInt(ht.charCode,8)}))}if(!forge$I.random)forge$I.random=ot;else for(var lt in ot)forge$I.random[lt]=ot[lt];forge$I.random.createInstance=it,forge$I.random})(typeof jQuery<"u"?jQuery:null)})();var forge$H=forge$W,piTable$1=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],s$1=[1,2,3,5],rol$1=function(et,tt){return et<<tt&65535|(et&65535)>>16-tt},ror$1=function(et,tt){return(et&65535)>>tt|et<<16-tt&65535};forge$H.rc2=forge$H.rc2||{},forge$H.rc2.expandKey=function(et,tt){typeof et=="string"&&(et=forge$H.util.createBuffer(et)),tt=tt||128;var rt=et,nt=et.length(),it=tt,ot=Math.ceil(it/8),st=255>>(it&7),at;for(at=nt;at<128;at++)rt.putByte(piTable$1[rt.at(at-1)+rt.at(at-nt)&255]);for(rt.setAt(128-ot,piTable$1[rt.at(128-ot)&st]),at=127-ot;at>=0;at--)rt.setAt(at,piTable$1[rt.at(at+1)^rt.at(at+ot)]);return rt};var createCipher$1=function(et,tt,rt){var nt=!1,it=null,ot=null,st=null,at,ct,ut,lt,ht=[];for(et=forge$H.rc2.expandKey(et,tt),ut=0;ut<64;ut++)ht.push(et.getInt16Le());rt?(at=function(pt){for(ut=0;ut<4;ut++)pt[ut]+=ht[lt]+(pt[(ut+3)%4]&pt[(ut+2)%4])+(~pt[(ut+3)%4]&pt[(ut+1)%4]),pt[ut]=rol$1(pt[ut],s$1[ut]),lt++},ct=function(pt){for(ut=0;ut<4;ut++)pt[ut]+=ht[pt[(ut+3)%4]&63]}):(at=function(pt){for(ut=3;ut>=0;ut--)pt[ut]=ror$1(pt[ut],s$1[ut]),pt[ut]-=ht[lt]+(pt[(ut+3)%4]&pt[(ut+2)%4])+(~pt[(ut+3)%4]&pt[(ut+1)%4]),lt--},ct=function(pt){for(ut=3;ut>=0;ut--)pt[ut]-=ht[pt[(ut+3)%4]&63]});var ft=function(pt){var gt=[];for(ut=0;ut<4;ut++){var _t=it.getInt16Le();st!==null&&(rt?_t^=st.getInt16Le():st.putInt16Le(_t)),gt.push(_t&65535)}lt=rt?0:63;for(var mt=0;mt<pt.length;mt++)for(var At=0;At<pt[mt][0];At++)pt[mt][1](gt);for(ut=0;ut<4;ut++)st!==null&&(rt?st.putInt16Le(gt[ut]):gt[ut]^=st.getInt16Le()),ot.putInt16Le(gt[ut])},dt=null;return dt={start:function(pt,gt){pt&&typeof pt=="string"&&(pt=forge$H.util.createBuffer(pt)),nt=!1,it=forge$H.util.createBuffer(),ot=gt||new forge$H.util.createBuffer,st=pt,dt.output=ot},update:function(pt){for(nt||it.putBuffer(pt);it.length()>=8;)ft([[5,at],[1,ct],[6,at],[1,ct],[5,at]])},finish:function(pt){var gt=!0;if(rt)if(pt)gt=pt(8,it,!rt);else{var _t=it.length()===8?8:8-it.length();it.fillWithByte(_t,_t)}if(gt&&(nt=!0,dt.update()),!rt&&(gt=it.length()===0,gt))if(pt)gt=pt(8,ot,!rt);else{var mt=ot.length(),At=ot.at(mt-1);At>mt?gt=!1:ot.truncate(At)}return gt}},dt};forge$H.rc2.startEncrypting=function(et,tt,rt){var nt=forge$H.rc2.createEncryptionCipher(et,128);return nt.start(tt,rt),nt},forge$H.rc2.createEncryptionCipher=function(et,tt){return createCipher$1(et,tt,!0)},forge$H.rc2.startDecrypting=function(et,tt,rt){var nt=forge$H.rc2.createDecryptionCipher(et,128);return nt.start(tt,rt),nt},forge$H.rc2.createDecryptionCipher=function(et,tt){return createCipher$1(et,tt,!1)};var forge$G=forge$W;forge$G.jsbn=forge$G.jsbn||{};var dbits$1;function BigInteger$6(et,tt,rt){this.data=[],et!=null&&(typeof et=="number"?this.fromNumber(et,tt,rt):tt==null&&typeof et!="string"?this.fromString(et,256):this.fromString(et,tt))}forge$G.jsbn.BigInteger=BigInteger$6;function nbi$1(){return new BigInteger$6(null)}function am1$1(et,tt,rt,nt,it,ot){for(;--ot>=0;){var st=tt*this.data[et++]+rt.data[nt]+it;it=Math.floor(st/67108864),rt.data[nt++]=st&67108863}return it}function am2$1(et,tt,rt,nt,it,ot){for(var st=tt&32767,at=tt>>15;--ot>=0;){var ct=this.data[et]&32767,ut=this.data[et++]>>15,lt=at*ct+ut*st;ct=st*ct+((lt&32767)<<15)+rt.data[nt]+(it&1073741823),it=(ct>>>30)+(lt>>>15)+at*ut+(it>>>30),rt.data[nt++]=ct&1073741823}return it}function am3$1(et,tt,rt,nt,it,ot){for(var st=tt&16383,at=tt>>14;--ot>=0;){var ct=this.data[et]&16383,ut=this.data[et++]>>14,lt=at*ct+ut*st;ct=st*ct+((lt&16383)<<14)+rt.data[nt]+it,it=(ct>>28)+(lt>>14)+at*ut,rt.data[nt++]=ct&268435455}return it}typeof navigator>"u"?(BigInteger$6.prototype.am=am3$1,dbits$1=28):navigator.appName=="Microsoft Internet Explorer"?(BigInteger$6.prototype.am=am2$1,dbits$1=30):navigator.appName!="Netscape"?(BigInteger$6.prototype.am=am1$1,dbits$1=26):(BigInteger$6.prototype.am=am3$1,dbits$1=28),BigInteger$6.prototype.DB=dbits$1,BigInteger$6.prototype.DM=(1<<dbits$1)-1,BigInteger$6.prototype.DV=1<<dbits$1;var BI_FP$1=52;BigInteger$6.prototype.FV=Math.pow(2,BI_FP$1),BigInteger$6.prototype.F1=BI_FP$1-dbits$1,BigInteger$6.prototype.F2=2*dbits$1-BI_FP$1;var BI_RM$1="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC$1=new Array,rr$1,vv$1;for(rr$1="0".charCodeAt(0),vv$1=0;vv$1<=9;++vv$1)BI_RC$1[rr$1++]=vv$1;for(rr$1="a".charCodeAt(0),vv$1=10;vv$1<36;++vv$1)BI_RC$1[rr$1++]=vv$1;for(rr$1="A".charCodeAt(0),vv$1=10;vv$1<36;++vv$1)BI_RC$1[rr$1++]=vv$1;function int2char$1(et){return BI_RM$1.charAt(et)}function intAt$1(et,tt){var rt=BI_RC$1[et.charCodeAt(tt)];return rt??-1}function bnpCopyTo$1(et){for(var tt=this.t-1;tt>=0;--tt)et.data[tt]=this.data[tt];et.t=this.t,et.s=this.s}function bnpFromInt$1(et){this.t=1,this.s=et<0?-1:0,et>0?this.data[0]=et:et<-1?this.data[0]=et+this.DV:this.t=0}function nbv$1(et){var tt=nbi$1();return tt.fromInt(et),tt}function bnpFromString$1(et,tt){var rt;if(tt==16)rt=4;else if(tt==8)rt=3;else if(tt==256)rt=8;else if(tt==2)rt=1;else if(tt==32)rt=5;else if(tt==4)rt=2;else{this.fromRadix(et,tt);return}this.t=0,this.s=0;for(var nt=et.length,it=!1,ot=0;--nt>=0;){var st=rt==8?et[nt]&255:intAt$1(et,nt);if(st<0){et.charAt(nt)=="-"&&(it=!0);continue}it=!1,ot==0?this.data[this.t++]=st:ot+rt>this.DB?(this.data[this.t-1]|=(st&(1<<this.DB-ot)-1)<<ot,this.data[this.t++]=st>>this.DB-ot):this.data[this.t-1]|=st<<ot,ot+=rt,ot>=this.DB&&(ot-=this.DB)}rt==8&&et[0]&128&&(this.s=-1,ot>0&&(this.data[this.t-1]|=(1<<this.DB-ot)-1<<ot)),this.clamp(),it&&BigInteger$6.ZERO.subTo(this,this)}function bnpClamp$1(){for(var et=this.s&this.DM;this.t>0&&this.data[this.t-1]==et;)--this.t}function bnToString$1(et){if(this.s<0)return"-"+this.negate().toString(et);var tt;if(et==16)tt=4;else if(et==8)tt=3;else if(et==2)tt=1;else if(et==32)tt=5;else if(et==4)tt=2;else return this.toRadix(et);var rt=(1<<tt)-1,nt,it=!1,ot="",st=this.t,at=this.DB-st*this.DB%tt;if(st-- >0)for(at<this.DB&&(nt=this.data[st]>>at)>0&&(it=!0,ot=int2char$1(nt));st>=0;)at<tt?(nt=(this.data[st]&(1<<at)-1)<<tt-at,nt|=this.data[--st]>>(at+=this.DB-tt)):(nt=this.data[st]>>(at-=tt)&rt,at<=0&&(at+=this.DB,--st)),nt>0&&(it=!0),it&&(ot+=int2char$1(nt));return it?ot:"0"}function bnNegate$1(){var et=nbi$1();return BigInteger$6.ZERO.subTo(this,et),et}function bnAbs$1(){return this.s<0?this.negate():this}function bnCompareTo$1(et){var tt=this.s-et.s;if(tt!=0)return tt;var rt=this.t;if(tt=rt-et.t,tt!=0)return this.s<0?-tt:tt;for(;--rt>=0;)if((tt=this.data[rt]-et.data[rt])!=0)return tt;return 0}function nbits$1(et){var tt=1,rt;return(rt=et>>>16)!=0&&(et=rt,tt+=16),(rt=et>>8)!=0&&(et=rt,tt+=8),(rt=et>>4)!=0&&(et=rt,tt+=4),(rt=et>>2)!=0&&(et=rt,tt+=2),(rt=et>>1)!=0&&(et=rt,tt+=1),tt}function bnBitLength$1(){return this.t<=0?0:this.DB*(this.t-1)+nbits$1(this.data[this.t-1]^this.s&this.DM)}function bnpDLShiftTo$1(et,tt){var rt;for(rt=this.t-1;rt>=0;--rt)tt.data[rt+et]=this.data[rt];for(rt=et-1;rt>=0;--rt)tt.data[rt]=0;tt.t=this.t+et,tt.s=this.s}function bnpDRShiftTo$1(et,tt){for(var rt=et;rt<this.t;++rt)tt.data[rt-et]=this.data[rt];tt.t=Math.max(this.t-et,0),tt.s=this.s}function bnpLShiftTo$1(et,tt){var rt=et%this.DB,nt=this.DB-rt,it=(1<<nt)-1,ot=Math.floor(et/this.DB),st=this.s<<rt&this.DM,at;for(at=this.t-1;at>=0;--at)tt.data[at+ot+1]=this.data[at]>>nt|st,st=(this.data[at]&it)<<rt;for(at=ot-1;at>=0;--at)tt.data[at]=0;tt.data[ot]=st,tt.t=this.t+ot+1,tt.s=this.s,tt.clamp()}function bnpRShiftTo$1(et,tt){tt.s=this.s;var rt=Math.floor(et/this.DB);if(rt>=this.t){tt.t=0;return}var nt=et%this.DB,it=this.DB-nt,ot=(1<<nt)-1;tt.data[0]=this.data[rt]>>nt;for(var st=rt+1;st<this.t;++st)tt.data[st-rt-1]|=(this.data[st]&ot)<<it,tt.data[st-rt]=this.data[st]>>nt;nt>0&&(tt.data[this.t-rt-1]|=(this.s&ot)<<it),tt.t=this.t-rt,tt.clamp()}function bnpSubTo$1(et,tt){for(var rt=0,nt=0,it=Math.min(et.t,this.t);rt<it;)nt+=this.data[rt]-et.data[rt],tt.data[rt++]=nt&this.DM,nt>>=this.DB;if(et.t<this.t){for(nt-=et.s;rt<this.t;)nt+=this.data[rt],tt.data[rt++]=nt&this.DM,nt>>=this.DB;nt+=this.s}else{for(nt+=this.s;rt<et.t;)nt-=et.data[rt],tt.data[rt++]=nt&this.DM,nt>>=this.DB;nt-=et.s}tt.s=nt<0?-1:0,nt<-1?tt.data[rt++]=this.DV+nt:nt>0&&(tt.data[rt++]=nt),tt.t=rt,tt.clamp()}function bnpMultiplyTo$1(et,tt){var rt=this.abs(),nt=et.abs(),it=rt.t;for(tt.t=it+nt.t;--it>=0;)tt.data[it]=0;for(it=0;it<nt.t;++it)tt.data[it+rt.t]=rt.am(0,nt.data[it],tt,it,0,rt.t);tt.s=0,tt.clamp(),this.s!=et.s&&BigInteger$6.ZERO.subTo(tt,tt)}function bnpSquareTo$1(et){for(var tt=this.abs(),rt=et.t=2*tt.t;--rt>=0;)et.data[rt]=0;for(rt=0;rt<tt.t-1;++rt){var nt=tt.am(rt,tt.data[rt],et,2*rt,0,1);(et.data[rt+tt.t]+=tt.am(rt+1,2*tt.data[rt],et,2*rt+1,nt,tt.t-rt-1))>=tt.DV&&(et.data[rt+tt.t]-=tt.DV,et.data[rt+tt.t+1]=1)}et.t>0&&(et.data[et.t-1]+=tt.am(rt,tt.data[rt],et,2*rt,0,1)),et.s=0,et.clamp()}function bnpDivRemTo$1(et,tt,rt){var nt=et.abs();if(!(nt.t<=0)){var it=this.abs();if(it.t<nt.t){tt==null||tt.fromInt(0),rt!=null&&this.copyTo(rt);return}rt==null&&(rt=nbi$1());var ot=nbi$1(),st=this.s,at=et.s,ct=this.DB-nbits$1(nt.data[nt.t-1]);ct>0?(nt.lShiftTo(ct,ot),it.lShiftTo(ct,rt)):(nt.copyTo(ot),it.copyTo(rt));var ut=ot.t,lt=ot.data[ut-1];if(lt!=0){var ht=lt*(1<<this.F1)+(ut>1?ot.data[ut-2]>>this.F2:0),ft=this.FV/ht,dt=(1<<this.F1)/ht,pt=1<<this.F2,gt=rt.t,_t=gt-ut,mt=tt??nbi$1();for(ot.dlShiftTo(_t,mt),rt.compareTo(mt)>=0&&(rt.data[rt.t++]=1,rt.subTo(mt,rt)),BigInteger$6.ONE.dlShiftTo(ut,mt),mt.subTo(ot,ot);ot.t<ut;)ot.data[ot.t++]=0;for(;--_t>=0;){var At=rt.data[--gt]==lt?this.DM:Math.floor(rt.data[gt]*ft+(rt.data[gt-1]+pt)*dt);if((rt.data[gt]+=ot.am(0,At,rt,_t,0,ut))<At)for(ot.dlShiftTo(_t,mt),rt.subTo(mt,rt);rt.data[gt]<--At;)rt.subTo(mt,rt)}tt!=null&&(rt.drShiftTo(ut,tt),st!=at&&BigInteger$6.ZERO.subTo(tt,tt)),rt.t=ut,rt.clamp(),ct>0&&rt.rShiftTo(ct,rt),st<0&&BigInteger$6.ZERO.subTo(rt,rt)}}}function bnMod$1(et){var tt=nbi$1();return this.abs().divRemTo(et,null,tt),this.s<0&&tt.compareTo(BigInteger$6.ZERO)>0&&et.subTo(tt,tt),tt}function Classic$1(et){this.m=et}function cConvert$1(et){return et.s<0||et.compareTo(this.m)>=0?et.mod(this.m):et}function cRevert$1(et){return et}function cReduce$1(et){et.divRemTo(this.m,null,et)}function cMulTo$1(et,tt,rt){et.multiplyTo(tt,rt),this.reduce(rt)}function cSqrTo$1(et,tt){et.squareTo(tt),this.reduce(tt)}Classic$1.prototype.convert=cConvert$1,Classic$1.prototype.revert=cRevert$1,Classic$1.prototype.reduce=cReduce$1,Classic$1.prototype.mulTo=cMulTo$1,Classic$1.prototype.sqrTo=cSqrTo$1;function bnpInvDigit$1(){if(this.t<1)return 0;var et=this.data[0];if(!(et&1))return 0;var tt=et&3;return tt=tt*(2-(et&15)*tt)&15,tt=tt*(2-(et&255)*tt)&255,tt=tt*(2-((et&65535)*tt&65535))&65535,tt=tt*(2-et*tt%this.DV)%this.DV,tt>0?this.DV-tt:-tt}function Montgomery$1(et){this.m=et,this.mp=et.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<et.DB-15)-1,this.mt2=2*et.t}function montConvert$1(et){var tt=nbi$1();return et.abs().dlShiftTo(this.m.t,tt),tt.divRemTo(this.m,null,tt),et.s<0&&tt.compareTo(BigInteger$6.ZERO)>0&&this.m.subTo(tt,tt),tt}function montRevert$1(et){var tt=nbi$1();return et.copyTo(tt),this.reduce(tt),tt}function montReduce$1(et){for(;et.t<=this.mt2;)et.data[et.t++]=0;for(var tt=0;tt<this.m.t;++tt){var rt=et.data[tt]&32767,nt=rt*this.mpl+((rt*this.mph+(et.data[tt]>>15)*this.mpl&this.um)<<15)&et.DM;for(rt=tt+this.m.t,et.data[rt]+=this.m.am(0,nt,et,tt,0,this.m.t);et.data[rt]>=et.DV;)et.data[rt]-=et.DV,et.data[++rt]++}et.clamp(),et.drShiftTo(this.m.t,et),et.compareTo(this.m)>=0&&et.subTo(this.m,et)}function montSqrTo$1(et,tt){et.squareTo(tt),this.reduce(tt)}function montMulTo$1(et,tt,rt){et.multiplyTo(tt,rt),this.reduce(rt)}Montgomery$1.prototype.convert=montConvert$1,Montgomery$1.prototype.revert=montRevert$1,Montgomery$1.prototype.reduce=montReduce$1,Montgomery$1.prototype.mulTo=montMulTo$1,Montgomery$1.prototype.sqrTo=montSqrTo$1;function bnpIsEven$1(){return(this.t>0?this.data[0]&1:this.s)==0}function bnpExp$1(et,tt){if(et>4294967295||et<1)return BigInteger$6.ONE;var rt=nbi$1(),nt=nbi$1(),it=tt.convert(this),ot=nbits$1(et)-1;for(it.copyTo(rt);--ot>=0;)if(tt.sqrTo(rt,nt),(et&1<<ot)>0)tt.mulTo(nt,it,rt);else{var st=rt;rt=nt,nt=st}return tt.revert(rt)}function bnModPowInt$1(et,tt){var rt;return et<256||tt.isEven()?rt=new Classic$1(tt):rt=new Montgomery$1(tt),this.exp(et,rt)}BigInteger$6.prototype.copyTo=bnpCopyTo$1,BigInteger$6.prototype.fromInt=bnpFromInt$1,BigInteger$6.prototype.fromString=bnpFromString$1,BigInteger$6.prototype.clamp=bnpClamp$1,BigInteger$6.prototype.dlShiftTo=bnpDLShiftTo$1,BigInteger$6.prototype.drShiftTo=bnpDRShiftTo$1,BigInteger$6.prototype.lShiftTo=bnpLShiftTo$1,BigInteger$6.prototype.rShiftTo=bnpRShiftTo$1,BigInteger$6.prototype.subTo=bnpSubTo$1,BigInteger$6.prototype.multiplyTo=bnpMultiplyTo$1,BigInteger$6.prototype.squareTo=bnpSquareTo$1,BigInteger$6.prototype.divRemTo=bnpDivRemTo$1,BigInteger$6.prototype.invDigit=bnpInvDigit$1,BigInteger$6.prototype.isEven=bnpIsEven$1,BigInteger$6.prototype.exp=bnpExp$1,BigInteger$6.prototype.toString=bnToString$1,BigInteger$6.prototype.negate=bnNegate$1,BigInteger$6.prototype.abs=bnAbs$1,BigInteger$6.prototype.compareTo=bnCompareTo$1,BigInteger$6.prototype.bitLength=bnBitLength$1,BigInteger$6.prototype.mod=bnMod$1,BigInteger$6.prototype.modPowInt=bnModPowInt$1,BigInteger$6.ZERO=nbv$1(0),BigInteger$6.ONE=nbv$1(1);function bnClone$1(){var et=nbi$1();return this.copyTo(et),et}function bnIntValue$1(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function bnByteValue$1(){return this.t==0?this.s:this.data[0]<<24>>24}function bnShortValue$1(){return this.t==0?this.s:this.data[0]<<16>>16}function bnpChunkSize$1(et){return Math.floor(Math.LN2*this.DB/Math.log(et))}function bnSigNum$1(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function bnpToRadix$1(et){if(et==null&&(et=10),this.signum()==0||et<2||et>36)return"0";var tt=this.chunkSize(et),rt=Math.pow(et,tt),nt=nbv$1(rt),it=nbi$1(),ot=nbi$1(),st="";for(this.divRemTo(nt,it,ot);it.signum()>0;)st=(rt+ot.intValue()).toString(et).substr(1)+st,it.divRemTo(nt,it,ot);return ot.intValue().toString(et)+st}function bnpFromRadix$1(et,tt){this.fromInt(0),tt==null&&(tt=10);for(var rt=this.chunkSize(tt),nt=Math.pow(tt,rt),it=!1,ot=0,st=0,at=0;at<et.length;++at){var ct=intAt$1(et,at);if(ct<0){et.charAt(at)=="-"&&this.signum()==0&&(it=!0);continue}st=tt*st+ct,++ot>=rt&&(this.dMultiply(nt),this.dAddOffset(st,0),ot=0,st=0)}ot>0&&(this.dMultiply(Math.pow(tt,ot)),this.dAddOffset(st,0)),it&&BigInteger$6.ZERO.subTo(this,this)}function bnpFromNumber$1(et,tt,rt){if(typeof tt=="number")if(et<2)this.fromInt(1);else for(this.fromNumber(et,rt),this.testBit(et-1)||this.bitwiseTo(BigInteger$6.ONE.shiftLeft(et-1),op_or$1,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(tt);)this.dAddOffset(2,0),this.bitLength()>et&&this.subTo(BigInteger$6.ONE.shiftLeft(et-1),this);else{var nt=new Array,it=et&7;nt.length=(et>>3)+1,tt.nextBytes(nt),it>0?nt[0]&=(1<<it)-1:nt[0]=0,this.fromString(nt,256)}}function bnToByteArray$1(){var et=this.t,tt=new Array;tt[0]=this.s;var rt=this.DB-et*this.DB%8,nt,it=0;if(et-- >0)for(rt<this.DB&&(nt=this.data[et]>>rt)!=(this.s&this.DM)>>rt&&(tt[it++]=nt|this.s<<this.DB-rt);et>=0;)rt<8?(nt=(this.data[et]&(1<<rt)-1)<<8-rt,nt|=this.data[--et]>>(rt+=this.DB-8)):(nt=this.data[et]>>(rt-=8)&255,rt<=0&&(rt+=this.DB,--et)),nt&128&&(nt|=-256),it==0&&(this.s&128)!=(nt&128)&&++it,(it>0||nt!=this.s)&&(tt[it++]=nt);return tt}function bnEquals$1(et){return this.compareTo(et)==0}function bnMin$1(et){return this.compareTo(et)<0?this:et}function bnMax$1(et){return this.compareTo(et)>0?this:et}function bnpBitwiseTo$1(et,tt,rt){var nt,it,ot=Math.min(et.t,this.t);for(nt=0;nt<ot;++nt)rt.data[nt]=tt(this.data[nt],et.data[nt]);if(et.t<this.t){for(it=et.s&this.DM,nt=ot;nt<this.t;++nt)rt.data[nt]=tt(this.data[nt],it);rt.t=this.t}else{for(it=this.s&this.DM,nt=ot;nt<et.t;++nt)rt.data[nt]=tt(it,et.data[nt]);rt.t=et.t}rt.s=tt(this.s,et.s),rt.clamp()}function op_and$1(et,tt){return et&tt}function bnAnd$1(et){var tt=nbi$1();return this.bitwiseTo(et,op_and$1,tt),tt}function op_or$1(et,tt){return et|tt}function bnOr$1(et){var tt=nbi$1();return this.bitwiseTo(et,op_or$1,tt),tt}function op_xor$1(et,tt){return et^tt}function bnXor$1(et){var tt=nbi$1();return this.bitwiseTo(et,op_xor$1,tt),tt}function op_andnot$1(et,tt){return et&~tt}function bnAndNot$1(et){var tt=nbi$1();return this.bitwiseTo(et,op_andnot$1,tt),tt}function bnNot$1(){for(var et=nbi$1(),tt=0;tt<this.t;++tt)et.data[tt]=this.DM&~this.data[tt];return et.t=this.t,et.s=~this.s,et}function bnShiftLeft$1(et){var tt=nbi$1();return et<0?this.rShiftTo(-et,tt):this.lShiftTo(et,tt),tt}function bnShiftRight$1(et){var tt=nbi$1();return et<0?this.lShiftTo(-et,tt):this.rShiftTo(et,tt),tt}function lbit$1(et){if(et==0)return-1;var tt=0;return et&65535||(et>>=16,tt+=16),et&255||(et>>=8,tt+=8),et&15||(et>>=4,tt+=4),et&3||(et>>=2,tt+=2),et&1||++tt,tt}function bnGetLowestSetBit$1(){for(var et=0;et<this.t;++et)if(this.data[et]!=0)return et*this.DB+lbit$1(this.data[et]);return this.s<0?this.t*this.DB:-1}function cbit$1(et){for(var tt=0;et!=0;)et&=et-1,++tt;return tt}function bnBitCount$1(){for(var et=0,tt=this.s&this.DM,rt=0;rt<this.t;++rt)et+=cbit$1(this.data[rt]^tt);return et}function bnTestBit$1(et){var tt=Math.floor(et/this.DB);return tt>=this.t?this.s!=0:(this.data[tt]&1<<et%this.DB)!=0}function bnpChangeBit$1(et,tt){var rt=BigInteger$6.ONE.shiftLeft(et);return this.bitwiseTo(rt,tt,rt),rt}function bnSetBit$1(et){return this.changeBit(et,op_or$1)}function bnClearBit$1(et){return this.changeBit(et,op_andnot$1)}function bnFlipBit$1(et){return this.changeBit(et,op_xor$1)}function bnpAddTo$1(et,tt){for(var rt=0,nt=0,it=Math.min(et.t,this.t);rt<it;)nt+=this.data[rt]+et.data[rt],tt.data[rt++]=nt&this.DM,nt>>=this.DB;if(et.t<this.t){for(nt+=et.s;rt<this.t;)nt+=this.data[rt],tt.data[rt++]=nt&this.DM,nt>>=this.DB;nt+=this.s}else{for(nt+=this.s;rt<et.t;)nt+=et.data[rt],tt.data[rt++]=nt&this.DM,nt>>=this.DB;nt+=et.s}tt.s=nt<0?-1:0,nt>0?tt.data[rt++]=nt:nt<-1&&(tt.data[rt++]=this.DV+nt),tt.t=rt,tt.clamp()}function bnAdd$1(et){var tt=nbi$1();return this.addTo(et,tt),tt}function bnSubtract$1(et){var tt=nbi$1();return this.subTo(et,tt),tt}function bnMultiply$1(et){var tt=nbi$1();return this.multiplyTo(et,tt),tt}function bnDivide$1(et){var tt=nbi$1();return this.divRemTo(et,tt,null),tt}function bnRemainder$1(et){var tt=nbi$1();return this.divRemTo(et,null,tt),tt}function bnDivideAndRemainder$1(et){var tt=nbi$1(),rt=nbi$1();return this.divRemTo(et,tt,rt),new Array(tt,rt)}function bnpDMultiply$1(et){this.data[this.t]=this.am(0,et-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset$1(et,tt){if(et!=0){for(;this.t<=tt;)this.data[this.t++]=0;for(this.data[tt]+=et;this.data[tt]>=this.DV;)this.data[tt]-=this.DV,++tt>=this.t&&(this.data[this.t++]=0),++this.data[tt]}}function NullExp$1(){}function nNop$1(et){return et}function nMulTo$1(et,tt,rt){et.multiplyTo(tt,rt)}function nSqrTo$1(et,tt){et.squareTo(tt)}NullExp$1.prototype.convert=nNop$1,NullExp$1.prototype.revert=nNop$1,NullExp$1.prototype.mulTo=nMulTo$1,NullExp$1.prototype.sqrTo=nSqrTo$1;function bnPow$1(et){return this.exp(et,new NullExp$1)}function bnpMultiplyLowerTo$1(et,tt,rt){var nt=Math.min(this.t+et.t,tt);for(rt.s=0,rt.t=nt;nt>0;)rt.data[--nt]=0;var it;for(it=rt.t-this.t;nt<it;++nt)rt.data[nt+this.t]=this.am(0,et.data[nt],rt,nt,0,this.t);for(it=Math.min(et.t,tt);nt<it;++nt)this.am(0,et.data[nt],rt,nt,0,tt-nt);rt.clamp()}function bnpMultiplyUpperTo$1(et,tt,rt){--tt;var nt=rt.t=this.t+et.t-tt;for(rt.s=0;--nt>=0;)rt.data[nt]=0;for(nt=Math.max(tt-this.t,0);nt<et.t;++nt)rt.data[this.t+nt-tt]=this.am(tt-nt,et.data[nt],rt,0,0,this.t+nt-tt);rt.clamp(),rt.drShiftTo(1,rt)}function Barrett$1(et){this.r2=nbi$1(),this.q3=nbi$1(),BigInteger$6.ONE.dlShiftTo(2*et.t,this.r2),this.mu=this.r2.divide(et),this.m=et}function barrettConvert$1(et){if(et.s<0||et.t>2*this.m.t)return et.mod(this.m);if(et.compareTo(this.m)<0)return et;var tt=nbi$1();return et.copyTo(tt),this.reduce(tt),tt}function barrettRevert$1(et){return et}function barrettReduce$1(et){for(et.drShiftTo(this.m.t-1,this.r2),et.t>this.m.t+1&&(et.t=this.m.t+1,et.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);et.compareTo(this.r2)<0;)et.dAddOffset(1,this.m.t+1);for(et.subTo(this.r2,et);et.compareTo(this.m)>=0;)et.subTo(this.m,et)}function barrettSqrTo$1(et,tt){et.squareTo(tt),this.reduce(tt)}function barrettMulTo$1(et,tt,rt){et.multiplyTo(tt,rt),this.reduce(rt)}Barrett$1.prototype.convert=barrettConvert$1,Barrett$1.prototype.revert=barrettRevert$1,Barrett$1.prototype.reduce=barrettReduce$1,Barrett$1.prototype.mulTo=barrettMulTo$1,Barrett$1.prototype.sqrTo=barrettSqrTo$1;function bnModPow$1(et,tt){var rt=et.bitLength(),nt,it=nbv$1(1),ot;if(rt<=0)return it;rt<18?nt=1:rt<48?nt=3:rt<144?nt=4:rt<768?nt=5:nt=6,rt<8?ot=new Classic$1(tt):tt.isEven()?ot=new Barrett$1(tt):ot=new Montgomery$1(tt);var st=new Array,at=3,ct=nt-1,ut=(1<<nt)-1;if(st[1]=ot.convert(this),nt>1){var lt=nbi$1();for(ot.sqrTo(st[1],lt);at<=ut;)st[at]=nbi$1(),ot.mulTo(lt,st[at-2],st[at]),at+=2}var ht=et.t-1,ft,dt=!0,pt=nbi$1(),gt;for(rt=nbits$1(et.data[ht])-1;ht>=0;){for(rt>=ct?ft=et.data[ht]>>rt-ct&ut:(ft=(et.data[ht]&(1<<rt+1)-1)<<ct-rt,ht>0&&(ft|=et.data[ht-1]>>this.DB+rt-ct)),at=nt;!(ft&1);)ft>>=1,--at;if((rt-=at)<0&&(rt+=this.DB,--ht),dt)st[ft].copyTo(it),dt=!1;else{for(;at>1;)ot.sqrTo(it,pt),ot.sqrTo(pt,it),at-=2;at>0?ot.sqrTo(it,pt):(gt=it,it=pt,pt=gt),ot.mulTo(pt,st[ft],it)}for(;ht>=0&&!(et.data[ht]&1<<rt);)ot.sqrTo(it,pt),gt=it,it=pt,pt=gt,--rt<0&&(rt=this.DB-1,--ht)}return ot.revert(it)}function bnGCD$1(et){var tt=this.s<0?this.negate():this.clone(),rt=et.s<0?et.negate():et.clone();if(tt.compareTo(rt)<0){var nt=tt;tt=rt,rt=nt}var it=tt.getLowestSetBit(),ot=rt.getLowestSetBit();if(ot<0)return tt;for(it<ot&&(ot=it),ot>0&&(tt.rShiftTo(ot,tt),rt.rShiftTo(ot,rt));tt.signum()>0;)(it=tt.getLowestSetBit())>0&&tt.rShiftTo(it,tt),(it=rt.getLowestSetBit())>0&&rt.rShiftTo(it,rt),tt.compareTo(rt)>=0?(tt.subTo(rt,tt),tt.rShiftTo(1,tt)):(rt.subTo(tt,rt),rt.rShiftTo(1,rt));return ot>0&&rt.lShiftTo(ot,rt),rt}function bnpModInt$1(et){if(et<=0)return 0;var tt=this.DV%et,rt=this.s<0?et-1:0;if(this.t>0)if(tt==0)rt=this.data[0]%et;else for(var nt=this.t-1;nt>=0;--nt)rt=(tt*rt+this.data[nt])%et;return rt}function bnModInverse$1(et){var tt=et.isEven();if(this.isEven()&&tt||et.signum()==0)return BigInteger$6.ZERO;for(var rt=et.clone(),nt=this.clone(),it=nbv$1(1),ot=nbv$1(0),st=nbv$1(0),at=nbv$1(1);rt.signum()!=0;){for(;rt.isEven();)rt.rShiftTo(1,rt),tt?((!it.isEven()||!ot.isEven())&&(it.addTo(this,it),ot.subTo(et,ot)),it.rShiftTo(1,it)):ot.isEven()||ot.subTo(et,ot),ot.rShiftTo(1,ot);for(;nt.isEven();)nt.rShiftTo(1,nt),tt?((!st.isEven()||!at.isEven())&&(st.addTo(this,st),at.subTo(et,at)),st.rShiftTo(1,st)):at.isEven()||at.subTo(et,at),at.rShiftTo(1,at);rt.compareTo(nt)>=0?(rt.subTo(nt,rt),tt&&it.subTo(st,it),ot.subTo(at,ot)):(nt.subTo(rt,nt),tt&&st.subTo(it,st),at.subTo(ot,at))}if(nt.compareTo(BigInteger$6.ONE)!=0)return BigInteger$6.ZERO;if(at.compareTo(et)>=0)return at.subtract(et);if(at.signum()<0)at.addTo(et,at);else return at;return at.signum()<0?at.add(et):at}var lowprimes$1=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],lplim$1=(1<<26)/lowprimes$1[lowprimes$1.length-1];function bnIsProbablePrime$1(et){var tt,rt=this.abs();if(rt.t==1&&rt.data[0]<=lowprimes$1[lowprimes$1.length-1]){for(tt=0;tt<lowprimes$1.length;++tt)if(rt.data[0]==lowprimes$1[tt])return!0;return!1}if(rt.isEven())return!1;for(tt=1;tt<lowprimes$1.length;){for(var nt=lowprimes$1[tt],it=tt+1;it<lowprimes$1.length&&nt<lplim$1;)nt*=lowprimes$1[it++];for(nt=rt.modInt(nt);tt<it;)if(nt%lowprimes$1[tt++]==0)return!1}return rt.millerRabin(et)}function bnpMillerRabin$1(et){var tt=this.subtract(BigInteger$6.ONE),rt=tt.getLowestSetBit();if(rt<=0)return!1;for(var nt=tt.shiftRight(rt),it=bnGetPrng$1(),ot,st=0;st<et;++st){do ot=new BigInteger$6(this.bitLength(),it);while(ot.compareTo(BigInteger$6.ONE)<=0||ot.compareTo(tt)>=0);var at=ot.modPow(nt,this);if(at.compareTo(BigInteger$6.ONE)!=0&&at.compareTo(tt)!=0){for(var ct=1;ct++<rt&&at.compareTo(tt)!=0;)if(at=at.modPowInt(2,this),at.compareTo(BigInteger$6.ONE)==0)return!1;if(at.compareTo(tt)!=0)return!1}}return!0}function bnGetPrng$1(){return{nextBytes:function(et){for(var tt=0;tt<et.length;++tt)et[tt]=Math.floor(Math.random()*256)}}}BigInteger$6.prototype.chunkSize=bnpChunkSize$1,BigInteger$6.prototype.toRadix=bnpToRadix$1,BigInteger$6.prototype.fromRadix=bnpFromRadix$1,BigInteger$6.prototype.fromNumber=bnpFromNumber$1,BigInteger$6.prototype.bitwiseTo=bnpBitwiseTo$1,BigInteger$6.prototype.changeBit=bnpChangeBit$1,BigInteger$6.prototype.addTo=bnpAddTo$1,BigInteger$6.prototype.dMultiply=bnpDMultiply$1,BigInteger$6.prototype.dAddOffset=bnpDAddOffset$1,BigInteger$6.prototype.multiplyLowerTo=bnpMultiplyLowerTo$1,BigInteger$6.prototype.multiplyUpperTo=bnpMultiplyUpperTo$1,BigInteger$6.prototype.modInt=bnpModInt$1,BigInteger$6.prototype.millerRabin=bnpMillerRabin$1,BigInteger$6.prototype.clone=bnClone$1,BigInteger$6.prototype.intValue=bnIntValue$1,BigInteger$6.prototype.byteValue=bnByteValue$1,BigInteger$6.prototype.shortValue=bnShortValue$1,BigInteger$6.prototype.signum=bnSigNum$1,BigInteger$6.prototype.toByteArray=bnToByteArray$1,BigInteger$6.prototype.equals=bnEquals$1,BigInteger$6.prototype.min=bnMin$1,BigInteger$6.prototype.max=bnMax$1,BigInteger$6.prototype.and=bnAnd$1,BigInteger$6.prototype.or=bnOr$1,BigInteger$6.prototype.xor=bnXor$1,BigInteger$6.prototype.andNot=bnAndNot$1,BigInteger$6.prototype.not=bnNot$1,BigInteger$6.prototype.shiftLeft=bnShiftLeft$1,BigInteger$6.prototype.shiftRight=bnShiftRight$1,BigInteger$6.prototype.getLowestSetBit=bnGetLowestSetBit$1,BigInteger$6.prototype.bitCount=bnBitCount$1,BigInteger$6.prototype.testBit=bnTestBit$1,BigInteger$6.prototype.setBit=bnSetBit$1,BigInteger$6.prototype.clearBit=bnClearBit$1,BigInteger$6.prototype.flipBit=bnFlipBit$1,BigInteger$6.prototype.add=bnAdd$1,BigInteger$6.prototype.subtract=bnSubtract$1,BigInteger$6.prototype.multiply=bnMultiply$1,BigInteger$6.prototype.divide=bnDivide$1,BigInteger$6.prototype.remainder=bnRemainder$1,BigInteger$6.prototype.divideAndRemainder=bnDivideAndRemainder$1,BigInteger$6.prototype.modPow=bnModPow$1,BigInteger$6.prototype.modInverse=bnModInverse$1,BigInteger$6.prototype.pow=bnPow$1,BigInteger$6.prototype.gcd=bnGCD$1,BigInteger$6.prototype.isProbablePrime=bnIsProbablePrime$1;var forge$F=forge$W,sha1$1=forge$F.sha1=forge$F.sha1||{};forge$F.md.sha1=forge$F.md.algorithms.sha1=sha1$1,sha1$1.create=function(){_initialized$4||_init$4();var et=null,tt=forge$F.util.createBuffer(),rt=new Array(80),nt={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return nt.start=function(){nt.messageLength=0,nt.fullMessageLength=nt.messageLength64=[];for(var it=nt.messageLengthSize/4,ot=0;ot<it;++ot)nt.fullMessageLength.push(0);return tt=forge$F.util.createBuffer(),et={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},nt},nt.start(),nt.update=function(it,ot){ot==="utf8"&&(it=forge$F.util.encodeUtf8(it));var st=it.length;nt.messageLength+=st,st=[st/4294967296>>>0,st>>>0];for(var at=nt.fullMessageLength.length-1;at>=0;--at)nt.fullMessageLength[at]+=st[1],st[1]=st[0]+(nt.fullMessageLength[at]/4294967296>>>0),nt.fullMessageLength[at]=nt.fullMessageLength[at]>>>0,st[0]=st[1]/4294967296>>>0;return tt.putBytes(it),_update$4(et,rt,tt),(tt.read>2048||tt.length()===0)&&tt.compact(),nt},nt.digest=function(){var it=forge$F.util.createBuffer();it.putBytes(tt.bytes());var ot=nt.fullMessageLength[nt.fullMessageLength.length-1]+nt.messageLengthSize,st=ot&nt.blockLength-1;it.putBytes(_padding$4.substr(0,nt.blockLength-st));for(var at,ct,ut=nt.fullMessageLength[0]*8,lt=0;lt<nt.fullMessageLength.length-1;++lt)at=nt.fullMessageLength[lt+1]*8,ct=at/4294967296>>>0,ut+=ct,it.putInt32(ut>>>0),ut=at>>>0;it.putInt32(ut);var ht={h0:et.h0,h1:et.h1,h2:et.h2,h3:et.h3,h4:et.h4};_update$4(ht,rt,it);var ft=forge$F.util.createBuffer();return ft.putInt32(ht.h0),ft.putInt32(ht.h1),ft.putInt32(ht.h2),ft.putInt32(ht.h3),ft.putInt32(ht.h4),ft},nt};var _padding$4=null,_initialized$4=!1;function _init$4(){_padding$4=String.fromCharCode(128),_padding$4+=forge$F.util.fillString(String.fromCharCode(0),64),_initialized$4=!0}function _update$4(et,tt,rt){for(var nt,it,ot,st,at,ct,ut,lt,ht=rt.length();ht>=64;){for(it=et.h0,ot=et.h1,st=et.h2,at=et.h3,ct=et.h4,lt=0;lt<16;++lt)nt=rt.getInt32(),tt[lt]=nt,ut=at^ot&(st^at),nt=(it<<5|it>>>27)+ut+ct+1518500249+nt,ct=at,at=st,st=(ot<<30|ot>>>2)>>>0,ot=it,it=nt;for(;lt<20;++lt)nt=tt[lt-3]^tt[lt-8]^tt[lt-14]^tt[lt-16],nt=nt<<1|nt>>>31,tt[lt]=nt,ut=at^ot&(st^at),nt=(it<<5|it>>>27)+ut+ct+1518500249+nt,ct=at,at=st,st=(ot<<30|ot>>>2)>>>0,ot=it,it=nt;for(;lt<32;++lt)nt=tt[lt-3]^tt[lt-8]^tt[lt-14]^tt[lt-16],nt=nt<<1|nt>>>31,tt[lt]=nt,ut=ot^st^at,nt=(it<<5|it>>>27)+ut+ct+1859775393+nt,ct=at,at=st,st=(ot<<30|ot>>>2)>>>0,ot=it,it=nt;for(;lt<40;++lt)nt=tt[lt-6]^tt[lt-16]^tt[lt-28]^tt[lt-32],nt=nt<<2|nt>>>30,tt[lt]=nt,ut=ot^st^at,nt=(it<<5|it>>>27)+ut+ct+1859775393+nt,ct=at,at=st,st=(ot<<30|ot>>>2)>>>0,ot=it,it=nt;for(;lt<60;++lt)nt=tt[lt-6]^tt[lt-16]^tt[lt-28]^tt[lt-32],nt=nt<<2|nt>>>30,tt[lt]=nt,ut=ot&st|at&(ot^st),nt=(it<<5|it>>>27)+ut+ct+2400959708+nt,ct=at,at=st,st=(ot<<30|ot>>>2)>>>0,ot=it,it=nt;for(;lt<80;++lt)nt=tt[lt-6]^tt[lt-16]^tt[lt-28]^tt[lt-32],nt=nt<<2|nt>>>30,tt[lt]=nt,ut=ot^st^at,nt=(it<<5|it>>>27)+ut+ct+3395469782+nt,ct=at,at=st,st=(ot<<30|ot>>>2)>>>0,ot=it,it=nt;et.h0=et.h0+it|0,et.h1=et.h1+ot|0,et.h2=et.h2+st|0,et.h3=et.h3+at|0,et.h4=et.h4+ct|0,ht-=64}}var forge$E=forge$W,pkcs1$1=forge$E.pkcs1=forge$E.pkcs1||{};pkcs1$1.encode_rsa_oaep=function(et,tt,rt){var nt,it,ot,st;typeof rt=="string"?(nt=rt,it=arguments[3]||void 0,ot=arguments[4]||void 0):rt&&(nt=rt.label||void 0,it=rt.seed||void 0,ot=rt.md||void 0,rt.mgf1&&rt.mgf1.md&&(st=rt.mgf1.md)),ot?ot.start():ot=forge$E.md.sha1.create(),st||(st=ot);var at=Math.ceil(et.n.bitLength()/8),ct=at-2*ot.digestLength-2;if(tt.length>ct){var ut=new Error("RSAES-OAEP input message length is too long.");throw ut.length=tt.length,ut.maxLength=ct,ut}nt||(nt=""),ot.update(nt,"raw");for(var lt=ot.digest(),ht="",ft=ct-tt.length,dt=0;dt<ft;dt++)ht+="\0";var pt=lt.getBytes()+ht+""+tt;if(!it)it=forge$E.random.getBytes(ot.digestLength);else if(it.length!==ot.digestLength){var ut=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw ut.seedLength=it.length,ut.digestLength=ot.digestLength,ut}var gt=rsa_mgf1$1(it,at-ot.digestLength-1,st),_t=forge$E.util.xorBytes(pt,gt,pt.length),mt=rsa_mgf1$1(_t,ot.digestLength,st),At=forge$E.util.xorBytes(it,mt,it.length);return"\0"+At+_t},pkcs1$1.decode_rsa_oaep=function(et,tt,rt){var nt,it,ot;typeof rt=="string"?(nt=rt,it=arguments[3]||void 0):rt&&(nt=rt.label||void 0,it=rt.md||void 0,rt.mgf1&&rt.mgf1.md&&(ot=rt.mgf1.md));var st=Math.ceil(et.n.bitLength()/8);if(tt.length!==st){var at=new Error("RSAES-OAEP encoded message length is invalid.");throw at.length=tt.length,at.expectedLength=st,at}if(it===void 0?it=forge$E.md.sha1.create():it.start(),ot||(ot=it),st<2*it.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");nt||(nt=""),it.update(nt,"raw");for(var ct=it.digest().getBytes(),ut=tt.charAt(0),lt=tt.substring(1,it.digestLength+1),ht=tt.substring(1+it.digestLength),ft=rsa_mgf1$1(ht,it.digestLength,ot),dt=forge$E.util.xorBytes(lt,ft,lt.length),pt=rsa_mgf1$1(dt,st-it.digestLength-1,ot),gt=forge$E.util.xorBytes(ht,pt,ht.length),_t=gt.substring(0,it.digestLength),at=ut!=="\0",mt=0;mt<it.digestLength;++mt)at|=ct.charAt(mt)!==_t.charAt(mt);for(var At=1,It=it.digestLength,Mt=it.digestLength;Mt<gt.length;Mt++){var kt=gt.charCodeAt(Mt),Ct=kt&1^1,Ut=At?65534:0;at|=kt&Ut,At=At&Ct,It+=At}if(at||gt.charCodeAt(It)!==1)throw new Error("Invalid RSAES-OAEP padding.");return gt.substring(It+1)};function rsa_mgf1$1(et,tt,rt){rt||(rt=forge$E.md.sha1.create());for(var nt="",it=Math.ceil(tt/rt.digestLength),ot=0;ot<it;++ot){var st=String.fromCharCode(ot>>24&255,ot>>16&255,ot>>8&255,ot&255);rt.start(),rt.update(et+st),nt+=rt.digest().getBytes()}return nt.substring(0,tt)}var forge$D=forge$W;(function(){if(forge$D.prime){forge$D.prime;return}var et=forge$D.prime=forge$D.prime||{},tt=forge$D.jsbn.BigInteger,rt=[6,4,2,4,2,4,6,2],nt=new tt(null);nt.fromInt(30);var it=function(ht,ft){return ht|ft};et.generateProbablePrime=function(ht,ft,dt){typeof ft=="function"&&(dt=ft,ft={}),ft=ft||{};var pt=ft.algorithm||"PRIMEINC";typeof pt=="string"&&(pt={name:pt}),pt.options=pt.options||{};var gt=ft.prng||forge$D.random,_t={nextBytes:function(mt){for(var At=gt.getBytesSync(mt.length),It=0;It<mt.length;++It)mt[It]=At.charCodeAt(It)}};if(pt.name==="PRIMEINC")return ot(ht,_t,pt.options,dt);throw new Error("Invalid prime generation algorithm: "+pt.name)};function ot(ht,ft,dt,pt){return"workers"in dt?ct(ht,ft,dt,pt):st(ht,ft,dt,pt)}function st(ht,ft,dt,pt){var gt=ut(ht,ft),_t=0,mt=lt(gt.bitLength());"millerRabinTests"in dt&&(mt=dt.millerRabinTests);var At=10;"maxBlockTime"in dt&&(At=dt.maxBlockTime),at(gt,ht,ft,_t,mt,At,pt)}function at(ht,ft,dt,pt,gt,_t,mt){var At=+new Date;do{if(ht.bitLength()>ft&&(ht=ut(ft,dt)),ht.isProbablePrime(gt))return mt(null,ht);ht.dAddOffset(rt[pt++%8],0)}while(_t<0||+new Date-At<_t);forge$D.util.setImmediate(function(){at(ht,ft,dt,pt,gt,_t,mt)})}function ct(ht,ft,dt,pt){if(typeof Worker>"u")return st(ht,ft,dt,pt);var gt=ut(ht,ft),_t=dt.workers,mt=dt.workLoad||100,At=mt*30/8,It=dt.workerScript||"forge/prime.worker.js";if(_t===-1)return forge$D.util.estimateCores(function(kt,Ct){kt&&(Ct=2),_t=Ct-1,Mt()});Mt();function Mt(){_t=Math.max(1,_t);for(var kt=[],Ct=0;Ct<_t;++Ct)kt[Ct]=new Worker(It);for(var Ct=0;Ct<_t;++Ct)kt[Ct].addEventListener("message",Wt);var Ut=!1;function Wt(Ft){if(!Ut){var Ce=Ft.data;if(Ce.found){for(var bt=0;bt<kt.length;++bt)kt[bt].terminate();return Ut=!0,pt(null,new tt(Ce.prime,16))}gt.bitLength()>ht&&(gt=ut(ht,ft));var yt=gt.toString(16);Ft.target.postMessage({hex:yt,workLoad:mt}),gt.dAddOffset(At,0)}}}}function ut(ht,ft){var dt=new tt(ht,ft),pt=ht-1;return dt.testBit(pt)||dt.bitwiseTo(tt.ONE.shiftLeft(pt),it,dt),dt.dAddOffset(31-dt.mod(nt).byteValue(),0),dt}function lt(ht){return ht<=100?27:ht<=150?18:ht<=200?15:ht<=250?12:ht<=300?9:ht<=350?8:ht<=400?7:ht<=500?6:ht<=600?5:ht<=800?4:ht<=1250?3:2}})();var forge$C=forge$W;if(typeof BigInteger$5>"u")var BigInteger$5=forge$C.jsbn.BigInteger;var _crypto$2=forge$C.util.isNodejs?require$$0$3:null,asn1$5=forge$C.asn1,util$5=forge$C.util;forge$C.pki=forge$C.pki||{},forge$C.pki.rsa=forge$C.rsa=forge$C.rsa||{};var pki$3=forge$C.pki,GCD_30_DELTA$1=[6,4,2,4,2,4,6,2],privateKeyValidator$2={name:"PrivateKeyInfo",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},rsaPrivateKeyValidator$1={name:"RSAPrivateKey",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},rsaPublicKeyValidator$1={name:"RSAPublicKey",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},publicKeyValidator$2=forge$C.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:asn1$5.Class.UNIVERSAL,type:asn1$5.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},emsaPkcs1v15encode$1=function(et){var tt;if(et.algorithm in pki$3.oids)tt=pki$3.oids[et.algorithm];else{var rt=new Error("Unknown message digest algorithm.");throw rt.algorithm=et.algorithm,rt}var nt=asn1$5.oidToDer(tt).getBytes(),it=asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.SEQUENCE,!0,[]),ot=asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.SEQUENCE,!0,[]);ot.value.push(asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.OID,!1,nt)),ot.value.push(asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.NULL,!1,""));var st=asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.OCTETSTRING,!1,et.digest().getBytes());return it.value.push(ot),it.value.push(st),asn1$5.toDer(it).getBytes()},_modPow$1=function(et,tt,rt){if(rt)return et.modPow(tt.e,tt.n);if(!tt.p||!tt.q)return et.modPow(tt.d,tt.n);tt.dP||(tt.dP=tt.d.mod(tt.p.subtract(BigInteger$5.ONE))),tt.dQ||(tt.dQ=tt.d.mod(tt.q.subtract(BigInteger$5.ONE))),tt.qInv||(tt.qInv=tt.q.modInverse(tt.p));var nt;do nt=new BigInteger$5(forge$C.util.bytesToHex(forge$C.random.getBytes(tt.n.bitLength()/8)),16);while(nt.compareTo(tt.n)>=0||!nt.gcd(tt.n).equals(BigInteger$5.ONE));et=et.multiply(nt.modPow(tt.e,tt.n)).mod(tt.n);for(var it=et.mod(tt.p).modPow(tt.dP,tt.p),ot=et.mod(tt.q).modPow(tt.dQ,tt.q);it.compareTo(ot)<0;)it=it.add(tt.p);var st=it.subtract(ot).multiply(tt.qInv).mod(tt.p).multiply(tt.q).add(ot);return st=st.multiply(nt.modInverse(tt.n)).mod(tt.n),st};pki$3.rsa.encrypt=function(et,tt,rt){var nt=rt,it,ot=Math.ceil(tt.n.bitLength()/8);rt!==!1&&rt!==!0?(nt=rt===2,it=_encodePkcs1_v1_5$1(et,tt,rt)):(it=forge$C.util.createBuffer(),it.putBytes(et));for(var st=new BigInteger$5(it.toHex(),16),at=_modPow$1(st,tt,nt),ct=at.toString(16),ut=forge$C.util.createBuffer(),lt=ot-Math.ceil(ct.length/2);lt>0;)ut.putByte(0),--lt;return ut.putBytes(forge$C.util.hexToBytes(ct)),ut.getBytes()},pki$3.rsa.decrypt=function(et,tt,rt,nt){var it=Math.ceil(tt.n.bitLength()/8);if(et.length!==it){var ot=new Error("Encrypted message length is invalid.");throw ot.length=et.length,ot.expected=it,ot}var st=new BigInteger$5(forge$C.util.createBuffer(et).toHex(),16);if(st.compareTo(tt.n)>=0)throw new Error("Encrypted message is invalid.");for(var at=_modPow$1(st,tt,rt),ct=at.toString(16),ut=forge$C.util.createBuffer(),lt=it-Math.ceil(ct.length/2);lt>0;)ut.putByte(0),--lt;return ut.putBytes(forge$C.util.hexToBytes(ct)),nt!==!1?_decodePkcs1_v1_5$1(ut.getBytes(),tt,rt):ut.getBytes()},pki$3.rsa.createKeyPairGenerationState=function(et,tt,rt){typeof et=="string"&&(et=parseInt(et,10)),et=et||2048,rt=rt||{};var nt=rt.prng||forge$C.random,it={nextBytes:function(at){for(var ct=nt.getBytesSync(at.length),ut=0;ut<at.length;++ut)at[ut]=ct.charCodeAt(ut)}},ot=rt.algorithm||"PRIMEINC",st;if(ot==="PRIMEINC")st={algorithm:ot,state:0,bits:et,rng:it,eInt:tt||65537,e:new BigInteger$5(null),p:null,q:null,qBits:et>>1,pBits:et-(et>>1),pqState:0,num:null,keys:null},st.e.fromInt(st.eInt);else throw new Error("Invalid key generation algorithm: "+ot);return st},pki$3.rsa.stepKeyPairGenerationState=function(et,tt){"algorithm"in et||(et.algorithm="PRIMEINC");var rt=new BigInteger$5(null);rt.fromInt(30);for(var nt=0,it=function(ht,ft){return ht|ft},ot=+new Date,st,at=0;et.keys===null&&(tt<=0||at<tt);){if(et.state===0){var ct=et.p===null?et.pBits:et.qBits,ut=ct-1;et.pqState===0?(et.num=new BigInteger$5(ct,et.rng),et.num.testBit(ut)||et.num.bitwiseTo(BigInteger$5.ONE.shiftLeft(ut),it,et.num),et.num.dAddOffset(31-et.num.mod(rt).byteValue(),0),nt=0,++et.pqState):et.pqState===1?et.num.bitLength()>ct?et.pqState=0:et.num.isProbablePrime(_getMillerRabinTests$1(et.num.bitLength()))?++et.pqState:et.num.dAddOffset(GCD_30_DELTA$1[nt++%8],0):et.pqState===2?et.pqState=et.num.subtract(BigInteger$5.ONE).gcd(et.e).compareTo(BigInteger$5.ONE)===0?3:0:et.pqState===3&&(et.pqState=0,et.p===null?et.p=et.num:et.q=et.num,et.p!==null&&et.q!==null&&++et.state,et.num=null)}else if(et.state===1)et.p.compareTo(et.q)<0&&(et.num=et.p,et.p=et.q,et.q=et.num),++et.state;else if(et.state===2)et.p1=et.p.subtract(BigInteger$5.ONE),et.q1=et.q.subtract(BigInteger$5.ONE),et.phi=et.p1.multiply(et.q1),++et.state;else if(et.state===3)et.phi.gcd(et.e).compareTo(BigInteger$5.ONE)===0?++et.state:(et.p=null,et.q=null,et.state=0);else if(et.state===4)et.n=et.p.multiply(et.q),et.n.bitLength()===et.bits?++et.state:(et.q=null,et.state=0);else if(et.state===5){var lt=et.e.modInverse(et.phi);et.keys={privateKey:pki$3.rsa.setPrivateKey(et.n,et.e,lt,et.p,et.q,lt.mod(et.p1),lt.mod(et.q1),et.q.modInverse(et.p)),publicKey:pki$3.rsa.setPublicKey(et.n,et.e)}}st=+new Date,at+=st-ot,ot=st}return et.keys!==null},pki$3.rsa.generateKeyPair=function(et,tt,rt,nt){if(arguments.length===1?typeof et=="object"?(rt=et,et=void 0):typeof et=="function"&&(nt=et,et=void 0):arguments.length===2?typeof et=="number"?typeof tt=="function"?(nt=tt,tt=void 0):typeof tt!="number"&&(rt=tt,tt=void 0):(rt=et,nt=tt,et=void 0,tt=void 0):arguments.length===3&&(typeof tt=="number"?typeof rt=="function"&&(nt=rt,rt=void 0):(nt=rt,rt=tt,tt=void 0)),rt=rt||{},et===void 0&&(et=rt.bits||2048),tt===void 0&&(tt=rt.e||65537),!forge$C.options.usePureJavaScript&&!rt.prng&&et>=256&&et<=16384&&(tt===65537||tt===3)){if(nt){if(_detectNodeCrypto$1("generateKeyPair"))return _crypto$2.generateKeyPair("rsa",{modulusLength:et,publicExponent:tt,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(at,ct,ut){if(at)return nt(at);nt(null,{privateKey:pki$3.privateKeyFromPem(ut),publicKey:pki$3.publicKeyFromPem(ct)})});if(_detectSubtleCrypto$1("generateKey")&&_detectSubtleCrypto$1("exportKey"))return util$5.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:et,publicExponent:_intToUint8Array$1(tt),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(at){return util$5.globalScope.crypto.subtle.exportKey("pkcs8",at.privateKey)}).then(void 0,function(at){nt(at)}).then(function(at){if(at){var ct=pki$3.privateKeyFromAsn1(asn1$5.fromDer(forge$C.util.createBuffer(at)));nt(null,{privateKey:ct,publicKey:pki$3.setRsaPublicKey(ct.n,ct.e)})}});if(_detectSubtleMsCrypto$1("generateKey")&&_detectSubtleMsCrypto$1("exportKey")){var it=util$5.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:et,publicExponent:_intToUint8Array$1(tt),hash:{name:"SHA-256"}},!0,["sign","verify"]);it.oncomplete=function(at){var ct=at.target.result,ut=util$5.globalScope.msCrypto.subtle.exportKey("pkcs8",ct.privateKey);ut.oncomplete=function(lt){var ht=lt.target.result,ft=pki$3.privateKeyFromAsn1(asn1$5.fromDer(forge$C.util.createBuffer(ht)));nt(null,{privateKey:ft,publicKey:pki$3.setRsaPublicKey(ft.n,ft.e)})},ut.onerror=function(lt){nt(lt)}},it.onerror=function(at){nt(at)};return}}else if(_detectNodeCrypto$1("generateKeyPairSync")){var ot=_crypto$2.generateKeyPairSync("rsa",{modulusLength:et,publicExponent:tt,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:pki$3.privateKeyFromPem(ot.privateKey),publicKey:pki$3.publicKeyFromPem(ot.publicKey)}}}var st=pki$3.rsa.createKeyPairGenerationState(et,tt,rt);if(!nt)return pki$3.rsa.stepKeyPairGenerationState(st,0),st.keys;_generateKeyPair$1(st,rt,nt)},pki$3.setRsaPublicKey=pki$3.rsa.setPublicKey=function(et,tt){var rt={n:et,e:tt};return rt.encrypt=function(nt,it,ot){if(typeof it=="string"?it=it.toUpperCase():it===void 0&&(it="RSAES-PKCS1-V1_5"),it==="RSAES-PKCS1-V1_5")it={encode:function(at,ct,ut){return _encodePkcs1_v1_5$1(at,ct,2).getBytes()}};else if(it==="RSA-OAEP"||it==="RSAES-OAEP")it={encode:function(at,ct){return forge$C.pkcs1.encode_rsa_oaep(ct,at,ot)}};else if(["RAW","NONE","NULL",null].indexOf(it)!==-1)it={encode:function(at){return at}};else if(typeof it=="string")throw new Error('Unsupported encryption scheme: "'+it+'".');var st=it.encode(nt,rt,!0);return pki$3.rsa.encrypt(st,rt,!0)},rt.verify=function(nt,it,ot){typeof ot=="string"?ot=ot.toUpperCase():ot===void 0&&(ot="RSASSA-PKCS1-V1_5"),ot==="RSASSA-PKCS1-V1_5"?ot={verify:function(at,ct){ct=_decodePkcs1_v1_5$1(ct,rt,!0);var ut=asn1$5.fromDer(ct);return at===ut.value[1].value}}:(ot==="NONE"||ot==="NULL"||ot===null)&&(ot={verify:function(at,ct){return ct=_decodePkcs1_v1_5$1(ct,rt,!0),at===ct}});var st=pki$3.rsa.decrypt(it,rt,!0,!1);return ot.verify(nt,st,rt.n.bitLength())},rt},pki$3.setRsaPrivateKey=pki$3.rsa.setPrivateKey=function(et,tt,rt,nt,it,ot,st,at){var ct={n:et,e:tt,d:rt,p:nt,q:it,dP:ot,dQ:st,qInv:at};return ct.decrypt=function(ut,lt,ht){typeof lt=="string"?lt=lt.toUpperCase():lt===void 0&&(lt="RSAES-PKCS1-V1_5");var ft=pki$3.rsa.decrypt(ut,ct,!1,!1);if(lt==="RSAES-PKCS1-V1_5")lt={decode:_decodePkcs1_v1_5$1};else if(lt==="RSA-OAEP"||lt==="RSAES-OAEP")lt={decode:function(dt,pt){return forge$C.pkcs1.decode_rsa_oaep(pt,dt,ht)}};else if(["RAW","NONE","NULL",null].indexOf(lt)!==-1)lt={decode:function(dt){return dt}};else throw new Error('Unsupported encryption scheme: "'+lt+'".');return lt.decode(ft,ct,!1)},ct.sign=function(ut,lt){var ht=!1;typeof lt=="string"&&(lt=lt.toUpperCase()),lt===void 0||lt==="RSASSA-PKCS1-V1_5"?(lt={encode:emsaPkcs1v15encode$1},ht=1):(lt==="NONE"||lt==="NULL"||lt===null)&&(lt={encode:function(){return ut}},ht=1);var ft=lt.encode(ut,ct.n.bitLength());return pki$3.rsa.encrypt(ft,ct,ht)},ct},pki$3.wrapRsaPrivateKey=function(et){return asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.SEQUENCE,!0,[asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.INTEGER,!1,asn1$5.integerToDer(0).getBytes()),asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.SEQUENCE,!0,[asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.OID,!1,asn1$5.oidToDer(pki$3.oids.rsaEncryption).getBytes()),asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.NULL,!1,"")]),asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.OCTETSTRING,!1,asn1$5.toDer(et).getBytes())])},pki$3.privateKeyFromAsn1=function(et){var tt={},rt=[];if(asn1$5.validate(et,privateKeyValidator$2,tt,rt)&&(et=asn1$5.fromDer(forge$C.util.createBuffer(tt.privateKey))),tt={},rt=[],!asn1$5.validate(et,rsaPrivateKeyValidator$1,tt,rt)){var nt=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw nt.errors=rt,nt}var it,ot,st,at,ct,ut,lt,ht;return it=forge$C.util.createBuffer(tt.privateKeyModulus).toHex(),ot=forge$C.util.createBuffer(tt.privateKeyPublicExponent).toHex(),st=forge$C.util.createBuffer(tt.privateKeyPrivateExponent).toHex(),at=forge$C.util.createBuffer(tt.privateKeyPrime1).toHex(),ct=forge$C.util.createBuffer(tt.privateKeyPrime2).toHex(),ut=forge$C.util.createBuffer(tt.privateKeyExponent1).toHex(),lt=forge$C.util.createBuffer(tt.privateKeyExponent2).toHex(),ht=forge$C.util.createBuffer(tt.privateKeyCoefficient).toHex(),pki$3.setRsaPrivateKey(new BigInteger$5(it,16),new BigInteger$5(ot,16),new BigInteger$5(st,16),new BigInteger$5(at,16),new BigInteger$5(ct,16),new BigInteger$5(ut,16),new BigInteger$5(lt,16),new BigInteger$5(ht,16))},pki$3.privateKeyToAsn1=pki$3.privateKeyToRSAPrivateKey=function(et){return asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.SEQUENCE,!0,[asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.INTEGER,!1,asn1$5.integerToDer(0).getBytes()),asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.INTEGER,!1,_bnToBytes$1(et.n)),asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.INTEGER,!1,_bnToBytes$1(et.e)),asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.INTEGER,!1,_bnToBytes$1(et.d)),asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.INTEGER,!1,_bnToBytes$1(et.p)),asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.INTEGER,!1,_bnToBytes$1(et.q)),asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.INTEGER,!1,_bnToBytes$1(et.dP)),asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.INTEGER,!1,_bnToBytes$1(et.dQ)),asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.INTEGER,!1,_bnToBytes$1(et.qInv))])},pki$3.publicKeyFromAsn1=function(et){var tt={},rt=[];if(asn1$5.validate(et,publicKeyValidator$2,tt,rt)){var nt=asn1$5.derToOid(tt.publicKeyOid);if(nt!==pki$3.oids.rsaEncryption){var it=new Error("Cannot read public key. Unknown OID.");throw it.oid=nt,it}et=tt.rsaPublicKey}if(rt=[],!asn1$5.validate(et,rsaPublicKeyValidator$1,tt,rt)){var it=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw it.errors=rt,it}var ot=forge$C.util.createBuffer(tt.publicKeyModulus).toHex(),st=forge$C.util.createBuffer(tt.publicKeyExponent).toHex();return pki$3.setRsaPublicKey(new BigInteger$5(ot,16),new BigInteger$5(st,16))},pki$3.publicKeyToAsn1=pki$3.publicKeyToSubjectPublicKeyInfo=function(et){return asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.SEQUENCE,!0,[asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.SEQUENCE,!0,[asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.OID,!1,asn1$5.oidToDer(pki$3.oids.rsaEncryption).getBytes()),asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.NULL,!1,"")]),asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.BITSTRING,!1,[pki$3.publicKeyToRSAPublicKey(et)])])},pki$3.publicKeyToRSAPublicKey=function(et){return asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.SEQUENCE,!0,[asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.INTEGER,!1,_bnToBytes$1(et.n)),asn1$5.create(asn1$5.Class.UNIVERSAL,asn1$5.Type.INTEGER,!1,_bnToBytes$1(et.e))])};function _encodePkcs1_v1_5$1(et,tt,rt){var nt=forge$C.util.createBuffer(),it=Math.ceil(tt.n.bitLength()/8);if(et.length>it-11){var ot=new Error("Message is too long for PKCS#1 v1.5 padding.");throw ot.length=et.length,ot.max=it-11,ot}nt.putByte(0),nt.putByte(rt);var st=it-3-et.length,at;if(rt===0||rt===1){at=rt===0?0:255;for(var ct=0;ct<st;++ct)nt.putByte(at)}else for(;st>0;){for(var ut=0,lt=forge$C.random.getBytes(st),ct=0;ct<st;++ct)at=lt.charCodeAt(ct),at===0?++ut:nt.putByte(at);st=ut}return nt.putByte(0),nt.putBytes(et),nt}function _decodePkcs1_v1_5$1(et,tt,rt,nt){var it=Math.ceil(tt.n.bitLength()/8),ot=forge$C.util.createBuffer(et),st=ot.getByte(),at=ot.getByte();if(st!==0||rt&&at!==0&&at!==1||!rt&&at!=2||rt&&at===0&&typeof nt>"u")throw new Error("Encryption block is invalid.");var ct=0;if(at===0){ct=it-3-nt;for(var ut=0;ut<ct;++ut)if(ot.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(at===1)for(ct=0;ot.length()>1;){if(ot.getByte()!==255){--ot.read;break}++ct}else if(at===2)for(ct=0;ot.length()>1;){if(ot.getByte()===0){--ot.read;break}++ct}var lt=ot.getByte();if(lt!==0||ct!==it-3-ot.length())throw new Error("Encryption block is invalid.");return ot.getBytes()}function _generateKeyPair$1(et,tt,rt){typeof tt=="function"&&(rt=tt,tt={}),tt=tt||{};var nt={algorithm:{name:tt.algorithm||"PRIMEINC",options:{workers:tt.workers||2,workLoad:tt.workLoad||100,workerScript:tt.workerScript}}};"prng"in tt&&(nt.prng=tt.prng),it();function it(){ot(et.pBits,function(at,ct){if(at)return rt(at);if(et.p=ct,et.q!==null)return st(at,et.q);ot(et.qBits,st)})}function ot(at,ct){forge$C.prime.generateProbablePrime(at,nt,ct)}function st(at,ct){if(at)return rt(at);if(et.q=ct,et.p.compareTo(et.q)<0){var ut=et.p;et.p=et.q,et.q=ut}if(et.p.subtract(BigInteger$5.ONE).gcd(et.e).compareTo(BigInteger$5.ONE)!==0){et.p=null,it();return}if(et.q.subtract(BigInteger$5.ONE).gcd(et.e).compareTo(BigInteger$5.ONE)!==0){et.q=null,ot(et.qBits,st);return}if(et.p1=et.p.subtract(BigInteger$5.ONE),et.q1=et.q.subtract(BigInteger$5.ONE),et.phi=et.p1.multiply(et.q1),et.phi.gcd(et.e).compareTo(BigInteger$5.ONE)!==0){et.p=et.q=null,it();return}if(et.n=et.p.multiply(et.q),et.n.bitLength()!==et.bits){et.q=null,ot(et.qBits,st);return}var lt=et.e.modInverse(et.phi);et.keys={privateKey:pki$3.rsa.setPrivateKey(et.n,et.e,lt,et.p,et.q,lt.mod(et.p1),lt.mod(et.q1),et.q.modInverse(et.p)),publicKey:pki$3.rsa.setPublicKey(et.n,et.e)},rt(null,et.keys)}}function _bnToBytes$1(et){var tt=et.toString(16);tt[0]>="8"&&(tt="00"+tt);var rt=forge$C.util.hexToBytes(tt);return rt.length>1&&(rt.charCodeAt(0)===0&&!(rt.charCodeAt(1)&128)||rt.charCodeAt(0)===255&&(rt.charCodeAt(1)&128)===128)?rt.substr(1):rt}function _getMillerRabinTests$1(et){return et<=100?27:et<=150?18:et<=200?15:et<=250?12:et<=300?9:et<=350?8:et<=400?7:et<=500?6:et<=600?5:et<=800?4:et<=1250?3:2}function _detectNodeCrypto$1(et){return forge$C.util.isNodejs&&typeof _crypto$2[et]=="function"}function _detectSubtleCrypto$1(et){return typeof util$5.globalScope<"u"&&typeof util$5.globalScope.crypto=="object"&&typeof util$5.globalScope.crypto.subtle=="object"&&typeof util$5.globalScope.crypto.subtle[et]=="function"}function _detectSubtleMsCrypto$1(et){return typeof util$5.globalScope<"u"&&typeof util$5.globalScope.msCrypto=="object"&&typeof util$5.globalScope.msCrypto.subtle=="object"&&typeof util$5.globalScope.msCrypto.subtle[et]=="function"}function _intToUint8Array$1(et){for(var tt=forge$C.util.hexToBytes(et.toString(16)),rt=new Uint8Array(tt.length),nt=0;nt<tt.length;++nt)rt[nt]=tt.charCodeAt(nt);return rt}var forge$B=forge$W;if(typeof BigInteger$4>"u")var BigInteger$4=forge$B.jsbn.BigInteger;var asn1$4=forge$B.asn1,pki$2=forge$B.pki=forge$B.pki||{};pki$2.pbe=forge$B.pbe=forge$B.pbe||{};var oids$2=pki$2.oids,encryptedPrivateKeyValidator$1={name:"EncryptedPrivateKeyInfo",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},PBES2AlgorithmsValidator$1={name:"PBES2Algorithms",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},pkcs12PbeParamsValidator$1={name:"pkcs-12PbeParams",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:asn1$4.Class.UNIVERSAL,type:asn1$4.Type.INTEGER,constructed:!1,capture:"iterations"}]};pki$2.encryptPrivateKeyInfo=function(et,tt,rt){rt=rt||{},rt.saltSize=rt.saltSize||8,rt.count=rt.count||2048,rt.algorithm=rt.algorithm||"aes128",rt.prfAlgorithm=rt.prfAlgorithm||"sha1";var nt=forge$B.random.getBytesSync(rt.saltSize),it=rt.count,ot=asn1$4.integerToDer(it),st,at,ct;if(rt.algorithm.indexOf("aes")===0||rt.algorithm==="des"){var ut,lt,ht;switch(rt.algorithm){case"aes128":st=16,ut=16,lt=oids$2["aes128-CBC"],ht=forge$B.aes.createEncryptionCipher;break;case"aes192":st=24,ut=16,lt=oids$2["aes192-CBC"],ht=forge$B.aes.createEncryptionCipher;break;case"aes256":st=32,ut=16,lt=oids$2["aes256-CBC"],ht=forge$B.aes.createEncryptionCipher;break;case"des":st=8,ut=8,lt=oids$2.desCBC,ht=forge$B.des.createEncryptionCipher;break;default:var ft=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw ft.algorithm=rt.algorithm,ft}var dt="hmacWith"+rt.prfAlgorithm.toUpperCase(),pt=prfAlgorithmToMessageDigest$1(dt),gt=forge$B.pkcs5.pbkdf2(tt,nt,it,st,pt),_t=forge$B.random.getBytesSync(ut),mt=ht(gt);mt.start(_t),mt.update(asn1$4.toDer(et)),mt.finish(),ct=mt.output.getBytes();var At=createPbkdf2Params$1(nt,ot,st,dt);at=asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.OID,!1,asn1$4.oidToDer(oids$2.pkcs5PBES2).getBytes()),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.OID,!1,asn1$4.oidToDer(oids$2.pkcs5PBKDF2).getBytes()),At]),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.OID,!1,asn1$4.oidToDer(lt).getBytes()),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.OCTETSTRING,!1,_t)])])])}else if(rt.algorithm==="3des"){st=24;var It=new forge$B.util.ByteBuffer(nt),gt=pki$2.pbe.generatePkcs12Key(tt,It,1,it,st),_t=pki$2.pbe.generatePkcs12Key(tt,It,2,it,st),mt=forge$B.des.createEncryptionCipher(gt);mt.start(_t),mt.update(asn1$4.toDer(et)),mt.finish(),ct=mt.output.getBytes(),at=asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.OID,!1,asn1$4.oidToDer(oids$2["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.OCTETSTRING,!1,nt),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,ot.getBytes())])])}else{var ft=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw ft.algorithm=rt.algorithm,ft}var Mt=asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[at,asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.OCTETSTRING,!1,ct)]);return Mt},pki$2.decryptPrivateKeyInfo=function(et,tt){var rt=null,nt={},it=[];if(!asn1$4.validate(et,encryptedPrivateKeyValidator$1,nt,it)){var ot=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw ot.errors=it,ot}var st=asn1$4.derToOid(nt.encryptionOid),at=pki$2.pbe.getCipher(st,nt.encryptionParams,tt),ct=forge$B.util.createBuffer(nt.encryptedData);return at.update(ct),at.finish()&&(rt=asn1$4.fromDer(at.output)),rt},pki$2.encryptedPrivateKeyToPem=function(et,tt){var rt={type:"ENCRYPTED PRIVATE KEY",body:asn1$4.toDer(et).getBytes()};return forge$B.pem.encode(rt,{maxline:tt})},pki$2.encryptedPrivateKeyFromPem=function(et){var tt=forge$B.pem.decode(et)[0];if(tt.type!=="ENCRYPTED PRIVATE KEY"){var rt=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw rt.headerType=tt.type,rt}if(tt.procType&&tt.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return asn1$4.fromDer(tt.body)},pki$2.encryptRsaPrivateKey=function(et,tt,rt){if(rt=rt||{},!rt.legacy){var nt=pki$2.wrapRsaPrivateKey(pki$2.privateKeyToAsn1(et));return nt=pki$2.encryptPrivateKeyInfo(nt,tt,rt),pki$2.encryptedPrivateKeyToPem(nt)}var it,ot,st,at;switch(rt.algorithm){case"aes128":it="AES-128-CBC",st=16,ot=forge$B.random.getBytesSync(16),at=forge$B.aes.createEncryptionCipher;break;case"aes192":it="AES-192-CBC",st=24,ot=forge$B.random.getBytesSync(16),at=forge$B.aes.createEncryptionCipher;break;case"aes256":it="AES-256-CBC",st=32,ot=forge$B.random.getBytesSync(16),at=forge$B.aes.createEncryptionCipher;break;case"3des":it="DES-EDE3-CBC",st=24,ot=forge$B.random.getBytesSync(8),at=forge$B.des.createEncryptionCipher;break;case"des":it="DES-CBC",st=8,ot=forge$B.random.getBytesSync(8),at=forge$B.des.createEncryptionCipher;break;default:var ct=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+rt.algorithm+'".');throw ct.algorithm=rt.algorithm,ct}var ut=forge$B.pbe.opensslDeriveBytes(tt,ot.substr(0,8),st),lt=at(ut);lt.start(ot),lt.update(asn1$4.toDer(pki$2.privateKeyToAsn1(et))),lt.finish();var ht={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:it,parameters:forge$B.util.bytesToHex(ot).toUpperCase()},body:lt.output.getBytes()};return forge$B.pem.encode(ht)},pki$2.decryptRsaPrivateKey=function(et,tt){var rt=null,nt=forge$B.pem.decode(et)[0];if(nt.type!=="ENCRYPTED PRIVATE KEY"&&nt.type!=="PRIVATE KEY"&&nt.type!=="RSA PRIVATE KEY"){var it=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw it.headerType=it,it}if(nt.procType&&nt.procType.type==="ENCRYPTED"){var ot,st;switch(nt.dekInfo.algorithm){case"DES-CBC":ot=8,st=forge$B.des.createDecryptionCipher;break;case"DES-EDE3-CBC":ot=24,st=forge$B.des.createDecryptionCipher;break;case"AES-128-CBC":ot=16,st=forge$B.aes.createDecryptionCipher;break;case"AES-192-CBC":ot=24,st=forge$B.aes.createDecryptionCipher;break;case"AES-256-CBC":ot=32,st=forge$B.aes.createDecryptionCipher;break;case"RC2-40-CBC":ot=5,st=function(ht){return forge$B.rc2.createDecryptionCipher(ht,40)};break;case"RC2-64-CBC":ot=8,st=function(ht){return forge$B.rc2.createDecryptionCipher(ht,64)};break;case"RC2-128-CBC":ot=16,st=function(ht){return forge$B.rc2.createDecryptionCipher(ht,128)};break;default:var it=new Error('Could not decrypt private key; unsupported encryption algorithm "'+nt.dekInfo.algorithm+'".');throw it.algorithm=nt.dekInfo.algorithm,it}var at=forge$B.util.hexToBytes(nt.dekInfo.parameters),ct=forge$B.pbe.opensslDeriveBytes(tt,at.substr(0,8),ot),ut=st(ct);if(ut.start(at),ut.update(forge$B.util.createBuffer(nt.body)),ut.finish())rt=ut.output.getBytes();else return rt}else rt=nt.body;return nt.type==="ENCRYPTED PRIVATE KEY"?rt=pki$2.decryptPrivateKeyInfo(asn1$4.fromDer(rt),tt):rt=asn1$4.fromDer(rt),rt!==null&&(rt=pki$2.privateKeyFromAsn1(rt)),rt},pki$2.pbe.generatePkcs12Key=function(et,tt,rt,nt,it,ot){var st,at;if(typeof ot>"u"||ot===null){if(!("sha1"in forge$B.md))throw new Error('"sha1" hash algorithm unavailable.');ot=forge$B.md.sha1.create()}var ct=ot.digestLength,ut=ot.blockLength,lt=new forge$B.util.ByteBuffer,ht=new forge$B.util.ByteBuffer;if(et!=null){for(at=0;at<et.length;at++)ht.putInt16(et.charCodeAt(at));ht.putInt16(0)}var ft=ht.length(),dt=tt.length(),pt=new forge$B.util.ByteBuffer;pt.fillWithByte(rt,ut);var gt=ut*Math.ceil(dt/ut),_t=new forge$B.util.ByteBuffer;for(at=0;at<gt;at++)_t.putByte(tt.at(at%dt));var mt=ut*Math.ceil(ft/ut),At=new forge$B.util.ByteBuffer;for(at=0;at<mt;at++)At.putByte(ht.at(at%ft));var It=_t;It.putBuffer(At);for(var Mt=Math.ceil(it/ct),kt=1;kt<=Mt;kt++){var Ct=new forge$B.util.ByteBuffer;Ct.putBytes(pt.bytes()),Ct.putBytes(It.bytes());for(var Ut=0;Ut<nt;Ut++)ot.start(),ot.update(Ct.getBytes()),Ct=ot.digest();var Wt=new forge$B.util.ByteBuffer;for(at=0;at<ut;at++)Wt.putByte(Ct.at(at%ct));var Ft=Math.ceil(dt/ut)+Math.ceil(ft/ut),Ce=new forge$B.util.ByteBuffer;for(st=0;st<Ft;st++){var bt=new forge$B.util.ByteBuffer(It.getBytes(ut)),yt=511;for(at=Wt.length()-1;at>=0;at--)yt=yt>>8,yt+=Wt.at(at)+bt.at(at),bt.setAt(at,yt&255);Ce.putBuffer(bt)}It=Ce,lt.putBuffer(Ct)}return lt.truncate(lt.length()-it),lt},pki$2.pbe.getCipher=function(et,tt,rt){switch(et){case pki$2.oids.pkcs5PBES2:return pki$2.pbe.getCipherForPBES2(et,tt,rt);case pki$2.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case pki$2.oids["pbewithSHAAnd40BitRC2-CBC"]:return pki$2.pbe.getCipherForPKCS12PBE(et,tt,rt);default:var nt=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw nt.oid=et,nt.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],nt}},pki$2.pbe.getCipherForPBES2=function(et,tt,rt){var nt={},it=[];if(!asn1$4.validate(tt,PBES2AlgorithmsValidator$1,nt,it)){var ot=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw ot.errors=it,ot}if(et=asn1$4.derToOid(nt.kdfOid),et!==pki$2.oids.pkcs5PBKDF2){var ot=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw ot.oid=et,ot.supportedOids=["pkcs5PBKDF2"],ot}if(et=asn1$4.derToOid(nt.encOid),et!==pki$2.oids["aes128-CBC"]&&et!==pki$2.oids["aes192-CBC"]&&et!==pki$2.oids["aes256-CBC"]&&et!==pki$2.oids["des-EDE3-CBC"]&&et!==pki$2.oids.desCBC){var ot=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw ot.oid=et,ot.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],ot}var st=nt.kdfSalt,at=forge$B.util.createBuffer(nt.kdfIterationCount);at=at.getInt(at.length()<<3);var ct,ut;switch(pki$2.oids[et]){case"aes128-CBC":ct=16,ut=forge$B.aes.createDecryptionCipher;break;case"aes192-CBC":ct=24,ut=forge$B.aes.createDecryptionCipher;break;case"aes256-CBC":ct=32,ut=forge$B.aes.createDecryptionCipher;break;case"des-EDE3-CBC":ct=24,ut=forge$B.des.createDecryptionCipher;break;case"desCBC":ct=8,ut=forge$B.des.createDecryptionCipher;break}var lt=prfOidToMessageDigest$1(nt.prfOid),ht=forge$B.pkcs5.pbkdf2(rt,st,at,ct,lt),ft=nt.encIv,dt=ut(ht);return dt.start(ft),dt},pki$2.pbe.getCipherForPKCS12PBE=function(et,tt,rt){var nt={},it=[];if(!asn1$4.validate(tt,pkcs12PbeParamsValidator$1,nt,it)){var ot=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw ot.errors=it,ot}var st=forge$B.util.createBuffer(nt.salt),at=forge$B.util.createBuffer(nt.iterations);at=at.getInt(at.length()<<3);var ct,ut,lt;switch(et){case pki$2.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:ct=24,ut=8,lt=forge$B.des.startDecrypting;break;case pki$2.oids["pbewithSHAAnd40BitRC2-CBC"]:ct=5,ut=8,lt=function(gt,_t){var mt=forge$B.rc2.createDecryptionCipher(gt,40);return mt.start(_t,null),mt};break;default:var ot=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw ot.oid=et,ot}var ht=prfOidToMessageDigest$1(nt.prfOid),ft=pki$2.pbe.generatePkcs12Key(rt,st,1,at,ct,ht);ht.start();var dt=pki$2.pbe.generatePkcs12Key(rt,st,2,at,ut,ht);return lt(ft,dt)},pki$2.pbe.opensslDeriveBytes=function(et,tt,rt,nt){if(typeof nt>"u"||nt===null){if(!("md5"in forge$B.md))throw new Error('"md5" hash algorithm unavailable.');nt=forge$B.md.md5.create()}tt===null&&(tt="");for(var it=[hash$3(nt,et+tt)],ot=16,st=1;ot<rt;++st,ot+=16)it.push(hash$3(nt,it[st-1]+et+tt));return it.join("").substr(0,rt)};function hash$3(et,tt){return et.start().update(tt).digest().getBytes()}function prfOidToMessageDigest$1(et){var tt;if(!et)tt="hmacWithSHA1";else if(tt=pki$2.oids[asn1$4.derToOid(et)],!tt){var rt=new Error("Unsupported PRF OID.");throw rt.oid=et,rt.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],rt}return prfAlgorithmToMessageDigest$1(tt)}function prfAlgorithmToMessageDigest$1(et){var tt=forge$B.md;switch(et){case"hmacWithSHA224":tt=forge$B.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":et=et.substr(8).toLowerCase();break;default:var rt=new Error("Unsupported PRF algorithm.");throw rt.algorithm=et,rt.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],rt}if(!tt||!(et in tt))throw new Error("Unknown hash algorithm: "+et);return tt[et].create()}function createPbkdf2Params$1(et,tt,rt,nt){var it=asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.OCTETSTRING,!1,et),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,tt.getBytes())]);return nt!=="hmacWithSHA1"&&it.value.push(asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.INTEGER,!1,forge$B.util.hexToBytes(rt.toString(16))),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.SEQUENCE,!0,[asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.OID,!1,asn1$4.oidToDer(pki$2.oids[nt]).getBytes()),asn1$4.create(asn1$4.Class.UNIVERSAL,asn1$4.Type.NULL,!1,"")])),it}function assign(et,tt){for(const rt in tt)Object.defineProperty(et,rt,{value:tt[rt],enumerable:!0,configurable:!0});return et}function createError(et,tt,rt){if(!et||typeof et=="string")throw new TypeError("Please pass an Error to err-code");rt||(rt={}),typeof tt=="object"&&(rt=tt,tt=""),tt&&(rt.code=tt);try{return assign(et,rt)}catch{rt.message=et.message,rt.stack=et.stack;const nt=function(){};return nt.prototype=Object.create(Object.getPrototypeOf(et)),assign(new nt,rt)}}var errCode$i=createError;const identity$9=from$1({prefix:"\0",name:"identity",encode:et=>toString$8(et),decode:et=>fromString$b(et)}),identityBase=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$9},Symbol.toStringTag,{value:"Module"})),base2=rfc4648({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$1=Object.freeze(Object.defineProperty({__proto__:null,base2},Symbol.toStringTag,{value:"Module"})),base8=rfc4648({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$1=Object.freeze(Object.defineProperty({__proto__:null,base8},Symbol.toStringTag,{value:"Module"})),base10=baseX({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$1=Object.freeze(Object.defineProperty({__proto__:null,base10},Symbol.toStringTag,{value:"Module"})),alphabet=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),alphabetBytesToChars=alphabet.reduce((et,tt,rt)=>(et[rt]=tt,et),[]),alphabetCharsToBytes=alphabet.reduce((et,tt,rt)=>(et[tt.codePointAt(0)]=rt,et),[]);function encode$b(et){return et.reduce((tt,rt)=>(tt+=alphabetBytesToChars[rt],tt),"")}function decode$d(et){const tt=[];for(const rt of et){const nt=alphabetCharsToBytes[rt.codePointAt(0)];if(nt===void 0)throw new Error(`Non-base256emoji character: ${rt}`);tt.push(nt)}return new Uint8Array(tt)}const base256emoji=from$1({prefix:"\u{1F680}",name:"base256emoji",encode:encode$b,decode:decode$d}),base256emoji$1=Object.freeze(Object.defineProperty({__proto__:null,base256emoji},Symbol.toStringTag,{value:"Module"})),from=({name:et,code:tt,encode:rt})=>new Hasher(et,tt,rt);class Hasher{constructor(tt,rt,nt){this.name=tt,this.code=rt,this.encode=nt}digest(tt){if(tt instanceof Uint8Array){const rt=this.encode(tt);return rt instanceof Uint8Array?create$9(this.code,rt):rt.then(nt=>create$9(this.code,nt))}else throw Error("Unknown type, must be binary type")}}const hasher=Object.freeze(Object.defineProperty({__proto__:null,Hasher,from},Symbol.toStringTag,{value:"Module"})),sha$1=et=>async tt=>new Uint8Array(await crypto.subtle.digest(et,tt)),sha256$d=from({name:"sha2-256",code:18,encode:sha$1("SHA-256")}),sha512$3=from({name:"sha2-512",code:19,encode:sha$1("SHA-512")}),sha2Browser=Object.freeze(Object.defineProperty({__proto__:null,sha256:sha256$d,sha512:sha512$3},Symbol.toStringTag,{value:"Module"})),code$4=0,name$5="identity",encode$a=coerce,digest=et=>create$9(code$4,encode$a(et)),identity$7={code:code$4,name:name$5,encode:encode$a,digest},identity$8=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$7},Symbol.toStringTag,{value:"Module"})),name$4="raw",code$3=85,encode$9=et=>coerce(et),decode$c=et=>coerce(et),raw$6=Object.freeze(Object.defineProperty({__proto__:null,code:code$3,decode:decode$c,encode:encode$9,name:name$4},Symbol.toStringTag,{value:"Module"})),textEncoder$3=new TextEncoder,textDecoder$2=new TextDecoder,name$3="json",code$2=512,encode$8=et=>textEncoder$3.encode(JSON.stringify(et)),decode$b=et=>JSON.parse(textDecoder$2.decode(et)),json$1=Object.freeze(Object.defineProperty({__proto__:null,code:code$2,decode:decode$b,encode:encode$8,name:name$3},Symbol.toStringTag,{value:"Module"})),src$h=Object.freeze(Object.defineProperty({__proto__:null,CID:CID$f,bytes:bytes$3,digest:digest$1,hasher,varint:varint$8},Symbol.toStringTag,{value:"Module"})),bases$9={...identityBase,...base2$1,...base8$1,...base10$1,...base16$1,...base32$8,...base36$1,...base58,...base64$9,...base256emoji$1},hashes={...sha2Browser,...identity$8},codecs={raw:raw$6,json:json$1},basics=Object.freeze(Object.defineProperty({__proto__:null,CID:CID$f,bases:bases$9,bytes:bytes$3,codecs,digest:digest$1,hasher,hashes,varint:varint$8},Symbol.toStringTag,{value:"Module"}));function asUint8Array(et){return globalThis.Buffer!=null?new Uint8Array(et.buffer,et.byteOffset,et.byteLength):et}function allocUnsafe(et=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?asUint8Array(globalThis.Buffer.allocUnsafe(et)):new Uint8Array(et)}function createCodec$5(et,tt,rt,nt){return{name:et,prefix:tt,encoder:{name:et,prefix:tt,encode:rt},decoder:{decode:nt}}}const string$5=createCodec$5("utf8","u",et=>"u"+new TextDecoder("utf8").decode(et),et=>new TextEncoder().encode(et.substring(1))),ascii$5=createCodec$5("ascii","a",et=>{let tt="a";for(let rt=0;rt<et.length;rt++)tt+=String.fromCharCode(et[rt]);return tt},et=>{et=et.substring(1);const tt=allocUnsafe(et.length);for(let rt=0;rt<et.length;rt++)tt[rt]=et.charCodeAt(rt);return tt}),BASES$3={utf8:string$5,"utf-8":string$5,hex:bases$9.base16,latin1:ascii$5,ascii:ascii$5,binary:ascii$5,...bases$9};function fromString$9(et,tt="utf8"){const rt=BASES$3[tt];if(!rt)throw new Error(`Unsupported encoding "${tt}"`);return(tt==="utf8"||tt==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?asUint8Array(globalThis.Buffer.from(et,"utf-8")):rt.decoder.decode(`${rt.prefix}${et}`)}const fromString$a=Object.freeze(Object.defineProperty({__proto__:null,fromString:fromString$9},Symbol.toStringTag,{value:"Module"})),require$$9$2=getAugmentedNamespace(fromString$a);function concat$5(et,tt){tt||(tt=et.reduce((it,ot)=>it+ot.length,0));const rt=allocUnsafe(tt);let nt=0;for(const it of et)rt.set(it,nt),nt+=it.length;return asUint8Array(rt)}const concat$6=Object.freeze(Object.defineProperty({__proto__:null,concat:concat$5},Symbol.toStringTag,{value:"Module"})),require$$7$1=getAugmentedNamespace(concat$6);var webcrypto$9={};webcrypto$9.get=(et=globalThis)=>{const tt=et.crypto;if(!tt||!tt.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return tt};const{concat:concat$4}=require$$7$1,{fromString:fromString$8}=require$$9$2,webcrypto$8=webcrypto$9;function create$6({algorithm:et="AES-GCM",nonceLength:tt=12,keyLength:rt=16,digest:nt="SHA-256",saltLength:it=16,iterations:ot=32767}={}){const st=webcrypto$8.get();rt*=8;async function at(ut,lt){const ht=st.getRandomValues(new Uint8Array(it)),ft=st.getRandomValues(new Uint8Array(tt)),dt={name:et,iv:ft},pt={name:"PBKDF2",salt:ht,iterations:ot,hash:{name:nt}},gt=await st.subtle.importKey("raw",fromString$8(lt),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),_t=await st.subtle.deriveKey(pt,gt,{name:et,length:rt},!0,["encrypt"]),mt=await st.subtle.encrypt(dt,_t,ut);return concat$4([ht,dt.iv,new Uint8Array(mt)])}async function ct(ut,lt){const ht=ut.slice(0,it),ft=ut.slice(it,it+tt),dt=ut.slice(it+tt),pt={name:et,iv:ft},gt={name:"PBKDF2",salt:ht,iterations:ot,hash:{name:nt}},_t=await st.subtle.importKey("raw",fromString$8(lt),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),mt=await st.subtle.deriveKey(gt,_t,{name:et,length:rt},!0,["decrypt"]),At=await st.subtle.decrypt(pt,mt,dt);return new Uint8Array(At)}return{encrypt:at,decrypt:ct}}var aesGcm_browser$2={create:create$6};const{base64:base64$5}=require$$4,ciphers$6=aesGcm_browser$2;var importer$5={import:async function(et,tt){const rt=base64$5.decode(et);return await ciphers$6.create().decrypt(rt,tt)}};const require$$1$4=getAugmentedNamespace(sha2Browser);function equals(et,tt){if(et===tt)return!0;if(et.byteLength!==tt.byteLength)return!1;for(let rt=0;rt<et.byteLength;rt++)if(et[rt]!==tt[rt])return!1;return!0}const equals$1=Object.freeze(Object.defineProperty({__proto__:null,equals},Symbol.toStringTag,{value:"Module"})),require$$1$3=getAugmentedNamespace(equals$1);function toString$6(et,tt="utf8"){const rt=BASES$3[tt];if(!rt)throw new Error(`Unsupported encoding "${tt}"`);return(tt==="utf8"||tt==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(et.buffer,et.byteOffset,et.byteLength).toString("utf8"):rt.encoder.encode(et).substring(1)}const toString$7=Object.freeze(Object.defineProperty({__proto__:null,toString:toString$6},Symbol.toStringTag,{value:"Module"})),require$$1$2=getAugmentedNamespace(toString$7);var forge$A=forge$W,sha512$2=forge$A.sha512=forge$A.sha512||{};forge$A.md.sha512=forge$A.md.algorithms.sha512=sha512$2;var sha384$1=forge$A.sha384=forge$A.sha512.sha384=forge$A.sha512.sha384||{};sha384$1.create=function(){return sha512$2.create("SHA-384")},forge$A.md.sha384=forge$A.md.algorithms.sha384=sha384$1,forge$A.sha512.sha256=forge$A.sha512.sha256||{create:function(){return sha512$2.create("SHA-512/256")}},forge$A.md["sha512/256"]=forge$A.md.algorithms["sha512/256"]=forge$A.sha512.sha256,forge$A.sha512.sha224=forge$A.sha512.sha224||{create:function(){return sha512$2.create("SHA-512/224")}},forge$A.md["sha512/224"]=forge$A.md.algorithms["sha512/224"]=forge$A.sha512.sha224,sha512$2.create=function(et){if(_initialized$3||_init$3(),typeof et>"u"&&(et="SHA-512"),!(et in _states$1))throw new Error("Invalid SHA-512 algorithm: "+et);for(var tt=_states$1[et],rt=null,nt=forge$A.util.createBuffer(),it=new Array(80),ot=0;ot<80;++ot)it[ot]=new Array(2);var st=64;switch(et){case"SHA-384":st=48;break;case"SHA-512/256":st=32;break;case"SHA-512/224":st=28;break}var at={algorithm:et.replace("-","").toLowerCase(),blockLength:128,digestLength:st,messageLength:0,fullMessageLength:null,messageLengthSize:16};return at.start=function(){at.messageLength=0,at.fullMessageLength=at.messageLength128=[];for(var ct=at.messageLengthSize/4,ut=0;ut<ct;++ut)at.fullMessageLength.push(0);nt=forge$A.util.createBuffer(),rt=new Array(tt.length);for(var ut=0;ut<tt.length;++ut)rt[ut]=tt[ut].slice(0);return at},at.start(),at.update=function(ct,ut){ut==="utf8"&&(ct=forge$A.util.encodeUtf8(ct));var lt=ct.length;at.messageLength+=lt,lt=[lt/4294967296>>>0,lt>>>0];for(var ht=at.fullMessageLength.length-1;ht>=0;--ht)at.fullMessageLength[ht]+=lt[1],lt[1]=lt[0]+(at.fullMessageLength[ht]/4294967296>>>0),at.fullMessageLength[ht]=at.fullMessageLength[ht]>>>0,lt[0]=lt[1]/4294967296>>>0;return nt.putBytes(ct),_update$3(rt,it,nt),(nt.read>2048||nt.length()===0)&&nt.compact(),at},at.digest=function(){var ct=forge$A.util.createBuffer();ct.putBytes(nt.bytes());var ut=at.fullMessageLength[at.fullMessageLength.length-1]+at.messageLengthSize,lt=ut&at.blockLength-1;ct.putBytes(_padding$3.substr(0,at.blockLength-lt));for(var ht,ft,dt=at.fullMessageLength[0]*8,pt=0;pt<at.fullMessageLength.length-1;++pt)ht=at.fullMessageLength[pt+1]*8,ft=ht/4294967296>>>0,dt+=ft,ct.putInt32(dt>>>0),dt=ht>>>0;ct.putInt32(dt);for(var gt=new Array(rt.length),pt=0;pt<rt.length;++pt)gt[pt]=rt[pt].slice(0);_update$3(gt,it,ct);var _t=forge$A.util.createBuffer(),mt;et==="SHA-512"?mt=gt.length:et==="SHA-384"?mt=gt.length-2:mt=gt.length-4;for(var pt=0;pt<mt;++pt)_t.putInt32(gt[pt][0]),(pt!==mt-1||et!=="SHA-512/224")&&_t.putInt32(gt[pt][1]);return _t},at};var _padding$3=null,_initialized$3=!1,_k$2=null,_states$1=null;function _init$3(){_padding$3=String.fromCharCode(128),_padding$3+=forge$A.util.fillString(String.fromCharCode(0),128),_k$2=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],_states$1={},_states$1["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],_states$1["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],_states$1["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],_states$1["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],_initialized$3=!0}function _update$3(et,tt,rt){for(var nt,it,ot,st,at,ct,ut,lt,ht,ft,dt,pt,gt,_t,mt,At,It,Mt,kt,Ct,Ut,Wt,Ft,Ce,bt,yt,$t,Et,Tt,Pt,St,Dt,wt,xt,Ke,Pe=rt.length();Pe>=128;){for(Tt=0;Tt<16;++Tt)tt[Tt][0]=rt.getInt32()>>>0,tt[Tt][1]=rt.getInt32()>>>0;for(;Tt<80;++Tt)Dt=tt[Tt-2],Pt=Dt[0],St=Dt[1],nt=((Pt>>>19|St<<13)^(St>>>29|Pt<<3)^Pt>>>6)>>>0,it=((Pt<<13|St>>>19)^(St<<3|Pt>>>29)^(Pt<<26|St>>>6))>>>0,xt=tt[Tt-15],Pt=xt[0],St=xt[1],ot=((Pt>>>1|St<<31)^(Pt>>>8|St<<24)^Pt>>>7)>>>0,st=((Pt<<31|St>>>1)^(Pt<<24|St>>>8)^(Pt<<25|St>>>7))>>>0,wt=tt[Tt-7],Ke=tt[Tt-16],St=it+wt[1]+st+Ke[1],tt[Tt][0]=nt+wt[0]+ot+Ke[0]+(St/4294967296>>>0)>>>0,tt[Tt][1]=St>>>0;for(gt=et[0][0],_t=et[0][1],mt=et[1][0],At=et[1][1],It=et[2][0],Mt=et[2][1],kt=et[3][0],Ct=et[3][1],Ut=et[4][0],Wt=et[4][1],Ft=et[5][0],Ce=et[5][1],bt=et[6][0],yt=et[6][1],$t=et[7][0],Et=et[7][1],Tt=0;Tt<80;++Tt)ut=((Ut>>>14|Wt<<18)^(Ut>>>18|Wt<<14)^(Wt>>>9|Ut<<23))>>>0,lt=((Ut<<18|Wt>>>14)^(Ut<<14|Wt>>>18)^(Wt<<23|Ut>>>9))>>>0,ht=(bt^Ut&(Ft^bt))>>>0,ft=(yt^Wt&(Ce^yt))>>>0,at=((gt>>>28|_t<<4)^(_t>>>2|gt<<30)^(_t>>>7|gt<<25))>>>0,ct=((gt<<4|_t>>>28)^(_t<<30|gt>>>2)^(_t<<25|gt>>>7))>>>0,dt=(gt&mt|It&(gt^mt))>>>0,pt=(_t&At|Mt&(_t^At))>>>0,St=Et+lt+ft+_k$2[Tt][1]+tt[Tt][1],nt=$t+ut+ht+_k$2[Tt][0]+tt[Tt][0]+(St/4294967296>>>0)>>>0,it=St>>>0,St=ct+pt,ot=at+dt+(St/4294967296>>>0)>>>0,st=St>>>0,$t=bt,Et=yt,bt=Ft,yt=Ce,Ft=Ut,Ce=Wt,St=Ct+it,Ut=kt+nt+(St/4294967296>>>0)>>>0,Wt=St>>>0,kt=It,Ct=Mt,It=mt,Mt=At,mt=gt,At=_t,St=it+st,gt=nt+ot+(St/4294967296>>>0)>>>0,_t=St>>>0;St=et[0][1]+_t,et[0][0]=et[0][0]+gt+(St/4294967296>>>0)>>>0,et[0][1]=St>>>0,St=et[1][1]+At,et[1][0]=et[1][0]+mt+(St/4294967296>>>0)>>>0,et[1][1]=St>>>0,St=et[2][1]+Mt,et[2][0]=et[2][0]+It+(St/4294967296>>>0)>>>0,et[2][1]=St>>>0,St=et[3][1]+Ct,et[3][0]=et[3][0]+kt+(St/4294967296>>>0)>>>0,et[3][1]=St>>>0,St=et[4][1]+Wt,et[4][0]=et[4][0]+Ut+(St/4294967296>>>0)>>>0,et[4][1]=St>>>0,St=et[5][1]+Ce,et[5][0]=et[5][0]+Ft+(St/4294967296>>>0)>>>0,et[5][1]=St>>>0,St=et[6][1]+yt,et[6][0]=et[6][0]+bt+(St/4294967296>>>0)>>>0,et[6][1]=St>>>0,St=et[7][1]+Et,et[7][0]=et[7][0]+$t+(St/4294967296>>>0)>>>0,et[7][1]=St>>>0,Pe-=128}}var rsaBrowser$2={};const MAX_BYTES=65536;function randomBytes$8(et){const tt=new Uint8Array(et);let rt=0;if(et>0)if(et>MAX_BYTES)for(;rt<et;)rt+MAX_BYTES>et?(crypto.getRandomValues(tt.subarray(rt,rt+(et-rt))),rt+=et-rt):(crypto.getRandomValues(tt.subarray(rt,rt+MAX_BYTES)),rt+=MAX_BYTES);else crypto.getRandomValues(tt);return tt}var random_browser=randomBytes$8;const randomBytes$7=random_browser,errcode$m=errCode$i;var randomBytes_1$3=function(et){if(isNaN(et)||et<=0)throw errcode$m(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return randomBytes$7(et)},rsaUtils$2={},util$4={};(function(et){const tt=forge$W,{fromString:rt}=require$$9$2,{toString:nt}=require$$1$2,{concat:it}=require$$7$1;et.bigIntegerToUintBase64url=(ot,st)=>{let at=Uint8Array.from(ot.abs().toByteArray());if(at=at[0]===0?at.slice(1):at,st!=null){if(at.length>st)throw new Error("byte array longer than desired length");at=it([new Uint8Array(st-at.length),at])}return nt(at,"base64url")},et.base64urlToBigInteger=ot=>{const st=et.base64urlToBuffer(ot);return new tt.jsbn.BigInteger(nt(st,"base16"),16)},et.base64urlToBuffer=(ot,st)=>{let at=rt(ot,"base64urlpad");if(st!=null){if(at.length>st)throw new Error("byte array longer than desired length");at=it([new Uint8Array(st-at.length),at])}return at}})(util$4);const forge$z=forge$W,{bigIntegerToUintBase64url:bigIntegerToUintBase64url$2,base64urlToBigInteger:base64urlToBigInteger$2}=util$4,{fromString:uint8ArrayFromString$n}=require$$9$2,{toString:uint8ArrayToString$t}=require$$1$2;rsaUtils$2.pkcs1ToJwk=function(et){const tt=forge$z.asn1.fromDer(uint8ArrayToString$t(et,"ascii")),rt=forge$z.pki.privateKeyFromAsn1(tt);return{kty:"RSA",n:bigIntegerToUintBase64url$2(rt.n),e:bigIntegerToUintBase64url$2(rt.e),d:bigIntegerToUintBase64url$2(rt.d),p:bigIntegerToUintBase64url$2(rt.p),q:bigIntegerToUintBase64url$2(rt.q),dp:bigIntegerToUintBase64url$2(rt.dP),dq:bigIntegerToUintBase64url$2(rt.dQ),qi:bigIntegerToUintBase64url$2(rt.qInv),alg:"RS256",kid:"2011-04-29"}},rsaUtils$2.jwkToPkcs1=function(et){const tt=forge$z.pki.privateKeyToAsn1({n:base64urlToBigInteger$2(et.n),e:base64urlToBigInteger$2(et.e),d:base64urlToBigInteger$2(et.d),p:base64urlToBigInteger$2(et.p),q:base64urlToBigInteger$2(et.q),dP:base64urlToBigInteger$2(et.dp),dQ:base64urlToBigInteger$2(et.dq),qInv:base64urlToBigInteger$2(et.qi)});return uint8ArrayFromString$n(forge$z.asn1.toDer(tt).getBytes(),"ascii")},rsaUtils$2.pkixToJwk=function(et){const tt=forge$z.asn1.fromDer(uint8ArrayToString$t(et,"ascii")),rt=forge$z.pki.publicKeyFromAsn1(tt);return{kty:"RSA",n:bigIntegerToUintBase64url$2(rt.n),e:bigIntegerToUintBase64url$2(rt.e),alg:"RS256",kid:"2011-04-29"}},rsaUtils$2.jwkToPkix=function(et){const tt=forge$z.pki.publicKeyToAsn1({n:base64urlToBigInteger$2(et.n),e:base64urlToBigInteger$2(et.e)});return uint8ArrayFromString$n(forge$z.asn1.toDer(tt).getBytes(),"ascii")};var jwk2pem$2,hasRequiredJwk2pem$2;function requireJwk2pem$2(){if(hasRequiredJwk2pem$2)return jwk2pem$2;hasRequiredJwk2pem$2=1;const et=forge$W,{base64urlToBigInteger:tt}=util$4;function rt(ot,st){return st.map(at=>tt(ot[at]))}function nt(ot){return et.pki.setRsaPrivateKey(...rt(ot,["n","e","d","p","q","dp","dq","qi"]))}function it(ot){return et.pki.setRsaPublicKey(...rt(ot,["n","e"]))}return jwk2pem$2={jwk2pub:it,jwk2priv:nt},jwk2pem$2}const webcrypto$7=webcrypto$9,randomBytes$6=randomBytes_1$3,{toString:uint8ArrayToString$s}=require$$1$2,{fromString:uint8ArrayFromString$m}=require$$9$2;rsaBrowser$2.utils=rsaUtils$2,rsaBrowser$2.generateKey=async function(et){const tt=await webcrypto$7.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:et,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),rt=await exportKey$2(tt);return{privateKey:rt[0],publicKey:rt[1]}},rsaBrowser$2.unmarshalPrivateKey=async function(et){const tt=[await webcrypto$7.get().subtle.importKey("jwk",et,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await derivePublicFromPrivate$2(et)],rt=await exportKey$2({privateKey:tt[0],publicKey:tt[1]});return{privateKey:rt[0],publicKey:rt[1]}},rsaBrowser$2.getRandomValues=randomBytes$6,rsaBrowser$2.hashAndSign=async function(et,tt){const rt=await webcrypto$7.get().subtle.importKey("jwk",et,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),nt=await webcrypto$7.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},rt,Uint8Array.from(tt));return new Uint8Array(nt,nt.byteOffset,nt.byteLength)},rsaBrowser$2.hashAndVerify=async function(et,tt,rt){const nt=await webcrypto$7.get().subtle.importKey("jwk",et,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return webcrypto$7.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},nt,tt,rt)};function exportKey$2(et){return Promise.all([webcrypto$7.get().subtle.exportKey("jwk",et.privateKey),webcrypto$7.get().subtle.exportKey("jwk",et.publicKey)])}function derivePublicFromPrivate$2(et){return webcrypto$7.get().subtle.importKey("jwk",{kty:et.kty,n:et.n,e:et.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}const{jwk2pub:jwk2pub$2,jwk2priv:jwk2priv$2}=requireJwk2pem$2();function convertKey$2(et,tt,rt,nt){const it=tt?jwk2pub$2(et):jwk2priv$2(et),ot=uint8ArrayToString$s(Uint8Array.from(rt),"ascii"),st=nt(ot,it);return uint8ArrayFromString$m(st,"ascii")}rsaBrowser$2.encrypt=function(et,tt){return convertKey$2(et,!0,tt,(rt,nt)=>nt.encrypt(rt))},rsaBrowser$2.decrypt=function(et,tt){return convertKey$2(et,!1,tt,(rt,nt)=>nt.decrypt(rt))};const{base64:base64$4}=require$$4,ciphers$5=aesGcm_browser$2;var exporter$b={export:async function(et,tt){const rt=await ciphers$5.create().encrypt(et,tt);return base64$4.encode(rt)}};const{sha256:sha256$c}=require$$1$4,errcode$l=errCode$i,{equals:uint8ArrayEquals$a}=require$$1$3,{toString:uint8ArrayToString$r}=require$$1$2,forge$y=forge$W,crypto$8=rsaBrowser$2,pbm$5=keys$6,exporter$a=exporter$b;let RsaPublicKey$2=class{constructor(et){this._key=et}async verify(et,tt){return crypto$8.hashAndVerify(this._key,tt,et)}marshal(){return crypto$8.utils.jwkToPkix(this._key)}get bytes(){return pbm$5.PublicKey.encode({Type:pbm$5.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(et){return crypto$8.encrypt(this._key,et)}equals(et){return uint8ArrayEquals$a(this.bytes,et.bytes)}async hash(){const{bytes:et}=await sha256$c.digest(this.bytes);return et}},RsaPrivateKey$2=class{constructor(et,tt){this._key=et,this._publicKey=tt}genSecret(){return crypto$8.getRandomValues(16)}async sign(et){return crypto$8.hashAndSign(this._key,et)}get public(){if(!this._publicKey)throw errcode$l(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new RsaPublicKey$2(this._publicKey)}decrypt(et){return crypto$8.decrypt(this._key,et)}marshal(){return crypto$8.utils.jwkToPkcs1(this._key)}get bytes(){return pbm$5.PrivateKey.encode({Type:pbm$5.KeyType.RSA,Data:this.marshal()}).finish()}equals(et){return uint8ArrayEquals$a(this.bytes,et.bytes)}async hash(){const{bytes:et}=await sha256$c.digest(this.bytes);return et}async id(){const et=await this.public.hash();return uint8ArrayToString$r(et,"base58btc")}async export(et,tt="pkcs-8"){if(tt==="pkcs-8"){const rt=new forge$y.util.ByteBuffer(this.marshal()),nt=forge$y.asn1.fromDer(rt),it=forge$y.pki.privateKeyFromAsn1(nt),ot={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return forge$y.pki.encryptRsaPrivateKey(it,et,ot)}else{if(tt==="libp2p-key")return exporter$a.export(this.bytes,et);throw errcode$l(new Error(`export format '${tt}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function unmarshalRsaPrivateKey$2(et){const tt=crypto$8.utils.pkcs1ToJwk(et),rt=await crypto$8.unmarshalPrivateKey(tt);return new RsaPrivateKey$2(rt.privateKey,rt.publicKey)}function unmarshalRsaPublicKey$2(et){const tt=crypto$8.utils.pkixToJwk(et);return new RsaPublicKey$2(tt)}async function fromJwk$2(et){const tt=await crypto$8.unmarshalPrivateKey(et);return new RsaPrivateKey$2(tt.privateKey,tt.publicKey)}async function generateKeyPair$9(et){const tt=await crypto$8.generateKey(et);return new RsaPrivateKey$2(tt.privateKey,tt.publicKey)}var rsaClass$2={RsaPublicKey:RsaPublicKey$2,RsaPrivateKey:RsaPrivateKey$2,unmarshalRsaPublicKey:unmarshalRsaPublicKey$2,unmarshalRsaPrivateKey:unmarshalRsaPrivateKey$2,generateKeyPair:generateKeyPair$9,fromJwk:fromJwk$2};const require$$7=getAugmentedNamespace(identity$8);var ed25519$3={},nobleEd25519={exports:{}};nobleEd25519.exports,function(et,tt){Object.defineProperty(tt,"__esModule",{value:!0}),tt.utils=tt.verify=tt.sign=tt.getPublicKey=tt.SignResult=tt.Signature=tt.Point=tt.ExtendedPoint=tt.CURVE=void 0;const rt={a:-1n,d:0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3n,P:2n**255n-19n,n:2n**252n+0x14def9dea2f79cd65812631a5cf5d3edn,h:8n,Gx:0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51an,Gy:0x6666666666666666666666666666666666666666666666666666666666666658n};tt.CURVE=rt;const nt=32,it=0x2b8324804fc1df0b2b4d00993dfbd7a72f431806ad2fe478c4ee1b274a0ea0b0n,ot=0x376931bf2b8348ac0f3cfcc931f5d1fdaf9d8e0c1b7854bd7e97f6a0497b2e1bn,st=0x786c8905cfaffca216c27b91fe01d8409d2f16175a4172be99c8fdaa805d40ean,at=0x29072a8b2b3e0d79994abddbe70dfe42c81a138cd5e350fe27c09c1945fc176n,ct=0x5968b37af66c22414cdcd32f529b4eebd29e4a2cb01e199931ad5aaa44ed4d20n;class ut{constructor(jt,qt,Ge,Ie){this.x=jt,this.y=qt,this.z=Ge,this.t=Ie}static fromAffine(jt){if(!(jt instanceof ht))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return jt.equals(ht.ZERO)?ut.ZERO:new ut(jt.x,jt.y,1n,Ct(jt.x*jt.y))}static toAffineBatch(jt){const qt=Wt(jt.map(Ge=>Ge.z));return jt.map((Ge,Ie)=>Ge.toAffine(qt[Ie]))}static normalizeZ(jt){return this.toAffineBatch(jt).map(this.fromAffine)}static fromRistrettoHash(jt){const qt=kt(jt.slice(0,nt)),Ge=this.calcElligatorRistrettoMap(qt),Ie=kt(jt.slice(nt,nt*2)),Xe=this.calcElligatorRistrettoMap(Ie);return Ge.add(Xe)}static calcElligatorRistrettoMap(jt){const{d:qt}=rt,Ge=Ct(it*jt*jt),Ie=Ct((Ge+1n)*at);let Xe=-1n;const Je=Ct((Xe-qt*Ge)*Ct(Ge+qt));let{isValid:Qe,value:We}=bt(Ie,Je),ur=Ct(We*jt);At(ur)||(ur=Ct(-ur)),Qe||(We=ur),Qe||(Xe=Ge);const ar=Ct(Xe*(Ge-1n)*ct-Je),cr=We*We,$r=Ct((We+We)*Je),fr=Ct(ar*ot),ue=Ct(1n-cr),Qt=Ct(1n+cr);return new ut(Ct($r*Qt),Ct(ue*fr),Ct(fr*Qt),Ct($r*ue))}static fromRistrettoBytes(jt){const{a:qt,d:Ge}=rt,Ie="ExtendedPoint.fromRistrettoBytes: Cannot convert bytes to Ristretto Point",Xe=kt(jt);if(!Pt(mt(Xe,nt),jt)||At(Xe))throw new Error(Ie);const Je=Ct(Xe*Xe),Qe=Ct(1n+qt*Je),We=Ct(1n-qt*Je),ur=Ct(Qe*Qe),ar=Ct(We*We),cr=Ct(qt*Ge*ur-ar),{isValid:$r,value:fr}=yt(Ct(cr*ar)),ue=Ct(fr*We),Qt=Ct(fr*ue*cr);let me=Ct((Xe+Xe)*ue);At(me)&&(me=Ct(-me));const Lt=Ct(Qe*Qt),Gt=Ct(me*Lt);if(!$r||At(Gt)||Lt===0n)throw new Error(Ie);return new ut(me,Lt,1n,Gt)}toRistrettoBytes(){let{x:jt,y:qt,z:Ge,t:Ie}=this;const Xe=Ct((Ge+qt)*(Ge-qt)),Je=Ct(jt*qt),{value:Qe}=yt(Ct(Xe*Je**2n)),We=Ct(Qe*Xe),ur=Ct(Qe*Je),ar=Ct(We*ur*Ie);let cr;At(Ie*ar)?([jt,qt]=[Ct(qt*it),Ct(jt*it)],cr=Ct(We*st)):cr=ur,At(jt*ar)&&(qt=Ct(-qt));let $r=Ct((Ge-qt)*cr);return At($r)&&($r=Ct(-$r)),mt($r,nt)}equals(jt){const qt=this,Ge=jt,[Ie,Xe,Je,Qe]=[qt.t,Ge.t,qt.z,Ge.z];return Ct(Ie*Qe)===Ct(Xe*Je)}negate(){return new ut(Ct(-this.x),this.y,this.z,Ct(-this.t))}double(){const jt=this.x,qt=this.y,Ge=this.z,{a:Ie}=rt,Xe=Ct(jt**2n),Je=Ct(qt**2n),Qe=Ct(2n*Ge**2n),We=Ct(Ie*Xe),ur=Ct((jt+qt)**2n-Xe-Je),ar=Ct(We+Je),cr=Ct(ar-Qe),$r=Ct(We-Je),fr=Ct(ur*cr),ue=Ct(ar*$r),Qt=Ct(ur*$r),me=Ct(cr*ar);return new ut(fr,ue,me,Qt)}add(jt){const qt=this.x,Ge=this.y,Ie=this.z,Xe=this.t,Je=jt.x,Qe=jt.y,We=jt.z,ur=jt.t,ar=Ct((Ge-qt)*(Qe+Je)),cr=Ct((Ge+qt)*(Qe-Je)),$r=Ct(cr-ar);if($r===0n)return this.double();const fr=Ct(Ie*2n*ur),ue=Ct(Xe*2n*We),Qt=Ct(ue+fr),me=Ct(cr+ar),Lt=Ct(ue-fr),Gt=Ct(Qt*$r),Xt=Ct(me*Lt),Yt=Ct(Qt*Lt),He=Ct($r*me);return new ut(Gt,Xt,He,Yt)}subtract(jt){return this.add(jt.negate())}multiplyUnsafe(jt){if(!It(jt))throw new TypeError("Point#multiply: expected number or bigint");let qt=Ct(BigInt(jt),rt.n);if(qt===1n)return this;let Ge=ut.ZERO,Ie=this;for(;qt>0n;)qt&1n&&(Ge=Ge.add(Ie)),Ie=Ie.double(),qt>>=1n;return Ge}precomputeWindow(jt){const qt=256/jt+1;let Ge=[],Ie=this,Xe=Ie;for(let Je=0;Je<qt;Je++){Xe=Ie,Ge.push(Xe);for(let Qe=1;Qe<2**(jt-1);Qe++)Xe=Xe.add(Ie),Ge.push(Xe);Ie=Xe.double()}return Ge}wNAF(jt,qt){!qt&&this.equals(ut.BASE)&&(qt=ht.BASE);const Ge=qt&&qt._WINDOW_SIZE||1;if(256%Ge)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let Ie=qt&&lt.get(qt);Ie||(Ie=this.precomputeWindow(Ge),qt&&Ge!==1&&(Ie=ut.normalizeZ(Ie),lt.set(qt,Ie)));let Xe=ut.ZERO,Je=ut.ZERO;const Qe=256/Ge+1,We=2**(Ge-1),ur=BigInt(2**Ge-1),ar=2**Ge,cr=BigInt(Ge);for(let $r=0;$r<Qe;$r++){const fr=$r*We;let ue=Number(jt&ur);if(jt>>=cr,ue>We&&(ue-=ar,jt+=1n),ue===0)Je=Je.add($r%2?Ie[fr].negate():Ie[fr]);else{const Qt=Ie[fr+Math.abs(ue)-1];Xe=Xe.add(ue<0?Qt.negate():Qt)}}return[Xe,Je]}multiply(jt,qt){if(!It(jt))throw new TypeError("Point#multiply: expected number or bigint");const Ge=Ct(BigInt(jt),rt.n);return ut.normalizeZ(this.wNAF(Ge,qt))[0]}toAffine(jt=Ut(this.z)){const qt=Ct(this.x*jt),Ge=Ct(this.y*jt);return new ht(qt,Ge)}}tt.ExtendedPoint=ut,ut.BASE=new ut(rt.Gx,rt.Gy,1n,Ct(rt.Gx*rt.Gy)),ut.ZERO=new ut(0n,1n,1n,0n);const lt=new WeakMap;class ht{constructor(jt,qt){this.x=jt,this.y=qt}_setWindowSize(jt){this._WINDOW_SIZE=jt,lt.delete(this)}static fromHex(jt){const{d:qt,P:Ge}=rt,Ie=jt instanceof Uint8Array?jt:gt(jt);if(Ie.length!==32)throw new Error("Point.fromHex: expected 32 bytes");const Xe=Ie[31],Je=Xe&-129,Qe=(Xe&128)!==0,We=Uint8Array.from(Array.from(Ie.slice(0,31)).concat(Je)),ur=Mt(We);if(ur>=Ge)throw new Error("Point.fromHex expects hex <= Fp");const ar=Ct(ur*ur),cr=Ct(ar-1n),$r=Ct(qt*ar+1n);let{isValid:fr,value:ue}=bt(cr,$r);if(!fr)throw new Error("Point.fromHex: invalid y coordinate");const Qt=(ue&1n)===1n;return Qe!==Qt&&(ue=Ct(-ue)),new ht(ue,ur)}static async fromPrivateKey(jt){const qt=await tt.utils.sha512(wt(jt));return ht.BASE.multiply(Tt(qt))}toRawBytes(){const jt=_t(this.y),qt=new Uint8Array(nt);for(let Ie=jt.length-2,Xe=0;Xe<nt&&Ie>=0;Ie-=2,Xe++)qt[Xe]=Number.parseInt(jt[Ie]+jt[Ie+1],16);const Ge=this.x&1n?128:0;return qt[nt-1]|=Ge,qt}toHex(){return pt(this.toRawBytes())}toX25519(){return Ct((1n+this.y)*Ut(1n-this.y))}equals(jt){return this.x===jt.x&&this.y===jt.y}negate(){return new ht(Ct(-this.x),this.y)}add(jt){return ut.fromAffine(this).add(ut.fromAffine(jt)).toAffine()}subtract(jt){return this.add(jt.negate())}multiply(jt){return ut.fromAffine(this).multiply(jt,this).toAffine()}}tt.Point=ht,ht.BASE=new ht(rt.Gx,rt.Gy),ht.ZERO=new ht(0n,1n);class ft{constructor(jt,qt){this.r=jt,this.s=qt}static fromHex(jt){jt=St(jt);const qt=ht.fromHex(jt.slice(0,32)),Ge=Mt(jt.slice(32));if(!Dt(Ge))throw new Error("Signature.fromHex expects s <= CURVE.n");return new ft(qt,Ge)}toRawBytes(){const jt=gt(_t(this.s)).reverse(),qt=new Uint8Array(nt);qt.set(jt);const Ge=new Uint8Array(nt*2);return Ge.set(this.r.toRawBytes()),Ge.set(qt,32),Ge}toHex(){return pt(this.toRawBytes())}}tt.Signature=ft,tt.SignResult=ft;function dt(...zt){if(zt.length===1)return zt[0];const jt=zt.reduce((Ge,Ie)=>Ge+Ie.length,0),qt=new Uint8Array(jt);for(let Ge=0,Ie=0;Ge<zt.length;Ge++){const Xe=zt[Ge];qt.set(Xe,Ie),Ie+=Xe.length}return qt}function pt(zt){let jt="";for(let qt=0;qt<zt.length;qt++)jt+=zt[qt].toString(16).padStart(2,"0");return jt}function gt(zt){if(typeof zt!="string")throw new TypeError("hexToBytes: expected string, got "+typeof zt);if(zt.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const jt=new Uint8Array(zt.length/2);for(let qt=0;qt<jt.length;qt++){const Ge=qt*2;jt[qt]=Number.parseInt(zt.slice(Ge,Ge+2),16)}return jt}function _t(zt){const jt=zt.toString(16);return jt.length&1?`0${jt}`:jt}function mt(zt,jt=nt){const qt=_t(zt).padStart(jt*2,"0");return gt(qt).reverse()}function At(zt){return(Ct(zt)&1n)===1n}function It(zt){return!!(typeof zt=="bigint"&&zt>0n||typeof zt=="number"&&zt>0&&Number.isSafeInteger(zt))}function Mt(zt){let jt=0n;for(let qt=0;qt<zt.length;qt++)jt+=BigInt(zt[qt])<<8n*BigInt(qt);return jt}function kt(zt){return Ct(Mt(zt)&2n**255n-1n)}function Ct(zt,jt=rt.P){const qt=zt%jt;return qt>=0n?qt:jt+qt}function Ut(zt,jt=rt.P){if(zt===0n||jt<=0n)throw new Error(`invert: expected positive integers, got n=${zt} mod=${jt}`);let qt=Ct(zt,jt),Ge=jt,[Ie,Xe,Je,Qe]=[0n,1n,1n,0n];for(;qt!==0n;){const We=Ge/qt,ur=Ge%qt,ar=Ie-Je*We,cr=Xe-Qe*We;[Ge,qt]=[qt,ur],[Ie,Xe]=[Je,Qe],[Je,Qe]=[ar,cr]}if(Ge!==1n)throw new Error("invert: does not exist");return Ct(Ie,jt)}function Wt(zt,jt=rt.P){const qt=zt.length,Ge=new Array(qt);let Ie=1n;for(let Xe=0;Xe<qt;Xe++)zt[Xe]!==0n&&(Ge[Xe]=Ie,Ie=Ct(Ie*zt[Xe],jt));Ie=Ut(Ie,jt);for(let Xe=qt-1;Xe>=0;Xe--){if(zt[Xe]===0n)continue;let Je=Ct(Ie*zt[Xe],jt);zt[Xe]=Ct(Ie*Ge[Xe],jt),Ie=Je}return zt}function Ft(zt,jt){const{P:qt}=rt;let Ge=zt;for(;jt-- >0n;)Ge*=Ge,Ge%=qt;return Ge}function Ce(zt){const{P:jt}=rt,qt=zt*zt%jt*zt%jt,Ge=Ft(qt,2n)*qt%jt,Ie=Ft(Ge,1n)*zt%jt,Xe=Ft(Ie,5n)*Ie%jt,Je=Ft(Xe,10n)*Xe%jt,Qe=Ft(Je,20n)*Je%jt,We=Ft(Qe,40n)*Qe%jt,ur=Ft(We,80n)*We%jt,ar=Ft(ur,80n)*We%jt,cr=Ft(ar,10n)*Xe%jt;return Ft(cr,2n)*zt%jt}function bt(zt,jt){const qt=Ct(jt*jt*jt),Ge=Ct(qt*qt*jt);let Ie=Ct(zt*qt*Ce(zt*Ge));const Xe=Ct(jt*Ie*Ie),Je=Ie,Qe=Ct(Ie*it),We=Xe===zt,ur=Xe===Ct(-zt),ar=Xe===Ct(-zt*it);return We&&(Ie=Je),(ur||ar)&&(Ie=Qe),At(Ie)&&(Ie=Ct(-Ie)),{isValid:We||ur,value:Ie}}function yt(zt){return bt(1n,zt)}async function $t(...zt){const jt=dt(...zt),qt=await tt.utils.sha512(jt),Ge=Mt(qt);return Ct(Ge,rt.n)}function Et(zt){return zt.slice(nt)}function Tt(zt){const jt=nt-1,qt=zt.slice(0,nt);return qt[0]&=248,qt[jt]&=127,qt[jt]|=64,Ct(Mt(qt),rt.n)}function Pt(zt,jt){if(zt.length!==jt.length)return!1;for(let qt=0;qt<zt.length;qt++)if(zt[qt]!==jt[qt])return!1;return!0}function St(zt){return zt instanceof Uint8Array?zt:gt(zt)}function Dt(zt){return 0<zt&&zt<rt.n}function wt(zt){let jt;if(typeof zt=="bigint"||typeof zt=="number"&&Number.isSafeInteger(zt)){if(jt=BigInt(zt),jt<0n||jt>2n**256n)throw new Error("Expected 32 bytes of private key");zt=jt.toString(16).padStart(nt*2,"0")}if(typeof zt=="string"){if(zt.length!==64)throw new Error("Expected 32 bytes of private key");return gt(zt)}else if(zt instanceof Uint8Array){if(zt.length!==32)throw new Error("Expected 32 bytes of private key");return zt}else throw new TypeError("Expected valid private key")}async function xt(zt){const jt=await ht.fromPrivateKey(zt);return typeof zt=="string"?jt.toHex():jt.toRawBytes()}tt.getPublicKey=xt;async function Ke(zt,jt){const qt=await tt.utils.sha512(wt(jt)),Ge=Tt(qt),Ie=ht.BASE.multiply(Ge),Xe=St(zt),Je=await $t(Et(qt),Xe),Qe=ht.BASE.multiply(Je),We=await $t(Qe.toRawBytes(),Ie.toRawBytes(),Xe),ur=Ct(Je+We*Ge,rt.n),ar=new ft(Qe,ur);return typeof zt=="string"?ar.toHex():ar.toRawBytes()}tt.sign=Ke;async function Pe(zt,jt,qt){jt=St(jt),qt instanceof ht||(qt=ht.fromHex(qt)),zt instanceof ft||(zt=ft.fromHex(zt));const Ge=await $t(zt.r.toRawBytes(),qt.toRawBytes(),jt),Ie=ut.fromAffine(qt).multiplyUnsafe(Ge),Xe=ut.BASE.multiply(zt.s);return ut.fromAffine(zt.r).add(Ie).subtract(Xe).multiplyUnsafe(8n).equals(ut.ZERO)}tt.verify=Pe,ht.BASE._setWindowSize(8);const Ht=(()=>{const zt=typeof self=="object"&&"crypto"in self?self.crypto:void 0,jt=typeof commonjsRequire=="function"&&commonjsRequire.bind(et);return{node:jt&&!zt?jt("crypto"):void 0,web:zt}})();tt.utils={TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],randomBytes:(zt=32)=>{if(Ht.web)return Ht.web.getRandomValues(new Uint8Array(zt));if(Ht.node){const{randomBytes:jt}=Ht.node;return new Uint8Array(jt(zt).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>{let zt=1024;for(;zt--;){const jt=tt.utils.randomBytes(32),qt=Mt(jt);if(qt>1n&&qt<rt.n)return jt}throw new Error("Valid private key was not found in 1024 iterations. PRNG is broken")},sha512:async zt=>{if(Ht.web){const jt=await Ht.web.subtle.digest("SHA-512",zt.buffer);return new Uint8Array(jt)}else{if(Ht.node)return Uint8Array.from(Ht.node.createHash("sha512").update(zt).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(zt=8,jt=ht.BASE){const qt=jt.equals(ht.BASE)?jt:new ht(jt.x,jt.y);return qt._setWindowSize(zt),qt.multiply(1n),qt}}}(nobleEd25519,nobleEd25519.exports);var nobleEd25519Exports=nobleEd25519.exports;(function(et){const tt=nobleEd25519Exports,rt=32,nt=64,it=32;et.publicKeyLength=rt,et.privateKeyLength=nt,et.generateKey=async function(){const st=tt.utils.randomPrivateKey(),at=await tt.getPublicKey(st);return{privateKey:ot(st,at),publicKey:at}},et.generateKeyFromSeed=async function(st){if(st.length!==it)throw new TypeError('"seed" must be 32 bytes in length.');if(!(st instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const at=st,ct=await tt.getPublicKey(at);return{privateKey:ot(at,ct),publicKey:ct}},et.hashAndSign=function(st,at){const ct=st.slice(0,it);return tt.sign(at,ct)},et.hashAndVerify=function(st,at,ct){return tt.verify(at,ct,st)};function ot(st,at){const ct=new Uint8Array(et.privateKeyLength);for(let ut=0;ut<it;ut++)ct[ut]=st[ut],ct[it+ut]=at[ut];return ct}})(ed25519$3);const errcode$k=errCode$i,{equals:uint8ArrayEquals$9}=require$$1$3,{sha256:sha256$b}=require$$1$4,{base58btc:base58btc$6}=require$$1$5,{identity:identity$6}=require$$7,crypto$7=ed25519$3,pbm$4=keys$6,exporter$9=exporter$b;let Ed25519PublicKey$2=class{constructor(et){this._key=ensureKey$2(et,crypto$7.publicKeyLength)}async verify(et,tt){return crypto$7.hashAndVerify(this._key,tt,et)}marshal(){return this._key}get bytes(){return pbm$4.PublicKey.encode({Type:pbm$4.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(et){return uint8ArrayEquals$9(this.bytes,et.bytes)}async hash(){const{bytes:et}=await sha256$b.digest(this.bytes);return et}},Ed25519PrivateKey$2=class{constructor(et,tt){this._key=ensureKey$2(et,crypto$7.privateKeyLength),this._publicKey=ensureKey$2(tt,crypto$7.publicKeyLength)}async sign(et){return crypto$7.hashAndSign(this._key,et)}get public(){return new Ed25519PublicKey$2(this._publicKey)}marshal(){return this._key}get bytes(){return pbm$4.PrivateKey.encode({Type:pbm$4.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(et){return uint8ArrayEquals$9(this.bytes,et.bytes)}async hash(){const{bytes:et}=await sha256$b.digest(this.bytes);return et}async id(){const et=await identity$6.digest(this.public.bytes);return base58btc$6.encode(et.bytes).substring(1)}async export(et,tt="libp2p-key"){if(tt==="libp2p-key")return exporter$9.export(this.bytes,et);throw errcode$k(new Error(`export format '${tt}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function unmarshalEd25519PrivateKey$2(et){if(et.length>crypto$7.privateKeyLength){et=ensureKey$2(et,crypto$7.privateKeyLength+crypto$7.publicKeyLength);const nt=et.slice(0,crypto$7.privateKeyLength),it=et.slice(crypto$7.privateKeyLength,et.length);return new Ed25519PrivateKey$2(nt,it)}et=ensureKey$2(et,crypto$7.privateKeyLength);const tt=et.slice(0,crypto$7.privateKeyLength),rt=et.slice(crypto$7.publicKeyLength);return new Ed25519PrivateKey$2(tt,rt)}function unmarshalEd25519PublicKey$2(et){return et=ensureKey$2(et,crypto$7.publicKeyLength),new Ed25519PublicKey$2(et)}async function generateKeyPair$8(){const{privateKey:et,publicKey:tt}=await crypto$7.generateKey();return new Ed25519PrivateKey$2(et,tt)}async function generateKeyPairFromSeed$5(et){const{privateKey:tt,publicKey:rt}=await crypto$7.generateKeyFromSeed(et);return new Ed25519PrivateKey$2(tt,rt)}function ensureKey$2(et,tt){if(et=Uint8Array.from(et||[]),et.length!==tt)throw errcode$k(new Error(`Key must be a Uint8Array of length ${tt}, got ${et.length}`),"ERR_INVALID_KEY_TYPE");return et}var ed25519Class$2={Ed25519PublicKey:Ed25519PublicKey$2,Ed25519PrivateKey:Ed25519PrivateKey$2,unmarshalEd25519PrivateKey:unmarshalEd25519PrivateKey$2,unmarshalEd25519PublicKey:unmarshalEd25519PublicKey$2,generateKeyPair:generateKeyPair$8,generateKeyPairFromSeed:generateKeyPairFromSeed$5},nobleSecp256k1={exports:{}},hasRequiredNobleSecp256k1;function requireNobleSecp256k1(){return hasRequiredNobleSecp256k1||(hasRequiredNobleSecp256k1=1,function(et,tt){Object.defineProperty(tt,"__esModule",{value:!0}),tt.utils=tt.schnorr=tt.verify=tt.signSync=tt.sign=tt.getSharedSecret=tt.recoverPublicKey=tt.getPublicKey=tt.SignResult=tt.Signature=tt.Point=tt.CURVE=void 0;const rt={a:0n,b:7n,P:2n**256n-2n**32n-977n,n:2n**256n-0x14551231950b75fc4402da1732fc9bebfn,h:1n,Gx:0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798n,Gy:0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8n,beta:0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501een};tt.CURVE=rt;function nt(ue){const{a:Qt,b:me}=rt;return kt(ue**3n+Qt*ue+me)}const it=rt.a===0n;class ot{constructor(Qt,me,Lt){this.x=Qt,this.y=me,this.z=Lt}static fromAffine(Qt){if(!(Qt instanceof at))throw new TypeError("JacobianPoint#fromAffine: expected Point");return new ot(Qt.x,Qt.y,1n)}static toAffineBatch(Qt){const me=Ft(Qt.map(Lt=>Lt.z));return Qt.map((Lt,Gt)=>Lt.toAffine(me[Gt]))}static normalizeZ(Qt){return ot.toAffineBatch(Qt).map(ot.fromAffine)}equals(Qt){const me=this,Lt=Qt,Gt=kt(me.z*me.z),Xt=kt(me.z*Gt),Yt=kt(Lt.z*Lt.z),He=kt(Lt.z*Yt);return kt(me.x*Yt)===kt(Gt*Lt.x)&&kt(me.y*He)===kt(Xt*Lt.y)}negate(){return new ot(this.x,kt(-this.y),this.z)}double(){const Qt=this.x,me=this.y,Lt=this.z,Gt=kt(Qt**2n),Xt=kt(me**2n),Yt=kt(Xt**2n),He=kt(2n*(kt(kt((Qt+Xt)**2n))-Gt-Yt)),ir=kt(3n*Gt),vt=kt(ir**2n),Rt=kt(vt-2n*He),Bt=kt(ir*(He-Rt)-8n*Yt),Nt=kt(2n*me*Lt);return new ot(Rt,Bt,Nt)}add(Qt){if(!(Qt instanceof ot))throw new TypeError("JacobianPoint#add: expected JacobianPoint");const me=this.x,Lt=this.y,Gt=this.z,Xt=Qt.x,Yt=Qt.y,He=Qt.z;if(Xt===0n||Yt===0n)return this;if(me===0n||Lt===0n)return Qt;const ir=kt(Gt**2n),vt=kt(He**2n),Rt=kt(me*vt),Bt=kt(Xt*ir),Nt=kt(Lt*He*vt),Ot=kt(kt(Yt*Gt)*ir),Kt=kt(Bt-Rt),$e=kt(Ot-Nt);if(Kt===0n)return $e===0n?this.double():ot.ZERO;const nr=kt(Kt**2n),Ze=kt(Kt*nr),tr=kt(Rt*nr),lr=kt($e**2n-Ze-2n*tr),dr=kt($e*(tr-lr)-Nt*Ze),br=kt(Gt*He*Kt);return new ot(lr,dr,br)}subtract(Qt){return this.add(Qt.negate())}multiplyUnsafe(Qt){if(!Mt(Qt))throw new TypeError("Point#multiply: expected valid scalar");let me=kt(BigInt(Qt),rt.n);if(!it){let Rt=ot.ZERO,Bt=this;for(;me>0n;)me&1n&&(Rt=Rt.add(Bt)),Bt=Bt.double(),me>>=1n;return Rt}let[Lt,Gt,Xt,Yt]=yt(me),He=ot.ZERO,ir=ot.ZERO,vt=this;for(;Gt>0n||Yt>0n;)Gt&1n&&(He=He.add(vt)),Yt&1n&&(ir=ir.add(vt)),vt=vt.double(),Gt>>=1n,Yt>>=1n;return Lt&&(He=He.negate()),Xt&&(ir=ir.negate()),ir=new ot(kt(ir.x*rt.beta),ir.y,ir.z),He.add(ir)}precomputeWindow(Qt){const me=it?128/Qt+1:256/Qt+1;let Lt=[],Gt=this,Xt=Gt;for(let Yt=0;Yt<me;Yt++){Xt=Gt,Lt.push(Xt);for(let He=1;He<2**(Qt-1);He++)Xt=Xt.add(Gt),Lt.push(Xt);Gt=Xt.double()}return Lt}wNAF(Qt,me){!me&&this.equals(ot.BASE)&&(me=at.BASE);const Lt=me&&me._WINDOW_SIZE||1;if(256%Lt)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let Gt=me&&st.get(me);Gt||(Gt=this.precomputeWindow(Lt),me&&Lt!==1&&(Gt=ot.normalizeZ(Gt),st.set(me,Gt)));let Xt=ot.ZERO,Yt=ot.ZERO;const He=it?128/Lt+1:256/Lt+1,ir=2**(Lt-1),vt=BigInt(2**Lt-1),Rt=2**Lt,Bt=BigInt(Lt);for(let Nt=0;Nt<He;Nt++){const Ot=Nt*ir;let Kt=Number(Qt&vt);if(Qt>>=Bt,Kt>ir&&(Kt-=Rt,Qt+=1n),Kt===0)Yt=Yt.add(Nt%2?Gt[Ot].negate():Gt[Ot]);else{const $e=Gt[Ot+Math.abs(Kt)-1];Xt=Xt.add(Kt<0?$e.negate():$e)}}return[Xt,Yt]}multiply(Qt,me){if(!Mt(Qt))throw new TypeError("Point#multiply: expected valid scalar");let Lt=kt(BigInt(Qt),rt.n),Gt,Xt;if(it){const[Yt,He,ir,vt]=yt(Lt);let Rt,Bt,Nt,Ot;[Rt,Nt]=this.wNAF(He,me),[Bt,Ot]=this.wNAF(vt,me),Yt&&(Rt=Rt.negate()),ir&&(Bt=Bt.negate()),Bt=new ot(kt(Bt.x*rt.beta),Bt.y,Bt.z),[Gt,Xt]=[Rt.add(Bt),Nt.add(Ot)]}else[Gt,Xt]=this.wNAF(Lt,me);return ot.normalizeZ([Gt,Xt])[0]}toAffine(Qt=Wt(this.z)){const me=Qt**2n,Lt=kt(this.x*me),Gt=kt(this.y*me*Qt);return new at(Lt,Gt)}}ot.BASE=new ot(rt.Gx,rt.Gy,1n),ot.ZERO=new ot(0n,1n,0n);const st=new WeakMap;class at{constructor(Qt,me){this.x=Qt,this.y=me}_setWindowSize(Qt){this._WINDOW_SIZE=Qt,st.delete(this)}static fromCompressedHex(Qt){const me=Qt.length===32,Lt=At(me?Qt:Qt.slice(1)),Gt=nt(Lt);let Xt=Ut(Gt);const Yt=(Xt&1n)===1n;me?Yt&&(Xt=kt(-Xt)):(Qt[0]&1)===1!==Yt&&(Xt=kt(-Xt));const He=new at(Lt,Xt);return He.assertValidity(),He}static fromUncompressedHex(Qt){const me=At(Qt.slice(1,33)),Lt=At(Qt.slice(33)),Gt=new at(me,Lt);return Gt.assertValidity(),Gt}static fromHex(Qt){const me=mt(Qt),Lt=me[0];if(me.length===32||me.length===33&&(Lt===2||Lt===3))return this.fromCompressedHex(me);if(me.length===65&&Lt===4)return this.fromUncompressedHex(me);throw new Error(`Point.fromHex: received invalid point. Expected 32-33 compressed bytes or 65 uncompressed bytes, not ${me.length}`)}static fromPrivateKey(Qt){return at.BASE.multiply(wt(Qt))}static fromSignature(Qt,me,Lt){let Gt=Qt instanceof Uint8Array?At(Qt):gt(Qt);const Xt=Ke(me),{r:Yt,s:He}=Xt;if(Lt!==0&&Lt!==1)throw new Error("Cannot recover signature: invalid yParity bit");const ir=2+(Lt&1),vt=at.fromHex(`0${ir}${ft(Yt)}`),Rt=ot.fromAffine(vt).multiplyUnsafe(He),Bt=ot.BASE.multiply(Gt),Nt=Wt(Yt,rt.n),Ot=Rt.subtract(Bt).multiplyUnsafe(Nt).toAffine();return Ot.assertValidity(),Ot}toRawBytes(Qt=!1){return _t(this.toHex(Qt))}toHex(Qt=!1){const me=ft(this.x);return Qt?`${this.y&1n?"03":"02"}${me}`:`04${me}${ft(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){const Qt="Point is not on elliptic curve",{P:me}=rt,{x:Lt,y:Gt}=this;if(Lt===0n||Gt===0n||Lt>=me||Gt>=me)throw new Error(Qt);const Xt=kt(Gt*Gt),Yt=nt(Lt);if((Xt-Yt)%me!==0n)throw new Error(Qt)}equals(Qt){return this.x===Qt.x&&this.y===Qt.y}negate(){return new at(this.x,kt(-this.y))}double(){return ot.fromAffine(this).double().toAffine()}add(Qt){return ot.fromAffine(this).add(ot.fromAffine(Qt)).toAffine()}subtract(Qt){return this.add(Qt.negate())}multiply(Qt){return ot.fromAffine(this).multiply(Qt,this).toAffine()}}tt.Point=at,at.BASE=new at(rt.Gx,rt.Gy),at.ZERO=new at(0n,0n);function ct(ue){return Number.parseInt(ue[0],16)>=8?"00"+ue:ue}class ut{constructor(Qt,me){this.r=Qt,this.s=me}static fromCompact(Qt){if(typeof Qt!="string"&&!(Qt instanceof Uint8Array))throw new TypeError("Signature.fromCompact: Expected string or Uint8Array");const me=Qt instanceof Uint8Array?ht(Qt):Qt;if(me.length!==128)throw new Error("Signature.fromCompact: Expected 64-byte hex");const Lt=new ut(gt(me.slice(0,64)),gt(me.slice(64,128)));return Lt.assertValidity(),Lt}static fromDER(Qt){const me="Signature.fromDER";if(typeof Qt!="string"&&!(Qt instanceof Uint8Array))throw new TypeError(`${me}: Expected string or Uint8Array`);const Lt=Qt instanceof Uint8Array?ht(Qt):Qt,Gt=It(Lt.slice(2,4));if(Lt.slice(0,2)!=="30"||Gt!==Lt.length-4||Lt.slice(4,6)!=="02")throw new Error(`${me}: Invalid signature ${Lt}`);const Xt=It(Lt.slice(6,8)),Yt=8+Xt,He=Lt.slice(8,Yt);if(He.startsWith("00")&&It(He.slice(2,4))<=127)throw new Error(`${me}: Invalid r with trailing length`);const ir=gt(He);if(Lt.slice(Yt,Yt+2)!=="02")throw new Error(`${me}: Invalid r-s separator`);const vt=It(Lt.slice(Yt+2,Yt+4)),Rt=Gt-vt-Xt-10;if(Rt>0||Rt===-4)throw new Error(`${me}: Invalid total length`);if(vt>Gt-Xt-4)throw new Error(`${me}: Invalid s`);const Bt=Yt+4,Nt=Lt.slice(Bt,Bt+vt);if(Nt.startsWith("00")&&It(Nt.slice(2,4))<=127)throw new Error(`${me}: Invalid s with trailing length`);const Ot=gt(Nt),Kt=new ut(ir,Ot);return Kt.assertValidity(),Kt}static fromHex(Qt){return this.fromDER(Qt)}assertValidity(){const{r:Qt,s:me}=this;if(!St(Qt))throw new Error("Invalid Signature: r must be 0 < r < n");if(!St(me))throw new Error("Invalid Signature: s must be 0 < s < n")}toDERRawBytes(Qt=!1){return _t(this.toDERHex(Qt))}toDERHex(Qt=!1){const me=ct(pt(this.s));if(Qt)return me;const Lt=ct(pt(this.r)),Gt=pt(Lt.length/2),Xt=pt(me.length/2);return`30${pt(Lt.length/2+me.length/2+4)}02${Gt}${Lt}02${Xt}${me}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return _t(this.toCompactHex())}toCompactHex(){return ft(this.r)+ft(this.s)}}tt.Signature=ut,tt.SignResult=ut;function lt(...ue){if(ue.length===1)return ue[0];const Qt=ue.reduce((Lt,Gt)=>Lt+Gt.length,0),me=new Uint8Array(Qt);for(let Lt=0,Gt=0;Lt<ue.length;Lt++){const Xt=ue[Lt];me.set(Xt,Gt),Gt+=Xt.length}return me}function ht(ue){let Qt="";for(let me=0;me<ue.length;me++)Qt+=ue[me].toString(16).padStart(2,"0");return Qt}function ft(ue){return ue.toString(16).padStart(64,"0")}function dt(ue){return _t(ft(ue))}function pt(ue){const Qt=ue.toString(16);return Qt.length&1?`0${Qt}`:Qt}function gt(ue){if(typeof ue!="string")throw new TypeError("hexToNumber: expected string, got "+typeof ue);return BigInt(`0x${ue}`)}function _t(ue){if(typeof ue!="string")throw new TypeError("hexToBytes: expected string, got "+typeof ue);if(ue.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const Qt=new Uint8Array(ue.length/2);for(let me=0;me<Qt.length;me++){const Lt=me*2;Qt[me]=Number.parseInt(ue.slice(Lt,Lt+2),16)}return Qt}function mt(ue){return ue instanceof Uint8Array?ue:_t(ue)}function At(ue){return gt(ht(ue))}function It(ue){return Number.parseInt(ue,16)*2}function Mt(ue){return!!(typeof ue=="bigint"&&ue>0n||typeof ue=="number"&&ue>0&&Number.isSafeInteger(ue))}function kt(ue,Qt=rt.P){const me=ue%Qt;return me>=0?me:Qt+me}function Ct(ue,Qt){const{P:me}=rt;let Lt=ue;for(;Qt-- >0n;)Lt*=Lt,Lt%=me;return Lt}function Ut(ue){const{P:Qt}=rt,me=ue*ue*ue%Qt,Lt=me*me*ue%Qt,Gt=Ct(Lt,3n)*Lt%Qt,Xt=Ct(Gt,3n)*Lt%Qt,Yt=Ct(Xt,2n)*me%Qt,He=Ct(Yt,11n)*Yt%Qt,ir=Ct(He,22n)*He%Qt,vt=Ct(ir,44n)*ir%Qt,Rt=Ct(vt,88n)*vt%Qt,Bt=Ct(Rt,44n)*ir%Qt,Nt=Ct(Bt,3n)*Lt%Qt,Ot=Ct(Nt,23n)*He%Qt,Kt=Ct(Ot,6n)*me%Qt;return Ct(Kt,2n)}function Wt(ue,Qt=rt.P){if(ue===0n||Qt<=0n)throw new Error(`invert: expected positive integers, got n=${ue} mod=${Qt}`);let me=kt(ue,Qt),Lt=Qt,[Gt,Xt,Yt,He]=[0n,1n,1n,0n];for(;me!==0n;){const ir=Lt/me,vt=Lt%me,Rt=Gt-Yt*ir,Bt=Xt-He*ir;[Lt,me]=[me,vt],[Gt,Xt]=[Yt,He],[Yt,He]=[Rt,Bt]}if(Lt!==1n)throw new Error("invert: does not exist");return kt(Gt,Qt)}function Ft(ue,Qt=rt.P){const me=ue.length,Lt=new Array(me);let Gt=1n;for(let Xt=0;Xt<me;Xt++)ue[Xt]!==0n&&(Lt[Xt]=Gt,Gt=kt(Gt*ue[Xt],Qt));Gt=Wt(Gt,Qt);for(let Xt=me-1;Xt>=0;Xt--){if(ue[Xt]===0n)continue;const Yt=kt(Gt*ue[Xt],Qt);ue[Xt]=kt(Gt*Lt[Xt],Qt),Gt=Yt}return ue}const Ce=(ue,Qt)=>(ue+Qt/2n)/Qt,bt=2n**128n;function yt(ue){const{n:Qt}=rt,me=0x3086d221a7d46bcde86c90e49284eb15n,Lt=-0xe4437ed6010e88286f547fa90abfe4c3n,Gt=0x114ca50f7a8e2f3f657c1108d9d44cfd8n,Xt=me,Yt=Ce(Xt*ue,Qt),He=Ce(-Lt*ue,Qt);let ir=kt(ue-Yt*me-He*Gt,Qt),vt=kt(-Yt*Lt-He*Xt,Qt);const Rt=ir>bt,Bt=vt>bt;if(Rt&&(ir=Qt-ir),Bt&&(vt=Qt-vt),ir>bt||vt>bt)throw new Error("splitScalarEndo: Endomorphism failed");return[Rt,ir,Bt,vt]}function $t(ue){typeof ue!="string"&&(ue=ht(ue));let Qt=gt(ue||"0");const me=ue.length/2*8-256;return me>0&&(Qt=Qt>>BigInt(me)),Qt>=rt.n&&(Qt-=rt.n),Qt}function Et(ue,Qt){if(ue==null)throw new Error(`sign: expected valid msgHash, not "${ue}"`);const me=typeof ue=="string"?gt(ue):At(ue),Lt=dt(me),Gt=At(Lt),Xt=dt(Qt);let Yt=new Uint8Array(32).fill(1),He=new Uint8Array(32).fill(0);const ir=Uint8Array.from([0]),vt=Uint8Array.from([1]);return[Lt,Gt,Xt,Yt,He,ir,vt]}async function Tt(ue,Qt){const me=wt(Qt);let[Lt,Gt,Xt,Yt,He,ir,vt]=Et(ue,me);const Rt=tt.utils.hmacSha256;He=await Rt(He,Yt,ir,Xt,Lt),Yt=await Rt(He,Yt),He=await Rt(He,Yt,vt,Xt,Lt),Yt=await Rt(He,Yt);for(let Bt=0;Bt<1e3;Bt++){Yt=await Rt(He,Yt);let Nt=Dt(Yt,Gt,me);if(Nt)return Nt;He=await Rt(He,Yt,ir),Yt=await Rt(He,Yt)}throw new TypeError("secp256k1: Tried 1,000 k values for sign(), all were invalid")}function Pt(ue,Qt){const me=wt(Qt);let[Lt,Gt,Xt,Yt,He,ir,vt]=Et(ue,me);const Rt=tt.utils.hmacSha256Sync;if(!Rt)throw new Error("utils.hmacSha256Sync is undefined, you need to set it");if(He=Rt(He,Yt,ir,Xt,Lt),He instanceof Promise)throw new Error("To use sync sign(), ensure utils.hmacSha256 is sync");Yt=Rt(He,Yt),He=Rt(He,Yt,vt,Xt,Lt),Yt=Rt(He,Yt);for(let Bt=0;Bt<1e3;Bt++){Yt=Rt(He,Yt);let Nt=Dt(Yt,Gt,me);if(Nt)return Nt;He=Rt(He,Yt,ir),Yt=Rt(He,Yt)}throw new TypeError("secp256k1: Tried 1,000 k values for sign(), all were invalid")}function St(ue){return 0<ue&&ue<rt.n}function Dt(ue,Qt,me){const Lt=At(ue);if(!St(Lt))return;const Gt=rt.n,Xt=at.BASE.multiply(Lt),Yt=kt(Xt.x,Gt),He=kt(Wt(Lt,Gt)*(Qt+Yt*me),Gt);if(!(Yt===0n||He===0n))return[Xt,Yt,He]}function wt(ue){let Qt;if(typeof ue=="bigint")Qt=ue;else if(typeof ue=="number"&&Number.isSafeInteger(ue)&&ue>0)Qt=BigInt(ue);else if(typeof ue=="string"){if(ue.length!==64)throw new Error("Expected 32 bytes of private key");Qt=gt(ue)}else if(ue instanceof Uint8Array){if(ue.length!==32)throw new Error("Expected 32 bytes of private key");Qt=At(ue)}else throw new TypeError("Expected valid private key");if(!St(Qt))throw new Error("Expected private key: 0 < key < n");return Qt}function xt(ue){return ue instanceof at?(ue.assertValidity(),ue):at.fromHex(ue)}function Ke(ue){return ue instanceof ut?(ue.assertValidity(),ue):ut.fromDER(ue)}function Pe(ue,Qt=!1){const me=at.fromPrivateKey(ue);return typeof ue=="string"?me.toHex(Qt):me.toRawBytes(Qt)}tt.getPublicKey=Pe;function Ht(ue,Qt,me){const Lt=at.fromSignature(ue,Qt,me);return typeof ue=="string"?Lt.toHex():Lt.toRawBytes()}tt.recoverPublicKey=Ht;function zt(ue){const Qt=ue instanceof Uint8Array,me=typeof ue=="string",Lt=(Qt||me)&&ue.length;return Qt?Lt===33||Lt===65:me?Lt===66||Lt===130:ue instanceof at}function jt(ue,Qt,me=!1){if(zt(ue))throw new TypeError("getSharedSecret: first arg must be private key");if(!zt(Qt))throw new TypeError("getSharedSecret: second arg must be public key");const Lt=xt(Qt);Lt.assertValidity();const Gt=Lt.multiply(wt(ue));return typeof ue=="string"?Gt.toHex(me):Gt.toRawBytes(me)}tt.getSharedSecret=jt;function qt(ue,Qt,me=!1){const[Lt,Gt,Xt]=ue;let{canonical:Yt,der:He,recovered:ir}=Qt,vt=(Lt.x===Gt?0:2)|Number(Lt.y&1n),Rt=Xt;const Bt=rt.n>>1n;Xt>Bt&&Yt&&(Rt=rt.n-Xt,vt^=1);const Nt=new ut(Gt,Rt);Nt.assertValidity();const Ot=He===!1?Nt.toCompactHex():Nt.toDERHex(),Kt=me?Ot:_t(Ot);return ir?[Kt,vt]:Kt}async function Ge(ue,Qt,me={}){return qt(await Tt(ue,Qt),me,typeof ue=="string")}tt.sign=Ge;function Ie(ue,Qt,me={}){return qt(Pt(ue,Qt),me,typeof ue=="string")}tt.signSync=Ie;function Xe(ue,Qt,me){const{n:Lt}=rt;let Gt;try{Gt=Ke(ue)}catch{return!1}const{r:Xt,s:Yt}=Gt,He=$t(Qt);if(He===0n)return!1;const ir=ot.fromAffine(xt(me)),vt=Wt(Yt,Lt),Rt=kt(He*vt,Lt),Bt=kt(Xt*vt,Lt),Nt=ot.BASE.multiply(Rt),Ot=ir.multiplyUnsafe(Bt),Kt=Nt.add(Ot).toAffine();return kt(Kt.x,Lt)===Xt}tt.verify=Xe;async function Je(ue,...Qt){const me=new Uint8Array(ue.split("").map(Xt=>Xt.charCodeAt(0))),Lt=await tt.utils.sha256(me),Gt=await tt.utils.sha256(lt(Lt,Lt,...Qt));return At(Gt)}async function Qe(ue,Qt,me){const Lt=dt(ue),Gt=await Je("BIP0340/challenge",Lt,Qt.toRawX(),me);return kt(Gt,rt.n)}function We(ue){return kt(ue.y,2n)===0n}class ur{constructor(Qt,me){if(this.r=Qt,this.s=me,Qt<=0n||me<=0n||Qt>=rt.P||me>=rt.n)throw new Error("Invalid signature")}static fromHex(Qt){const me=mt(Qt);if(me.length!==64)throw new TypeError(`SchnorrSignature.fromHex: expected 64 bytes, not ${me.length}`);const Lt=At(me.slice(0,32)),Gt=At(me.slice(32));return new ur(Lt,Gt)}toHex(){return ft(this.r)+ft(this.s)}toRawBytes(){return _t(this.toHex())}}function ar(ue){const Qt=at.fromPrivateKey(ue);return typeof ue=="string"?Qt.toHexX():Qt.toRawX()}async function cr(ue,Qt,me=tt.utils.randomBytes()){if(ue==null)throw new TypeError(`sign: Expected valid message, not "${ue}"`);Qt||(Qt=0n);const{n:Lt}=rt,Gt=mt(ue),Xt=wt(Qt),Yt=mt(me);if(Yt.length!==32)throw new TypeError("sign: Expected 32 bytes of aux randomness");const He=at.fromPrivateKey(Xt),ir=We(He)?Xt:Lt-Xt,vt=await Je("BIP0340/aux",Yt),Rt=ir^vt,Bt=await Je("BIP0340/nonce",dt(Rt),He.toRawX(),Gt),Nt=kt(Bt,Lt);if(Nt===0n)throw new Error("sign: Creation of signature failed. k is zero");const Ot=at.fromPrivateKey(Nt),Kt=We(Ot)?Nt:Lt-Nt,$e=await Qe(Ot.x,He,Gt),nr=new ur(Ot.x,kt(Kt+$e*ir,Lt));if(!await $r(nr.toRawBytes(),Gt,He.toRawX()))throw new Error("sign: Invalid signature produced");return typeof ue=="string"?nr.toHex():nr.toRawBytes()}async function $r(ue,Qt,me){const Lt=ue instanceof ur?ue:ur.fromHex(ue),Gt=typeof Qt=="string"?_t(Qt):Qt,Xt=xt(me),Yt=await Qe(Lt.r,Xt,Gt),He=at.fromPrivateKey(Lt.s),ir=Xt.multiply(Yt),vt=He.subtract(ir);return!(vt.equals(at.BASE)||!We(vt)||vt.x!==Lt.r)}tt.schnorr={Signature:ur,getPublicKey:ar,sign:cr,verify:$r},at.BASE._setWindowSize(8);const fr=(()=>{const ue=typeof self=="object"&&"crypto"in self?self.crypto:void 0;return{node:typeof commonjsRequire=="function"&&!ue?require$$0$3:void 0,web:ue}})();tt.utils={isValidPrivateKey(ue){try{return wt(ue),!0}catch{return!1}},randomBytes:(ue=32)=>{if(fr.web)return fr.web.getRandomValues(new Uint8Array(ue));if(fr.node){const{randomBytes:Qt}=fr.node;return new Uint8Array(Qt(ue).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>{let ue=8;for(;ue--;){const Qt=tt.utils.randomBytes(32),me=At(Qt);if(St(me)&&me!==1n)return Qt}throw new Error("Valid private key was not found in 8 iterations. PRNG is broken")},sha256:async ue=>{if(fr.web){const Qt=await fr.web.subtle.digest("SHA-256",ue.buffer);return new Uint8Array(Qt)}else if(fr.node){const{createHash:Qt}=fr.node;return Uint8Array.from(Qt("sha256").update(ue).digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(ue,...Qt)=>{if(fr.web){const me=await fr.web.subtle.importKey("raw",ue,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),Lt=lt(...Qt),Gt=await fr.web.subtle.sign("HMAC",me,Lt);return new Uint8Array(Gt)}else if(fr.node){const{createHmac:me}=fr.node,Lt=me("sha256",ue);for(let Gt of Qt)Lt.update(Gt);return Uint8Array.from(Lt.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,precompute(ue=8,Qt=at.BASE){const me=Qt===at.BASE?Qt:new at(Qt.x,Qt.y);return me._setWindowSize(ue),me.multiply(3n),me}}}(nobleSecp256k1,nobleSecp256k1.exports)),nobleSecp256k1.exports}var secp256k1$2,hasRequiredSecp256k1$3;function requireSecp256k1$3(){if(hasRequiredSecp256k1$3)return secp256k1$2;hasRequiredSecp256k1$3=1;const et=errCode$i,tt=requireNobleSecp256k1(),{sha256:rt}=require$$1$4;return secp256k1$2=()=>{function nt(){return tt.utils.randomPrivateKey()}async function it(ht,ft){const{digest:dt}=await rt.digest(ft);try{return await tt.sign(dt,ht)}catch(pt){throw et(pt,"ERR_INVALID_INPUT")}}async function ot(ht,ft,dt){try{const{digest:pt}=await rt.digest(dt);return tt.verify(ft,pt,ht)}catch(pt){throw et(pt,"ERR_INVALID_INPUT")}}function st(ht){return tt.Point.fromHex(ht).toRawBytes(!0)}function at(ht){return tt.Point.fromHex(ht).toRawBytes(!1)}function ct(ht){try{tt.getPublicKey(ht,!0)}catch(ft){throw et(ft,"ERR_INVALID_PRIVATE_KEY")}}function ut(ht){try{tt.Point.fromHex(ht)}catch(ft){throw et(ft,"ERR_INVALID_PUBLIC_KEY")}}function lt(ht){try{return tt.getPublicKey(ht,!0)}catch(ft){throw et(ft,"ERR_INVALID_PRIVATE_KEY")}}return{generateKey:nt,privateKeyLength:32,hashAndSign:it,hashAndVerify:ot,compressPublicKey:st,decompressPublicKey:at,validatePrivateKey:ct,validatePublicKey:ut,computePublicKey:lt}},secp256k1$2}const{sha256:sha256$a}=require$$1$4,errcode$j=errCode$i,{equals:uint8ArrayEquals$8}=require$$1$3,{toString:uint8ArrayToString$q}=require$$1$2,exporter$8=exporter$b;var secp256k1Class$2=(et,tt,rt)=>{rt=rt||requireSecp256k1$3()();class nt{constructor(ut){rt.validatePublicKey(ut),this._key=ut}verify(ut,lt){return rt.hashAndVerify(this._key,lt,ut)}marshal(){return rt.compressPublicKey(this._key)}get bytes(){return et.PublicKey.encode({Type:et.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(ut){return uint8ArrayEquals$8(this.bytes,ut.bytes)}async hash(){const{bytes:ut}=await sha256$a.digest(this.bytes);return ut}}class it{constructor(ut,lt){this._key=ut,this._publicKey=lt||rt.computePublicKey(ut),rt.validatePrivateKey(this._key),rt.validatePublicKey(this._publicKey)}sign(ut){return rt.hashAndSign(this._key,ut)}get public(){return new nt(this._publicKey)}marshal(){return this._key}get bytes(){return et.PrivateKey.encode({Type:et.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(ut){return uint8ArrayEquals$8(this.bytes,ut.bytes)}async hash(){const{bytes:ut}=await sha256$a.digest(this.bytes);return ut}async id(){const ut=await this.public.hash();return uint8ArrayToString$q(ut,"base58btc")}async export(ut,lt="libp2p-key"){if(lt==="libp2p-key")return exporter$8.export(this.bytes,ut);throw errcode$j(new Error(`export format '${lt}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function ot(ct){return new it(ct)}function st(ct){return new nt(ct)}async function at(){const ct=await rt.generateKey();return new it(ct)}return{Secp256k1PublicKey:nt,Secp256k1PrivateKey:it,unmarshalSecp256k1PrivateKey:ot,unmarshalSecp256k1PublicKey:st,generateKeyPair:at}},indexBrowser$2={},lengths$3,hasRequiredLengths$1;function requireLengths$1(){return hasRequiredLengths$1||(hasRequiredLengths$1=1,lengths$3={SHA1:20,SHA256:32,SHA512:64}),lengths$3}var hasRequiredIndexBrowser$1;function requireIndexBrowser$1(){if(hasRequiredIndexBrowser$1)return indexBrowser$2;hasRequiredIndexBrowser$1=1;const et=webcrypto$9,tt=requireLengths$1(),rt={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},nt=async(it,ot)=>{const st=await et.get().subtle.sign({name:"HMAC"},it,ot);return new Uint8Array(st,st.byteOffset,st.byteLength)};return indexBrowser$2.create=async function(it,ot){const st=rt[it],at=await et.get().subtle.importKey("raw",ot,{name:"HMAC",hash:{name:st}},!1,["sign"]);return{async digest(ct){return nt(at,ct)},length:tt[it]}},indexBrowser$2}var keyStretcher$2,hasRequiredKeyStretcher$2;function requireKeyStretcher$2(){if(hasRequiredKeyStretcher$2)return keyStretcher$2;hasRequiredKeyStretcher$2=1;const et=errCode$i,{concat:tt}=require$$7$1,{fromString:rt}=require$$9$2,nt=requireIndexBrowser$1(),it={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};return keyStretcher$2=async(ot,st,at)=>{const ct=it[ot];if(!ct){const Ut=Object.keys(it).join(" / ");throw et(new Error(`unknown cipher type '${ot}'. Must be ${Ut}`),"ERR_INVALID_CIPHER_TYPE")}if(!st)throw et(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");const ut=ct.keySize,lt=ct.ivSize,ht=20,ft=rt("key expansion"),dt=2*(lt+ut+ht),pt=await nt.create(st,at);let gt=await pt.digest(ft);const _t=[];let mt=0;for(;mt<dt;){const Ut=await pt.digest(tt([gt,ft]));let Wt=Ut.length;mt+Wt>dt&&(Wt=dt-mt),_t.push(Ut),mt+=Wt,gt=await pt.digest(gt)}const At=dt/2,It=tt(_t),Mt=It.slice(0,At),kt=It.slice(At,dt),Ct=Ut=>({iv:Ut.slice(0,lt),cipherKey:Ut.slice(lt,lt+ut),macKey:Ut.slice(lt+ut)});return{k1:Ct(Mt),k2:Ct(kt)}},keyStretcher$2}var ecdhBrowser$2={},validateCurveType$2,hasRequiredValidateCurveType$2;function requireValidateCurveType$2(){if(hasRequiredValidateCurveType$2)return validateCurveType$2;hasRequiredValidateCurveType$2=1;const et=errCode$i;return validateCurveType$2=function(tt,rt){if(!tt.includes(rt)){const nt=tt.join(" / ");throw et(new Error(`Unknown curve: ${rt}. Must be ${nt}`),"ERR_INVALID_CURVE")}},validateCurveType$2}var hasRequiredEcdhBrowser$2;function requireEcdhBrowser$2(){if(hasRequiredEcdhBrowser$2)return ecdhBrowser$2;hasRequiredEcdhBrowser$2=1;const et=errCode$i,tt=webcrypto$9,{base64urlToBuffer:rt}=util$4,nt=requireValidateCurveType$2(),{toString:it}=require$$1$2,{concat:ot}=require$$7$1,{equals:st}=require$$1$3,at={"P-256":256,"P-384":384,"P-521":521};ecdhBrowser$2.generateEphmeralKeyPair=async function(ft){nt(Object.keys(at),ft);const dt=await tt.get().subtle.generateKey({name:"ECDH",namedCurve:ft},!0,["deriveBits"]),pt=async(_t,mt)=>{let At;mt?At=await tt.get().subtle.importKey("jwk",ht(ft,mt),{name:"ECDH",namedCurve:ft},!1,["deriveBits"]):At=dt.privateKey;const It=[await tt.get().subtle.importKey("jwk",lt(ft,_t),{name:"ECDH",namedCurve:ft},!1,[]),At],Mt=await tt.get().subtle.deriveBits({name:"ECDH",namedCurve:ft,public:It[0]},It[1],at[ft]);return new Uint8Array(Mt,Mt.byteOffset,Mt.byteLength)},gt=await tt.get().subtle.exportKey("jwk",dt.publicKey);return{key:ut(gt),genSharedKey:pt}};const ct={"P-256":32,"P-384":48,"P-521":66};function ut(ft){const dt=ct[ft.crv];return ot([Uint8Array.from([4]),rt(ft.x,dt),rt(ft.y,dt)],1+dt*2)}function lt(ft,dt){const pt=ct[ft];if(st(!dt.slice(0,1),Uint8Array.from([4])))throw et(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:ft,x:it(dt.slice(1,pt+1),"base64url"),y:it(dt.slice(1+pt),"base64url"),ext:!0}}const ht=(ft,dt)=>({...lt(ft,dt.public),d:it(dt.private,"base64url")});return ecdhBrowser$2}var ephemeralKeys$2,hasRequiredEphemeralKeys$2;function requireEphemeralKeys$2(){if(hasRequiredEphemeralKeys$2)return ephemeralKeys$2;hasRequiredEphemeralKeys$2=1;const et=requireEcdhBrowser$2();return ephemeralKeys$2=async tt=>et.generateEphmeralKeyPair(tt),ephemeralKeys$2}const keysPBM$2=keys$6,forge$x=forge$W,errcode$i=errCode$i,{fromString:uint8ArrayFromString$l}=require$$9$2,importer$4=importer$5,supportedKeys$2={rsa:rsaClass$2,ed25519:ed25519Class$2,secp256k1:secp256k1Class$2(keysPBM$2)},ErrMissingSecp256K1$2={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function typeToKey$2(et){const tt=supportedKeys$2[et.toLowerCase()];if(!tt){const rt=Object.keys(supportedKeys$2).join(" / ");throw errcode$i(new Error(`invalid or unsupported key type ${et}. Must be ${rt}`),"ERR_UNSUPPORTED_KEY_TYPE")}return tt}const generateKeyPair$7=async(et,tt)=>typeToKey$2(et).generateKeyPair(tt),generateKeyPairFromSeed$4=async(et,tt,rt)=>{const nt=typeToKey$2(et);if(et.toLowerCase()!=="ed25519")throw errcode$i(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return nt.generateKeyPairFromSeed(tt,rt)},unmarshalPublicKey$2=et=>{const tt=keysPBM$2.PublicKey.decode(et),rt=tt.Data;switch(tt.Type){case keysPBM$2.KeyType.RSA:return supportedKeys$2.rsa.unmarshalRsaPublicKey(rt);case keysPBM$2.KeyType.Ed25519:return supportedKeys$2.ed25519.unmarshalEd25519PublicKey(rt);case keysPBM$2.KeyType.Secp256k1:if(supportedKeys$2.secp256k1)return supportedKeys$2.secp256k1.unmarshalSecp256k1PublicKey(rt);throw errcode$i(new Error(ErrMissingSecp256K1$2.message),ErrMissingSecp256K1$2.code);default:typeToKey$2(tt.Type)}},marshalPublicKey$2=(et,tt)=>(tt=(tt||"rsa").toLowerCase(),typeToKey$2(tt),et.bytes),unmarshalPrivateKey$2=async et=>{const tt=keysPBM$2.PrivateKey.decode(et),rt=tt.Data;switch(tt.Type){case keysPBM$2.KeyType.RSA:return supportedKeys$2.rsa.unmarshalRsaPrivateKey(rt);case keysPBM$2.KeyType.Ed25519:return supportedKeys$2.ed25519.unmarshalEd25519PrivateKey(rt);case keysPBM$2.KeyType.Secp256k1:if(supportedKeys$2.secp256k1)return supportedKeys$2.secp256k1.unmarshalSecp256k1PrivateKey(rt);throw errcode$i(new Error(ErrMissingSecp256K1$2.message),ErrMissingSecp256K1$2.code);default:typeToKey$2(tt.Type)}},marshalPrivateKey$2=(et,tt)=>(tt=(tt||"rsa").toLowerCase(),typeToKey$2(tt),et.bytes),importKey$2=async(et,tt)=>{try{const it=await importer$4.import(et,tt);return unmarshalPrivateKey$2(it)}catch{}const rt=forge$x.pki.decryptRsaPrivateKey(et,tt);if(rt===null)throw errcode$i(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let nt=forge$x.asn1.toDer(forge$x.pki.privateKeyToAsn1(rt));return nt=uint8ArrayFromString$l(nt.getBytes(),"ascii"),supportedKeys$2.rsa.unmarshalRsaPrivateKey(nt)};var keys$5={supportedKeys:supportedKeys$2,keysPBM:keysPBM$2,keyStretcher:requireKeyStretcher$2(),generateEphemeralKeyPair:requireEphemeralKeys$2(),generateKeyPair:generateKeyPair$7,generateKeyPairFromSeed:generateKeyPairFromSeed$4,unmarshalPublicKey:unmarshalPublicKey$2,marshalPublicKey:marshalPublicKey$2,unmarshalPrivateKey:unmarshalPrivateKey$2,marshalPrivateKey:marshalPrivateKey$2,import:importKey$2},classIs={exports:{}};function withIs(et,{className:tt,symbolName:rt}){const nt=Symbol.for(rt),it={[tt]:class extends et{constructor(...ot){super(...ot),Object.defineProperty(this,nt,{value:!0})}get[Symbol.toStringTag](){return tt}}}[tt];return it[`is${tt}`]=ot=>!!(ot&&ot[nt]),it}function withIsProto(et,{className:tt,symbolName:rt,withoutNew:nt}){const it=Symbol.for(rt),ot={[tt]:function(...st){if(nt&&!(this instanceof ot))return new ot(...st);const at=et.call(this,...st)||this;return at&&!at[it]&&Object.defineProperty(at,it,{value:!0}),at}}[tt];return ot.prototype=Object.create(et.prototype),ot.prototype.constructor=ot,Object.defineProperty(ot.prototype,Symbol.toStringTag,{get(){return tt}}),ot[`is${tt}`]=st=>!!(st&&st[it]),ot}classIs.exports=withIs,classIs.exports.proto=withIsProto;var classIsExports=classIs.exports,$protobuf$9=minimal,$Reader$9=$protobuf$9.Reader,$Writer$9=$protobuf$9.Writer,$util$8=$protobuf$9.util,$root$9=$protobuf$9.roots["libp2p-peer-id"]||($protobuf$9.roots["libp2p-peer-id"]={});$root$9.PeerIdProto=function(){function et(tt){if(tt)for(var rt=Object.keys(tt),nt=0;nt<rt.length;++nt)tt[rt[nt]]!=null&&(this[rt[nt]]=tt[rt[nt]])}return et.prototype.id=$util$8.newBuffer([]),et.prototype.pubKey=$util$8.newBuffer([]),et.prototype.privKey=$util$8.newBuffer([]),et.encode=function(tt,rt){return rt||(rt=$Writer$9.create()),rt.uint32(10).bytes(tt.id),tt.pubKey!=null&&Object.hasOwnProperty.call(tt,"pubKey")&&rt.uint32(18).bytes(tt.pubKey),tt.privKey!=null&&Object.hasOwnProperty.call(tt,"privKey")&&rt.uint32(26).bytes(tt.privKey),rt},et.decode=function(tt,rt){tt instanceof $Reader$9||(tt=$Reader$9.create(tt));for(var nt=rt===void 0?tt.len:tt.pos+rt,it=new $root$9.PeerIdProto;tt.pos<nt;){var ot=tt.uint32();switch(ot>>>3){case 1:it.id=tt.bytes();break;case 2:it.pubKey=tt.bytes();break;case 3:it.privKey=tt.bytes();break;default:tt.skipType(ot&7);break}}if(!it.hasOwnProperty("id"))throw $util$8.ProtocolError("missing required 'id'",{instance:it});return it},et.fromObject=function(tt){if(tt instanceof $root$9.PeerIdProto)return tt;var rt=new $root$9.PeerIdProto;return tt.id!=null&&(typeof tt.id=="string"?$util$8.base64.decode(tt.id,rt.id=$util$8.newBuffer($util$8.base64.length(tt.id)),0):tt.id.length&&(rt.id=tt.id)),tt.pubKey!=null&&(typeof tt.pubKey=="string"?$util$8.base64.decode(tt.pubKey,rt.pubKey=$util$8.newBuffer($util$8.base64.length(tt.pubKey)),0):tt.pubKey.length&&(rt.pubKey=tt.pubKey)),tt.privKey!=null&&(typeof tt.privKey=="string"?$util$8.base64.decode(tt.privKey,rt.privKey=$util$8.newBuffer($util$8.base64.length(tt.privKey)),0):tt.privKey.length&&(rt.privKey=tt.privKey)),rt},et.toObject=function(tt,rt){rt||(rt={});var nt={};return rt.defaults&&(rt.bytes===String?nt.id="":(nt.id=[],rt.bytes!==Array&&(nt.id=$util$8.newBuffer(nt.id))),rt.bytes===String?nt.pubKey="":(nt.pubKey=[],rt.bytes!==Array&&(nt.pubKey=$util$8.newBuffer(nt.pubKey))),rt.bytes===String?nt.privKey="":(nt.privKey=[],rt.bytes!==Array&&(nt.privKey=$util$8.newBuffer(nt.privKey)))),tt.id!=null&&tt.hasOwnProperty("id")&&(nt.id=rt.bytes===String?$util$8.base64.encode(tt.id,0,tt.id.length):rt.bytes===Array?Array.prototype.slice.call(tt.id):tt.id),tt.pubKey!=null&&tt.hasOwnProperty("pubKey")&&(nt.pubKey=rt.bytes===String?$util$8.base64.encode(tt.pubKey,0,tt.pubKey.length):rt.bytes===Array?Array.prototype.slice.call(tt.pubKey):tt.pubKey),tt.privKey!=null&&tt.hasOwnProperty("privKey")&&(nt.privKey=rt.bytes===String?$util$8.base64.encode(tt.privKey,0,tt.privKey.length):rt.bytes===Array?Array.prototype.slice.call(tt.privKey):tt.privKey),nt},et.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf$9.util.toJSONOptions)},et}();var proto$1=$root$9;(function(et,tt){const{CID:rt}=require$$6$2,nt=require$$4$1,it=require$$2,ot=require$$1$5,st=require$$4,{base58btc:at}=require$$1$5,{base32:ct}=require$$4$1,{base16:ut}=require$$5$1,lt=require$$6$1,ht=keys$5,ft=classIsExports,{PeerIdProto:dt}=proto$1,{equals:pt}=require$$1$3,{fromString:gt}=require$$9$2,{toString:_t}=require$$1$2,{identity:mt}=require$$7,At={...nt,...it,...ot,...st},It=Object.keys(At).reduce((yt,$t)=>yt.or(At[$t]),ct.decoder),Mt=112,kt=114;class Ct{constructor($t,Et,Tt){if(!($t instanceof Uint8Array))throw new Error("invalid id provided");if(Et&&Tt&&!pt(Et.public.bytes,Tt.bytes))throw new Error("inconsistent arguments");this._id=$t,this._idB58String=at.encode(this.id).substring(1),this._privKey=Et,this._pubKey=Tt}get id(){return this._id}set id($t){throw new Error("Id is immutable")}get privKey(){return this._privKey}set privKey($t){this._privKey=$t}get pubKey(){if(this._pubKey)return this._pubKey;if(this._privKey)return this._privKey.public;try{const $t=lt.decode(this.id);$t.code===mt.code&&(this._pubKey=ht.unmarshalPublicKey($t.digest))}catch{}return this._pubKey}set pubKey($t){this._pubKey=$t}marshalPubKey(){if(this.pubKey)return ht.marshalPublicKey(this.pubKey)}marshalPrivKey(){if(this.privKey)return ht.marshalPrivateKey(this.privKey)}marshal($t){return dt.encode({id:this.toBytes(),pubKey:this.marshalPubKey(),privKey:$t?null:this.marshalPrivKey()}).finish()}toPrint(){let $t=this.toB58String();$t.startsWith("Qm")&&($t=$t.slice(2));let Et=6;return $t.length<Et&&(Et=$t.length),"<peer.ID "+$t.substr(0,Et)+">"}toJSON(){return{id:this.toB58String(),privKey:bt(this.marshalPrivKey()),pubKey:bt(this.marshalPubKey())}}toHexString(){return ut.encode(this.id).substring(1)}toBytes(){return this.id}toB58String(){return this._idB58String}toString(){if(!this._idCIDString){const $t=rt.createV1(kt,lt.decode(this.id));Object.defineProperty(this,"_idCIDString",{value:$t.toString(),enumerable:!1})}return this._idCIDString}equals($t){if($t instanceof Uint8Array)return pt(this.id,$t);if($t.id)return pt(this.id,$t.id);throw new Error("not valid Id")}isEqual($t){return this.equals($t)}isValid(){return!!(this.privKey&&this.privKey.public&&this.privKey.public.bytes&&this.pubKey.bytes instanceof Uint8Array&&pt(this.privKey.public.bytes,this.pubKey.bytes))}hasInlinePublicKey(){try{if(lt.decode(this.id).code===mt.code)return!0}catch{}return!1}}const Ut=ft(Ct,{className:"PeerId",symbolName:"@libp2p/js-peer-id/PeerId"});tt=et.exports=Ut;const Wt=yt=>yt.bytes.length<=42?lt.create(mt.code,yt.bytes).bytes:yt.hash(),Ft=async(yt,$t)=>{const Et=await Wt($t);return new Ut(Et,yt,$t)};tt.create=async yt=>{yt=yt||{},yt.bits=yt.bits||2048,yt.keyType=yt.keyType||"RSA";const $t=await ht.generateKeyPair(yt.keyType,yt.bits);return Ft($t,$t.public)},tt.createFromHexString=yt=>new Ut(ut.decode("f"+yt)),tt.createFromBytes=yt=>{try{const $t=rt.decode(yt);if(!Ce($t))throw new Error("Supplied PeerID CID is invalid");return tt.createFromCID($t)}catch{if(lt.decode(yt).code!==mt.code)throw new Error("Supplied PeerID CID is invalid");return new Ut(yt)}},tt.createFromB58String=yt=>tt.createFromBytes(at.decode("z"+yt));const Ce=yt=>yt.code===kt||yt.code===Mt;tt.createFromCID=yt=>{if(yt=rt.asCID(yt),!yt||!Ce(yt))throw new Error("Supplied PeerID CID is invalid");return new Ut(yt.multihash.bytes)},tt.createFromPubKey=async yt=>{let $t=yt;if(typeof $t=="string"&&($t=gt(yt,"base64pad")),!($t instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");const Et=await ht.unmarshalPublicKey($t);return Ft(void 0,Et)},tt.createFromPrivKey=async yt=>{if(typeof yt=="string"&&(yt=gt(yt,"base64pad")),!(yt instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");const $t=await ht.unmarshalPrivateKey(yt);return Ft($t,$t.public)},tt.createFromJSON=async yt=>{const $t=at.decode("z"+yt.id),Et=yt.privKey&&gt(yt.privKey,"base64pad"),Tt=yt.pubKey&&gt(yt.pubKey,"base64pad"),Pt=Tt&&await ht.unmarshalPublicKey(Tt);if(!Et)return new Ut($t,void 0,Pt);const St=await ht.unmarshalPrivateKey(Et),Dt=await Wt(St.public);let wt;if(Pt&&(wt=await Wt(Pt)),Pt&&!pt(Dt,wt))throw new Error("Public and private key do not match");if($t&&!pt(Dt,$t))throw new Error("Id and private key do not match");return new Ut($t,St,Pt)},tt.createFromProtobuf=async yt=>{typeof yt=="string"&&(yt=gt(yt,"base16"));let{id:$t,privKey:Et,pubKey:Tt}=dt.decode(yt);Et=Et?await ht.unmarshalPrivateKey(Et):!1,Tt=Tt?await ht.unmarshalPublicKey(Tt):!1;let Pt,St;if(Et&&(St=await Wt(Et.public)),Tt&&(Pt=await Wt(Tt)),Et){if(Tt&&!pt(St,Pt))throw new Error("Public and private key do not match");return new Ut(St,Et,Et.public)}if(Tt)return new Ut(Pt,void 0,Tt);if($t)return new Ut($t);throw new Error("Protobuf did not contain any usable key material")},tt.parse=yt=>((yt.charAt(0)==="1"||yt.charAt(0)==="Q")&&(yt=`z${yt}`),tt.createFromBytes(It.decode(yt))),tt.isPeerId=yt=>!!(typeof yt=="object"&&yt._id&&yt._idB58String);function bt(yt){if(yt)return _t(yt,"base64pad")}})(src$j,src$j.exports);var srcExports$1=src$j.exports,src$g={},indexBrowser$1={},webcrypto$6={};webcrypto$6.get=(et=self)=>{const tt=et.crypto||et.msCrypto;if(!tt||!tt.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return tt};var lengths$2={SHA1:20,SHA256:32,SHA512:64};const webcrypto$5=webcrypto$6,lengths$1=lengths$2,hashTypes={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},sign$2=async(et,tt)=>{const rt=await webcrypto$5.get().subtle.sign({name:"HMAC"},et,tt);return new Uint8Array(rt,rt.byteOffset,rt.byteLength)};indexBrowser$1.create=async function(et,tt){const rt=hashTypes[et],nt=await webcrypto$5.get().subtle.importKey("raw",tt,{name:"HMAC",hash:{name:rt}},!1,["sign"]);return{async digest(it){return sign$2(nt,it)},length:lengths$1[et]}};var aes$1={};const forge$w=forge$W,{toString:uint8ArrayToString$p}=require$$1$2,{fromString:uint8ArrayFromString$k}=require$$9$2;var ciphersBrowser={createCipheriv:(et,tt,rt)=>{const nt=forge$w.cipher.createCipher("AES-CTR",uint8ArrayToString$p(tt,"ascii"));return nt.start({iv:uint8ArrayToString$p(rt,"ascii")}),{update:it=>(nt.update(forge$w.util.createBuffer(uint8ArrayToString$p(it,"ascii"))),uint8ArrayFromString$k(nt.output.getBytes(),"ascii"))}},createDecipheriv:(et,tt,rt)=>{const nt=forge$w.cipher.createDecipher("AES-CTR",uint8ArrayToString$p(tt,"ascii"));return nt.start({iv:uint8ArrayToString$p(rt,"ascii")}),{update:it=>(nt.update(forge$w.util.createBuffer(uint8ArrayToString$p(it,"ascii"))),uint8ArrayFromString$k(nt.output.getBytes(),"ascii"))}}};const errcode$h=errCode$i,CIPHER_MODES={16:"aes-128-ctr",32:"aes-256-ctr"};var cipherMode$1=function(et){const tt=CIPHER_MODES[et.length];if(!tt){const rt=Object.entries(CIPHER_MODES).map(([nt,it])=>`${nt} (${it})`).join(" / ");throw errcode$h(new Error(`Invalid key length ${et.length} bytes. Must be ${rt}`),"ERR_INVALID_KEY_LENGTH")}return tt};const ciphers$4=ciphersBrowser,cipherMode=cipherMode$1;aes$1.create=async function(et,tt){const rt=cipherMode(et),nt=ciphers$4.createCipheriv(rt,et,tt),it=ciphers$4.createDecipheriv(rt,et,tt);return{async encrypt(ot){return nt.update(ot)},async decrypt(ot){return it.update(ot)}}};var $protobuf$8=minimal,$Reader$8=$protobuf$8.Reader,$Writer$8=$protobuf$8.Writer,$util$7=$protobuf$8.util,$root$8=$protobuf$8.roots["libp2p-crypto-keys"]||($protobuf$8.roots["libp2p-crypto-keys"]={});$root$8.KeyType=function(){var et={},tt=Object.create(et);return tt[et[0]="RSA"]=0,tt[et[1]="Ed25519"]=1,tt[et[2]="Secp256k1"]=2,tt}(),$root$8.PublicKey=function(){function et(tt){if(tt)for(var rt=Object.keys(tt),nt=0;nt<rt.length;++nt)tt[rt[nt]]!=null&&(this[rt[nt]]=tt[rt[nt]])}return et.prototype.Type=0,et.prototype.Data=$util$7.newBuffer([]),et.encode=function(tt,rt){return rt||(rt=$Writer$8.create()),rt.uint32(8).int32(tt.Type),rt.uint32(18).bytes(tt.Data),rt},et.decode=function(tt,rt){tt instanceof $Reader$8||(tt=$Reader$8.create(tt));for(var nt=rt===void 0?tt.len:tt.pos+rt,it=new $root$8.PublicKey;tt.pos<nt;){var ot=tt.uint32();switch(ot>>>3){case 1:it.Type=tt.int32();break;case 2:it.Data=tt.bytes();break;default:tt.skipType(ot&7);break}}if(!it.hasOwnProperty("Type"))throw $util$7.ProtocolError("missing required 'Type'",{instance:it});if(!it.hasOwnProperty("Data"))throw $util$7.ProtocolError("missing required 'Data'",{instance:it});return it},et.fromObject=function(tt){if(tt instanceof $root$8.PublicKey)return tt;var rt=new $root$8.PublicKey;switch(tt.Type){case"RSA":case 0:rt.Type=0;break;case"Ed25519":case 1:rt.Type=1;break;case"Secp256k1":case 2:rt.Type=2;break}return tt.Data!=null&&(typeof tt.Data=="string"?$util$7.base64.decode(tt.Data,rt.Data=$util$7.newBuffer($util$7.base64.length(tt.Data)),0):tt.Data.length&&(rt.Data=tt.Data)),rt},et.toObject=function(tt,rt){rt||(rt={});var nt={};return rt.defaults&&(nt.Type=rt.enums===String?"RSA":0,rt.bytes===String?nt.Data="":(nt.Data=[],rt.bytes!==Array&&(nt.Data=$util$7.newBuffer(nt.Data)))),tt.Type!=null&&tt.hasOwnProperty("Type")&&(nt.Type=rt.enums===String?$root$8.KeyType[tt.Type]:tt.Type),tt.Data!=null&&tt.hasOwnProperty("Data")&&(nt.Data=rt.bytes===String?$util$7.base64.encode(tt.Data,0,tt.Data.length):rt.bytes===Array?Array.prototype.slice.call(tt.Data):tt.Data),nt},et.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf$8.util.toJSONOptions)},et}(),$root$8.PrivateKey=function(){function et(tt){if(tt)for(var rt=Object.keys(tt),nt=0;nt<rt.length;++nt)tt[rt[nt]]!=null&&(this[rt[nt]]=tt[rt[nt]])}return et.prototype.Type=0,et.prototype.Data=$util$7.newBuffer([]),et.encode=function(tt,rt){return rt||(rt=$Writer$8.create()),rt.uint32(8).int32(tt.Type),rt.uint32(18).bytes(tt.Data),rt},et.decode=function(tt,rt){tt instanceof $Reader$8||(tt=$Reader$8.create(tt));for(var nt=rt===void 0?tt.len:tt.pos+rt,it=new $root$8.PrivateKey;tt.pos<nt;){var ot=tt.uint32();switch(ot>>>3){case 1:it.Type=tt.int32();break;case 2:it.Data=tt.bytes();break;default:tt.skipType(ot&7);break}}if(!it.hasOwnProperty("Type"))throw $util$7.ProtocolError("missing required 'Type'",{instance:it});if(!it.hasOwnProperty("Data"))throw $util$7.ProtocolError("missing required 'Data'",{instance:it});return it},et.fromObject=function(tt){if(tt instanceof $root$8.PrivateKey)return tt;var rt=new $root$8.PrivateKey;switch(tt.Type){case"RSA":case 0:rt.Type=0;break;case"Ed25519":case 1:rt.Type=1;break;case"Secp256k1":case 2:rt.Type=2;break}return tt.Data!=null&&(typeof tt.Data=="string"?$util$7.base64.decode(tt.Data,rt.Data=$util$7.newBuffer($util$7.base64.length(tt.Data)),0):tt.Data.length&&(rt.Data=tt.Data)),rt},et.toObject=function(tt,rt){rt||(rt={});var nt={};return rt.defaults&&(nt.Type=rt.enums===String?"RSA":0,rt.bytes===String?nt.Data="":(nt.Data=[],rt.bytes!==Array&&(nt.Data=$util$7.newBuffer(nt.Data)))),tt.Type!=null&&tt.hasOwnProperty("Type")&&(nt.Type=rt.enums===String?$root$8.KeyType[tt.Type]:tt.Type),tt.Data!=null&&tt.hasOwnProperty("Data")&&(nt.Data=rt.bytes===String?$util$7.base64.encode(tt.Data,0,tt.Data.length):rt.bytes===Array?Array.prototype.slice.call(tt.Data):tt.Data),nt},et.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf$8.util.toJSONOptions)},et}();var keys$4=$root$8;const{concat:concat$3}=require$$7$1,{fromString:fromString$7}=require$$9$2,webcrypto$4=webcrypto$6;function create$5({algorithm:et="AES-GCM",nonceLength:tt=12,keyLength:rt=16,digest:nt="SHA-256",saltLength:it=16,iterations:ot=32767}={}){const st=webcrypto$4.get();rt*=8;async function at(ut,lt){const ht=st.getRandomValues(new Uint8Array(it)),ft=st.getRandomValues(new Uint8Array(tt)),dt={name:et,iv:ft},pt={name:"PBKDF2",salt:ht,iterations:ot,hash:{name:nt}},gt=await st.subtle.importKey("raw",fromString$7(lt),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),_t=await st.subtle.deriveKey(pt,gt,{name:et,length:rt},!0,["encrypt"]),mt=await st.subtle.encrypt(dt,_t,ut);return concat$3([ht,dt.iv,new Uint8Array(mt)])}async function ct(ut,lt){const ht=ut.slice(0,it),ft=ut.slice(it,it+tt),dt=ut.slice(it+tt),pt={name:et,iv:ft},gt={name:"PBKDF2",salt:ht,iterations:ot,hash:{name:nt}},_t=await st.subtle.importKey("raw",fromString$7(lt),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),mt=await st.subtle.deriveKey(gt,_t,{name:et,length:rt},!0,["decrypt"]),At=await st.subtle.decrypt(pt,mt,dt);return new Uint8Array(At)}return{encrypt:at,decrypt:ct}}var aesGcm_browser$1={create:create$5};const{base64:base64$3}=require$$4,ciphers$3=aesGcm_browser$1;var importer$3={import:async function(et,tt){const rt=base64$3.decode(et);return await ciphers$3.create().decrypt(rt,tt)}},asn1Validator$1={},forge$v=forge$W,asn1$3=forge$v.asn1;asn1Validator$1.privateKeyValidator={name:"PrivateKeyInfo",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},asn1Validator$1.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:asn1$3.Class.UNIVERSAL,type:asn1$3.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]};var forge$u=forge$W,asn1Validator=asn1Validator$1,publicKeyValidator$1=asn1Validator.publicKeyValidator,privateKeyValidator$1=asn1Validator.privateKeyValidator;if(typeof BigInteger$3>"u")var BigInteger$3=forge$u.jsbn.BigInteger;var ByteBuffer=forge$u.util.ByteBuffer,NativeBuffer=typeof Buffer>"u"?Uint8Array:Buffer;forge$u.pki=forge$u.pki||{},forge$u.pki.ed25519=forge$u.ed25519=forge$u.ed25519||{};var ed25519$2=forge$u.ed25519;ed25519$2.constants={},ed25519$2.constants.PUBLIC_KEY_BYTE_LENGTH=32,ed25519$2.constants.PRIVATE_KEY_BYTE_LENGTH=64,ed25519$2.constants.SEED_BYTE_LENGTH=32,ed25519$2.constants.SIGN_BYTE_LENGTH=64,ed25519$2.constants.HASH_BYTE_LENGTH=64,ed25519$2.generateKeyPair=function(et){et=et||{};var tt=et.seed;if(tt===void 0)tt=forge$u.random.getBytesSync(ed25519$2.constants.SEED_BYTE_LENGTH);else if(typeof tt=="string"){if(tt.length!==ed25519$2.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+ed25519$2.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(tt instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');tt=messageToNativeBuffer({message:tt,encoding:"binary"});for(var rt=new NativeBuffer(ed25519$2.constants.PUBLIC_KEY_BYTE_LENGTH),nt=new NativeBuffer(ed25519$2.constants.PRIVATE_KEY_BYTE_LENGTH),it=0;it<32;++it)nt[it]=tt[it];return crypto_sign_keypair(rt,nt),{publicKey:rt,privateKey:nt}},ed25519$2.privateKeyFromAsn1=function(et){var tt={},rt=[],nt=forge$u.asn1.validate(et,privateKeyValidator$1,tt,rt);if(!nt){var it=new Error("Invalid Key.");throw it.errors=rt,it}var ot=forge$u.asn1.derToOid(tt.privateKeyOid),st=forge$u.oids.EdDSA25519;if(ot!==st)throw new Error('Invalid OID "'+ot+'"; OID must be "'+st+'".');var at=tt.privateKey,ct=messageToNativeBuffer({message:forge$u.asn1.fromDer(at).value,encoding:"binary"});return{privateKeyBytes:ct}},ed25519$2.publicKeyFromAsn1=function(et){var tt={},rt=[],nt=forge$u.asn1.validate(et,publicKeyValidator$1,tt,rt);if(!nt){var it=new Error("Invalid Key.");throw it.errors=rt,it}var ot=forge$u.asn1.derToOid(tt.publicKeyOid),st=forge$u.oids.EdDSA25519;if(ot!==st)throw new Error('Invalid OID "'+ot+'"; OID must be "'+st+'".');var at=tt.ed25519PublicKey;if(at.length!==ed25519$2.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return messageToNativeBuffer({message:at,encoding:"binary"})},ed25519$2.publicKeyFromPrivateKey=function(et){et=et||{};var tt=messageToNativeBuffer({message:et.privateKey,encoding:"binary"});if(tt.length!==ed25519$2.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+ed25519$2.constants.PRIVATE_KEY_BYTE_LENGTH);for(var rt=new NativeBuffer(ed25519$2.constants.PUBLIC_KEY_BYTE_LENGTH),nt=0;nt<rt.length;++nt)rt[nt]=tt[32+nt];return rt},ed25519$2.sign=function(et){et=et||{};var tt=messageToNativeBuffer(et),rt=messageToNativeBuffer({message:et.privateKey,encoding:"binary"});if(rt.length===ed25519$2.constants.SEED_BYTE_LENGTH){var nt=ed25519$2.generateKeyPair({seed:rt});rt=nt.privateKey}else if(rt.length!==ed25519$2.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+ed25519$2.constants.SEED_BYTE_LENGTH+" or "+ed25519$2.constants.PRIVATE_KEY_BYTE_LENGTH);var it=new NativeBuffer(ed25519$2.constants.SIGN_BYTE_LENGTH+tt.length);crypto_sign(it,tt,tt.length,rt);for(var ot=new NativeBuffer(ed25519$2.constants.SIGN_BYTE_LENGTH),st=0;st<ot.length;++st)ot[st]=it[st];return ot},ed25519$2.verify=function(et){et=et||{};var tt=messageToNativeBuffer(et);if(et.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var rt=messageToNativeBuffer({message:et.signature,encoding:"binary"});if(rt.length!==ed25519$2.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+ed25519$2.constants.SIGN_BYTE_LENGTH);var nt=messageToNativeBuffer({message:et.publicKey,encoding:"binary"});if(nt.length!==ed25519$2.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+ed25519$2.constants.PUBLIC_KEY_BYTE_LENGTH);var it=new NativeBuffer(ed25519$2.constants.SIGN_BYTE_LENGTH+tt.length),ot=new NativeBuffer(ed25519$2.constants.SIGN_BYTE_LENGTH+tt.length),st;for(st=0;st<ed25519$2.constants.SIGN_BYTE_LENGTH;++st)it[st]=rt[st];for(st=0;st<tt.length;++st)it[st+ed25519$2.constants.SIGN_BYTE_LENGTH]=tt[st];return crypto_sign_open(ot,it,it.length,nt)>=0};function messageToNativeBuffer(et){var tt=et.message;if(tt instanceof Uint8Array||tt instanceof NativeBuffer)return tt;var rt=et.encoding;if(tt===void 0)if(et.md)tt=et.md.digest().getBytes(),rt="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof tt=="string"&&!rt)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof tt=="string"){if(typeof Buffer<"u")return Buffer.from(tt,rt);tt=new ByteBuffer(tt,rt)}else if(!(tt instanceof ByteBuffer))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var nt=new NativeBuffer(tt.length()),it=0;it<nt.length;++it)nt[it]=tt.at(it);return nt}var gf0=gf(),gf1=gf([1]),D$2=gf([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),D2=gf([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),X$2=gf([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),Y$2=gf([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),L$3=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),I$2=gf([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function sha512$1(et,tt){var rt=forge$u.md.sha512.create(),nt=new ByteBuffer(et);rt.update(nt.getBytes(tt),"binary");var it=rt.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(it,"binary");for(var ot=new NativeBuffer(ed25519$2.constants.HASH_BYTE_LENGTH),st=0;st<64;++st)ot[st]=it.charCodeAt(st);return ot}function crypto_sign_keypair(et,tt){var rt=[gf(),gf(),gf(),gf()],nt,it=sha512$1(tt,32);for(it[0]&=248,it[31]&=127,it[31]|=64,scalarbase(rt,it),pack(et,rt),nt=0;nt<32;++nt)tt[nt+32]=et[nt];return 0}function crypto_sign(et,tt,rt,nt){var it,ot,st=new Float64Array(64),at=[gf(),gf(),gf(),gf()],ct=sha512$1(nt,32);ct[0]&=248,ct[31]&=127,ct[31]|=64;var ut=rt+64;for(it=0;it<rt;++it)et[64+it]=tt[it];for(it=0;it<32;++it)et[32+it]=ct[32+it];var lt=sha512$1(et.subarray(32),rt+32);for(reduce(lt),scalarbase(at,lt),pack(et,at),it=32;it<64;++it)et[it]=nt[it];var ht=sha512$1(et,rt+64);for(reduce(ht),it=32;it<64;++it)st[it]=0;for(it=0;it<32;++it)st[it]=lt[it];for(it=0;it<32;++it)for(ot=0;ot<32;ot++)st[it+ot]+=ht[it]*ct[ot];return modL(et.subarray(32),st),ut}function crypto_sign_open(et,tt,rt,nt){var it,ot,st=new NativeBuffer(32),at=[gf(),gf(),gf(),gf()],ct=[gf(),gf(),gf(),gf()];if(ot=-1,rt<64||unpackneg(ct,nt))return-1;for(it=0;it<rt;++it)et[it]=tt[it];for(it=0;it<32;++it)et[it+32]=nt[it];var ut=sha512$1(et,rt);if(reduce(ut),scalarmult(at,ct,ut),scalarbase(ct,tt.subarray(32)),add(at,ct),pack(st,at),rt-=64,crypto_verify_32(tt,0,st,0)){for(it=0;it<rt;++it)et[it]=0;return-1}for(it=0;it<rt;++it)et[it]=tt[it+64];return ot=rt,ot}function modL(et,tt){var rt,nt,it,ot;for(nt=63;nt>=32;--nt){for(rt=0,it=nt-32,ot=nt-12;it<ot;++it)tt[it]+=rt-16*tt[nt]*L$3[it-(nt-32)],rt=tt[it]+128>>8,tt[it]-=rt*256;tt[it]+=rt,tt[nt]=0}for(rt=0,it=0;it<32;++it)tt[it]+=rt-(tt[31]>>4)*L$3[it],rt=tt[it]>>8,tt[it]&=255;for(it=0;it<32;++it)tt[it]-=rt*L$3[it];for(nt=0;nt<32;++nt)tt[nt+1]+=tt[nt]>>8,et[nt]=tt[nt]&255}function reduce(et){for(var tt=new Float64Array(64),rt=0;rt<64;++rt)tt[rt]=et[rt],et[rt]=0;modL(et,tt)}function add(et,tt){var rt=gf(),nt=gf(),it=gf(),ot=gf(),st=gf(),at=gf(),ct=gf(),ut=gf(),lt=gf();Z$2(rt,et[1],et[0]),Z$2(lt,tt[1],tt[0]),M$2(rt,rt,lt),A$2(nt,et[0],et[1]),A$2(lt,tt[0],tt[1]),M$2(nt,nt,lt),M$2(it,et[3],tt[3]),M$2(it,it,D2),M$2(ot,et[2],tt[2]),A$2(ot,ot,ot),Z$2(st,nt,rt),Z$2(at,ot,it),A$2(ct,ot,it),A$2(ut,nt,rt),M$2(et[0],st,at),M$2(et[1],ut,ct),M$2(et[2],ct,at),M$2(et[3],st,ut)}function cswap(et,tt,rt){for(var nt=0;nt<4;++nt)sel25519(et[nt],tt[nt],rt)}function pack(et,tt){var rt=gf(),nt=gf(),it=gf();inv25519(it,tt[2]),M$2(rt,tt[0],it),M$2(nt,tt[1],it),pack25519(et,nt),et[31]^=par25519(rt)<<7}function pack25519(et,tt){var rt,nt,it,ot=gf(),st=gf();for(rt=0;rt<16;++rt)st[rt]=tt[rt];for(car25519(st),car25519(st),car25519(st),nt=0;nt<2;++nt){for(ot[0]=st[0]-65517,rt=1;rt<15;++rt)ot[rt]=st[rt]-65535-(ot[rt-1]>>16&1),ot[rt-1]&=65535;ot[15]=st[15]-32767-(ot[14]>>16&1),it=ot[15]>>16&1,ot[14]&=65535,sel25519(st,ot,1-it)}for(rt=0;rt<16;rt++)et[2*rt]=st[rt]&255,et[2*rt+1]=st[rt]>>8}function unpackneg(et,tt){var rt=gf(),nt=gf(),it=gf(),ot=gf(),st=gf(),at=gf(),ct=gf();return set25519(et[2],gf1),unpack25519(et[1],tt),S$1(it,et[1]),M$2(ot,it,D$2),Z$2(it,it,et[2]),A$2(ot,et[2],ot),S$1(st,ot),S$1(at,st),M$2(ct,at,st),M$2(rt,ct,it),M$2(rt,rt,ot),pow2523(rt,rt),M$2(rt,rt,it),M$2(rt,rt,ot),M$2(rt,rt,ot),M$2(et[0],rt,ot),S$1(nt,et[0]),M$2(nt,nt,ot),neq25519(nt,it)&&M$2(et[0],et[0],I$2),S$1(nt,et[0]),M$2(nt,nt,ot),neq25519(nt,it)?-1:(par25519(et[0])===tt[31]>>7&&Z$2(et[0],gf0,et[0]),M$2(et[3],et[0],et[1]),0)}function unpack25519(et,tt){var rt;for(rt=0;rt<16;++rt)et[rt]=tt[2*rt]+(tt[2*rt+1]<<8);et[15]&=32767}function pow2523(et,tt){var rt=gf(),nt;for(nt=0;nt<16;++nt)rt[nt]=tt[nt];for(nt=250;nt>=0;--nt)S$1(rt,rt),nt!==1&&M$2(rt,rt,tt);for(nt=0;nt<16;++nt)et[nt]=rt[nt]}function neq25519(et,tt){var rt=new NativeBuffer(32),nt=new NativeBuffer(32);return pack25519(rt,et),pack25519(nt,tt),crypto_verify_32(rt,0,nt,0)}function crypto_verify_32(et,tt,rt,nt){return vn$1(et,tt,rt,nt,32)}function vn$1(et,tt,rt,nt,it){var ot,st=0;for(ot=0;ot<it;++ot)st|=et[tt+ot]^rt[nt+ot];return(1&st-1>>>8)-1}function par25519(et){var tt=new NativeBuffer(32);return pack25519(tt,et),tt[0]&1}function scalarmult(et,tt,rt){var nt,it;for(set25519(et[0],gf0),set25519(et[1],gf1),set25519(et[2],gf1),set25519(et[3],gf0),it=255;it>=0;--it)nt=rt[it/8|0]>>(it&7)&1,cswap(et,tt,nt),add(tt,et),add(et,et),cswap(et,tt,nt)}function scalarbase(et,tt){var rt=[gf(),gf(),gf(),gf()];set25519(rt[0],X$2),set25519(rt[1],Y$2),set25519(rt[2],gf1),M$2(rt[3],X$2,Y$2),scalarmult(et,rt,tt)}function set25519(et,tt){var rt;for(rt=0;rt<16;rt++)et[rt]=tt[rt]|0}function inv25519(et,tt){var rt=gf(),nt;for(nt=0;nt<16;++nt)rt[nt]=tt[nt];for(nt=253;nt>=0;--nt)S$1(rt,rt),nt!==2&&nt!==4&&M$2(rt,rt,tt);for(nt=0;nt<16;++nt)et[nt]=rt[nt]}function car25519(et){var tt,rt,nt=1;for(tt=0;tt<16;++tt)rt=et[tt]+nt+65535,nt=Math.floor(rt/65536),et[tt]=rt-nt*65536;et[0]+=nt-1+37*(nt-1)}function sel25519(et,tt,rt){for(var nt,it=~(rt-1),ot=0;ot<16;++ot)nt=it&(et[ot]^tt[ot]),et[ot]^=nt,tt[ot]^=nt}function gf(et){var tt,rt=new Float64Array(16);if(et)for(tt=0;tt<et.length;++tt)rt[tt]=et[tt];return rt}function A$2(et,tt,rt){for(var nt=0;nt<16;++nt)et[nt]=tt[nt]+rt[nt]}function Z$2(et,tt,rt){for(var nt=0;nt<16;++nt)et[nt]=tt[nt]-rt[nt]}function S$1(et,tt){M$2(et,tt,tt)}function M$2(et,tt,rt){var nt,it,ot=0,st=0,at=0,ct=0,ut=0,lt=0,ht=0,ft=0,dt=0,pt=0,gt=0,_t=0,mt=0,At=0,It=0,Mt=0,kt=0,Ct=0,Ut=0,Wt=0,Ft=0,Ce=0,bt=0,yt=0,$t=0,Et=0,Tt=0,Pt=0,St=0,Dt=0,wt=0,xt=rt[0],Ke=rt[1],Pe=rt[2],Ht=rt[3],zt=rt[4],jt=rt[5],qt=rt[6],Ge=rt[7],Ie=rt[8],Xe=rt[9],Je=rt[10],Qe=rt[11],We=rt[12],ur=rt[13],ar=rt[14],cr=rt[15];nt=tt[0],ot+=nt*xt,st+=nt*Ke,at+=nt*Pe,ct+=nt*Ht,ut+=nt*zt,lt+=nt*jt,ht+=nt*qt,ft+=nt*Ge,dt+=nt*Ie,pt+=nt*Xe,gt+=nt*Je,_t+=nt*Qe,mt+=nt*We,At+=nt*ur,It+=nt*ar,Mt+=nt*cr,nt=tt[1],st+=nt*xt,at+=nt*Ke,ct+=nt*Pe,ut+=nt*Ht,lt+=nt*zt,ht+=nt*jt,ft+=nt*qt,dt+=nt*Ge,pt+=nt*Ie,gt+=nt*Xe,_t+=nt*Je,mt+=nt*Qe,At+=nt*We,It+=nt*ur,Mt+=nt*ar,kt+=nt*cr,nt=tt[2],at+=nt*xt,ct+=nt*Ke,ut+=nt*Pe,lt+=nt*Ht,ht+=nt*zt,ft+=nt*jt,dt+=nt*qt,pt+=nt*Ge,gt+=nt*Ie,_t+=nt*Xe,mt+=nt*Je,At+=nt*Qe,It+=nt*We,Mt+=nt*ur,kt+=nt*ar,Ct+=nt*cr,nt=tt[3],ct+=nt*xt,ut+=nt*Ke,lt+=nt*Pe,ht+=nt*Ht,ft+=nt*zt,dt+=nt*jt,pt+=nt*qt,gt+=nt*Ge,_t+=nt*Ie,mt+=nt*Xe,At+=nt*Je,It+=nt*Qe,Mt+=nt*We,kt+=nt*ur,Ct+=nt*ar,Ut+=nt*cr,nt=tt[4],ut+=nt*xt,lt+=nt*Ke,ht+=nt*Pe,ft+=nt*Ht,dt+=nt*zt,pt+=nt*jt,gt+=nt*qt,_t+=nt*Ge,mt+=nt*Ie,At+=nt*Xe,It+=nt*Je,Mt+=nt*Qe,kt+=nt*We,Ct+=nt*ur,Ut+=nt*ar,Wt+=nt*cr,nt=tt[5],lt+=nt*xt,ht+=nt*Ke,ft+=nt*Pe,dt+=nt*Ht,pt+=nt*zt,gt+=nt*jt,_t+=nt*qt,mt+=nt*Ge,At+=nt*Ie,It+=nt*Xe,Mt+=nt*Je,kt+=nt*Qe,Ct+=nt*We,Ut+=nt*ur,Wt+=nt*ar,Ft+=nt*cr,nt=tt[6],ht+=nt*xt,ft+=nt*Ke,dt+=nt*Pe,pt+=nt*Ht,gt+=nt*zt,_t+=nt*jt,mt+=nt*qt,At+=nt*Ge,It+=nt*Ie,Mt+=nt*Xe,kt+=nt*Je,Ct+=nt*Qe,Ut+=nt*We,Wt+=nt*ur,Ft+=nt*ar,Ce+=nt*cr,nt=tt[7],ft+=nt*xt,dt+=nt*Ke,pt+=nt*Pe,gt+=nt*Ht,_t+=nt*zt,mt+=nt*jt,At+=nt*qt,It+=nt*Ge,Mt+=nt*Ie,kt+=nt*Xe,Ct+=nt*Je,Ut+=nt*Qe,Wt+=nt*We,Ft+=nt*ur,Ce+=nt*ar,bt+=nt*cr,nt=tt[8],dt+=nt*xt,pt+=nt*Ke,gt+=nt*Pe,_t+=nt*Ht,mt+=nt*zt,At+=nt*jt,It+=nt*qt,Mt+=nt*Ge,kt+=nt*Ie,Ct+=nt*Xe,Ut+=nt*Je,Wt+=nt*Qe,Ft+=nt*We,Ce+=nt*ur,bt+=nt*ar,yt+=nt*cr,nt=tt[9],pt+=nt*xt,gt+=nt*Ke,_t+=nt*Pe,mt+=nt*Ht,At+=nt*zt,It+=nt*jt,Mt+=nt*qt,kt+=nt*Ge,Ct+=nt*Ie,Ut+=nt*Xe,Wt+=nt*Je,Ft+=nt*Qe,Ce+=nt*We,bt+=nt*ur,yt+=nt*ar,$t+=nt*cr,nt=tt[10],gt+=nt*xt,_t+=nt*Ke,mt+=nt*Pe,At+=nt*Ht,It+=nt*zt,Mt+=nt*jt,kt+=nt*qt,Ct+=nt*Ge,Ut+=nt*Ie,Wt+=nt*Xe,Ft+=nt*Je,Ce+=nt*Qe,bt+=nt*We,yt+=nt*ur,$t+=nt*ar,Et+=nt*cr,nt=tt[11],_t+=nt*xt,mt+=nt*Ke,At+=nt*Pe,It+=nt*Ht,Mt+=nt*zt,kt+=nt*jt,Ct+=nt*qt,Ut+=nt*Ge,Wt+=nt*Ie,Ft+=nt*Xe,Ce+=nt*Je,bt+=nt*Qe,yt+=nt*We,$t+=nt*ur,Et+=nt*ar,Tt+=nt*cr,nt=tt[12],mt+=nt*xt,At+=nt*Ke,It+=nt*Pe,Mt+=nt*Ht,kt+=nt*zt,Ct+=nt*jt,Ut+=nt*qt,Wt+=nt*Ge,Ft+=nt*Ie,Ce+=nt*Xe,bt+=nt*Je,yt+=nt*Qe,$t+=nt*We,Et+=nt*ur,Tt+=nt*ar,Pt+=nt*cr,nt=tt[13],At+=nt*xt,It+=nt*Ke,Mt+=nt*Pe,kt+=nt*Ht,Ct+=nt*zt,Ut+=nt*jt,Wt+=nt*qt,Ft+=nt*Ge,Ce+=nt*Ie,bt+=nt*Xe,yt+=nt*Je,$t+=nt*Qe,Et+=nt*We,Tt+=nt*ur,Pt+=nt*ar,St+=nt*cr,nt=tt[14],It+=nt*xt,Mt+=nt*Ke,kt+=nt*Pe,Ct+=nt*Ht,Ut+=nt*zt,Wt+=nt*jt,Ft+=nt*qt,Ce+=nt*Ge,bt+=nt*Ie,yt+=nt*Xe,$t+=nt*Je,Et+=nt*Qe,Tt+=nt*We,Pt+=nt*ur,St+=nt*ar,Dt+=nt*cr,nt=tt[15],Mt+=nt*xt,kt+=nt*Ke,Ct+=nt*Pe,Ut+=nt*Ht,Wt+=nt*zt,Ft+=nt*jt,Ce+=nt*qt,bt+=nt*Ge,yt+=nt*Ie,$t+=nt*Xe,Et+=nt*Je,Tt+=nt*Qe,Pt+=nt*We,St+=nt*ur,Dt+=nt*ar,wt+=nt*cr,ot+=38*kt,st+=38*Ct,at+=38*Ut,ct+=38*Wt,ut+=38*Ft,lt+=38*Ce,ht+=38*bt,ft+=38*yt,dt+=38*$t,pt+=38*Et,gt+=38*Tt,_t+=38*Pt,mt+=38*St,At+=38*Dt,It+=38*wt,it=1,nt=ot+it+65535,it=Math.floor(nt/65536),ot=nt-it*65536,nt=st+it+65535,it=Math.floor(nt/65536),st=nt-it*65536,nt=at+it+65535,it=Math.floor(nt/65536),at=nt-it*65536,nt=ct+it+65535,it=Math.floor(nt/65536),ct=nt-it*65536,nt=ut+it+65535,it=Math.floor(nt/65536),ut=nt-it*65536,nt=lt+it+65535,it=Math.floor(nt/65536),lt=nt-it*65536,nt=ht+it+65535,it=Math.floor(nt/65536),ht=nt-it*65536,nt=ft+it+65535,it=Math.floor(nt/65536),ft=nt-it*65536,nt=dt+it+65535,it=Math.floor(nt/65536),dt=nt-it*65536,nt=pt+it+65535,it=Math.floor(nt/65536),pt=nt-it*65536,nt=gt+it+65535,it=Math.floor(nt/65536),gt=nt-it*65536,nt=_t+it+65535,it=Math.floor(nt/65536),_t=nt-it*65536,nt=mt+it+65535,it=Math.floor(nt/65536),mt=nt-it*65536,nt=At+it+65535,it=Math.floor(nt/65536),At=nt-it*65536,nt=It+it+65535,it=Math.floor(nt/65536),It=nt-it*65536,nt=Mt+it+65535,it=Math.floor(nt/65536),Mt=nt-it*65536,ot+=it-1+37*(it-1),it=1,nt=ot+it+65535,it=Math.floor(nt/65536),ot=nt-it*65536,nt=st+it+65535,it=Math.floor(nt/65536),st=nt-it*65536,nt=at+it+65535,it=Math.floor(nt/65536),at=nt-it*65536,nt=ct+it+65535,it=Math.floor(nt/65536),ct=nt-it*65536,nt=ut+it+65535,it=Math.floor(nt/65536),ut=nt-it*65536,nt=lt+it+65535,it=Math.floor(nt/65536),lt=nt-it*65536,nt=ht+it+65535,it=Math.floor(nt/65536),ht=nt-it*65536,nt=ft+it+65535,it=Math.floor(nt/65536),ft=nt-it*65536,nt=dt+it+65535,it=Math.floor(nt/65536),dt=nt-it*65536,nt=pt+it+65535,it=Math.floor(nt/65536),pt=nt-it*65536,nt=gt+it+65535,it=Math.floor(nt/65536),gt=nt-it*65536,nt=_t+it+65535,it=Math.floor(nt/65536),_t=nt-it*65536,nt=mt+it+65535,it=Math.floor(nt/65536),mt=nt-it*65536,nt=At+it+65535,it=Math.floor(nt/65536),At=nt-it*65536,nt=It+it+65535,it=Math.floor(nt/65536),It=nt-it*65536,nt=Mt+it+65535,it=Math.floor(nt/65536),Mt=nt-it*65536,ot+=it-1+37*(it-1),et[0]=ot,et[1]=st,et[2]=at,et[3]=ct,et[4]=ut,et[5]=lt,et[6]=ht,et[7]=ft,et[8]=dt,et[9]=pt,et[10]=gt,et[11]=_t,et[12]=mt,et[13]=At,et[14]=It,et[15]=Mt}var rsaBrowser$1={};const randomBytes$5=random_browser,errcode$g=errCode$i;var randomBytes_1$2=function(et){if(isNaN(et)||et<=0)throw errcode$g(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return randomBytes$5(et)},rsaUtils$1={},util$3={};(function(et){const tt=forge$W,{fromString:rt}=require$$9$2,{toString:nt}=require$$1$2,{concat:it}=require$$7$1;et.bigIntegerToUintBase64url=(ot,st)=>{let at=Uint8Array.from(ot.abs().toByteArray());if(at=at[0]===0?at.slice(1):at,st!=null){if(at.length>st)throw new Error("byte array longer than desired length");at=it([new Uint8Array(st-at.length),at])}return nt(at,"base64url")},et.base64urlToBigInteger=ot=>{const st=et.base64urlToBuffer(ot);return new tt.jsbn.BigInteger(nt(st,"base16"),16)},et.base64urlToBuffer=(ot,st)=>{let at=rt(ot,"base64urlpad");if(st!=null){if(at.length>st)throw new Error("byte array longer than desired length");at=it([new Uint8Array(st-at.length),at])}return at}})(util$3);const forge$t=forge$W,{bigIntegerToUintBase64url:bigIntegerToUintBase64url$1,base64urlToBigInteger:base64urlToBigInteger$1}=util$3,{fromString:uint8ArrayFromString$j}=require$$9$2,{toString:uint8ArrayToString$o}=require$$1$2;rsaUtils$1.pkcs1ToJwk=function(et){const tt=forge$t.asn1.fromDer(uint8ArrayToString$o(et,"ascii")),rt=forge$t.pki.privateKeyFromAsn1(tt);return{kty:"RSA",n:bigIntegerToUintBase64url$1(rt.n),e:bigIntegerToUintBase64url$1(rt.e),d:bigIntegerToUintBase64url$1(rt.d),p:bigIntegerToUintBase64url$1(rt.p),q:bigIntegerToUintBase64url$1(rt.q),dp:bigIntegerToUintBase64url$1(rt.dP),dq:bigIntegerToUintBase64url$1(rt.dQ),qi:bigIntegerToUintBase64url$1(rt.qInv),alg:"RS256",kid:"2011-04-29"}},rsaUtils$1.jwkToPkcs1=function(et){const tt=forge$t.pki.privateKeyToAsn1({n:base64urlToBigInteger$1(et.n),e:base64urlToBigInteger$1(et.e),d:base64urlToBigInteger$1(et.d),p:base64urlToBigInteger$1(et.p),q:base64urlToBigInteger$1(et.q),dP:base64urlToBigInteger$1(et.dp),dQ:base64urlToBigInteger$1(et.dq),qInv:base64urlToBigInteger$1(et.qi)});return uint8ArrayFromString$j(forge$t.asn1.toDer(tt).getBytes(),"ascii")},rsaUtils$1.pkixToJwk=function(et){const tt=forge$t.asn1.fromDer(uint8ArrayToString$o(et,"ascii")),rt=forge$t.pki.publicKeyFromAsn1(tt);return{kty:"RSA",n:bigIntegerToUintBase64url$1(rt.n),e:bigIntegerToUintBase64url$1(rt.e),alg:"RS256",kid:"2011-04-29"}},rsaUtils$1.jwkToPkix=function(et){const tt=forge$t.pki.publicKeyToAsn1({n:base64urlToBigInteger$1(et.n),e:base64urlToBigInteger$1(et.e)});return uint8ArrayFromString$j(forge$t.asn1.toDer(tt).getBytes(),"ascii")};var jwk2pem$1,hasRequiredJwk2pem$1;function requireJwk2pem$1(){if(hasRequiredJwk2pem$1)return jwk2pem$1;hasRequiredJwk2pem$1=1;const et=forge$W,{base64urlToBigInteger:tt}=util$3;function rt(ot,st){return st.map(at=>tt(ot[at]))}function nt(ot){return et.pki.setRsaPrivateKey(...rt(ot,["n","e","d","p","q","dp","dq","qi"]))}function it(ot){return et.pki.setRsaPublicKey(...rt(ot,["n","e"]))}return jwk2pem$1={jwk2pub:it,jwk2priv:nt},jwk2pem$1}const webcrypto$3=webcrypto$6,randomBytes$4=randomBytes_1$2,{toString:uint8ArrayToString$n}=require$$1$2,{fromString:uint8ArrayFromString$i}=require$$9$2;rsaBrowser$1.utils=rsaUtils$1,rsaBrowser$1.generateKey=async function(et){const tt=await webcrypto$3.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:et,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),rt=await exportKey$1(tt);return{privateKey:rt[0],publicKey:rt[1]}},rsaBrowser$1.unmarshalPrivateKey=async function(et){const tt=[await webcrypto$3.get().subtle.importKey("jwk",et,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await derivePublicFromPrivate$1(et)],rt=await exportKey$1({privateKey:tt[0],publicKey:tt[1]});return{privateKey:rt[0],publicKey:rt[1]}},rsaBrowser$1.getRandomValues=randomBytes$4,rsaBrowser$1.hashAndSign=async function(et,tt){const rt=await webcrypto$3.get().subtle.importKey("jwk",et,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),nt=await webcrypto$3.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},rt,Uint8Array.from(tt));return new Uint8Array(nt,nt.byteOffset,nt.byteLength)},rsaBrowser$1.hashAndVerify=async function(et,tt,rt){const nt=await webcrypto$3.get().subtle.importKey("jwk",et,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return webcrypto$3.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},nt,tt,rt)};function exportKey$1(et){return Promise.all([webcrypto$3.get().subtle.exportKey("jwk",et.privateKey),webcrypto$3.get().subtle.exportKey("jwk",et.publicKey)])}function derivePublicFromPrivate$1(et){return webcrypto$3.get().subtle.importKey("jwk",{kty:et.kty,n:et.n,e:et.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}const{jwk2pub:jwk2pub$1,jwk2priv:jwk2priv$1}=requireJwk2pem$1();function convertKey$1(et,tt,rt,nt){const it=tt?jwk2pub$1(et):jwk2priv$1(et),ot=uint8ArrayToString$n(Uint8Array.from(rt),"ascii"),st=nt(ot,it);return uint8ArrayFromString$i(st,"ascii")}rsaBrowser$1.encrypt=function(et,tt){return convertKey$1(et,!0,tt,(rt,nt)=>nt.encrypt(rt))},rsaBrowser$1.decrypt=function(et,tt){return convertKey$1(et,!1,tt,(rt,nt)=>nt.decrypt(rt))};const{base64:base64$2}=require$$4,ciphers$2=aesGcm_browser$1;var exporter$7={export:async function(et,tt){const rt=await ciphers$2.create().encrypt(et,tt);return base64$2.encode(rt)}};const{sha256:sha256$9}=require$$1$4,errcode$f=errCode$i,{equals:uint8ArrayEquals$7}=require$$1$3,{toString:uint8ArrayToString$m}=require$$1$2,forge$s=forge$W,crypto$6=rsaBrowser$1,pbm$3=keys$4,exporter$6=exporter$7;let RsaPublicKey$1=class{constructor(et){this._key=et}async verify(et,tt){return crypto$6.hashAndVerify(this._key,tt,et)}marshal(){return crypto$6.utils.jwkToPkix(this._key)}get bytes(){return pbm$3.PublicKey.encode({Type:pbm$3.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(et){return crypto$6.encrypt(this._key,et)}equals(et){return uint8ArrayEquals$7(this.bytes,et.bytes)}async hash(){const{bytes:et}=await sha256$9.digest(this.bytes);return et}},RsaPrivateKey$1=class{constructor(et,tt){this._key=et,this._publicKey=tt}genSecret(){return crypto$6.getRandomValues(16)}async sign(et){return crypto$6.hashAndSign(this._key,et)}get public(){if(!this._publicKey)throw errcode$f(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new RsaPublicKey$1(this._publicKey)}decrypt(et){return crypto$6.decrypt(this._key,et)}marshal(){return crypto$6.utils.jwkToPkcs1(this._key)}get bytes(){return pbm$3.PrivateKey.encode({Type:pbm$3.KeyType.RSA,Data:this.marshal()}).finish()}equals(et){return uint8ArrayEquals$7(this.bytes,et.bytes)}async hash(){const{bytes:et}=await sha256$9.digest(this.bytes);return et}async id(){const et=await this.public.hash();return uint8ArrayToString$m(et,"base58btc")}async export(et,tt="pkcs-8"){if(tt==="pkcs-8"){const rt=new forge$s.util.ByteBuffer(this.marshal()),nt=forge$s.asn1.fromDer(rt),it=forge$s.pki.privateKeyFromAsn1(nt),ot={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return forge$s.pki.encryptRsaPrivateKey(it,et,ot)}else{if(tt==="libp2p-key")return exporter$6.export(this.bytes,et);throw errcode$f(new Error(`export format '${tt}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}};async function unmarshalRsaPrivateKey$1(et){const tt=crypto$6.utils.pkcs1ToJwk(et),rt=await crypto$6.unmarshalPrivateKey(tt);return new RsaPrivateKey$1(rt.privateKey,rt.publicKey)}function unmarshalRsaPublicKey$1(et){const tt=crypto$6.utils.pkixToJwk(et);return new RsaPublicKey$1(tt)}async function fromJwk$1(et){const tt=await crypto$6.unmarshalPrivateKey(et);return new RsaPrivateKey$1(tt.privateKey,tt.publicKey)}async function generateKeyPair$6(et){const tt=await crypto$6.generateKey(et);return new RsaPrivateKey$1(tt.privateKey,tt.publicKey)}var rsaClass$1={RsaPublicKey:RsaPublicKey$1,RsaPrivateKey:RsaPrivateKey$1,unmarshalRsaPublicKey:unmarshalRsaPublicKey$1,unmarshalRsaPrivateKey:unmarshalRsaPrivateKey$1,generateKeyPair:generateKeyPair$6,fromJwk:fromJwk$1},ed25519$1={};const forge$r=forge$W;ed25519$1.publicKeyLength=forge$r.pki.ed25519.constants.PUBLIC_KEY_BYTE_LENGTH,ed25519$1.privateKeyLength=forge$r.pki.ed25519.constants.PRIVATE_KEY_BYTE_LENGTH,ed25519$1.generateKey=async function(){return forge$r.pki.ed25519.generateKeyPair()},ed25519$1.generateKeyFromSeed=async function(et){return forge$r.pki.ed25519.generateKeyPair({seed:et})},ed25519$1.hashAndSign=async function(et,tt){return forge$r.pki.ed25519.sign({message:tt,privateKey:et})},ed25519$1.hashAndVerify=async function(et,tt,rt){return forge$r.pki.ed25519.verify({signature:tt,message:rt,publicKey:et})};const errcode$e=errCode$i,{equals:uint8ArrayEquals$6}=require$$1$3,{sha256:sha256$8}=require$$1$4,{base58btc:base58btc$5}=require$$1$5,{identity:identity$5}=require$$7,crypto$5=ed25519$1,pbm$2=keys$4,exporter$5=exporter$7;let Ed25519PublicKey$1=class{constructor(et){this._key=ensureKey$1(et,crypto$5.publicKeyLength)}async verify(et,tt){return crypto$5.hashAndVerify(this._key,tt,et)}marshal(){return this._key}get bytes(){return pbm$2.PublicKey.encode({Type:pbm$2.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(et){return uint8ArrayEquals$6(this.bytes,et.bytes)}async hash(){const{bytes:et}=await sha256$8.digest(this.bytes);return et}},Ed25519PrivateKey$1=class{constructor(et,tt){this._key=ensureKey$1(et,crypto$5.privateKeyLength),this._publicKey=ensureKey$1(tt,crypto$5.publicKeyLength)}async sign(et){return crypto$5.hashAndSign(this._key,et)}get public(){return new Ed25519PublicKey$1(this._publicKey)}marshal(){return this._key}get bytes(){return pbm$2.PrivateKey.encode({Type:pbm$2.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(et){return uint8ArrayEquals$6(this.bytes,et.bytes)}async hash(){const{bytes:et}=await sha256$8.digest(this.bytes);return et}async id(){const et=await identity$5.digest(this.public.bytes);return base58btc$5.encode(et.bytes).substring(1)}async export(et,tt="libp2p-key"){if(tt==="libp2p-key")return exporter$5.export(this.bytes,et);throw errcode$e(new Error(`export format '${tt}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}};function unmarshalEd25519PrivateKey$1(et){if(et.length>crypto$5.privateKeyLength){et=ensureKey$1(et,crypto$5.privateKeyLength+crypto$5.publicKeyLength);const nt=et.slice(0,crypto$5.privateKeyLength),it=et.slice(crypto$5.privateKeyLength,et.length);return new Ed25519PrivateKey$1(nt,it)}et=ensureKey$1(et,crypto$5.privateKeyLength);const tt=et.slice(0,crypto$5.privateKeyLength),rt=et.slice(crypto$5.publicKeyLength);return new Ed25519PrivateKey$1(tt,rt)}function unmarshalEd25519PublicKey$1(et){return et=ensureKey$1(et,crypto$5.publicKeyLength),new Ed25519PublicKey$1(et)}async function generateKeyPair$5(){const{privateKey:et,publicKey:tt}=await crypto$5.generateKey();return new Ed25519PrivateKey$1(et,tt)}async function generateKeyPairFromSeed$3(et){const{privateKey:tt,publicKey:rt}=await crypto$5.generateKeyFromSeed(et);return new Ed25519PrivateKey$1(tt,rt)}function ensureKey$1(et,tt){if(et=Uint8Array.from(et||[]),et.length!==tt)throw errcode$e(new Error(`Key must be a Uint8Array of length ${tt}, got ${et.length}`),"ERR_INVALID_KEY_TYPE");return et}var ed25519Class$1={Ed25519PublicKey:Ed25519PublicKey$1,Ed25519PrivateKey:Ed25519PrivateKey$1,unmarshalEd25519PrivateKey:unmarshalEd25519PrivateKey$1,unmarshalEd25519PublicKey:unmarshalEd25519PublicKey$1,generateKeyPair:generateKeyPair$5,generateKeyPairFromSeed:generateKeyPairFromSeed$3},lib$4,hasRequiredLib$1;function requireLib$1(){if(hasRequiredLib$1)return lib$4;hasRequiredLib$1=1;const et={IMPOSSIBLE_CASE:"Impossible case. Please create issue.",TWEAK_ADD:"The tweak was out of range or the resulted private key is invalid",TWEAK_MUL:"The tweak was out of range or equal to zero",CONTEXT_RANDOMIZE_UNKNOW:"Unknow error on context randomization",SECKEY_INVALID:"Private Key is invalid",PUBKEY_PARSE:"Public Key could not be parsed",PUBKEY_SERIALIZE:"Public Key serialization error",PUBKEY_COMBINE:"The sum of the public keys is not valid",SIG_PARSE:"Signature could not be parsed",SIGN:"The nonce generation function failed, or the private key was invalid",RECOVER:"Public key could not be recover",ECDH:"Scalar was invalid (zero or overflow)"};function tt(st,at){if(!st)throw new Error(at)}function rt(st,at,ct){if(tt(at instanceof Uint8Array,`Expected ${st} to be an Uint8Array`),ct!==void 0)if(Array.isArray(ct)){const ut=ct.join(", "),lt=`Expected ${st} to be an Uint8Array with length [${ut}]`;tt(ct.includes(at.length),lt)}else{const ut=`Expected ${st} to be an Uint8Array with length ${ct}`;tt(at.length===ct,ut)}}function nt(st){tt(ot(st)==="Boolean","Expected compressed to be a Boolean")}function it(st=ct=>new Uint8Array(ct),at){return typeof st=="function"&&(st=st(at)),rt("output",st,at),st}function ot(st){return Object.prototype.toString.call(st).slice(8,-1)}return lib$4=st=>({contextRandomize(at){switch(tt(at===null||at instanceof Uint8Array,"Expected seed to be an Uint8Array or null"),at!==null&&rt("seed",at,32),st.contextRandomize(at)){case 1:throw new Error(et.CONTEXT_RANDOMIZE_UNKNOW)}},privateKeyVerify(at){return rt("private key",at,32),st.privateKeyVerify(at)===0},privateKeyNegate(at){switch(rt("private key",at,32),st.privateKeyNegate(at)){case 0:return at;case 1:throw new Error(et.IMPOSSIBLE_CASE)}},privateKeyTweakAdd(at,ct){switch(rt("private key",at,32),rt("tweak",ct,32),st.privateKeyTweakAdd(at,ct)){case 0:return at;case 1:throw new Error(et.TWEAK_ADD)}},privateKeyTweakMul(at,ct){switch(rt("private key",at,32),rt("tweak",ct,32),st.privateKeyTweakMul(at,ct)){case 0:return at;case 1:throw new Error(et.TWEAK_MUL)}},publicKeyVerify(at){return rt("public key",at,[33,65]),st.publicKeyVerify(at)===0},publicKeyCreate(at,ct=!0,ut){switch(rt("private key",at,32),nt(ct),ut=it(ut,ct?33:65),st.publicKeyCreate(ut,at)){case 0:return ut;case 1:throw new Error(et.SECKEY_INVALID);case 2:throw new Error(et.PUBKEY_SERIALIZE)}},publicKeyConvert(at,ct=!0,ut){switch(rt("public key",at,[33,65]),nt(ct),ut=it(ut,ct?33:65),st.publicKeyConvert(ut,at)){case 0:return ut;case 1:throw new Error(et.PUBKEY_PARSE);case 2:throw new Error(et.PUBKEY_SERIALIZE)}},publicKeyNegate(at,ct=!0,ut){switch(rt("public key",at,[33,65]),nt(ct),ut=it(ut,ct?33:65),st.publicKeyNegate(ut,at)){case 0:return ut;case 1:throw new Error(et.PUBKEY_PARSE);case 2:throw new Error(et.IMPOSSIBLE_CASE);case 3:throw new Error(et.PUBKEY_SERIALIZE)}},publicKeyCombine(at,ct=!0,ut){tt(Array.isArray(at),"Expected public keys to be an Array"),tt(at.length>0,"Expected public keys array will have more than zero items");for(const lt of at)rt("public key",lt,[33,65]);switch(nt(ct),ut=it(ut,ct?33:65),st.publicKeyCombine(ut,at)){case 0:return ut;case 1:throw new Error(et.PUBKEY_PARSE);case 2:throw new Error(et.PUBKEY_COMBINE);case 3:throw new Error(et.PUBKEY_SERIALIZE)}},publicKeyTweakAdd(at,ct,ut=!0,lt){switch(rt("public key",at,[33,65]),rt("tweak",ct,32),nt(ut),lt=it(lt,ut?33:65),st.publicKeyTweakAdd(lt,at,ct)){case 0:return lt;case 1:throw new Error(et.PUBKEY_PARSE);case 2:throw new Error(et.TWEAK_ADD)}},publicKeyTweakMul(at,ct,ut=!0,lt){switch(rt("public key",at,[33,65]),rt("tweak",ct,32),nt(ut),lt=it(lt,ut?33:65),st.publicKeyTweakMul(lt,at,ct)){case 0:return lt;case 1:throw new Error(et.PUBKEY_PARSE);case 2:throw new Error(et.TWEAK_MUL)}},signatureNormalize(at){switch(rt("signature",at,64),st.signatureNormalize(at)){case 0:return at;case 1:throw new Error(et.SIG_PARSE)}},signatureExport(at,ct){rt("signature",at,64),ct=it(ct,72);const ut={output:ct,outputlen:72};switch(st.signatureExport(ut,at)){case 0:return ct.slice(0,ut.outputlen);case 1:throw new Error(et.SIG_PARSE);case 2:throw new Error(et.IMPOSSIBLE_CASE)}},signatureImport(at,ct){switch(rt("signature",at),ct=it(ct,64),st.signatureImport(ct,at)){case 0:return ct;case 1:throw new Error(et.SIG_PARSE);case 2:throw new Error(et.IMPOSSIBLE_CASE)}},ecdsaSign(at,ct,ut={},lt){rt("message",at,32),rt("private key",ct,32),tt(ot(ut)==="Object","Expected options to be an Object"),ut.data!==void 0&&rt("options.data",ut.data),ut.noncefn!==void 0&&tt(ot(ut.noncefn)==="Function","Expected options.noncefn to be a Function"),lt=it(lt,64);const ht={signature:lt,recid:null};switch(st.ecdsaSign(ht,at,ct,ut.data,ut.noncefn)){case 0:return ht;case 1:throw new Error(et.SIGN);case 2:throw new Error(et.IMPOSSIBLE_CASE)}},ecdsaVerify(at,ct,ut){switch(rt("signature",at,64),rt("message",ct,32),rt("public key",ut,[33,65]),st.ecdsaVerify(at,ct,ut)){case 0:return!0;case 3:return!1;case 1:throw new Error(et.SIG_PARSE);case 2:throw new Error(et.PUBKEY_PARSE)}},ecdsaRecover(at,ct,ut,lt=!0,ht){switch(rt("signature",at,64),tt(ot(ct)==="Number"&&ct>=0&&ct<=3,"Expected recovery id to be a Number within interval [0, 3]"),rt("message",ut,32),nt(lt),ht=it(ht,lt?33:65),st.ecdsaRecover(ht,at,ct,ut)){case 0:return ht;case 1:throw new Error(et.SIG_PARSE);case 2:throw new Error(et.RECOVER);case 3:throw new Error(et.IMPOSSIBLE_CASE)}},ecdh(at,ct,ut={},lt){switch(rt("public key",at,[33,65]),rt("private key",ct,32),tt(ot(ut)==="Object","Expected options to be an Object"),ut.data!==void 0&&rt("options.data",ut.data),ut.hashfn!==void 0?(tt(ot(ut.hashfn)==="Function","Expected options.hashfn to be a Function"),ut.xbuf!==void 0&&rt("options.xbuf",ut.xbuf,32),ut.ybuf!==void 0&&rt("options.ybuf",ut.ybuf,32),rt("output",lt)):lt=it(lt,32),st.ecdh(lt,at,ct,ut.data,ut.hashfn,ut.xbuf,ut.ybuf)){case 0:return lt;case 1:throw new Error(et.PUBKEY_PARSE);case 2:throw new Error(et.ECDH)}}}),lib$4}var elliptic$2={};const name$2="elliptic",version$3="6.5.4",description="EC cryptography",main="lib/elliptic.js",files=["lib"],scripts={lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository={type:"git",url:"git@github.com:indutny/elliptic"},keywords=["EC","Elliptic","curve","Cryptography"],author="Fedor Indutny <fedor@indutny.com>",license="MIT",bugs={url:"https://github.com/indutny/elliptic/issues"},homepage="https://github.com/indutny/elliptic",devDependencies={brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies={"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"},require$$0$2={name:name$2,version:version$3,description,main,files,scripts,repository,keywords,author,license,bugs,homepage,devDependencies,dependencies};var utils$h={},bn$1={exports:{}};bn$1.exports;var hasRequiredBn;function requireBn(){return hasRequiredBn||(hasRequiredBn=1,function(et){(function(tt,rt){function nt(bt,yt){if(!bt)throw new Error(yt||"Assertion failed")}function it(bt,yt){bt.super_=yt;var $t=function(){};$t.prototype=yt.prototype,bt.prototype=new $t,bt.prototype.constructor=bt}function ot(bt,yt,$t){if(ot.isBN(bt))return bt;this.negative=0,this.words=null,this.length=0,this.red=null,bt!==null&&((yt==="le"||yt==="be")&&($t=yt,yt=10),this._init(bt||0,yt||10,$t||"be"))}typeof tt=="object"?tt.exports=ot:rt.BN=ot,ot.BN=ot,ot.wordSize=26;var st;try{typeof window<"u"&&typeof window.Buffer<"u"?st=window.Buffer:st=require$$0$3.Buffer}catch{}ot.isBN=function(bt){return bt instanceof ot?!0:bt!==null&&typeof bt=="object"&&bt.constructor.wordSize===ot.wordSize&&Array.isArray(bt.words)},ot.max=function(bt,yt){return bt.cmp(yt)>0?bt:yt},ot.min=function(bt,yt){return bt.cmp(yt)<0?bt:yt},ot.prototype._init=function(bt,yt,$t){if(typeof bt=="number")return this._initNumber(bt,yt,$t);if(typeof bt=="object")return this._initArray(bt,yt,$t);yt==="hex"&&(yt=16),nt(yt===(yt|0)&&yt>=2&&yt<=36),bt=bt.toString().replace(/\s+/g,"");var Et=0;bt[0]==="-"&&(Et++,this.negative=1),Et<bt.length&&(yt===16?this._parseHex(bt,Et,$t):(this._parseBase(bt,yt,Et),$t==="le"&&this._initArray(this.toArray(),yt,$t)))},ot.prototype._initNumber=function(bt,yt,$t){bt<0&&(this.negative=1,bt=-bt),bt<67108864?(this.words=[bt&67108863],this.length=1):bt<4503599627370496?(this.words=[bt&67108863,bt/67108864&67108863],this.length=2):(nt(bt<9007199254740992),this.words=[bt&67108863,bt/67108864&67108863,1],this.length=3),$t==="le"&&this._initArray(this.toArray(),yt,$t)},ot.prototype._initArray=function(bt,yt,$t){if(nt(typeof bt.length=="number"),bt.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(bt.length/3),this.words=new Array(this.length);for(var Et=0;Et<this.length;Et++)this.words[Et]=0;var Tt,Pt,St=0;if($t==="be")for(Et=bt.length-1,Tt=0;Et>=0;Et-=3)Pt=bt[Et]|bt[Et-1]<<8|bt[Et-2]<<16,this.words[Tt]|=Pt<<St&67108863,this.words[Tt+1]=Pt>>>26-St&67108863,St+=24,St>=26&&(St-=26,Tt++);else if($t==="le")for(Et=0,Tt=0;Et<bt.length;Et+=3)Pt=bt[Et]|bt[Et+1]<<8|bt[Et+2]<<16,this.words[Tt]|=Pt<<St&67108863,this.words[Tt+1]=Pt>>>26-St&67108863,St+=24,St>=26&&(St-=26,Tt++);return this.strip()};function at(bt,yt){var $t=bt.charCodeAt(yt);return $t>=65&&$t<=70?$t-55:$t>=97&&$t<=102?$t-87:$t-48&15}function ct(bt,yt,$t){var Et=at(bt,$t);return $t-1>=yt&&(Et|=at(bt,$t-1)<<4),Et}ot.prototype._parseHex=function(bt,yt,$t){this.length=Math.ceil((bt.length-yt)/6),this.words=new Array(this.length);for(var Et=0;Et<this.length;Et++)this.words[Et]=0;var Tt=0,Pt=0,St;if($t==="be")for(Et=bt.length-1;Et>=yt;Et-=2)St=ct(bt,yt,Et)<<Tt,this.words[Pt]|=St&67108863,Tt>=18?(Tt-=18,Pt+=1,this.words[Pt]|=St>>>26):Tt+=8;else{var Dt=bt.length-yt;for(Et=Dt%2===0?yt+1:yt;Et<bt.length;Et+=2)St=ct(bt,yt,Et)<<Tt,this.words[Pt]|=St&67108863,Tt>=18?(Tt-=18,Pt+=1,this.words[Pt]|=St>>>26):Tt+=8}this.strip()};function ut(bt,yt,$t,Et){for(var Tt=0,Pt=Math.min(bt.length,$t),St=yt;St<Pt;St++){var Dt=bt.charCodeAt(St)-48;Tt*=Et,Dt>=49?Tt+=Dt-49+10:Dt>=17?Tt+=Dt-17+10:Tt+=Dt}return Tt}ot.prototype._parseBase=function(bt,yt,$t){this.words=[0],this.length=1;for(var Et=0,Tt=1;Tt<=67108863;Tt*=yt)Et++;Et--,Tt=Tt/yt|0;for(var Pt=bt.length-$t,St=Pt%Et,Dt=Math.min(Pt,Pt-St)+$t,wt=0,xt=$t;xt<Dt;xt+=Et)wt=ut(bt,xt,xt+Et,yt),this.imuln(Tt),this.words[0]+wt<67108864?this.words[0]+=wt:this._iaddn(wt);if(St!==0){var Ke=1;for(wt=ut(bt,xt,bt.length,yt),xt=0;xt<St;xt++)Ke*=yt;this.imuln(Ke),this.words[0]+wt<67108864?this.words[0]+=wt:this._iaddn(wt)}this.strip()},ot.prototype.copy=function(bt){bt.words=new Array(this.length);for(var yt=0;yt<this.length;yt++)bt.words[yt]=this.words[yt];bt.length=this.length,bt.negative=this.negative,bt.red=this.red},ot.prototype.clone=function(){var bt=new ot(null);return this.copy(bt),bt},ot.prototype._expand=function(bt){for(;this.length<bt;)this.words[this.length++]=0;return this},ot.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},ot.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},ot.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var lt=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],ht=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],ft=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];ot.prototype.toString=function(bt,yt){bt=bt||10,yt=yt|0||1;var $t;if(bt===16||bt==="hex"){$t="";for(var Et=0,Tt=0,Pt=0;Pt<this.length;Pt++){var St=this.words[Pt],Dt=((St<<Et|Tt)&16777215).toString(16);Tt=St>>>24-Et&16777215,Tt!==0||Pt!==this.length-1?$t=lt[6-Dt.length]+Dt+$t:$t=Dt+$t,Et+=2,Et>=26&&(Et-=26,Pt--)}for(Tt!==0&&($t=Tt.toString(16)+$t);$t.length%yt!==0;)$t="0"+$t;return this.negative!==0&&($t="-"+$t),$t}if(bt===(bt|0)&&bt>=2&&bt<=36){var wt=ht[bt],xt=ft[bt];$t="";var Ke=this.clone();for(Ke.negative=0;!Ke.isZero();){var Pe=Ke.modn(xt).toString(bt);Ke=Ke.idivn(xt),Ke.isZero()?$t=Pe+$t:$t=lt[wt-Pe.length]+Pe+$t}for(this.isZero()&&($t="0"+$t);$t.length%yt!==0;)$t="0"+$t;return this.negative!==0&&($t="-"+$t),$t}nt(!1,"Base should be between 2 and 36")},ot.prototype.toNumber=function(){var bt=this.words[0];return this.length===2?bt+=this.words[1]*67108864:this.length===3&&this.words[2]===1?bt+=4503599627370496+this.words[1]*67108864:this.length>2&&nt(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-bt:bt},ot.prototype.toJSON=function(){return this.toString(16)},ot.prototype.toBuffer=function(bt,yt){return nt(typeof st<"u"),this.toArrayLike(st,bt,yt)},ot.prototype.toArray=function(bt,yt){return this.toArrayLike(Array,bt,yt)},ot.prototype.toArrayLike=function(bt,yt,$t){var Et=this.byteLength(),Tt=$t||Math.max(1,Et);nt(Et<=Tt,"byte array longer than desired length"),nt(Tt>0,"Requested array length <= 0"),this.strip();var Pt=yt==="le",St=new bt(Tt),Dt,wt,xt=this.clone();if(Pt){for(wt=0;!xt.isZero();wt++)Dt=xt.andln(255),xt.iushrn(8),St[wt]=Dt;for(;wt<Tt;wt++)St[wt]=0}else{for(wt=0;wt<Tt-Et;wt++)St[wt]=0;for(wt=0;!xt.isZero();wt++)Dt=xt.andln(255),xt.iushrn(8),St[Tt-wt-1]=Dt}return St},Math.clz32?ot.prototype._countBits=function(bt){return 32-Math.clz32(bt)}:ot.prototype._countBits=function(bt){var yt=bt,$t=0;return yt>=4096&&($t+=13,yt>>>=13),yt>=64&&($t+=7,yt>>>=7),yt>=8&&($t+=4,yt>>>=4),yt>=2&&($t+=2,yt>>>=2),$t+yt},ot.prototype._zeroBits=function(bt){if(bt===0)return 26;var yt=bt,$t=0;return yt&8191||($t+=13,yt>>>=13),yt&127||($t+=7,yt>>>=7),yt&15||($t+=4,yt>>>=4),yt&3||($t+=2,yt>>>=2),yt&1||$t++,$t},ot.prototype.bitLength=function(){var bt=this.words[this.length-1],yt=this._countBits(bt);return(this.length-1)*26+yt};function dt(bt){for(var yt=new Array(bt.bitLength()),$t=0;$t<yt.length;$t++){var Et=$t/26|0,Tt=$t%26;yt[$t]=(bt.words[Et]&1<<Tt)>>>Tt}return yt}ot.prototype.zeroBits=function(){if(this.isZero())return 0;for(var bt=0,yt=0;yt<this.length;yt++){var $t=this._zeroBits(this.words[yt]);if(bt+=$t,$t!==26)break}return bt},ot.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},ot.prototype.toTwos=function(bt){return this.negative!==0?this.abs().inotn(bt).iaddn(1):this.clone()},ot.prototype.fromTwos=function(bt){return this.testn(bt-1)?this.notn(bt).iaddn(1).ineg():this.clone()},ot.prototype.isNeg=function(){return this.negative!==0},ot.prototype.neg=function(){return this.clone().ineg()},ot.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},ot.prototype.iuor=function(bt){for(;this.length<bt.length;)this.words[this.length++]=0;for(var yt=0;yt<bt.length;yt++)this.words[yt]=this.words[yt]|bt.words[yt];return this.strip()},ot.prototype.ior=function(bt){return nt((this.negative|bt.negative)===0),this.iuor(bt)},ot.prototype.or=function(bt){return this.length>bt.length?this.clone().ior(bt):bt.clone().ior(this)},ot.prototype.uor=function(bt){return this.length>bt.length?this.clone().iuor(bt):bt.clone().iuor(this)},ot.prototype.iuand=function(bt){var yt;this.length>bt.length?yt=bt:yt=this;for(var $t=0;$t<yt.length;$t++)this.words[$t]=this.words[$t]&bt.words[$t];return this.length=yt.length,this.strip()},ot.prototype.iand=function(bt){return nt((this.negative|bt.negative)===0),this.iuand(bt)},ot.prototype.and=function(bt){return this.length>bt.length?this.clone().iand(bt):bt.clone().iand(this)},ot.prototype.uand=function(bt){return this.length>bt.length?this.clone().iuand(bt):bt.clone().iuand(this)},ot.prototype.iuxor=function(bt){var yt,$t;this.length>bt.length?(yt=this,$t=bt):(yt=bt,$t=this);for(var Et=0;Et<$t.length;Et++)this.words[Et]=yt.words[Et]^$t.words[Et];if(this!==yt)for(;Et<yt.length;Et++)this.words[Et]=yt.words[Et];return this.length=yt.length,this.strip()},ot.prototype.ixor=function(bt){return nt((this.negative|bt.negative)===0),this.iuxor(bt)},ot.prototype.xor=function(bt){return this.length>bt.length?this.clone().ixor(bt):bt.clone().ixor(this)},ot.prototype.uxor=function(bt){return this.length>bt.length?this.clone().iuxor(bt):bt.clone().iuxor(this)},ot.prototype.inotn=function(bt){nt(typeof bt=="number"&&bt>=0);var yt=Math.ceil(bt/26)|0,$t=bt%26;this._expand(yt),$t>0&&yt--;for(var Et=0;Et<yt;Et++)this.words[Et]=~this.words[Et]&67108863;return $t>0&&(this.words[Et]=~this.words[Et]&67108863>>26-$t),this.strip()},ot.prototype.notn=function(bt){return this.clone().inotn(bt)},ot.prototype.setn=function(bt,yt){nt(typeof bt=="number"&&bt>=0);var $t=bt/26|0,Et=bt%26;return this._expand($t+1),yt?this.words[$t]=this.words[$t]|1<<Et:this.words[$t]=this.words[$t]&~(1<<Et),this.strip()},ot.prototype.iadd=function(bt){var yt;if(this.negative!==0&&bt.negative===0)return this.negative=0,yt=this.isub(bt),this.negative^=1,this._normSign();if(this.negative===0&&bt.negative!==0)return bt.negative=0,yt=this.isub(bt),bt.negative=1,yt._normSign();var $t,Et;this.length>bt.length?($t=this,Et=bt):($t=bt,Et=this);for(var Tt=0,Pt=0;Pt<Et.length;Pt++)yt=($t.words[Pt]|0)+(Et.words[Pt]|0)+Tt,this.words[Pt]=yt&67108863,Tt=yt>>>26;for(;Tt!==0&&Pt<$t.length;Pt++)yt=($t.words[Pt]|0)+Tt,this.words[Pt]=yt&67108863,Tt=yt>>>26;if(this.length=$t.length,Tt!==0)this.words[this.length]=Tt,this.length++;else if($t!==this)for(;Pt<$t.length;Pt++)this.words[Pt]=$t.words[Pt];return this},ot.prototype.add=function(bt){var yt;return bt.negative!==0&&this.negative===0?(bt.negative=0,yt=this.sub(bt),bt.negative^=1,yt):bt.negative===0&&this.negative!==0?(this.negative=0,yt=bt.sub(this),this.negative=1,yt):this.length>bt.length?this.clone().iadd(bt):bt.clone().iadd(this)},ot.prototype.isub=function(bt){if(bt.negative!==0){bt.negative=0;var yt=this.iadd(bt);return bt.negative=1,yt._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(bt),this.negative=1,this._normSign();var $t=this.cmp(bt);if($t===0)return this.negative=0,this.length=1,this.words[0]=0,this;var Et,Tt;$t>0?(Et=this,Tt=bt):(Et=bt,Tt=this);for(var Pt=0,St=0;St<Tt.length;St++)yt=(Et.words[St]|0)-(Tt.words[St]|0)+Pt,Pt=yt>>26,this.words[St]=yt&67108863;for(;Pt!==0&&St<Et.length;St++)yt=(Et.words[St]|0)+Pt,Pt=yt>>26,this.words[St]=yt&67108863;if(Pt===0&&St<Et.length&&Et!==this)for(;St<Et.length;St++)this.words[St]=Et.words[St];return this.length=Math.max(this.length,St),Et!==this&&(this.negative=1),this.strip()},ot.prototype.sub=function(bt){return this.clone().isub(bt)};function pt(bt,yt,$t){$t.negative=yt.negative^bt.negative;var Et=bt.length+yt.length|0;$t.length=Et,Et=Et-1|0;var Tt=bt.words[0]|0,Pt=yt.words[0]|0,St=Tt*Pt,Dt=St&67108863,wt=St/67108864|0;$t.words[0]=Dt;for(var xt=1;xt<Et;xt++){for(var Ke=wt>>>26,Pe=wt&67108863,Ht=Math.min(xt,yt.length-1),zt=Math.max(0,xt-bt.length+1);zt<=Ht;zt++){var jt=xt-zt|0;Tt=bt.words[jt]|0,Pt=yt.words[zt]|0,St=Tt*Pt+Pe,Ke+=St/67108864|0,Pe=St&67108863}$t.words[xt]=Pe|0,wt=Ke|0}return wt!==0?$t.words[xt]=wt|0:$t.length--,$t.strip()}var gt=function(bt,yt,$t){var Et=bt.words,Tt=yt.words,Pt=$t.words,St=0,Dt,wt,xt,Ke=Et[0]|0,Pe=Ke&8191,Ht=Ke>>>13,zt=Et[1]|0,jt=zt&8191,qt=zt>>>13,Ge=Et[2]|0,Ie=Ge&8191,Xe=Ge>>>13,Je=Et[3]|0,Qe=Je&8191,We=Je>>>13,ur=Et[4]|0,ar=ur&8191,cr=ur>>>13,$r=Et[5]|0,fr=$r&8191,ue=$r>>>13,Qt=Et[6]|0,me=Qt&8191,Lt=Qt>>>13,Gt=Et[7]|0,Xt=Gt&8191,Yt=Gt>>>13,He=Et[8]|0,ir=He&8191,vt=He>>>13,Rt=Et[9]|0,Bt=Rt&8191,Nt=Rt>>>13,Ot=Tt[0]|0,Kt=Ot&8191,$e=Ot>>>13,nr=Tt[1]|0,Ze=nr&8191,tr=nr>>>13,lr=Tt[2]|0,dr=lr&8191,br=lr>>>13,Rr=Tt[3]|0,Er=Rr&8191,_r=Rr>>>13,Cr=Tt[4]|0,Ar=Cr&8191,Zt=Cr>>>13,Vt=Tt[5]|0,Jt=Vt&8191,Ue=Vt>>>13,er=Tt[6]|0,sr=er&8191,hr=er>>>13,gr=Tt[7]|0,mr=gr&8191,vr=gr>>>13,Tr=Tt[8]|0,wr=Tr&8191,Sr=Tr>>>13,Pr=Tt[9]|0,Ir=Pr&8191,Br=Pr>>>13;$t.negative=bt.negative^yt.negative,$t.length=19,Dt=Math.imul(Pe,Kt),wt=Math.imul(Pe,$e),wt=wt+Math.imul(Ht,Kt)|0,xt=Math.imul(Ht,$e);var qr=(St+Dt|0)+((wt&8191)<<13)|0;St=(xt+(wt>>>13)|0)+(qr>>>26)|0,qr&=67108863,Dt=Math.imul(jt,Kt),wt=Math.imul(jt,$e),wt=wt+Math.imul(qt,Kt)|0,xt=Math.imul(qt,$e),Dt=Dt+Math.imul(Pe,Ze)|0,wt=wt+Math.imul(Pe,tr)|0,wt=wt+Math.imul(Ht,Ze)|0,xt=xt+Math.imul(Ht,tr)|0;var Le=(St+Dt|0)+((wt&8191)<<13)|0;St=(xt+(wt>>>13)|0)+(Le>>>26)|0,Le&=67108863,Dt=Math.imul(Ie,Kt),wt=Math.imul(Ie,$e),wt=wt+Math.imul(Xe,Kt)|0,xt=Math.imul(Xe,$e),Dt=Dt+Math.imul(jt,Ze)|0,wt=wt+Math.imul(jt,tr)|0,wt=wt+Math.imul(qt,Ze)|0,xt=xt+Math.imul(qt,tr)|0,Dt=Dt+Math.imul(Pe,dr)|0,wt=wt+Math.imul(Pe,br)|0,wt=wt+Math.imul(Ht,dr)|0,xt=xt+Math.imul(Ht,br)|0;var yr=(St+Dt|0)+((wt&8191)<<13)|0;St=(xt+(wt>>>13)|0)+(yr>>>26)|0,yr&=67108863,Dt=Math.imul(Qe,Kt),wt=Math.imul(Qe,$e),wt=wt+Math.imul(We,Kt)|0,xt=Math.imul(We,$e),Dt=Dt+Math.imul(Ie,Ze)|0,wt=wt+Math.imul(Ie,tr)|0,wt=wt+Math.imul(Xe,Ze)|0,xt=xt+Math.imul(Xe,tr)|0,Dt=Dt+Math.imul(jt,dr)|0,wt=wt+Math.imul(jt,br)|0,wt=wt+Math.imul(qt,dr)|0,xt=xt+Math.imul(qt,br)|0,Dt=Dt+Math.imul(Pe,Er)|0,wt=wt+Math.imul(Pe,_r)|0,wt=wt+Math.imul(Ht,Er)|0,xt=xt+Math.imul(Ht,_r)|0;var pr=(St+Dt|0)+((wt&8191)<<13)|0;St=(xt+(wt>>>13)|0)+(pr>>>26)|0,pr&=67108863,Dt=Math.imul(ar,Kt),wt=Math.imul(ar,$e),wt=wt+Math.imul(cr,Kt)|0,xt=Math.imul(cr,$e),Dt=Dt+Math.imul(Qe,Ze)|0,wt=wt+Math.imul(Qe,tr)|0,wt=wt+Math.imul(We,Ze)|0,xt=xt+Math.imul(We,tr)|0,Dt=Dt+Math.imul(Ie,dr)|0,wt=wt+Math.imul(Ie,br)|0,wt=wt+Math.imul(Xe,dr)|0,xt=xt+Math.imul(Xe,br)|0,Dt=Dt+Math.imul(jt,Er)|0,wt=wt+Math.imul(jt,_r)|0,wt=wt+Math.imul(qt,Er)|0,xt=xt+Math.imul(qt,_r)|0,Dt=Dt+Math.imul(Pe,Ar)|0,wt=wt+Math.imul(Pe,Zt)|0,wt=wt+Math.imul(Ht,Ar)|0,xt=xt+Math.imul(Ht,Zt)|0;var kr=(St+Dt|0)+((wt&8191)<<13)|0;St=(xt+(wt>>>13)|0)+(kr>>>26)|0,kr&=67108863,Dt=Math.imul(fr,Kt),wt=Math.imul(fr,$e),wt=wt+Math.imul(ue,Kt)|0,xt=Math.imul(ue,$e),Dt=Dt+Math.imul(ar,Ze)|0,wt=wt+Math.imul(ar,tr)|0,wt=wt+Math.imul(cr,Ze)|0,xt=xt+Math.imul(cr,tr)|0,Dt=Dt+Math.imul(Qe,dr)|0,wt=wt+Math.imul(Qe,br)|0,wt=wt+Math.imul(We,dr)|0,xt=xt+Math.imul(We,br)|0,Dt=Dt+Math.imul(Ie,Er)|0,wt=wt+Math.imul(Ie,_r)|0,wt=wt+Math.imul(Xe,Er)|0,xt=xt+Math.imul(Xe,_r)|0,Dt=Dt+Math.imul(jt,Ar)|0,wt=wt+Math.imul(jt,Zt)|0,wt=wt+Math.imul(qt,Ar)|0,xt=xt+Math.imul(qt,Zt)|0,Dt=Dt+Math.imul(Pe,Jt)|0,wt=wt+Math.imul(Pe,Ue)|0,wt=wt+Math.imul(Ht,Jt)|0,xt=xt+Math.imul(Ht,Ue)|0;var Dr=(St+Dt|0)+((wt&8191)<<13)|0;St=(xt+(wt>>>13)|0)+(Dr>>>26)|0,Dr&=67108863,Dt=Math.imul(me,Kt),wt=Math.imul(me,$e),wt=wt+Math.imul(Lt,Kt)|0,xt=Math.imul(Lt,$e),Dt=Dt+Math.imul(fr,Ze)|0,wt=wt+Math.imul(fr,tr)|0,wt=wt+Math.imul(ue,Ze)|0,xt=xt+Math.imul(ue,tr)|0,Dt=Dt+Math.imul(ar,dr)|0,wt=wt+Math.imul(ar,br)|0,wt=wt+Math.imul(cr,dr)|0,xt=xt+Math.imul(cr,br)|0,Dt=Dt+Math.imul(Qe,Er)|0,wt=wt+Math.imul(Qe,_r)|0,wt=wt+Math.imul(We,Er)|0,xt=xt+Math.imul(We,_r)|0,Dt=Dt+Math.imul(Ie,Ar)|0,wt=wt+Math.imul(Ie,Zt)|0,wt=wt+Math.imul(Xe,Ar)|0,xt=xt+Math.imul(Xe,Zt)|0,Dt=Dt+Math.imul(jt,Jt)|0,wt=wt+Math.imul(jt,Ue)|0,wt=wt+Math.imul(qt,Jt)|0,xt=xt+Math.imul(qt,Ue)|0,Dt=Dt+Math.imul(Pe,sr)|0,wt=wt+Math.imul(Pe,hr)|0,wt=wt+Math.imul(Ht,sr)|0,xt=xt+Math.imul(Ht,hr)|0;var Or=(St+Dt|0)+((wt&8191)<<13)|0;St=(xt+(wt>>>13)|0)+(Or>>>26)|0,Or&=67108863,Dt=Math.imul(Xt,Kt),wt=Math.imul(Xt,$e),wt=wt+Math.imul(Yt,Kt)|0,xt=Math.imul(Yt,$e),Dt=Dt+Math.imul(me,Ze)|0,wt=wt+Math.imul(me,tr)|0,wt=wt+Math.imul(Lt,Ze)|0,xt=xt+Math.imul(Lt,tr)|0,Dt=Dt+Math.imul(fr,dr)|0,wt=wt+Math.imul(fr,br)|0,wt=wt+Math.imul(ue,dr)|0,xt=xt+Math.imul(ue,br)|0,Dt=Dt+Math.imul(ar,Er)|0,wt=wt+Math.imul(ar,_r)|0,wt=wt+Math.imul(cr,Er)|0,xt=xt+Math.imul(cr,_r)|0,Dt=Dt+Math.imul(Qe,Ar)|0,wt=wt+Math.imul(Qe,Zt)|0,wt=wt+Math.imul(We,Ar)|0,xt=xt+Math.imul(We,Zt)|0,Dt=Dt+Math.imul(Ie,Jt)|0,wt=wt+Math.imul(Ie,Ue)|0,wt=wt+Math.imul(Xe,Jt)|0,xt=xt+Math.imul(Xe,Ue)|0,Dt=Dt+Math.imul(jt,sr)|0,wt=wt+Math.imul(jt,hr)|0,wt=wt+Math.imul(qt,sr)|0,xt=xt+Math.imul(qt,hr)|0,Dt=Dt+Math.imul(Pe,mr)|0,wt=wt+Math.imul(Pe,vr)|0,wt=wt+Math.imul(Ht,mr)|0,xt=xt+Math.imul(Ht,vr)|0;var Mr=(St+Dt|0)+((wt&8191)<<13)|0;St=(xt+(wt>>>13)|0)+(Mr>>>26)|0,Mr&=67108863,Dt=Math.imul(ir,Kt),wt=Math.imul(ir,$e),wt=wt+Math.imul(vt,Kt)|0,xt=Math.imul(vt,$e),Dt=Dt+Math.imul(Xt,Ze)|0,wt=wt+Math.imul(Xt,tr)|0,wt=wt+Math.imul(Yt,Ze)|0,xt=xt+Math.imul(Yt,tr)|0,Dt=Dt+Math.imul(me,dr)|0,wt=wt+Math.imul(me,br)|0,wt=wt+Math.imul(Lt,dr)|0,xt=xt+Math.imul(Lt,br)|0,Dt=Dt+Math.imul(fr,Er)|0,wt=wt+Math.imul(fr,_r)|0,wt=wt+Math.imul(ue,Er)|0,xt=xt+Math.imul(ue,_r)|0,Dt=Dt+Math.imul(ar,Ar)|0,wt=wt+Math.imul(ar,Zt)|0,wt=wt+Math.imul(cr,Ar)|0,xt=xt+Math.imul(cr,Zt)|0,Dt=Dt+Math.imul(Qe,Jt)|0,wt=wt+Math.imul(Qe,Ue)|0,wt=wt+Math.imul(We,Jt)|0,xt=xt+Math.imul(We,Ue)|0,Dt=Dt+Math.imul(Ie,sr)|0,wt=wt+Math.imul(Ie,hr)|0,wt=wt+Math.imul(Xe,sr)|0,xt=xt+Math.imul(Xe,hr)|0,Dt=Dt+Math.imul(jt,mr)|0,wt=wt+Math.imul(jt,vr)|0,wt=wt+Math.imul(qt,mr)|0,xt=xt+Math.imul(qt,vr)|0,Dt=Dt+Math.imul(Pe,wr)|0,wt=wt+Math.imul(Pe,Sr)|0,wt=wt+Math.imul(Ht,wr)|0,xt=xt+Math.imul(Ht,Sr)|0;var Nr=(St+Dt|0)+((wt&8191)<<13)|0;St=(xt+(wt>>>13)|0)+(Nr>>>26)|0,Nr&=67108863,Dt=Math.imul(Bt,Kt),wt=Math.imul(Bt,$e),wt=wt+Math.imul(Nt,Kt)|0,xt=Math.imul(Nt,$e),Dt=Dt+Math.imul(ir,Ze)|0,wt=wt+Math.imul(ir,tr)|0,wt=wt+Math.imul(vt,Ze)|0,xt=xt+Math.imul(vt,tr)|0,Dt=Dt+Math.imul(Xt,dr)|0,wt=wt+Math.imul(Xt,br)|0,wt=wt+Math.imul(Yt,dr)|0,xt=xt+Math.imul(Yt,br)|0,Dt=Dt+Math.imul(me,Er)|0,wt=wt+Math.imul(me,_r)|0,wt=wt+Math.imul(Lt,Er)|0,xt=xt+Math.imul(Lt,_r)|0,Dt=Dt+Math.imul(fr,Ar)|0,wt=wt+Math.imul(fr,Zt)|0,wt=wt+Math.imul(ue,Ar)|0,xt=xt+Math.imul(ue,Zt)|0,Dt=Dt+Math.imul(ar,Jt)|0,wt=wt+Math.imul(ar,Ue)|0,wt=wt+Math.imul(cr,Jt)|0,xt=xt+Math.imul(cr,Ue)|0,Dt=Dt+Math.imul(Qe,sr)|0,wt=wt+Math.imul(Qe,hr)|0,wt=wt+Math.imul(We,sr)|0,xt=xt+Math.imul(We,hr)|0,Dt=Dt+Math.imul(Ie,mr)|0,wt=wt+Math.imul(Ie,vr)|0,wt=wt+Math.imul(Xe,mr)|0,xt=xt+Math.imul(Xe,vr)|0,Dt=Dt+Math.imul(jt,wr)|0,wt=wt+Math.imul(jt,Sr)|0,wt=wt+Math.imul(qt,wr)|0,xt=xt+Math.imul(qt,Sr)|0,Dt=Dt+Math.imul(Pe,Ir)|0,wt=wt+Math.imul(Pe,Br)|0,wt=wt+Math.imul(Ht,Ir)|0,xt=xt+Math.imul(Ht,Br)|0;var Fr=(St+Dt|0)+((wt&8191)<<13)|0;St=(xt+(wt>>>13)|0)+(Fr>>>26)|0,Fr&=67108863,Dt=Math.imul(Bt,Ze),wt=Math.imul(Bt,tr),wt=wt+Math.imul(Nt,Ze)|0,xt=Math.imul(Nt,tr),Dt=Dt+Math.imul(ir,dr)|0,wt=wt+Math.imul(ir,br)|0,wt=wt+Math.imul(vt,dr)|0,xt=xt+Math.imul(vt,br)|0,Dt=Dt+Math.imul(Xt,Er)|0,wt=wt+Math.imul(Xt,_r)|0,wt=wt+Math.imul(Yt,Er)|0,xt=xt+Math.imul(Yt,_r)|0,Dt=Dt+Math.imul(me,Ar)|0,wt=wt+Math.imul(me,Zt)|0,wt=wt+Math.imul(Lt,Ar)|0,xt=xt+Math.imul(Lt,Zt)|0,Dt=Dt+Math.imul(fr,Jt)|0,wt=wt+Math.imul(fr,Ue)|0,wt=wt+Math.imul(ue,Jt)|0,xt=xt+Math.imul(ue,Ue)|0,Dt=Dt+Math.imul(ar,sr)|0,wt=wt+Math.imul(ar,hr)|0,wt=wt+Math.imul(cr,sr)|0,xt=xt+Math.imul(cr,hr)|0,Dt=Dt+Math.imul(Qe,mr)|0,wt=wt+Math.imul(Qe,vr)|0,wt=wt+Math.imul(We,mr)|0,xt=xt+Math.imul(We,vr)|0,Dt=Dt+Math.imul(Ie,wr)|0,wt=wt+Math.imul(Ie,Sr)|0,wt=wt+Math.imul(Xe,wr)|0,xt=xt+Math.imul(Xe,Sr)|0,Dt=Dt+Math.imul(jt,Ir)|0,wt=wt+Math.imul(jt,Br)|0,wt=wt+Math.imul(qt,Ir)|0,xt=xt+Math.imul(qt,Br)|0;var Vr=(St+Dt|0)+((wt&8191)<<13)|0;St=(xt+(wt>>>13)|0)+(Vr>>>26)|0,Vr&=67108863,Dt=Math.imul(Bt,dr),wt=Math.imul(Bt,br),wt=wt+Math.imul(Nt,dr)|0,xt=Math.imul(Nt,br),Dt=Dt+Math.imul(ir,Er)|0,wt=wt+Math.imul(ir,_r)|0,wt=wt+Math.imul(vt,Er)|0,xt=xt+Math.imul(vt,_r)|0,Dt=Dt+Math.imul(Xt,Ar)|0,wt=wt+Math.imul(Xt,Zt)|0,wt=wt+Math.imul(Yt,Ar)|0,xt=xt+Math.imul(Yt,Zt)|0,Dt=Dt+Math.imul(me,Jt)|0,wt=wt+Math.imul(me,Ue)|0,wt=wt+Math.imul(Lt,Jt)|0,xt=xt+Math.imul(Lt,Ue)|0,Dt=Dt+Math.imul(fr,sr)|0,wt=wt+Math.imul(fr,hr)|0,wt=wt+Math.imul(ue,sr)|0,xt=xt+Math.imul(ue,hr)|0,Dt=Dt+Math.imul(ar,mr)|0,wt=wt+Math.imul(ar,vr)|0,wt=wt+Math.imul(cr,mr)|0,xt=xt+Math.imul(cr,vr)|0,Dt=Dt+Math.imul(Qe,wr)|0,wt=wt+Math.imul(Qe,Sr)|0,wt=wt+Math.imul(We,wr)|0,xt=xt+Math.imul(We,Sr)|0,Dt=Dt+Math.imul(Ie,Ir)|0,wt=wt+Math.imul(Ie,Br)|0,wt=wt+Math.imul(Xe,Ir)|0,xt=xt+Math.imul(Xe,Br)|0;var zr=(St+Dt|0)+((wt&8191)<<13)|0;St=(xt+(wt>>>13)|0)+(zr>>>26)|0,zr&=67108863,Dt=Math.imul(Bt,Er),wt=Math.imul(Bt,_r),wt=wt+Math.imul(Nt,Er)|0,xt=Math.imul(Nt,_r),Dt=Dt+Math.imul(ir,Ar)|0,wt=wt+Math.imul(ir,Zt)|0,wt=wt+Math.imul(vt,Ar)|0,xt=xt+Math.imul(vt,Zt)|0,Dt=Dt+Math.imul(Xt,Jt)|0,wt=wt+Math.imul(Xt,Ue)|0,wt=wt+Math.imul(Yt,Jt)|0,xt=xt+Math.imul(Yt,Ue)|0,Dt=Dt+Math.imul(me,sr)|0,wt=wt+Math.imul(me,hr)|0,wt=wt+Math.imul(Lt,sr)|0,xt=xt+Math.imul(Lt,hr)|0,Dt=Dt+Math.imul(fr,mr)|0,wt=wt+Math.imul(fr,vr)|0,wt=wt+Math.imul(ue,mr)|0,xt=xt+Math.imul(ue,vr)|0,Dt=Dt+Math.imul(ar,wr)|0,wt=wt+Math.imul(ar,Sr)|0,wt=wt+Math.imul(cr,wr)|0,xt=xt+Math.imul(cr,Sr)|0,Dt=Dt+Math.imul(Qe,Ir)|0,wt=wt+Math.imul(Qe,Br)|0,wt=wt+Math.imul(We,Ir)|0,xt=xt+Math.imul(We,Br)|0;var Hr=(St+Dt|0)+((wt&8191)<<13)|0;St=(xt+(wt>>>13)|0)+(Hr>>>26)|0,Hr&=67108863,Dt=Math.imul(Bt,Ar),wt=Math.imul(Bt,Zt),wt=wt+Math.imul(Nt,Ar)|0,xt=Math.imul(Nt,Zt),Dt=Dt+Math.imul(ir,Jt)|0,wt=wt+Math.imul(ir,Ue)|0,wt=wt+Math.imul(vt,Jt)|0,xt=xt+Math.imul(vt,Ue)|0,Dt=Dt+Math.imul(Xt,sr)|0,wt=wt+Math.imul(Xt,hr)|0,wt=wt+Math.imul(Yt,sr)|0,xt=xt+Math.imul(Yt,hr)|0,Dt=Dt+Math.imul(me,mr)|0,wt=wt+Math.imul(me,vr)|0,wt=wt+Math.imul(Lt,mr)|0,xt=xt+Math.imul(Lt,vr)|0,Dt=Dt+Math.imul(fr,wr)|0,wt=wt+Math.imul(fr,Sr)|0,wt=wt+Math.imul(ue,wr)|0,xt=xt+Math.imul(ue,Sr)|0,Dt=Dt+Math.imul(ar,Ir)|0,wt=wt+Math.imul(ar,Br)|0,wt=wt+Math.imul(cr,Ir)|0,xt=xt+Math.imul(cr,Br)|0;var Gr=(St+Dt|0)+((wt&8191)<<13)|0;St=(xt+(wt>>>13)|0)+(Gr>>>26)|0,Gr&=67108863,Dt=Math.imul(Bt,Jt),wt=Math.imul(Bt,Ue),wt=wt+Math.imul(Nt,Jt)|0,xt=Math.imul(Nt,Ue),Dt=Dt+Math.imul(ir,sr)|0,wt=wt+Math.imul(ir,hr)|0,wt=wt+Math.imul(vt,sr)|0,xt=xt+Math.imul(vt,hr)|0,Dt=Dt+Math.imul(Xt,mr)|0,wt=wt+Math.imul(Xt,vr)|0,wt=wt+Math.imul(Yt,mr)|0,xt=xt+Math.imul(Yt,vr)|0,Dt=Dt+Math.imul(me,wr)|0,wt=wt+Math.imul(me,Sr)|0,wt=wt+Math.imul(Lt,wr)|0,xt=xt+Math.imul(Lt,Sr)|0,Dt=Dt+Math.imul(fr,Ir)|0,wt=wt+Math.imul(fr,Br)|0,wt=wt+Math.imul(ue,Ir)|0,xt=xt+Math.imul(ue,Br)|0;var Wr=(St+Dt|0)+((wt&8191)<<13)|0;St=(xt+(wt>>>13)|0)+(Wr>>>26)|0,Wr&=67108863,Dt=Math.imul(Bt,sr),wt=Math.imul(Bt,hr),wt=wt+Math.imul(Nt,sr)|0,xt=Math.imul(Nt,hr),Dt=Dt+Math.imul(ir,mr)|0,wt=wt+Math.imul(ir,vr)|0,wt=wt+Math.imul(vt,mr)|0,xt=xt+Math.imul(vt,vr)|0,Dt=Dt+Math.imul(Xt,wr)|0,wt=wt+Math.imul(Xt,Sr)|0,wt=wt+Math.imul(Yt,wr)|0,xt=xt+Math.imul(Yt,Sr)|0,Dt=Dt+Math.imul(me,Ir)|0,wt=wt+Math.imul(me,Br)|0,wt=wt+Math.imul(Lt,Ir)|0,xt=xt+Math.imul(Lt,Br)|0;var Yr=(St+Dt|0)+((wt&8191)<<13)|0;St=(xt+(wt>>>13)|0)+(Yr>>>26)|0,Yr&=67108863,Dt=Math.imul(Bt,mr),wt=Math.imul(Bt,vr),wt=wt+Math.imul(Nt,mr)|0,xt=Math.imul(Nt,vr),Dt=Dt+Math.imul(ir,wr)|0,wt=wt+Math.imul(ir,Sr)|0,wt=wt+Math.imul(vt,wr)|0,xt=xt+Math.imul(vt,Sr)|0,Dt=Dt+Math.imul(Xt,Ir)|0,wt=wt+Math.imul(Xt,Br)|0,wt=wt+Math.imul(Yt,Ir)|0,xt=xt+Math.imul(Yt,Br)|0;var Xr=(St+Dt|0)+((wt&8191)<<13)|0;St=(xt+(wt>>>13)|0)+(Xr>>>26)|0,Xr&=67108863,Dt=Math.imul(Bt,wr),wt=Math.imul(Bt,Sr),wt=wt+Math.imul(Nt,wr)|0,xt=Math.imul(Nt,Sr),Dt=Dt+Math.imul(ir,Ir)|0,wt=wt+Math.imul(ir,Br)|0,wt=wt+Math.imul(vt,Ir)|0,xt=xt+Math.imul(vt,Br)|0;var Qr=(St+Dt|0)+((wt&8191)<<13)|0;St=(xt+(wt>>>13)|0)+(Qr>>>26)|0,Qr&=67108863,Dt=Math.imul(Bt,Ir),wt=Math.imul(Bt,Br),wt=wt+Math.imul(Nt,Ir)|0,xt=Math.imul(Nt,Br);var Jr=(St+Dt|0)+((wt&8191)<<13)|0;return St=(xt+(wt>>>13)|0)+(Jr>>>26)|0,Jr&=67108863,Pt[0]=qr,Pt[1]=Le,Pt[2]=yr,Pt[3]=pr,Pt[4]=kr,Pt[5]=Dr,Pt[6]=Or,Pt[7]=Mr,Pt[8]=Nr,Pt[9]=Fr,Pt[10]=Vr,Pt[11]=zr,Pt[12]=Hr,Pt[13]=Gr,Pt[14]=Wr,Pt[15]=Yr,Pt[16]=Xr,Pt[17]=Qr,Pt[18]=Jr,St!==0&&(Pt[19]=St,$t.length++),$t};Math.imul||(gt=pt);function _t(bt,yt,$t){$t.negative=yt.negative^bt.negative,$t.length=bt.length+yt.length;for(var Et=0,Tt=0,Pt=0;Pt<$t.length-1;Pt++){var St=Tt;Tt=0;for(var Dt=Et&67108863,wt=Math.min(Pt,yt.length-1),xt=Math.max(0,Pt-bt.length+1);xt<=wt;xt++){var Ke=Pt-xt,Pe=bt.words[Ke]|0,Ht=yt.words[xt]|0,zt=Pe*Ht,jt=zt&67108863;St=St+(zt/67108864|0)|0,jt=jt+Dt|0,Dt=jt&67108863,St=St+(jt>>>26)|0,Tt+=St>>>26,St&=67108863}$t.words[Pt]=Dt,Et=St,St=Tt}return Et!==0?$t.words[Pt]=Et:$t.length--,$t.strip()}function mt(bt,yt,$t){var Et=new At;return Et.mulp(bt,yt,$t)}ot.prototype.mulTo=function(bt,yt){var $t,Et=this.length+bt.length;return this.length===10&&bt.length===10?$t=gt(this,bt,yt):Et<63?$t=pt(this,bt,yt):Et<1024?$t=_t(this,bt,yt):$t=mt(this,bt,yt),$t};function At(bt,yt){this.x=bt,this.y=yt}At.prototype.makeRBT=function(bt){for(var yt=new Array(bt),$t=ot.prototype._countBits(bt)-1,Et=0;Et<bt;Et++)yt[Et]=this.revBin(Et,$t,bt);return yt},At.prototype.revBin=function(bt,yt,$t){if(bt===0||bt===$t-1)return bt;for(var Et=0,Tt=0;Tt<yt;Tt++)Et|=(bt&1)<<yt-Tt-1,bt>>=1;return Et},At.prototype.permute=function(bt,yt,$t,Et,Tt,Pt){for(var St=0;St<Pt;St++)Et[St]=yt[bt[St]],Tt[St]=$t[bt[St]]},At.prototype.transform=function(bt,yt,$t,Et,Tt,Pt){this.permute(Pt,bt,yt,$t,Et,Tt);for(var St=1;St<Tt;St<<=1)for(var Dt=St<<1,wt=Math.cos(2*Math.PI/Dt),xt=Math.sin(2*Math.PI/Dt),Ke=0;Ke<Tt;Ke+=Dt)for(var Pe=wt,Ht=xt,zt=0;zt<St;zt++){var jt=$t[Ke+zt],qt=Et[Ke+zt],Ge=$t[Ke+zt+St],Ie=Et[Ke+zt+St],Xe=Pe*Ge-Ht*Ie;Ie=Pe*Ie+Ht*Ge,Ge=Xe,$t[Ke+zt]=jt+Ge,Et[Ke+zt]=qt+Ie,$t[Ke+zt+St]=jt-Ge,Et[Ke+zt+St]=qt-Ie,zt!==Dt&&(Xe=wt*Pe-xt*Ht,Ht=wt*Ht+xt*Pe,Pe=Xe)}},At.prototype.guessLen13b=function(bt,yt){var $t=Math.max(yt,bt)|1,Et=$t&1,Tt=0;for($t=$t/2|0;$t;$t=$t>>>1)Tt++;return 1<<Tt+1+Et},At.prototype.conjugate=function(bt,yt,$t){if(!($t<=1))for(var Et=0;Et<$t/2;Et++){var Tt=bt[Et];bt[Et]=bt[$t-Et-1],bt[$t-Et-1]=Tt,Tt=yt[Et],yt[Et]=-yt[$t-Et-1],yt[$t-Et-1]=-Tt}},At.prototype.normalize13b=function(bt,yt){for(var $t=0,Et=0;Et<yt/2;Et++){var Tt=Math.round(bt[2*Et+1]/yt)*8192+Math.round(bt[2*Et]/yt)+$t;bt[Et]=Tt&67108863,Tt<67108864?$t=0:$t=Tt/67108864|0}return bt},At.prototype.convert13b=function(bt,yt,$t,Et){for(var Tt=0,Pt=0;Pt<yt;Pt++)Tt=Tt+(bt[Pt]|0),$t[2*Pt]=Tt&8191,Tt=Tt>>>13,$t[2*Pt+1]=Tt&8191,Tt=Tt>>>13;for(Pt=2*yt;Pt<Et;++Pt)$t[Pt]=0;nt(Tt===0),nt((Tt&-8192)===0)},At.prototype.stub=function(bt){for(var yt=new Array(bt),$t=0;$t<bt;$t++)yt[$t]=0;return yt},At.prototype.mulp=function(bt,yt,$t){var Et=2*this.guessLen13b(bt.length,yt.length),Tt=this.makeRBT(Et),Pt=this.stub(Et),St=new Array(Et),Dt=new Array(Et),wt=new Array(Et),xt=new Array(Et),Ke=new Array(Et),Pe=new Array(Et),Ht=$t.words;Ht.length=Et,this.convert13b(bt.words,bt.length,St,Et),this.convert13b(yt.words,yt.length,xt,Et),this.transform(St,Pt,Dt,wt,Et,Tt),this.transform(xt,Pt,Ke,Pe,Et,Tt);for(var zt=0;zt<Et;zt++){var jt=Dt[zt]*Ke[zt]-wt[zt]*Pe[zt];wt[zt]=Dt[zt]*Pe[zt]+wt[zt]*Ke[zt],Dt[zt]=jt}return this.conjugate(Dt,wt,Et),this.transform(Dt,wt,Ht,Pt,Et,Tt),this.conjugate(Ht,Pt,Et),this.normalize13b(Ht,Et),$t.negative=bt.negative^yt.negative,$t.length=bt.length+yt.length,$t.strip()},ot.prototype.mul=function(bt){var yt=new ot(null);return yt.words=new Array(this.length+bt.length),this.mulTo(bt,yt)},ot.prototype.mulf=function(bt){var yt=new ot(null);return yt.words=new Array(this.length+bt.length),mt(this,bt,yt)},ot.prototype.imul=function(bt){return this.clone().mulTo(bt,this)},ot.prototype.imuln=function(bt){nt(typeof bt=="number"),nt(bt<67108864);for(var yt=0,$t=0;$t<this.length;$t++){var Et=(this.words[$t]|0)*bt,Tt=(Et&67108863)+(yt&67108863);yt>>=26,yt+=Et/67108864|0,yt+=Tt>>>26,this.words[$t]=Tt&67108863}return yt!==0&&(this.words[$t]=yt,this.length++),this},ot.prototype.muln=function(bt){return this.clone().imuln(bt)},ot.prototype.sqr=function(){return this.mul(this)},ot.prototype.isqr=function(){return this.imul(this.clone())},ot.prototype.pow=function(bt){var yt=dt(bt);if(yt.length===0)return new ot(1);for(var $t=this,Et=0;Et<yt.length&&yt[Et]===0;Et++,$t=$t.sqr());if(++Et<yt.length)for(var Tt=$t.sqr();Et<yt.length;Et++,Tt=Tt.sqr())yt[Et]!==0&&($t=$t.mul(Tt));return $t},ot.prototype.iushln=function(bt){nt(typeof bt=="number"&&bt>=0);var yt=bt%26,$t=(bt-yt)/26,Et=67108863>>>26-yt<<26-yt,Tt;if(yt!==0){var Pt=0;for(Tt=0;Tt<this.length;Tt++){var St=this.words[Tt]&Et,Dt=(this.words[Tt]|0)-St<<yt;this.words[Tt]=Dt|Pt,Pt=St>>>26-yt}Pt&&(this.words[Tt]=Pt,this.length++)}if($t!==0){for(Tt=this.length-1;Tt>=0;Tt--)this.words[Tt+$t]=this.words[Tt];for(Tt=0;Tt<$t;Tt++)this.words[Tt]=0;this.length+=$t}return this.strip()},ot.prototype.ishln=function(bt){return nt(this.negative===0),this.iushln(bt)},ot.prototype.iushrn=function(bt,yt,$t){nt(typeof bt=="number"&&bt>=0);var Et;yt?Et=(yt-yt%26)/26:Et=0;var Tt=bt%26,Pt=Math.min((bt-Tt)/26,this.length),St=67108863^67108863>>>Tt<<Tt,Dt=$t;if(Et-=Pt,Et=Math.max(0,Et),Dt){for(var wt=0;wt<Pt;wt++)Dt.words[wt]=this.words[wt];Dt.length=Pt}if(Pt!==0)if(this.length>Pt)for(this.length-=Pt,wt=0;wt<this.length;wt++)this.words[wt]=this.words[wt+Pt];else this.words[0]=0,this.length=1;var xt=0;for(wt=this.length-1;wt>=0&&(xt!==0||wt>=Et);wt--){var Ke=this.words[wt]|0;this.words[wt]=xt<<26-Tt|Ke>>>Tt,xt=Ke&St}return Dt&&xt!==0&&(Dt.words[Dt.length++]=xt),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},ot.prototype.ishrn=function(bt,yt,$t){return nt(this.negative===0),this.iushrn(bt,yt,$t)},ot.prototype.shln=function(bt){return this.clone().ishln(bt)},ot.prototype.ushln=function(bt){return this.clone().iushln(bt)},ot.prototype.shrn=function(bt){return this.clone().ishrn(bt)},ot.prototype.ushrn=function(bt){return this.clone().iushrn(bt)},ot.prototype.testn=function(bt){nt(typeof bt=="number"&&bt>=0);var yt=bt%26,$t=(bt-yt)/26,Et=1<<yt;if(this.length<=$t)return!1;var Tt=this.words[$t];return!!(Tt&Et)},ot.prototype.imaskn=function(bt){nt(typeof bt=="number"&&bt>=0);var yt=bt%26,$t=(bt-yt)/26;if(nt(this.negative===0,"imaskn works only with positive numbers"),this.length<=$t)return this;if(yt!==0&&$t++,this.length=Math.min($t,this.length),yt!==0){var Et=67108863^67108863>>>yt<<yt;this.words[this.length-1]&=Et}return this.strip()},ot.prototype.maskn=function(bt){return this.clone().imaskn(bt)},ot.prototype.iaddn=function(bt){return nt(typeof bt=="number"),nt(bt<67108864),bt<0?this.isubn(-bt):this.negative!==0?this.length===1&&(this.words[0]|0)<bt?(this.words[0]=bt-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(bt),this.negative=1,this):this._iaddn(bt)},ot.prototype._iaddn=function(bt){this.words[0]+=bt;for(var yt=0;yt<this.length&&this.words[yt]>=67108864;yt++)this.words[yt]-=67108864,yt===this.length-1?this.words[yt+1]=1:this.words[yt+1]++;return this.length=Math.max(this.length,yt+1),this},ot.prototype.isubn=function(bt){if(nt(typeof bt=="number"),nt(bt<67108864),bt<0)return this.iaddn(-bt);if(this.negative!==0)return this.negative=0,this.iaddn(bt),this.negative=1,this;if(this.words[0]-=bt,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var yt=0;yt<this.length&&this.words[yt]<0;yt++)this.words[yt]+=67108864,this.words[yt+1]-=1;return this.strip()},ot.prototype.addn=function(bt){return this.clone().iaddn(bt)},ot.prototype.subn=function(bt){return this.clone().isubn(bt)},ot.prototype.iabs=function(){return this.negative=0,this},ot.prototype.abs=function(){return this.clone().iabs()},ot.prototype._ishlnsubmul=function(bt,yt,$t){var Et=bt.length+$t,Tt;this._expand(Et);var Pt,St=0;for(Tt=0;Tt<bt.length;Tt++){Pt=(this.words[Tt+$t]|0)+St;var Dt=(bt.words[Tt]|0)*yt;Pt-=Dt&67108863,St=(Pt>>26)-(Dt/67108864|0),this.words[Tt+$t]=Pt&67108863}for(;Tt<this.length-$t;Tt++)Pt=(this.words[Tt+$t]|0)+St,St=Pt>>26,this.words[Tt+$t]=Pt&67108863;if(St===0)return this.strip();for(nt(St===-1),St=0,Tt=0;Tt<this.length;Tt++)Pt=-(this.words[Tt]|0)+St,St=Pt>>26,this.words[Tt]=Pt&67108863;return this.negative=1,this.strip()},ot.prototype._wordDiv=function(bt,yt){var $t=this.length-bt.length,Et=this.clone(),Tt=bt,Pt=Tt.words[Tt.length-1]|0,St=this._countBits(Pt);$t=26-St,$t!==0&&(Tt=Tt.ushln($t),Et.iushln($t),Pt=Tt.words[Tt.length-1]|0);var Dt=Et.length-Tt.length,wt;if(yt!=="mod"){wt=new ot(null),wt.length=Dt+1,wt.words=new Array(wt.length);for(var xt=0;xt<wt.length;xt++)wt.words[xt]=0}var Ke=Et.clone()._ishlnsubmul(Tt,1,Dt);Ke.negative===0&&(Et=Ke,wt&&(wt.words[Dt]=1));for(var Pe=Dt-1;Pe>=0;Pe--){var Ht=(Et.words[Tt.length+Pe]|0)*67108864+(Et.words[Tt.length+Pe-1]|0);for(Ht=Math.min(Ht/Pt|0,67108863),Et._ishlnsubmul(Tt,Ht,Pe);Et.negative!==0;)Ht--,Et.negative=0,Et._ishlnsubmul(Tt,1,Pe),Et.isZero()||(Et.negative^=1);wt&&(wt.words[Pe]=Ht)}return wt&&wt.strip(),Et.strip(),yt!=="div"&&$t!==0&&Et.iushrn($t),{div:wt||null,mod:Et}},ot.prototype.divmod=function(bt,yt,$t){if(nt(!bt.isZero()),this.isZero())return{div:new ot(0),mod:new ot(0)};var Et,Tt,Pt;return this.negative!==0&&bt.negative===0?(Pt=this.neg().divmod(bt,yt),yt!=="mod"&&(Et=Pt.div.neg()),yt!=="div"&&(Tt=Pt.mod.neg(),$t&&Tt.negative!==0&&Tt.iadd(bt)),{div:Et,mod:Tt}):this.negative===0&&bt.negative!==0?(Pt=this.divmod(bt.neg(),yt),yt!=="mod"&&(Et=Pt.div.neg()),{div:Et,mod:Pt.mod}):this.negative&bt.negative?(Pt=this.neg().divmod(bt.neg(),yt),yt!=="div"&&(Tt=Pt.mod.neg(),$t&&Tt.negative!==0&&Tt.isub(bt)),{div:Pt.div,mod:Tt}):bt.length>this.length||this.cmp(bt)<0?{div:new ot(0),mod:this}:bt.length===1?yt==="div"?{div:this.divn(bt.words[0]),mod:null}:yt==="mod"?{div:null,mod:new ot(this.modn(bt.words[0]))}:{div:this.divn(bt.words[0]),mod:new ot(this.modn(bt.words[0]))}:this._wordDiv(bt,yt)},ot.prototype.div=function(bt){return this.divmod(bt,"div",!1).div},ot.prototype.mod=function(bt){return this.divmod(bt,"mod",!1).mod},ot.prototype.umod=function(bt){return this.divmod(bt,"mod",!0).mod},ot.prototype.divRound=function(bt){var yt=this.divmod(bt);if(yt.mod.isZero())return yt.div;var $t=yt.div.negative!==0?yt.mod.isub(bt):yt.mod,Et=bt.ushrn(1),Tt=bt.andln(1),Pt=$t.cmp(Et);return Pt<0||Tt===1&&Pt===0?yt.div:yt.div.negative!==0?yt.div.isubn(1):yt.div.iaddn(1)},ot.prototype.modn=function(bt){nt(bt<=67108863);for(var yt=(1<<26)%bt,$t=0,Et=this.length-1;Et>=0;Et--)$t=(yt*$t+(this.words[Et]|0))%bt;return $t},ot.prototype.idivn=function(bt){nt(bt<=67108863);for(var yt=0,$t=this.length-1;$t>=0;$t--){var Et=(this.words[$t]|0)+yt*67108864;this.words[$t]=Et/bt|0,yt=Et%bt}return this.strip()},ot.prototype.divn=function(bt){return this.clone().idivn(bt)},ot.prototype.egcd=function(bt){nt(bt.negative===0),nt(!bt.isZero());var yt=this,$t=bt.clone();yt.negative!==0?yt=yt.umod(bt):yt=yt.clone();for(var Et=new ot(1),Tt=new ot(0),Pt=new ot(0),St=new ot(1),Dt=0;yt.isEven()&&$t.isEven();)yt.iushrn(1),$t.iushrn(1),++Dt;for(var wt=$t.clone(),xt=yt.clone();!yt.isZero();){for(var Ke=0,Pe=1;!(yt.words[0]&Pe)&&Ke<26;++Ke,Pe<<=1);if(Ke>0)for(yt.iushrn(Ke);Ke-- >0;)(Et.isOdd()||Tt.isOdd())&&(Et.iadd(wt),Tt.isub(xt)),Et.iushrn(1),Tt.iushrn(1);for(var Ht=0,zt=1;!($t.words[0]&zt)&&Ht<26;++Ht,zt<<=1);if(Ht>0)for($t.iushrn(Ht);Ht-- >0;)(Pt.isOdd()||St.isOdd())&&(Pt.iadd(wt),St.isub(xt)),Pt.iushrn(1),St.iushrn(1);yt.cmp($t)>=0?(yt.isub($t),Et.isub(Pt),Tt.isub(St)):($t.isub(yt),Pt.isub(Et),St.isub(Tt))}return{a:Pt,b:St,gcd:$t.iushln(Dt)}},ot.prototype._invmp=function(bt){nt(bt.negative===0),nt(!bt.isZero());var yt=this,$t=bt.clone();yt.negative!==0?yt=yt.umod(bt):yt=yt.clone();for(var Et=new ot(1),Tt=new ot(0),Pt=$t.clone();yt.cmpn(1)>0&&$t.cmpn(1)>0;){for(var St=0,Dt=1;!(yt.words[0]&Dt)&&St<26;++St,Dt<<=1);if(St>0)for(yt.iushrn(St);St-- >0;)Et.isOdd()&&Et.iadd(Pt),Et.iushrn(1);for(var wt=0,xt=1;!($t.words[0]&xt)&&wt<26;++wt,xt<<=1);if(wt>0)for($t.iushrn(wt);wt-- >0;)Tt.isOdd()&&Tt.iadd(Pt),Tt.iushrn(1);yt.cmp($t)>=0?(yt.isub($t),Et.isub(Tt)):($t.isub(yt),Tt.isub(Et))}var Ke;return yt.cmpn(1)===0?Ke=Et:Ke=Tt,Ke.cmpn(0)<0&&Ke.iadd(bt),Ke},ot.prototype.gcd=function(bt){if(this.isZero())return bt.abs();if(bt.isZero())return this.abs();var yt=this.clone(),$t=bt.clone();yt.negative=0,$t.negative=0;for(var Et=0;yt.isEven()&&$t.isEven();Et++)yt.iushrn(1),$t.iushrn(1);do{for(;yt.isEven();)yt.iushrn(1);for(;$t.isEven();)$t.iushrn(1);var Tt=yt.cmp($t);if(Tt<0){var Pt=yt;yt=$t,$t=Pt}else if(Tt===0||$t.cmpn(1)===0)break;yt.isub($t)}while(!0);return $t.iushln(Et)},ot.prototype.invm=function(bt){return this.egcd(bt).a.umod(bt)},ot.prototype.isEven=function(){return(this.words[0]&1)===0},ot.prototype.isOdd=function(){return(this.words[0]&1)===1},ot.prototype.andln=function(bt){return this.words[0]&bt},ot.prototype.bincn=function(bt){nt(typeof bt=="number");var yt=bt%26,$t=(bt-yt)/26,Et=1<<yt;if(this.length<=$t)return this._expand($t+1),this.words[$t]|=Et,this;for(var Tt=Et,Pt=$t;Tt!==0&&Pt<this.length;Pt++){var St=this.words[Pt]|0;St+=Tt,Tt=St>>>26,St&=67108863,this.words[Pt]=St}return Tt!==0&&(this.words[Pt]=Tt,this.length++),this},ot.prototype.isZero=function(){return this.length===1&&this.words[0]===0},ot.prototype.cmpn=function(bt){var yt=bt<0;if(this.negative!==0&&!yt)return-1;if(this.negative===0&&yt)return 1;this.strip();var $t;if(this.length>1)$t=1;else{yt&&(bt=-bt),nt(bt<=67108863,"Number is too big");var Et=this.words[0]|0;$t=Et===bt?0:Et<bt?-1:1}return this.negative!==0?-$t|0:$t},ot.prototype.cmp=function(bt){if(this.negative!==0&&bt.negative===0)return-1;if(this.negative===0&&bt.negative!==0)return 1;var yt=this.ucmp(bt);return this.negative!==0?-yt|0:yt},ot.prototype.ucmp=function(bt){if(this.length>bt.length)return 1;if(this.length<bt.length)return-1;for(var yt=0,$t=this.length-1;$t>=0;$t--){var Et=this.words[$t]|0,Tt=bt.words[$t]|0;if(Et!==Tt){Et<Tt?yt=-1:Et>Tt&&(yt=1);break}}return yt},ot.prototype.gtn=function(bt){return this.cmpn(bt)===1},ot.prototype.gt=function(bt){return this.cmp(bt)===1},ot.prototype.gten=function(bt){return this.cmpn(bt)>=0},ot.prototype.gte=function(bt){return this.cmp(bt)>=0},ot.prototype.ltn=function(bt){return this.cmpn(bt)===-1},ot.prototype.lt=function(bt){return this.cmp(bt)===-1},ot.prototype.lten=function(bt){return this.cmpn(bt)<=0},ot.prototype.lte=function(bt){return this.cmp(bt)<=0},ot.prototype.eqn=function(bt){return this.cmpn(bt)===0},ot.prototype.eq=function(bt){return this.cmp(bt)===0},ot.red=function(bt){return new Ft(bt)},ot.prototype.toRed=function(bt){return nt(!this.red,"Already a number in reduction context"),nt(this.negative===0,"red works only with positives"),bt.convertTo(this)._forceRed(bt)},ot.prototype.fromRed=function(){return nt(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},ot.prototype._forceRed=function(bt){return this.red=bt,this},ot.prototype.forceRed=function(bt){return nt(!this.red,"Already a number in reduction context"),this._forceRed(bt)},ot.prototype.redAdd=function(bt){return nt(this.red,"redAdd works only with red numbers"),this.red.add(this,bt)},ot.prototype.redIAdd=function(bt){return nt(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,bt)},ot.prototype.redSub=function(bt){return nt(this.red,"redSub works only with red numbers"),this.red.sub(this,bt)},ot.prototype.redISub=function(bt){return nt(this.red,"redISub works only with red numbers"),this.red.isub(this,bt)},ot.prototype.redShl=function(bt){return nt(this.red,"redShl works only with red numbers"),this.red.shl(this,bt)},ot.prototype.redMul=function(bt){return nt(this.red,"redMul works only with red numbers"),this.red._verify2(this,bt),this.red.mul(this,bt)},ot.prototype.redIMul=function(bt){return nt(this.red,"redMul works only with red numbers"),this.red._verify2(this,bt),this.red.imul(this,bt)},ot.prototype.redSqr=function(){return nt(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},ot.prototype.redISqr=function(){return nt(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},ot.prototype.redSqrt=function(){return nt(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},ot.prototype.redInvm=function(){return nt(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},ot.prototype.redNeg=function(){return nt(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},ot.prototype.redPow=function(bt){return nt(this.red&&!bt.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,bt)};var It={k256:null,p224:null,p192:null,p25519:null};function Mt(bt,yt){this.name=bt,this.p=new ot(yt,16),this.n=this.p.bitLength(),this.k=new ot(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}Mt.prototype._tmp=function(){var bt=new ot(null);return bt.words=new Array(Math.ceil(this.n/13)),bt},Mt.prototype.ireduce=function(bt){var yt=bt,$t;do this.split(yt,this.tmp),yt=this.imulK(yt),yt=yt.iadd(this.tmp),$t=yt.bitLength();while($t>this.n);var Et=$t<this.n?-1:yt.ucmp(this.p);return Et===0?(yt.words[0]=0,yt.length=1):Et>0?yt.isub(this.p):yt.strip!==void 0?yt.strip():yt._strip(),yt},Mt.prototype.split=function(bt,yt){bt.iushrn(this.n,0,yt)},Mt.prototype.imulK=function(bt){return bt.imul(this.k)};function kt(){Mt.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}it(kt,Mt),kt.prototype.split=function(bt,yt){for(var $t=4194303,Et=Math.min(bt.length,9),Tt=0;Tt<Et;Tt++)yt.words[Tt]=bt.words[Tt];if(yt.length=Et,bt.length<=9){bt.words[0]=0,bt.length=1;return}var Pt=bt.words[9];for(yt.words[yt.length++]=Pt&$t,Tt=10;Tt<bt.length;Tt++){var St=bt.words[Tt]|0;bt.words[Tt-10]=(St&$t)<<4|Pt>>>22,Pt=St}Pt>>>=22,bt.words[Tt-10]=Pt,Pt===0&&bt.length>10?bt.length-=10:bt.length-=9},kt.prototype.imulK=function(bt){bt.words[bt.length]=0,bt.words[bt.length+1]=0,bt.length+=2;for(var yt=0,$t=0;$t<bt.length;$t++){var Et=bt.words[$t]|0;yt+=Et*977,bt.words[$t]=yt&67108863,yt=Et*64+(yt/67108864|0)}return bt.words[bt.length-1]===0&&(bt.length--,bt.words[bt.length-1]===0&&bt.length--),bt};function Ct(){Mt.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}it(Ct,Mt);function Ut(){Mt.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}it(Ut,Mt);function Wt(){Mt.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}it(Wt,Mt),Wt.prototype.imulK=function(bt){for(var yt=0,$t=0;$t<bt.length;$t++){var Et=(bt.words[$t]|0)*19+yt,Tt=Et&67108863;Et>>>=26,bt.words[$t]=Tt,yt=Et}return yt!==0&&(bt.words[bt.length++]=yt),bt},ot._prime=function(bt){if(It[bt])return It[bt];var yt;if(bt==="k256")yt=new kt;else if(bt==="p224")yt=new Ct;else if(bt==="p192")yt=new Ut;else if(bt==="p25519")yt=new Wt;else throw new Error("Unknown prime "+bt);return It[bt]=yt,yt};function Ft(bt){if(typeof bt=="string"){var yt=ot._prime(bt);this.m=yt.p,this.prime=yt}else nt(bt.gtn(1),"modulus must be greater than 1"),this.m=bt,this.prime=null}Ft.prototype._verify1=function(bt){nt(bt.negative===0,"red works only with positives"),nt(bt.red,"red works only with red numbers")},Ft.prototype._verify2=function(bt,yt){nt((bt.negative|yt.negative)===0,"red works only with positives"),nt(bt.red&&bt.red===yt.red,"red works only with red numbers")},Ft.prototype.imod=function(bt){return this.prime?this.prime.ireduce(bt)._forceRed(this):bt.umod(this.m)._forceRed(this)},Ft.prototype.neg=function(bt){return bt.isZero()?bt.clone():this.m.sub(bt)._forceRed(this)},Ft.prototype.add=function(bt,yt){this._verify2(bt,yt);var $t=bt.add(yt);return $t.cmp(this.m)>=0&&$t.isub(this.m),$t._forceRed(this)},Ft.prototype.iadd=function(bt,yt){this._verify2(bt,yt);var $t=bt.iadd(yt);return $t.cmp(this.m)>=0&&$t.isub(this.m),$t},Ft.prototype.sub=function(bt,yt){this._verify2(bt,yt);var $t=bt.sub(yt);return $t.cmpn(0)<0&&$t.iadd(this.m),$t._forceRed(this)},Ft.prototype.isub=function(bt,yt){this._verify2(bt,yt);var $t=bt.isub(yt);return $t.cmpn(0)<0&&$t.iadd(this.m),$t},Ft.prototype.shl=function(bt,yt){return this._verify1(bt),this.imod(bt.ushln(yt))},Ft.prototype.imul=function(bt,yt){return this._verify2(bt,yt),this.imod(bt.imul(yt))},Ft.prototype.mul=function(bt,yt){return this._verify2(bt,yt),this.imod(bt.mul(yt))},Ft.prototype.isqr=function(bt){return this.imul(bt,bt.clone())},Ft.prototype.sqr=function(bt){return this.mul(bt,bt)},Ft.prototype.sqrt=function(bt){if(bt.isZero())return bt.clone();var yt=this.m.andln(3);if(nt(yt%2===1),yt===3){var $t=this.m.add(new ot(1)).iushrn(2);return this.pow(bt,$t)}for(var Et=this.m.subn(1),Tt=0;!Et.isZero()&&Et.andln(1)===0;)Tt++,Et.iushrn(1);nt(!Et.isZero());var Pt=new ot(1).toRed(this),St=Pt.redNeg(),Dt=this.m.subn(1).iushrn(1),wt=this.m.bitLength();for(wt=new ot(2*wt*wt).toRed(this);this.pow(wt,Dt).cmp(St)!==0;)wt.redIAdd(St);for(var xt=this.pow(wt,Et),Ke=this.pow(bt,Et.addn(1).iushrn(1)),Pe=this.pow(bt,Et),Ht=Tt;Pe.cmp(Pt)!==0;){for(var zt=Pe,jt=0;zt.cmp(Pt)!==0;jt++)zt=zt.redSqr();nt(jt<Ht);var qt=this.pow(xt,new ot(1).iushln(Ht-jt-1));Ke=Ke.redMul(qt),xt=qt.redSqr(),Pe=Pe.redMul(xt),Ht=jt}return Ke},Ft.prototype.invm=function(bt){var yt=bt._invmp(this.m);return yt.negative!==0?(yt.negative=0,this.imod(yt).redNeg()):this.imod(yt)},Ft.prototype.pow=function(bt,yt){if(yt.isZero())return new ot(1).toRed(this);if(yt.cmpn(1)===0)return bt.clone();var $t=4,Et=new Array(1<<$t);Et[0]=new ot(1).toRed(this),Et[1]=bt;for(var Tt=2;Tt<Et.length;Tt++)Et[Tt]=this.mul(Et[Tt-1],bt);var Pt=Et[0],St=0,Dt=0,wt=yt.bitLength()%26;for(wt===0&&(wt=26),Tt=yt.length-1;Tt>=0;Tt--){for(var xt=yt.words[Tt],Ke=wt-1;Ke>=0;Ke--){var Pe=xt>>Ke&1;if(Pt!==Et[0]&&(Pt=this.sqr(Pt)),Pe===0&&St===0){Dt=0;continue}St<<=1,St|=Pe,Dt++,!(Dt!==$t&&(Tt!==0||Ke!==0))&&(Pt=this.mul(Pt,Et[St]),Dt=0,St=0)}wt=26}return Pt},Ft.prototype.convertTo=function(bt){var yt=bt.umod(this.m);return yt===bt?yt.clone():yt},Ft.prototype.convertFrom=function(bt){var yt=bt.clone();return yt.red=null,yt},ot.mont=function(bt){return new Ce(bt)};function Ce(bt){Ft.call(this,bt),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new ot(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}it(Ce,Ft),Ce.prototype.convertTo=function(bt){return this.imod(bt.ushln(this.shift))},Ce.prototype.convertFrom=function(bt){var yt=this.imod(bt.mul(this.rinv));return yt.red=null,yt},Ce.prototype.imul=function(bt,yt){if(bt.isZero()||yt.isZero())return bt.words[0]=0,bt.length=1,bt;var $t=bt.imul(yt),Et=$t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),Tt=$t.isub(Et).iushrn(this.shift),Pt=Tt;return Tt.cmp(this.m)>=0?Pt=Tt.isub(this.m):Tt.cmpn(0)<0&&(Pt=Tt.iadd(this.m)),Pt._forceRed(this)},Ce.prototype.mul=function(bt,yt){if(bt.isZero()||yt.isZero())return new ot(0)._forceRed(this);var $t=bt.mul(yt),Et=$t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),Tt=$t.isub(Et).iushrn(this.shift),Pt=Tt;return Tt.cmp(this.m)>=0?Pt=Tt.isub(this.m):Tt.cmpn(0)<0&&(Pt=Tt.iadd(this.m)),Pt._forceRed(this)},Ce.prototype.invm=function(bt){var yt=this.imod(bt._invmp(this.m).mul(this.r2));return yt._forceRed(this)}})(et,commonjsGlobal)}(bn$1)),bn$1.exports}var minimalisticAssert,hasRequiredMinimalisticAssert;function requireMinimalisticAssert(){if(hasRequiredMinimalisticAssert)return minimalisticAssert;hasRequiredMinimalisticAssert=1,minimalisticAssert=et;function et(tt,rt){if(!tt)throw new Error(rt||"Assertion failed")}return et.equal=function(tt,rt,nt){if(tt!=rt)throw new Error(nt||"Assertion failed: "+tt+" != "+rt)},minimalisticAssert}var utils$g={},hasRequiredUtils$5;function requireUtils$5(){return hasRequiredUtils$5||(hasRequiredUtils$5=1,function(et){var tt=et;function rt(ot,st){if(Array.isArray(ot))return ot.slice();if(!ot)return[];var at=[];if(typeof ot!="string"){for(var ct=0;ct<ot.length;ct++)at[ct]=ot[ct]|0;return at}if(st==="hex"){ot=ot.replace(/[^a-z0-9]+/ig,""),ot.length%2!==0&&(ot="0"+ot);for(var ct=0;ct<ot.length;ct+=2)at.push(parseInt(ot[ct]+ot[ct+1],16))}else for(var ct=0;ct<ot.length;ct++){var ut=ot.charCodeAt(ct),lt=ut>>8,ht=ut&255;lt?at.push(lt,ht):at.push(ht)}return at}tt.toArray=rt;function nt(ot){return ot.length===1?"0"+ot:ot}tt.zero2=nt;function it(ot){for(var st="",at=0;at<ot.length;at++)st+=nt(ot[at].toString(16));return st}tt.toHex=it,tt.encode=function(ot,st){return st==="hex"?it(ot):ot}}(utils$g)),utils$g}var hasRequiredUtils$4;function requireUtils$4(){return hasRequiredUtils$4||(hasRequiredUtils$4=1,function(et){var tt=et,rt=requireBn(),nt=requireMinimalisticAssert(),it=requireUtils$5();tt.assert=nt,tt.toArray=it.toArray,tt.zero2=it.zero2,tt.toHex=it.toHex,tt.encode=it.encode;function ot(lt,ht,ft){var dt=new Array(Math.max(lt.bitLength(),ft)+1);dt.fill(0);for(var pt=1<<ht+1,gt=lt.clone(),_t=0;_t<dt.length;_t++){var mt,At=gt.andln(pt-1);gt.isOdd()?(At>(pt>>1)-1?mt=(pt>>1)-At:mt=At,gt.isubn(mt)):mt=0,dt[_t]=mt,gt.iushrn(1)}return dt}tt.getNAF=ot;function st(lt,ht){var ft=[[],[]];lt=lt.clone(),ht=ht.clone();for(var dt=0,pt=0,gt;lt.cmpn(-dt)>0||ht.cmpn(-pt)>0;){var _t=lt.andln(3)+dt&3,mt=ht.andln(3)+pt&3;_t===3&&(_t=-1),mt===3&&(mt=-1);var At;_t&1?(gt=lt.andln(7)+dt&7,(gt===3||gt===5)&&mt===2?At=-_t:At=_t):At=0,ft[0].push(At);var It;mt&1?(gt=ht.andln(7)+pt&7,(gt===3||gt===5)&&_t===2?It=-mt:It=mt):It=0,ft[1].push(It),2*dt===At+1&&(dt=1-dt),2*pt===It+1&&(pt=1-pt),lt.iushrn(1),ht.iushrn(1)}return ft}tt.getJSF=st;function at(lt,ht,ft){var dt="_"+ht;lt.prototype[ht]=function(){return this[dt]!==void 0?this[dt]:this[dt]=ft.call(this)}}tt.cachedProperty=at;function ct(lt){return typeof lt=="string"?tt.toArray(lt,"hex"):lt}tt.parseBytes=ct;function ut(lt){return new rt(lt,"hex","le")}tt.intFromLE=ut}(utils$h)),utils$h}var brorand={exports:{}},hasRequiredBrorand;function requireBrorand(){if(hasRequiredBrorand)return brorand.exports;hasRequiredBrorand=1;var et;brorand.exports=function(nt){return et||(et=new tt(null)),et.generate(nt)};function tt(nt){this.rand=nt}if(brorand.exports.Rand=tt,tt.prototype.generate=function(nt){return this._rand(nt)},tt.prototype._rand=function(nt){if(this.rand.getBytes)return this.rand.getBytes(nt);for(var it=new Uint8Array(nt),ot=0;ot<it.length;ot++)it[ot]=this.rand.getByte();return it},typeof self=="object")self.crypto&&self.crypto.getRandomValues?tt.prototype._rand=function(nt){var it=new Uint8Array(nt);return self.crypto.getRandomValues(it),it}:self.msCrypto&&self.msCrypto.getRandomValues?tt.prototype._rand=function(nt){var it=new Uint8Array(nt);return self.msCrypto.getRandomValues(it),it}:typeof window=="object"&&(tt.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var rt=require$$0$3;if(typeof rt.randomBytes!="function")throw new Error("Not supported");tt.prototype._rand=function(nt){return rt.randomBytes(nt)}}catch{}return brorand.exports}var curve={},base$1,hasRequiredBase;function requireBase(){if(hasRequiredBase)return base$1;hasRequiredBase=1;var et=requireBn(),tt=requireUtils$4(),rt=tt.getNAF,nt=tt.getJSF,it=tt.assert;function ot(at,ct){this.type=at,this.p=new et(ct.p,16),this.red=ct.prime?et.red(ct.prime):et.mont(this.p),this.zero=new et(0).toRed(this.red),this.one=new et(1).toRed(this.red),this.two=new et(2).toRed(this.red),this.n=ct.n&&new et(ct.n,16),this.g=ct.g&&this.pointFromJSON(ct.g,ct.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var ut=this.n&&this.p.div(this.n);!ut||ut.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}base$1=ot,ot.prototype.point=function(){throw new Error("Not implemented")},ot.prototype.validate=function(){throw new Error("Not implemented")},ot.prototype._fixedNafMul=function(at,ct){it(at.precomputed);var ut=at._getDoubles(),lt=rt(ct,1,this._bitLength),ht=(1<<ut.step+1)-(ut.step%2===0?2:1);ht/=3;var ft=[],dt,pt;for(dt=0;dt<lt.length;dt+=ut.step){pt=0;for(var gt=dt+ut.step-1;gt>=dt;gt--)pt=(pt<<1)+lt[gt];ft.push(pt)}for(var _t=this.jpoint(null,null,null),mt=this.jpoint(null,null,null),At=ht;At>0;At--){for(dt=0;dt<ft.length;dt++)pt=ft[dt],pt===At?mt=mt.mixedAdd(ut.points[dt]):pt===-At&&(mt=mt.mixedAdd(ut.points[dt].neg()));_t=_t.add(mt)}return _t.toP()},ot.prototype._wnafMul=function(at,ct){var ut=4,lt=at._getNAFPoints(ut);ut=lt.wnd;for(var ht=lt.points,ft=rt(ct,ut,this._bitLength),dt=this.jpoint(null,null,null),pt=ft.length-1;pt>=0;pt--){for(var gt=0;pt>=0&&ft[pt]===0;pt--)gt++;if(pt>=0&&gt++,dt=dt.dblp(gt),pt<0)break;var _t=ft[pt];it(_t!==0),at.type==="affine"?_t>0?dt=dt.mixedAdd(ht[_t-1>>1]):dt=dt.mixedAdd(ht[-_t-1>>1].neg()):_t>0?dt=dt.add(ht[_t-1>>1]):dt=dt.add(ht[-_t-1>>1].neg())}return at.type==="affine"?dt.toP():dt},ot.prototype._wnafMulAdd=function(at,ct,ut,lt,ht){var ft=this._wnafT1,dt=this._wnafT2,pt=this._wnafT3,gt=0,_t,mt,At;for(_t=0;_t<lt;_t++){At=ct[_t];var It=At._getNAFPoints(at);ft[_t]=It.wnd,dt[_t]=It.points}for(_t=lt-1;_t>=1;_t-=2){var Mt=_t-1,kt=_t;if(ft[Mt]!==1||ft[kt]!==1){pt[Mt]=rt(ut[Mt],ft[Mt],this._bitLength),pt[kt]=rt(ut[kt],ft[kt],this._bitLength),gt=Math.max(pt[Mt].length,gt),gt=Math.max(pt[kt].length,gt);continue}var Ct=[ct[Mt],null,null,ct[kt]];ct[Mt].y.cmp(ct[kt].y)===0?(Ct[1]=ct[Mt].add(ct[kt]),Ct[2]=ct[Mt].toJ().mixedAdd(ct[kt].neg())):ct[Mt].y.cmp(ct[kt].y.redNeg())===0?(Ct[1]=ct[Mt].toJ().mixedAdd(ct[kt]),Ct[2]=ct[Mt].add(ct[kt].neg())):(Ct[1]=ct[Mt].toJ().mixedAdd(ct[kt]),Ct[2]=ct[Mt].toJ().mixedAdd(ct[kt].neg()));var Ut=[-3,-1,-5,-7,0,7,5,1,3],Wt=nt(ut[Mt],ut[kt]);for(gt=Math.max(Wt[0].length,gt),pt[Mt]=new Array(gt),pt[kt]=new Array(gt),mt=0;mt<gt;mt++){var Ft=Wt[0][mt]|0,Ce=Wt[1][mt]|0;pt[Mt][mt]=Ut[(Ft+1)*3+(Ce+1)],pt[kt][mt]=0,dt[Mt]=Ct}}var bt=this.jpoint(null,null,null),yt=this._wnafT4;for(_t=gt;_t>=0;_t--){for(var $t=0;_t>=0;){var Et=!0;for(mt=0;mt<lt;mt++)yt[mt]=pt[mt][_t]|0,yt[mt]!==0&&(Et=!1);if(!Et)break;$t++,_t--}if(_t>=0&&$t++,bt=bt.dblp($t),_t<0)break;for(mt=0;mt<lt;mt++){var Tt=yt[mt];Tt!==0&&(Tt>0?At=dt[mt][Tt-1>>1]:Tt<0&&(At=dt[mt][-Tt-1>>1].neg()),At.type==="affine"?bt=bt.mixedAdd(At):bt=bt.add(At))}}for(_t=0;_t<lt;_t++)dt[_t]=null;return ht?bt:bt.toP()};function st(at,ct){this.curve=at,this.type=ct,this.precomputed=null}return ot.BasePoint=st,st.prototype.eq=function(){throw new Error("Not implemented")},st.prototype.validate=function(){return this.curve.validate(this)},ot.prototype.decodePoint=function(at,ct){at=tt.toArray(at,ct);var ut=this.p.byteLength();if((at[0]===4||at[0]===6||at[0]===7)&&at.length-1===2*ut){at[0]===6?it(at[at.length-1]%2===0):at[0]===7&&it(at[at.length-1]%2===1);var lt=this.point(at.slice(1,1+ut),at.slice(1+ut,1+2*ut));return lt}else if((at[0]===2||at[0]===3)&&at.length-1===ut)return this.pointFromX(at.slice(1,1+ut),at[0]===3);throw new Error("Unknown point format")},st.prototype.encodeCompressed=function(at){return this.encode(at,!0)},st.prototype._encode=function(at){var ct=this.curve.p.byteLength(),ut=this.getX().toArray("be",ct);return at?[this.getY().isEven()?2:3].concat(ut):[4].concat(ut,this.getY().toArray("be",ct))},st.prototype.encode=function(at,ct){return tt.encode(this._encode(ct),at)},st.prototype.precompute=function(at){if(this.precomputed)return this;var ct={doubles:null,naf:null,beta:null};return ct.naf=this._getNAFPoints(8),ct.doubles=this._getDoubles(4,at),ct.beta=this._getBeta(),this.precomputed=ct,this},st.prototype._hasDoubles=function(at){if(!this.precomputed)return!1;var ct=this.precomputed.doubles;return ct?ct.points.length>=Math.ceil((at.bitLength()+1)/ct.step):!1},st.prototype._getDoubles=function(at,ct){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var ut=[this],lt=this,ht=0;ht<ct;ht+=at){for(var ft=0;ft<at;ft++)lt=lt.dbl();ut.push(lt)}return{step:at,points:ut}},st.prototype._getNAFPoints=function(at){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var ct=[this],ut=(1<<at)-1,lt=ut===1?null:this.dbl(),ht=1;ht<ut;ht++)ct[ht]=ct[ht-1].add(lt);return{wnd:at,points:ct}},st.prototype._getBeta=function(){return null},st.prototype.dblp=function(at){for(var ct=this,ut=0;ut<at;ut++)ct=ct.dbl();return ct},base$1}var inherits_browser={exports:{}},hasRequiredInherits_browser;function requireInherits_browser(){return hasRequiredInherits_browser||(hasRequiredInherits_browser=1,typeof Object.create=="function"?inherits_browser.exports=function(et,tt){tt&&(et.super_=tt,et.prototype=Object.create(tt.prototype,{constructor:{value:et,enumerable:!1,writable:!0,configurable:!0}}))}:inherits_browser.exports=function(et,tt){if(tt){et.super_=tt;var rt=function(){};rt.prototype=tt.prototype,et.prototype=new rt,et.prototype.constructor=et}}),inherits_browser.exports}var short,hasRequiredShort;function requireShort(){if(hasRequiredShort)return short;hasRequiredShort=1;var et=requireUtils$4(),tt=requireBn(),rt=requireInherits_browser(),nt=requireBase(),it=et.assert;function ot(ct){nt.call(this,"short",ct),this.a=new tt(ct.a,16).toRed(this.red),this.b=new tt(ct.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(ct),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}rt(ot,nt),short=ot,ot.prototype._getEndomorphism=function(ct){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var ut,lt;if(ct.beta)ut=new tt(ct.beta,16).toRed(this.red);else{var ht=this._getEndoRoots(this.p);ut=ht[0].cmp(ht[1])<0?ht[0]:ht[1],ut=ut.toRed(this.red)}if(ct.lambda)lt=new tt(ct.lambda,16);else{var ft=this._getEndoRoots(this.n);this.g.mul(ft[0]).x.cmp(this.g.x.redMul(ut))===0?lt=ft[0]:(lt=ft[1],it(this.g.mul(lt).x.cmp(this.g.x.redMul(ut))===0))}var dt;return ct.basis?dt=ct.basis.map(function(pt){return{a:new tt(pt.a,16),b:new tt(pt.b,16)}}):dt=this._getEndoBasis(lt),{beta:ut,lambda:lt,basis:dt}}},ot.prototype._getEndoRoots=function(ct){var ut=ct===this.p?this.red:tt.mont(ct),lt=new tt(2).toRed(ut).redInvm(),ht=lt.redNeg(),ft=new tt(3).toRed(ut).redNeg().redSqrt().redMul(lt),dt=ht.redAdd(ft).fromRed(),pt=ht.redSub(ft).fromRed();return[dt,pt]},ot.prototype._getEndoBasis=function(ct){for(var ut=this.n.ushrn(Math.floor(this.n.bitLength()/2)),lt=ct,ht=this.n.clone(),ft=new tt(1),dt=new tt(0),pt=new tt(0),gt=new tt(1),_t,mt,At,It,Mt,kt,Ct,Ut=0,Wt,Ft;lt.cmpn(0)!==0;){var Ce=ht.div(lt);Wt=ht.sub(Ce.mul(lt)),Ft=pt.sub(Ce.mul(ft));var bt=gt.sub(Ce.mul(dt));if(!At&&Wt.cmp(ut)<0)_t=Ct.neg(),mt=ft,At=Wt.neg(),It=Ft;else if(At&&++Ut===2)break;Ct=Wt,ht=lt,lt=Wt,pt=ft,ft=Ft,gt=dt,dt=bt}Mt=Wt.neg(),kt=Ft;var yt=At.sqr().add(It.sqr()),$t=Mt.sqr().add(kt.sqr());return $t.cmp(yt)>=0&&(Mt=_t,kt=mt),At.negative&&(At=At.neg(),It=It.neg()),Mt.negative&&(Mt=Mt.neg(),kt=kt.neg()),[{a:At,b:It},{a:Mt,b:kt}]},ot.prototype._endoSplit=function(ct){var ut=this.endo.basis,lt=ut[0],ht=ut[1],ft=ht.b.mul(ct).divRound(this.n),dt=lt.b.neg().mul(ct).divRound(this.n),pt=ft.mul(lt.a),gt=dt.mul(ht.a),_t=ft.mul(lt.b),mt=dt.mul(ht.b),At=ct.sub(pt).sub(gt),It=_t.add(mt).neg();return{k1:At,k2:It}},ot.prototype.pointFromX=function(ct,ut){ct=new tt(ct,16),ct.red||(ct=ct.toRed(this.red));var lt=ct.redSqr().redMul(ct).redIAdd(ct.redMul(this.a)).redIAdd(this.b),ht=lt.redSqrt();if(ht.redSqr().redSub(lt).cmp(this.zero)!==0)throw new Error("invalid point");var ft=ht.fromRed().isOdd();return(ut&&!ft||!ut&&ft)&&(ht=ht.redNeg()),this.point(ct,ht)},ot.prototype.validate=function(ct){if(ct.inf)return!0;var ut=ct.x,lt=ct.y,ht=this.a.redMul(ut),ft=ut.redSqr().redMul(ut).redIAdd(ht).redIAdd(this.b);return lt.redSqr().redISub(ft).cmpn(0)===0},ot.prototype._endoWnafMulAdd=function(ct,ut,lt){for(var ht=this._endoWnafT1,ft=this._endoWnafT2,dt=0;dt<ct.length;dt++){var pt=this._endoSplit(ut[dt]),gt=ct[dt],_t=gt._getBeta();pt.k1.negative&&(pt.k1.ineg(),gt=gt.neg(!0)),pt.k2.negative&&(pt.k2.ineg(),_t=_t.neg(!0)),ht[dt*2]=gt,ht[dt*2+1]=_t,ft[dt*2]=pt.k1,ft[dt*2+1]=pt.k2}for(var mt=this._wnafMulAdd(1,ht,ft,dt*2,lt),At=0;At<dt*2;At++)ht[At]=null,ft[At]=null;return mt};function st(ct,ut,lt,ht){nt.BasePoint.call(this,ct,"affine"),ut===null&&lt===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new tt(ut,16),this.y=new tt(lt,16),ht&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}rt(st,nt.BasePoint),ot.prototype.point=function(ct,ut,lt){return new st(this,ct,ut,lt)},ot.prototype.pointFromJSON=function(ct,ut){return st.fromJSON(this,ct,ut)},st.prototype._getBeta=function(){if(this.curve.endo){var ct=this.precomputed;if(ct&&ct.beta)return ct.beta;var ut=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(ct){var lt=this.curve,ht=function(ft){return lt.point(ft.x.redMul(lt.endo.beta),ft.y)};ct.beta=ut,ut.precomputed={beta:null,naf:ct.naf&&{wnd:ct.naf.wnd,points:ct.naf.points.map(ht)},doubles:ct.doubles&&{step:ct.doubles.step,points:ct.doubles.points.map(ht)}}}return ut}},st.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},st.fromJSON=function(ct,ut,lt){typeof ut=="string"&&(ut=JSON.parse(ut));var ht=ct.point(ut[0],ut[1],lt);if(!ut[2])return ht;function ft(pt){return ct.point(pt[0],pt[1],lt)}var dt=ut[2];return ht.precomputed={beta:null,doubles:dt.doubles&&{step:dt.doubles.step,points:[ht].concat(dt.doubles.points.map(ft))},naf:dt.naf&&{wnd:dt.naf.wnd,points:[ht].concat(dt.naf.points.map(ft))}},ht},st.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},st.prototype.isInfinity=function(){return this.inf},st.prototype.add=function(ct){if(this.inf)return ct;if(ct.inf)return this;if(this.eq(ct))return this.dbl();if(this.neg().eq(ct))return this.curve.point(null,null);if(this.x.cmp(ct.x)===0)return this.curve.point(null,null);var ut=this.y.redSub(ct.y);ut.cmpn(0)!==0&&(ut=ut.redMul(this.x.redSub(ct.x).redInvm()));var lt=ut.redSqr().redISub(this.x).redISub(ct.x),ht=ut.redMul(this.x.redSub(lt)).redISub(this.y);return this.curve.point(lt,ht)},st.prototype.dbl=function(){if(this.inf)return this;var ct=this.y.redAdd(this.y);if(ct.cmpn(0)===0)return this.curve.point(null,null);var ut=this.curve.a,lt=this.x.redSqr(),ht=ct.redInvm(),ft=lt.redAdd(lt).redIAdd(lt).redIAdd(ut).redMul(ht),dt=ft.redSqr().redISub(this.x.redAdd(this.x)),pt=ft.redMul(this.x.redSub(dt)).redISub(this.y);return this.curve.point(dt,pt)},st.prototype.getX=function(){return this.x.fromRed()},st.prototype.getY=function(){return this.y.fromRed()},st.prototype.mul=function(ct){return ct=new tt(ct,16),this.isInfinity()?this:this._hasDoubles(ct)?this.curve._fixedNafMul(this,ct):this.curve.endo?this.curve._endoWnafMulAdd([this],[ct]):this.curve._wnafMul(this,ct)},st.prototype.mulAdd=function(ct,ut,lt){var ht=[this,ut],ft=[ct,lt];return this.curve.endo?this.curve._endoWnafMulAdd(ht,ft):this.curve._wnafMulAdd(1,ht,ft,2)},st.prototype.jmulAdd=function(ct,ut,lt){var ht=[this,ut],ft=[ct,lt];return this.curve.endo?this.curve._endoWnafMulAdd(ht,ft,!0):this.curve._wnafMulAdd(1,ht,ft,2,!0)},st.prototype.eq=function(ct){return this===ct||this.inf===ct.inf&&(this.inf||this.x.cmp(ct.x)===0&&this.y.cmp(ct.y)===0)},st.prototype.neg=function(ct){if(this.inf)return this;var ut=this.curve.point(this.x,this.y.redNeg());if(ct&&this.precomputed){var lt=this.precomputed,ht=function(ft){return ft.neg()};ut.precomputed={naf:lt.naf&&{wnd:lt.naf.wnd,points:lt.naf.points.map(ht)},doubles:lt.doubles&&{step:lt.doubles.step,points:lt.doubles.points.map(ht)}}}return ut},st.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var ct=this.curve.jpoint(this.x,this.y,this.curve.one);return ct};function at(ct,ut,lt,ht){nt.BasePoint.call(this,ct,"jacobian"),ut===null&&lt===null&&ht===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new tt(0)):(this.x=new tt(ut,16),this.y=new tt(lt,16),this.z=new tt(ht,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}return rt(at,nt.BasePoint),ot.prototype.jpoint=function(ct,ut,lt){return new at(this,ct,ut,lt)},at.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var ct=this.z.redInvm(),ut=ct.redSqr(),lt=this.x.redMul(ut),ht=this.y.redMul(ut).redMul(ct);return this.curve.point(lt,ht)},at.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},at.prototype.add=function(ct){if(this.isInfinity())return ct;if(ct.isInfinity())return this;var ut=ct.z.redSqr(),lt=this.z.redSqr(),ht=this.x.redMul(ut),ft=ct.x.redMul(lt),dt=this.y.redMul(ut.redMul(ct.z)),pt=ct.y.redMul(lt.redMul(this.z)),gt=ht.redSub(ft),_t=dt.redSub(pt);if(gt.cmpn(0)===0)return _t.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var mt=gt.redSqr(),At=mt.redMul(gt),It=ht.redMul(mt),Mt=_t.redSqr().redIAdd(At).redISub(It).redISub(It),kt=_t.redMul(It.redISub(Mt)).redISub(dt.redMul(At)),Ct=this.z.redMul(ct.z).redMul(gt);return this.curve.jpoint(Mt,kt,Ct)},at.prototype.mixedAdd=function(ct){if(this.isInfinity())return ct.toJ();if(ct.isInfinity())return this;var ut=this.z.redSqr(),lt=this.x,ht=ct.x.redMul(ut),ft=this.y,dt=ct.y.redMul(ut).redMul(this.z),pt=lt.redSub(ht),gt=ft.redSub(dt);if(pt.cmpn(0)===0)return gt.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var _t=pt.redSqr(),mt=_t.redMul(pt),At=lt.redMul(_t),It=gt.redSqr().redIAdd(mt).redISub(At).redISub(At),Mt=gt.redMul(At.redISub(It)).redISub(ft.redMul(mt)),kt=this.z.redMul(pt);return this.curve.jpoint(It,Mt,kt)},at.prototype.dblp=function(ct){if(ct===0)return this;if(this.isInfinity())return this;if(!ct)return this.dbl();var ut;if(this.curve.zeroA||this.curve.threeA){var lt=this;for(ut=0;ut<ct;ut++)lt=lt.dbl();return lt}var ht=this.curve.a,ft=this.curve.tinv,dt=this.x,pt=this.y,gt=this.z,_t=gt.redSqr().redSqr(),mt=pt.redAdd(pt);for(ut=0;ut<ct;ut++){var At=dt.redSqr(),It=mt.redSqr(),Mt=It.redSqr(),kt=At.redAdd(At).redIAdd(At).redIAdd(ht.redMul(_t)),Ct=dt.redMul(It),Ut=kt.redSqr().redISub(Ct.redAdd(Ct)),Wt=Ct.redISub(Ut),Ft=kt.redMul(Wt);Ft=Ft.redIAdd(Ft).redISub(Mt);var Ce=mt.redMul(gt);ut+1<ct&&(_t=_t.redMul(Mt)),dt=Ut,gt=Ce,mt=Ft}return this.curve.jpoint(dt,mt.redMul(ft),gt)},at.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},at.prototype._zeroDbl=function(){var ct,ut,lt;if(this.zOne){var ht=this.x.redSqr(),ft=this.y.redSqr(),dt=ft.redSqr(),pt=this.x.redAdd(ft).redSqr().redISub(ht).redISub(dt);pt=pt.redIAdd(pt);var gt=ht.redAdd(ht).redIAdd(ht),_t=gt.redSqr().redISub(pt).redISub(pt),mt=dt.redIAdd(dt);mt=mt.redIAdd(mt),mt=mt.redIAdd(mt),ct=_t,ut=gt.redMul(pt.redISub(_t)).redISub(mt),lt=this.y.redAdd(this.y)}else{var At=this.x.redSqr(),It=this.y.redSqr(),Mt=It.redSqr(),kt=this.x.redAdd(It).redSqr().redISub(At).redISub(Mt);kt=kt.redIAdd(kt);var Ct=At.redAdd(At).redIAdd(At),Ut=Ct.redSqr(),Wt=Mt.redIAdd(Mt);Wt=Wt.redIAdd(Wt),Wt=Wt.redIAdd(Wt),ct=Ut.redISub(kt).redISub(kt),ut=Ct.redMul(kt.redISub(ct)).redISub(Wt),lt=this.y.redMul(this.z),lt=lt.redIAdd(lt)}return this.curve.jpoint(ct,ut,lt)},at.prototype._threeDbl=function(){var ct,ut,lt;if(this.zOne){var ht=this.x.redSqr(),ft=this.y.redSqr(),dt=ft.redSqr(),pt=this.x.redAdd(ft).redSqr().redISub(ht).redISub(dt);pt=pt.redIAdd(pt);var gt=ht.redAdd(ht).redIAdd(ht).redIAdd(this.curve.a),_t=gt.redSqr().redISub(pt).redISub(pt);ct=_t;var mt=dt.redIAdd(dt);mt=mt.redIAdd(mt),mt=mt.redIAdd(mt),ut=gt.redMul(pt.redISub(_t)).redISub(mt),lt=this.y.redAdd(this.y)}else{var At=this.z.redSqr(),It=this.y.redSqr(),Mt=this.x.redMul(It),kt=this.x.redSub(At).redMul(this.x.redAdd(At));kt=kt.redAdd(kt).redIAdd(kt);var Ct=Mt.redIAdd(Mt);Ct=Ct.redIAdd(Ct);var Ut=Ct.redAdd(Ct);ct=kt.redSqr().redISub(Ut),lt=this.y.redAdd(this.z).redSqr().redISub(It).redISub(At);var Wt=It.redSqr();Wt=Wt.redIAdd(Wt),Wt=Wt.redIAdd(Wt),Wt=Wt.redIAdd(Wt),ut=kt.redMul(Ct.redISub(ct)).redISub(Wt)}return this.curve.jpoint(ct,ut,lt)},at.prototype._dbl=function(){var ct=this.curve.a,ut=this.x,lt=this.y,ht=this.z,ft=ht.redSqr().redSqr(),dt=ut.redSqr(),pt=lt.redSqr(),gt=dt.redAdd(dt).redIAdd(dt).redIAdd(ct.redMul(ft)),_t=ut.redAdd(ut);_t=_t.redIAdd(_t);var mt=_t.redMul(pt),At=gt.redSqr().redISub(mt.redAdd(mt)),It=mt.redISub(At),Mt=pt.redSqr();Mt=Mt.redIAdd(Mt),Mt=Mt.redIAdd(Mt),Mt=Mt.redIAdd(Mt);var kt=gt.redMul(It).redISub(Mt),Ct=lt.redAdd(lt).redMul(ht);return this.curve.jpoint(At,kt,Ct)},at.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var ct=this.x.redSqr(),ut=this.y.redSqr(),lt=this.z.redSqr(),ht=ut.redSqr(),ft=ct.redAdd(ct).redIAdd(ct),dt=ft.redSqr(),pt=this.x.redAdd(ut).redSqr().redISub(ct).redISub(ht);pt=pt.redIAdd(pt),pt=pt.redAdd(pt).redIAdd(pt),pt=pt.redISub(dt);var gt=pt.redSqr(),_t=ht.redIAdd(ht);_t=_t.redIAdd(_t),_t=_t.redIAdd(_t),_t=_t.redIAdd(_t);var mt=ft.redIAdd(pt).redSqr().redISub(dt).redISub(gt).redISub(_t),At=ut.redMul(mt);At=At.redIAdd(At),At=At.redIAdd(At);var It=this.x.redMul(gt).redISub(At);It=It.redIAdd(It),It=It.redIAdd(It);var Mt=this.y.redMul(mt.redMul(_t.redISub(mt)).redISub(pt.redMul(gt)));Mt=Mt.redIAdd(Mt),Mt=Mt.redIAdd(Mt),Mt=Mt.redIAdd(Mt);var kt=this.z.redAdd(pt).redSqr().redISub(lt).redISub(gt);return this.curve.jpoint(It,Mt,kt)},at.prototype.mul=function(ct,ut){return ct=new tt(ct,ut),this.curve._wnafMul(this,ct)},at.prototype.eq=function(ct){if(ct.type==="affine")return this.eq(ct.toJ());if(this===ct)return!0;var ut=this.z.redSqr(),lt=ct.z.redSqr();if(this.x.redMul(lt).redISub(ct.x.redMul(ut)).cmpn(0)!==0)return!1;var ht=ut.redMul(this.z),ft=lt.redMul(ct.z);return this.y.redMul(ft).redISub(ct.y.redMul(ht)).cmpn(0)===0},at.prototype.eqXToP=function(ct){var ut=this.z.redSqr(),lt=ct.toRed(this.curve.red).redMul(ut);if(this.x.cmp(lt)===0)return!0;for(var ht=ct.clone(),ft=this.curve.redN.redMul(ut);;){if(ht.iadd(this.curve.n),ht.cmp(this.curve.p)>=0)return!1;if(lt.redIAdd(ft),this.x.cmp(lt)===0)return!0}},at.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},at.prototype.isInfinity=function(){return this.z.cmpn(0)===0},short}var mont,hasRequiredMont;function requireMont(){if(hasRequiredMont)return mont;hasRequiredMont=1;var et=requireBn(),tt=requireInherits_browser(),rt=requireBase(),nt=requireUtils$4();function it(st){rt.call(this,"mont",st),this.a=new et(st.a,16).toRed(this.red),this.b=new et(st.b,16).toRed(this.red),this.i4=new et(4).toRed(this.red).redInvm(),this.two=new et(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}tt(it,rt),mont=it,it.prototype.validate=function(st){var at=st.normalize().x,ct=at.redSqr(),ut=ct.redMul(at).redAdd(ct.redMul(this.a)).redAdd(at),lt=ut.redSqrt();return lt.redSqr().cmp(ut)===0};function ot(st,at,ct){rt.BasePoint.call(this,st,"projective"),at===null&&ct===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new et(at,16),this.z=new et(ct,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}return tt(ot,rt.BasePoint),it.prototype.decodePoint=function(st,at){return this.point(nt.toArray(st,at),1)},it.prototype.point=function(st,at){return new ot(this,st,at)},it.prototype.pointFromJSON=function(st){return ot.fromJSON(this,st)},ot.prototype.precompute=function(){},ot.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},ot.fromJSON=function(st,at){return new ot(st,at[0],at[1]||st.one)},ot.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},ot.prototype.isInfinity=function(){return this.z.cmpn(0)===0},ot.prototype.dbl=function(){var st=this.x.redAdd(this.z),at=st.redSqr(),ct=this.x.redSub(this.z),ut=ct.redSqr(),lt=at.redSub(ut),ht=at.redMul(ut),ft=lt.redMul(ut.redAdd(this.curve.a24.redMul(lt)));return this.curve.point(ht,ft)},ot.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},ot.prototype.diffAdd=function(st,at){var ct=this.x.redAdd(this.z),ut=this.x.redSub(this.z),lt=st.x.redAdd(st.z),ht=st.x.redSub(st.z),ft=ht.redMul(ct),dt=lt.redMul(ut),pt=at.z.redMul(ft.redAdd(dt).redSqr()),gt=at.x.redMul(ft.redISub(dt).redSqr());return this.curve.point(pt,gt)},ot.prototype.mul=function(st){for(var at=st.clone(),ct=this,ut=this.curve.point(null,null),lt=this,ht=[];at.cmpn(0)!==0;at.iushrn(1))ht.push(at.andln(1));for(var ft=ht.length-1;ft>=0;ft--)ht[ft]===0?(ct=ct.diffAdd(ut,lt),ut=ut.dbl()):(ut=ct.diffAdd(ut,lt),ct=ct.dbl());return ut},ot.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},ot.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},ot.prototype.eq=function(st){return this.getX().cmp(st.getX())===0},ot.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},ot.prototype.getX=function(){return this.normalize(),this.x.fromRed()},mont}var edwards,hasRequiredEdwards;function requireEdwards(){if(hasRequiredEdwards)return edwards;hasRequiredEdwards=1;var et=requireUtils$4(),tt=requireBn(),rt=requireInherits_browser(),nt=requireBase(),it=et.assert;function ot(at){this.twisted=(at.a|0)!==1,this.mOneA=this.twisted&&(at.a|0)===-1,this.extended=this.mOneA,nt.call(this,"edwards",at),this.a=new tt(at.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new tt(at.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new tt(at.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),it(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(at.c|0)===1}rt(ot,nt),edwards=ot,ot.prototype._mulA=function(at){return this.mOneA?at.redNeg():this.a.redMul(at)},ot.prototype._mulC=function(at){return this.oneC?at:this.c.redMul(at)},ot.prototype.jpoint=function(at,ct,ut,lt){return this.point(at,ct,ut,lt)},ot.prototype.pointFromX=function(at,ct){at=new tt(at,16),at.red||(at=at.toRed(this.red));var ut=at.redSqr(),lt=this.c2.redSub(this.a.redMul(ut)),ht=this.one.redSub(this.c2.redMul(this.d).redMul(ut)),ft=lt.redMul(ht.redInvm()),dt=ft.redSqrt();if(dt.redSqr().redSub(ft).cmp(this.zero)!==0)throw new Error("invalid point");var pt=dt.fromRed().isOdd();return(ct&&!pt||!ct&&pt)&&(dt=dt.redNeg()),this.point(at,dt)},ot.prototype.pointFromY=function(at,ct){at=new tt(at,16),at.red||(at=at.toRed(this.red));var ut=at.redSqr(),lt=ut.redSub(this.c2),ht=ut.redMul(this.d).redMul(this.c2).redSub(this.a),ft=lt.redMul(ht.redInvm());if(ft.cmp(this.zero)===0){if(ct)throw new Error("invalid point");return this.point(this.zero,at)}var dt=ft.redSqrt();if(dt.redSqr().redSub(ft).cmp(this.zero)!==0)throw new Error("invalid point");return dt.fromRed().isOdd()!==ct&&(dt=dt.redNeg()),this.point(dt,at)},ot.prototype.validate=function(at){if(at.isInfinity())return!0;at.normalize();var ct=at.x.redSqr(),ut=at.y.redSqr(),lt=ct.redMul(this.a).redAdd(ut),ht=this.c2.redMul(this.one.redAdd(this.d.redMul(ct).redMul(ut)));return lt.cmp(ht)===0};function st(at,ct,ut,lt,ht){nt.BasePoint.call(this,at,"projective"),ct===null&&ut===null&&lt===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new tt(ct,16),this.y=new tt(ut,16),this.z=lt?new tt(lt,16):this.curve.one,this.t=ht&&new tt(ht,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}return rt(st,nt.BasePoint),ot.prototype.pointFromJSON=function(at){return st.fromJSON(this,at)},ot.prototype.point=function(at,ct,ut,lt){return new st(this,at,ct,ut,lt)},st.fromJSON=function(at,ct){return new st(at,ct[0],ct[1],ct[2])},st.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},st.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},st.prototype._extDbl=function(){var at=this.x.redSqr(),ct=this.y.redSqr(),ut=this.z.redSqr();ut=ut.redIAdd(ut);var lt=this.curve._mulA(at),ht=this.x.redAdd(this.y).redSqr().redISub(at).redISub(ct),ft=lt.redAdd(ct),dt=ft.redSub(ut),pt=lt.redSub(ct),gt=ht.redMul(dt),_t=ft.redMul(pt),mt=ht.redMul(pt),At=dt.redMul(ft);return this.curve.point(gt,_t,At,mt)},st.prototype._projDbl=function(){var at=this.x.redAdd(this.y).redSqr(),ct=this.x.redSqr(),ut=this.y.redSqr(),lt,ht,ft,dt,pt,gt;if(this.curve.twisted){dt=this.curve._mulA(ct);var _t=dt.redAdd(ut);this.zOne?(lt=at.redSub(ct).redSub(ut).redMul(_t.redSub(this.curve.two)),ht=_t.redMul(dt.redSub(ut)),ft=_t.redSqr().redSub(_t).redSub(_t)):(pt=this.z.redSqr(),gt=_t.redSub(pt).redISub(pt),lt=at.redSub(ct).redISub(ut).redMul(gt),ht=_t.redMul(dt.redSub(ut)),ft=_t.redMul(gt))}else dt=ct.redAdd(ut),pt=this.curve._mulC(this.z).redSqr(),gt=dt.redSub(pt).redSub(pt),lt=this.curve._mulC(at.redISub(dt)).redMul(gt),ht=this.curve._mulC(dt).redMul(ct.redISub(ut)),ft=dt.redMul(gt);return this.curve.point(lt,ht,ft)},st.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},st.prototype._extAdd=function(at){var ct=this.y.redSub(this.x).redMul(at.y.redSub(at.x)),ut=this.y.redAdd(this.x).redMul(at.y.redAdd(at.x)),lt=this.t.redMul(this.curve.dd).redMul(at.t),ht=this.z.redMul(at.z.redAdd(at.z)),ft=ut.redSub(ct),dt=ht.redSub(lt),pt=ht.redAdd(lt),gt=ut.redAdd(ct),_t=ft.redMul(dt),mt=pt.redMul(gt),At=ft.redMul(gt),It=dt.redMul(pt);return this.curve.point(_t,mt,It,At)},st.prototype._projAdd=function(at){var ct=this.z.redMul(at.z),ut=ct.redSqr(),lt=this.x.redMul(at.x),ht=this.y.redMul(at.y),ft=this.curve.d.redMul(lt).redMul(ht),dt=ut.redSub(ft),pt=ut.redAdd(ft),gt=this.x.redAdd(this.y).redMul(at.x.redAdd(at.y)).redISub(lt).redISub(ht),_t=ct.redMul(dt).redMul(gt),mt,At;return this.curve.twisted?(mt=ct.redMul(pt).redMul(ht.redSub(this.curve._mulA(lt))),At=dt.redMul(pt)):(mt=ct.redMul(pt).redMul(ht.redSub(lt)),At=this.curve._mulC(dt).redMul(pt)),this.curve.point(_t,mt,At)},st.prototype.add=function(at){return this.isInfinity()?at:at.isInfinity()?this:this.curve.extended?this._extAdd(at):this._projAdd(at)},st.prototype.mul=function(at){return this._hasDoubles(at)?this.curve._fixedNafMul(this,at):this.curve._wnafMul(this,at)},st.prototype.mulAdd=function(at,ct,ut){return this.curve._wnafMulAdd(1,[this,ct],[at,ut],2,!1)},st.prototype.jmulAdd=function(at,ct,ut){return this.curve._wnafMulAdd(1,[this,ct],[at,ut],2,!0)},st.prototype.normalize=function(){if(this.zOne)return this;var at=this.z.redInvm();return this.x=this.x.redMul(at),this.y=this.y.redMul(at),this.t&&(this.t=this.t.redMul(at)),this.z=this.curve.one,this.zOne=!0,this},st.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},st.prototype.getX=function(){return this.normalize(),this.x.fromRed()},st.prototype.getY=function(){return this.normalize(),this.y.fromRed()},st.prototype.eq=function(at){return this===at||this.getX().cmp(at.getX())===0&&this.getY().cmp(at.getY())===0},st.prototype.eqXToP=function(at){var ct=at.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(ct)===0)return!0;for(var ut=at.clone(),lt=this.curve.redN.redMul(this.z);;){if(ut.iadd(this.curve.n),ut.cmp(this.curve.p)>=0)return!1;if(ct.redIAdd(lt),this.x.cmp(ct)===0)return!0}},st.prototype.toP=st.prototype.normalize,st.prototype.mixedAdd=st.prototype.add,edwards}var hasRequiredCurve;function requireCurve(){return hasRequiredCurve||(hasRequiredCurve=1,function(et){var tt=et;tt.base=requireBase(),tt.short=requireShort(),tt.mont=requireMont(),tt.edwards=requireEdwards()}(curve)),curve}var curves={},hash$2={},utils$f={},hasRequiredUtils$3;function requireUtils$3(){if(hasRequiredUtils$3)return utils$f;hasRequiredUtils$3=1;var et=requireMinimalisticAssert(),tt=requireInherits_browser();utils$f.inherits=tt;function rt(yt,$t){return(yt.charCodeAt($t)&64512)!==55296||$t<0||$t+1>=yt.length?!1:(yt.charCodeAt($t+1)&64512)===56320}function nt(yt,$t){if(Array.isArray(yt))return yt.slice();if(!yt)return[];var Et=[];if(typeof yt=="string")if($t){if($t==="hex")for(yt=yt.replace(/[^a-z0-9]+/ig,""),yt.length%2!==0&&(yt="0"+yt),Pt=0;Pt<yt.length;Pt+=2)Et.push(parseInt(yt[Pt]+yt[Pt+1],16))}else for(var Tt=0,Pt=0;Pt<yt.length;Pt++){var St=yt.charCodeAt(Pt);St<128?Et[Tt++]=St:St<2048?(Et[Tt++]=St>>6|192,Et[Tt++]=St&63|128):rt(yt,Pt)?(St=65536+((St&1023)<<10)+(yt.charCodeAt(++Pt)&1023),Et[Tt++]=St>>18|240,Et[Tt++]=St>>12&63|128,Et[Tt++]=St>>6&63|128,Et[Tt++]=St&63|128):(Et[Tt++]=St>>12|224,Et[Tt++]=St>>6&63|128,Et[Tt++]=St&63|128)}else for(Pt=0;Pt<yt.length;Pt++)Et[Pt]=yt[Pt]|0;return Et}utils$f.toArray=nt;function it(yt){for(var $t="",Et=0;Et<yt.length;Et++)$t+=at(yt[Et].toString(16));return $t}utils$f.toHex=it;function ot(yt){var $t=yt>>>24|yt>>>8&65280|yt<<8&16711680|(yt&255)<<24;return $t>>>0}utils$f.htonl=ot;function st(yt,$t){for(var Et="",Tt=0;Tt<yt.length;Tt++){var Pt=yt[Tt];$t==="little"&&(Pt=ot(Pt)),Et+=ct(Pt.toString(16))}return Et}utils$f.toHex32=st;function at(yt){return yt.length===1?"0"+yt:yt}utils$f.zero2=at;function ct(yt){return yt.length===7?"0"+yt:yt.length===6?"00"+yt:yt.length===5?"000"+yt:yt.length===4?"0000"+yt:yt.length===3?"00000"+yt:yt.length===2?"000000"+yt:yt.length===1?"0000000"+yt:yt}utils$f.zero8=ct;function ut(yt,$t,Et,Tt){var Pt=Et-$t;et(Pt%4===0);for(var St=new Array(Pt/4),Dt=0,wt=$t;Dt<St.length;Dt++,wt+=4){var xt;Tt==="big"?xt=yt[wt]<<24|yt[wt+1]<<16|yt[wt+2]<<8|yt[wt+3]:xt=yt[wt+3]<<24|yt[wt+2]<<16|yt[wt+1]<<8|yt[wt],St[Dt]=xt>>>0}return St}utils$f.join32=ut;function lt(yt,$t){for(var Et=new Array(yt.length*4),Tt=0,Pt=0;Tt<yt.length;Tt++,Pt+=4){var St=yt[Tt];$t==="big"?(Et[Pt]=St>>>24,Et[Pt+1]=St>>>16&255,Et[Pt+2]=St>>>8&255,Et[Pt+3]=St&255):(Et[Pt+3]=St>>>24,Et[Pt+2]=St>>>16&255,Et[Pt+1]=St>>>8&255,Et[Pt]=St&255)}return Et}utils$f.split32=lt;function ht(yt,$t){return yt>>>$t|yt<<32-$t}utils$f.rotr32=ht;function ft(yt,$t){return yt<<$t|yt>>>32-$t}utils$f.rotl32=ft;function dt(yt,$t){return yt+$t>>>0}utils$f.sum32=dt;function pt(yt,$t,Et){return yt+$t+Et>>>0}utils$f.sum32_3=pt;function gt(yt,$t,Et,Tt){return yt+$t+Et+Tt>>>0}utils$f.sum32_4=gt;function _t(yt,$t,Et,Tt,Pt){return yt+$t+Et+Tt+Pt>>>0}utils$f.sum32_5=_t;function mt(yt,$t,Et,Tt){var Pt=yt[$t],St=yt[$t+1],Dt=Tt+St>>>0,wt=(Dt<Tt?1:0)+Et+Pt;yt[$t]=wt>>>0,yt[$t+1]=Dt}utils$f.sum64=mt;function At(yt,$t,Et,Tt){var Pt=$t+Tt>>>0,St=(Pt<$t?1:0)+yt+Et;return St>>>0}utils$f.sum64_hi=At;function It(yt,$t,Et,Tt){var Pt=$t+Tt;return Pt>>>0}utils$f.sum64_lo=It;function Mt(yt,$t,Et,Tt,Pt,St,Dt,wt){var xt=0,Ke=$t;Ke=Ke+Tt>>>0,xt+=Ke<$t?1:0,Ke=Ke+St>>>0,xt+=Ke<St?1:0,Ke=Ke+wt>>>0,xt+=Ke<wt?1:0;var Pe=yt+Et+Pt+Dt+xt;return Pe>>>0}utils$f.sum64_4_hi=Mt;function kt(yt,$t,Et,Tt,Pt,St,Dt,wt){var xt=$t+Tt+St+wt;return xt>>>0}utils$f.sum64_4_lo=kt;function Ct(yt,$t,Et,Tt,Pt,St,Dt,wt,xt,Ke){var Pe=0,Ht=$t;Ht=Ht+Tt>>>0,Pe+=Ht<$t?1:0,Ht=Ht+St>>>0,Pe+=Ht<St?1:0,Ht=Ht+wt>>>0,Pe+=Ht<wt?1:0,Ht=Ht+Ke>>>0,Pe+=Ht<Ke?1:0;var zt=yt+Et+Pt+Dt+xt+Pe;return zt>>>0}utils$f.sum64_5_hi=Ct;function Ut(yt,$t,Et,Tt,Pt,St,Dt,wt,xt,Ke){var Pe=$t+Tt+St+wt+Ke;return Pe>>>0}utils$f.sum64_5_lo=Ut;function Wt(yt,$t,Et){var Tt=$t<<32-Et|yt>>>Et;return Tt>>>0}utils$f.rotr64_hi=Wt;function Ft(yt,$t,Et){var Tt=yt<<32-Et|$t>>>Et;return Tt>>>0}utils$f.rotr64_lo=Ft;function Ce(yt,$t,Et){return yt>>>Et}utils$f.shr64_hi=Ce;function bt(yt,$t,Et){var Tt=yt<<32-Et|$t>>>Et;return Tt>>>0}return utils$f.shr64_lo=bt,utils$f}var common$2={},hasRequiredCommon$1;function requireCommon$1(){if(hasRequiredCommon$1)return common$2;hasRequiredCommon$1=1;var et=requireUtils$3(),tt=requireMinimalisticAssert();function rt(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}return common$2.BlockHash=rt,rt.prototype.update=function(nt,it){if(nt=et.toArray(nt,it),this.pending?this.pending=this.pending.concat(nt):this.pending=nt,this.pendingTotal+=nt.length,this.pending.length>=this._delta8){nt=this.pending;var ot=nt.length%this._delta8;this.pending=nt.slice(nt.length-ot,nt.length),this.pending.length===0&&(this.pending=null),nt=et.join32(nt,0,nt.length-ot,this.endian);for(var st=0;st<nt.length;st+=this._delta32)this._update(nt,st,st+this._delta32)}return this},rt.prototype.digest=function(nt){return this.update(this._pad()),tt(this.pending===null),this._digest(nt)},rt.prototype._pad=function(){var nt=this.pendingTotal,it=this._delta8,ot=it-(nt+this.padLength)%it,st=new Array(ot+this.padLength);st[0]=128;for(var at=1;at<ot;at++)st[at]=0;if(nt<<=3,this.endian==="big"){for(var ct=8;ct<this.padLength;ct++)st[at++]=0;st[at++]=0,st[at++]=0,st[at++]=0,st[at++]=0,st[at++]=nt>>>24&255,st[at++]=nt>>>16&255,st[at++]=nt>>>8&255,st[at++]=nt&255}else for(st[at++]=nt&255,st[at++]=nt>>>8&255,st[at++]=nt>>>16&255,st[at++]=nt>>>24&255,st[at++]=0,st[at++]=0,st[at++]=0,st[at++]=0,ct=8;ct<this.padLength;ct++)st[at++]=0;return st},common$2}var sha={},common$1={},hasRequiredCommon;function requireCommon(){if(hasRequiredCommon)return common$1;hasRequiredCommon=1;var et=requireUtils$3(),tt=et.rotr32;function rt(lt,ht,ft,dt){if(lt===0)return nt(ht,ft,dt);if(lt===1||lt===3)return ot(ht,ft,dt);if(lt===2)return it(ht,ft,dt)}common$1.ft_1=rt;function nt(lt,ht,ft){return lt&ht^~lt&ft}common$1.ch32=nt;function it(lt,ht,ft){return lt&ht^lt&ft^ht&ft}common$1.maj32=it;function ot(lt,ht,ft){return lt^ht^ft}common$1.p32=ot;function st(lt){return tt(lt,2)^tt(lt,13)^tt(lt,22)}common$1.s0_256=st;function at(lt){return tt(lt,6)^tt(lt,11)^tt(lt,25)}common$1.s1_256=at;function ct(lt){return tt(lt,7)^tt(lt,18)^lt>>>3}common$1.g0_256=ct;function ut(lt){return tt(lt,17)^tt(lt,19)^lt>>>10}return common$1.g1_256=ut,common$1}var _1,hasRequired_1;function require_1(){if(hasRequired_1)return _1;hasRequired_1=1;var et=requireUtils$3(),tt=requireCommon$1(),rt=requireCommon(),nt=et.rotl32,it=et.sum32,ot=et.sum32_5,st=rt.ft_1,at=tt.BlockHash,ct=[1518500249,1859775393,2400959708,3395469782];function ut(){if(!(this instanceof ut))return new ut;at.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}return et.inherits(ut,at),_1=ut,ut.blockSize=512,ut.outSize=160,ut.hmacStrength=80,ut.padLength=64,ut.prototype._update=function(lt,ht){for(var ft=this.W,dt=0;dt<16;dt++)ft[dt]=lt[ht+dt];for(;dt<ft.length;dt++)ft[dt]=nt(ft[dt-3]^ft[dt-8]^ft[dt-14]^ft[dt-16],1);var pt=this.h[0],gt=this.h[1],_t=this.h[2],mt=this.h[3],At=this.h[4];for(dt=0;dt<ft.length;dt++){var It=~~(dt/20),Mt=ot(nt(pt,5),st(It,gt,_t,mt),At,ft[dt],ct[It]);At=mt,mt=_t,_t=nt(gt,30),gt=pt,pt=Mt}this.h[0]=it(this.h[0],pt),this.h[1]=it(this.h[1],gt),this.h[2]=it(this.h[2],_t),this.h[3]=it(this.h[3],mt),this.h[4]=it(this.h[4],At)},ut.prototype._digest=function(lt){return lt==="hex"?et.toHex32(this.h,"big"):et.split32(this.h,"big")},_1}var _256,hasRequired_256;function require_256(){if(hasRequired_256)return _256;hasRequired_256=1;var et=requireUtils$3(),tt=requireCommon$1(),rt=requireCommon(),nt=requireMinimalisticAssert(),it=et.sum32,ot=et.sum32_4,st=et.sum32_5,at=rt.ch32,ct=rt.maj32,ut=rt.s0_256,lt=rt.s1_256,ht=rt.g0_256,ft=rt.g1_256,dt=tt.BlockHash,pt=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function gt(){if(!(this instanceof gt))return new gt;dt.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=pt,this.W=new Array(64)}return et.inherits(gt,dt),_256=gt,gt.blockSize=512,gt.outSize=256,gt.hmacStrength=192,gt.padLength=64,gt.prototype._update=function(_t,mt){for(var At=this.W,It=0;It<16;It++)At[It]=_t[mt+It];for(;It<At.length;It++)At[It]=ot(ft(At[It-2]),At[It-7],ht(At[It-15]),At[It-16]);var Mt=this.h[0],kt=this.h[1],Ct=this.h[2],Ut=this.h[3],Wt=this.h[4],Ft=this.h[5],Ce=this.h[6],bt=this.h[7];for(nt(this.k.length===At.length),It=0;It<At.length;It++){var yt=st(bt,lt(Wt),at(Wt,Ft,Ce),this.k[It],At[It]),$t=it(ut(Mt),ct(Mt,kt,Ct));bt=Ce,Ce=Ft,Ft=Wt,Wt=it(Ut,yt),Ut=Ct,Ct=kt,kt=Mt,Mt=it(yt,$t)}this.h[0]=it(this.h[0],Mt),this.h[1]=it(this.h[1],kt),this.h[2]=it(this.h[2],Ct),this.h[3]=it(this.h[3],Ut),this.h[4]=it(this.h[4],Wt),this.h[5]=it(this.h[5],Ft),this.h[6]=it(this.h[6],Ce),this.h[7]=it(this.h[7],bt)},gt.prototype._digest=function(_t){return _t==="hex"?et.toHex32(this.h,"big"):et.split32(this.h,"big")},_256}var _224,hasRequired_224;function require_224(){if(hasRequired_224)return _224;hasRequired_224=1;var et=requireUtils$3(),tt=require_256();function rt(){if(!(this instanceof rt))return new rt;tt.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}return et.inherits(rt,tt),_224=rt,rt.blockSize=512,rt.outSize=224,rt.hmacStrength=192,rt.padLength=64,rt.prototype._digest=function(nt){return nt==="hex"?et.toHex32(this.h.slice(0,7),"big"):et.split32(this.h.slice(0,7),"big")},_224}var _512,hasRequired_512;function require_512(){if(hasRequired_512)return _512;hasRequired_512=1;var et=requireUtils$3(),tt=requireCommon$1(),rt=requireMinimalisticAssert(),nt=et.rotr64_hi,it=et.rotr64_lo,ot=et.shr64_hi,st=et.shr64_lo,at=et.sum64,ct=et.sum64_hi,ut=et.sum64_lo,lt=et.sum64_4_hi,ht=et.sum64_4_lo,ft=et.sum64_5_hi,dt=et.sum64_5_lo,pt=tt.BlockHash,gt=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function _t(){if(!(this instanceof _t))return new _t;pt.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=gt,this.W=new Array(160)}et.inherits(_t,pt),_512=_t,_t.blockSize=1024,_t.outSize=512,_t.hmacStrength=192,_t.padLength=128,_t.prototype._prepareBlock=function($t,Et){for(var Tt=this.W,Pt=0;Pt<32;Pt++)Tt[Pt]=$t[Et+Pt];for(;Pt<Tt.length;Pt+=2){var St=bt(Tt[Pt-4],Tt[Pt-3]),Dt=yt(Tt[Pt-4],Tt[Pt-3]),wt=Tt[Pt-14],xt=Tt[Pt-13],Ke=Ft(Tt[Pt-30],Tt[Pt-29]),Pe=Ce(Tt[Pt-30],Tt[Pt-29]),Ht=Tt[Pt-32],zt=Tt[Pt-31];Tt[Pt]=lt(St,Dt,wt,xt,Ke,Pe,Ht,zt),Tt[Pt+1]=ht(St,Dt,wt,xt,Ke,Pe,Ht,zt)}},_t.prototype._update=function($t,Et){this._prepareBlock($t,Et);var Tt=this.W,Pt=this.h[0],St=this.h[1],Dt=this.h[2],wt=this.h[3],xt=this.h[4],Ke=this.h[5],Pe=this.h[6],Ht=this.h[7],zt=this.h[8],jt=this.h[9],qt=this.h[10],Ge=this.h[11],Ie=this.h[12],Xe=this.h[13],Je=this.h[14],Qe=this.h[15];rt(this.k.length===Tt.length);for(var We=0;We<Tt.length;We+=2){var ur=Je,ar=Qe,cr=Ut(zt,jt),$r=Wt(zt,jt),fr=mt(zt,jt,qt,Ge,Ie),ue=At(zt,jt,qt,Ge,Ie,Xe),Qt=this.k[We],me=this.k[We+1],Lt=Tt[We],Gt=Tt[We+1],Xt=ft(ur,ar,cr,$r,fr,ue,Qt,me,Lt,Gt),Yt=dt(ur,ar,cr,$r,fr,ue,Qt,me,Lt,Gt);ur=kt(Pt,St),ar=Ct(Pt,St),cr=It(Pt,St,Dt,wt,xt),$r=Mt(Pt,St,Dt,wt,xt,Ke);var He=ct(ur,ar,cr,$r),ir=ut(ur,ar,cr,$r);Je=Ie,Qe=Xe,Ie=qt,Xe=Ge,qt=zt,Ge=jt,zt=ct(Pe,Ht,Xt,Yt),jt=ut(Ht,Ht,Xt,Yt),Pe=xt,Ht=Ke,xt=Dt,Ke=wt,Dt=Pt,wt=St,Pt=ct(Xt,Yt,He,ir),St=ut(Xt,Yt,He,ir)}at(this.h,0,Pt,St),at(this.h,2,Dt,wt),at(this.h,4,xt,Ke),at(this.h,6,Pe,Ht),at(this.h,8,zt,jt),at(this.h,10,qt,Ge),at(this.h,12,Ie,Xe),at(this.h,14,Je,Qe)},_t.prototype._digest=function($t){return $t==="hex"?et.toHex32(this.h,"big"):et.split32(this.h,"big")};function mt($t,Et,Tt,Pt,St){var Dt=$t&Tt^~$t&St;return Dt<0&&(Dt+=4294967296),Dt}function At($t,Et,Tt,Pt,St,Dt){var wt=Et&Pt^~Et&Dt;return wt<0&&(wt+=4294967296),wt}function It($t,Et,Tt,Pt,St){var Dt=$t&Tt^$t&St^Tt&St;return Dt<0&&(Dt+=4294967296),Dt}function Mt($t,Et,Tt,Pt,St,Dt){var wt=Et&Pt^Et&Dt^Pt&Dt;return wt<0&&(wt+=4294967296),wt}function kt($t,Et){var Tt=nt($t,Et,28),Pt=nt(Et,$t,2),St=nt(Et,$t,7),Dt=Tt^Pt^St;return Dt<0&&(Dt+=4294967296),Dt}function Ct($t,Et){var Tt=it($t,Et,28),Pt=it(Et,$t,2),St=it(Et,$t,7),Dt=Tt^Pt^St;return Dt<0&&(Dt+=4294967296),Dt}function Ut($t,Et){var Tt=nt($t,Et,14),Pt=nt($t,Et,18),St=nt(Et,$t,9),Dt=Tt^Pt^St;return Dt<0&&(Dt+=4294967296),Dt}function Wt($t,Et){var Tt=it($t,Et,14),Pt=it($t,Et,18),St=it(Et,$t,9),Dt=Tt^Pt^St;return Dt<0&&(Dt+=4294967296),Dt}function Ft($t,Et){var Tt=nt($t,Et,1),Pt=nt($t,Et,8),St=ot($t,Et,7),Dt=Tt^Pt^St;return Dt<0&&(Dt+=4294967296),Dt}function Ce($t,Et){var Tt=it($t,Et,1),Pt=it($t,Et,8),St=st($t,Et,7),Dt=Tt^Pt^St;return Dt<0&&(Dt+=4294967296),Dt}function bt($t,Et){var Tt=nt($t,Et,19),Pt=nt(Et,$t,29),St=ot($t,Et,6),Dt=Tt^Pt^St;return Dt<0&&(Dt+=4294967296),Dt}function yt($t,Et){var Tt=it($t,Et,19),Pt=it(Et,$t,29),St=st($t,Et,6),Dt=Tt^Pt^St;return Dt<0&&(Dt+=4294967296),Dt}return _512}var _384,hasRequired_384;function require_384(){if(hasRequired_384)return _384;hasRequired_384=1;var et=requireUtils$3(),tt=require_512();function rt(){if(!(this instanceof rt))return new rt;tt.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}return et.inherits(rt,tt),_384=rt,rt.blockSize=1024,rt.outSize=384,rt.hmacStrength=192,rt.padLength=128,rt.prototype._digest=function(nt){return nt==="hex"?et.toHex32(this.h.slice(0,12),"big"):et.split32(this.h.slice(0,12),"big")},_384}var hasRequiredSha;function requireSha(){return hasRequiredSha||(hasRequiredSha=1,sha.sha1=require_1(),sha.sha224=require_224(),sha.sha256=require_256(),sha.sha384=require_384(),sha.sha512=require_512()),sha}var ripemd={},hasRequiredRipemd;function requireRipemd(){if(hasRequiredRipemd)return ripemd;hasRequiredRipemd=1;var et=requireUtils$3(),tt=requireCommon$1(),rt=et.rotl32,nt=et.sum32,it=et.sum32_3,ot=et.sum32_4,st=tt.BlockHash;function at(){if(!(this instanceof at))return new at;st.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}et.inherits(at,st),ripemd.ripemd160=at,at.blockSize=512,at.outSize=160,at.hmacStrength=192,at.padLength=64,at.prototype._update=function(gt,_t){for(var mt=this.h[0],At=this.h[1],It=this.h[2],Mt=this.h[3],kt=this.h[4],Ct=mt,Ut=At,Wt=It,Ft=Mt,Ce=kt,bt=0;bt<80;bt++){var yt=nt(rt(ot(mt,ct(bt,At,It,Mt),gt[ht[bt]+_t],ut(bt)),dt[bt]),kt);mt=kt,kt=Mt,Mt=rt(It,10),It=At,At=yt,yt=nt(rt(ot(Ct,ct(79-bt,Ut,Wt,Ft),gt[ft[bt]+_t],lt(bt)),pt[bt]),Ce),Ct=Ce,Ce=Ft,Ft=rt(Wt,10),Wt=Ut,Ut=yt}yt=it(this.h[1],It,Ft),this.h[1]=it(this.h[2],Mt,Ce),this.h[2]=it(this.h[3],kt,Ct),this.h[3]=it(this.h[4],mt,Ut),this.h[4]=it(this.h[0],At,Wt),this.h[0]=yt},at.prototype._digest=function(gt){return gt==="hex"?et.toHex32(this.h,"little"):et.split32(this.h,"little")};function ct(gt,_t,mt,At){return gt<=15?_t^mt^At:gt<=31?_t&mt|~_t&At:gt<=47?(_t|~mt)^At:gt<=63?_t&At|mt&~At:_t^(mt|~At)}function ut(gt){return gt<=15?0:gt<=31?1518500249:gt<=47?1859775393:gt<=63?2400959708:2840853838}function lt(gt){return gt<=15?1352829926:gt<=31?1548603684:gt<=47?1836072691:gt<=63?2053994217:0}var ht=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],ft=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],dt=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],pt=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];return ripemd}var hmac$2,hasRequiredHmac;function requireHmac(){if(hasRequiredHmac)return hmac$2;hasRequiredHmac=1;var et=requireUtils$3(),tt=requireMinimalisticAssert();function rt(nt,it,ot){if(!(this instanceof rt))return new rt(nt,it,ot);this.Hash=nt,this.blockSize=nt.blockSize/8,this.outSize=nt.outSize/8,this.inner=null,this.outer=null,this._init(et.toArray(it,ot))}return hmac$2=rt,rt.prototype._init=function(nt){nt.length>this.blockSize&&(nt=new this.Hash().update(nt).digest()),tt(nt.length<=this.blockSize);for(var it=nt.length;it<this.blockSize;it++)nt.push(0);for(it=0;it<nt.length;it++)nt[it]^=54;for(this.inner=new this.Hash().update(nt),it=0;it<nt.length;it++)nt[it]^=106;this.outer=new this.Hash().update(nt)},rt.prototype.update=function(nt,it){return this.inner.update(nt,it),this},rt.prototype.digest=function(nt){return this.outer.update(this.inner.digest()),this.outer.digest(nt)},hmac$2}var hasRequiredHash;function requireHash(){return hasRequiredHash||(hasRequiredHash=1,function(et){var tt=et;tt.utils=requireUtils$3(),tt.common=requireCommon$1(),tt.sha=requireSha(),tt.ripemd=requireRipemd(),tt.hmac=requireHmac(),tt.sha1=tt.sha.sha1,tt.sha256=tt.sha.sha256,tt.sha224=tt.sha.sha224,tt.sha384=tt.sha.sha384,tt.sha512=tt.sha.sha512,tt.ripemd160=tt.ripemd.ripemd160}(hash$2)),hash$2}var secp256k1$1,hasRequiredSecp256k1$2;function requireSecp256k1$2(){return hasRequiredSecp256k1$2||(hasRequiredSecp256k1$2=1,secp256k1$1={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}),secp256k1$1}var hasRequiredCurves;function requireCurves(){return hasRequiredCurves||(hasRequiredCurves=1,function(et){var tt=et,rt=requireHash(),nt=requireCurve(),it=requireUtils$4(),ot=it.assert;function st(ut){ut.type==="short"?this.curve=new nt.short(ut):ut.type==="edwards"?this.curve=new nt.edwards(ut):this.curve=new nt.mont(ut),this.g=this.curve.g,this.n=this.curve.n,this.hash=ut.hash,ot(this.g.validate(),"Invalid curve"),ot(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}tt.PresetCurve=st;function at(ut,lt){Object.defineProperty(tt,ut,{configurable:!0,enumerable:!0,get:function(){var ht=new st(lt);return Object.defineProperty(tt,ut,{configurable:!0,enumerable:!0,value:ht}),ht}})}at("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:rt.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),at("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:rt.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),at("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:rt.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),at("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:rt.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),at("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:rt.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),at("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:rt.sha256,gRed:!1,g:["9"]}),at("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:rt.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var ct;try{ct=requireSecp256k1$2()}catch{ct=void 0}at("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:rt.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",ct]})}(curves)),curves}var hmacDrbg,hasRequiredHmacDrbg;function requireHmacDrbg(){if(hasRequiredHmacDrbg)return hmacDrbg;hasRequiredHmacDrbg=1;var et=requireHash(),tt=requireUtils$5(),rt=requireMinimalisticAssert();function nt(it){if(!(this instanceof nt))return new nt(it);this.hash=it.hash,this.predResist=!!it.predResist,this.outLen=this.hash.outSize,this.minEntropy=it.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var ot=tt.toArray(it.entropy,it.entropyEnc||"hex"),st=tt.toArray(it.nonce,it.nonceEnc||"hex"),at=tt.toArray(it.pers,it.persEnc||"hex");rt(ot.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(ot,st,at)}return hmacDrbg=nt,nt.prototype._init=function(it,ot,st){var at=it.concat(ot).concat(st);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var ct=0;ct<this.V.length;ct++)this.K[ct]=0,this.V[ct]=1;this._update(at),this._reseed=1,this.reseedInterval=281474976710656},nt.prototype._hmac=function(){return new et.hmac(this.hash,this.K)},nt.prototype._update=function(it){var ot=this._hmac().update(this.V).update([0]);it&&(ot=ot.update(it)),this.K=ot.digest(),this.V=this._hmac().update(this.V).digest(),it&&(this.K=this._hmac().update(this.V).update([1]).update(it).digest(),this.V=this._hmac().update(this.V).digest())},nt.prototype.reseed=function(it,ot,st,at){typeof ot!="string"&&(at=st,st=ot,ot=null),it=tt.toArray(it,ot),st=tt.toArray(st,at),rt(it.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(it.concat(st||[])),this._reseed=1},nt.prototype.generate=function(it,ot,st,at){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof ot!="string"&&(at=st,st=ot,ot=null),st&&(st=tt.toArray(st,at||"hex"),this._update(st));for(var ct=[];ct.length<it;)this.V=this._hmac().update(this.V).digest(),ct=ct.concat(this.V);var ut=ct.slice(0,it);return this._update(st),this._reseed++,tt.encode(ut,ot)},hmacDrbg}var key$2,hasRequiredKey$1;function requireKey$1(){if(hasRequiredKey$1)return key$2;hasRequiredKey$1=1;var et=requireBn(),tt=requireUtils$4(),rt=tt.assert;function nt(it,ot){this.ec=it,this.priv=null,this.pub=null,ot.priv&&this._importPrivate(ot.priv,ot.privEnc),ot.pub&&this._importPublic(ot.pub,ot.pubEnc)}return key$2=nt,nt.fromPublic=function(it,ot,st){return ot instanceof nt?ot:new nt(it,{pub:ot,pubEnc:st})},nt.fromPrivate=function(it,ot,st){return ot instanceof nt?ot:new nt(it,{priv:ot,privEnc:st})},nt.prototype.validate=function(){var it=this.getPublic();return it.isInfinity()?{result:!1,reason:"Invalid public key"}:it.validate()?it.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},nt.prototype.getPublic=function(it,ot){return typeof it=="string"&&(ot=it,it=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),ot?this.pub.encode(ot,it):this.pub},nt.prototype.getPrivate=function(it){return it==="hex"?this.priv.toString(16,2):this.priv},nt.prototype._importPrivate=function(it,ot){this.priv=new et(it,ot||16),this.priv=this.priv.umod(this.ec.curve.n)},nt.prototype._importPublic=function(it,ot){if(it.x||it.y){this.ec.curve.type==="mont"?rt(it.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&rt(it.x&&it.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(it.x,it.y);return}this.pub=this.ec.curve.decodePoint(it,ot)},nt.prototype.derive=function(it){return it.validate()||rt(it.validate(),"public point not validated"),it.mul(this.priv).getX()},nt.prototype.sign=function(it,ot,st){return this.ec.sign(it,this,ot,st)},nt.prototype.verify=function(it,ot){return this.ec.verify(it,ot,this)},nt.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"},key$2}var signature$1,hasRequiredSignature$1;function requireSignature$1(){if(hasRequiredSignature$1)return signature$1;hasRequiredSignature$1=1;var et=requireBn(),tt=requireUtils$4(),rt=tt.assert;function nt(ct,ut){if(ct instanceof nt)return ct;this._importDER(ct,ut)||(rt(ct.r&&ct.s,"Signature without r or s"),this.r=new et(ct.r,16),this.s=new et(ct.s,16),ct.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=ct.recoveryParam)}signature$1=nt;function it(){this.place=0}function ot(ct,ut){var lt=ct[ut.place++];if(!(lt&128))return lt;var ht=lt&15;if(ht===0||ht>4)return!1;for(var ft=0,dt=0,pt=ut.place;dt<ht;dt++,pt++)ft<<=8,ft|=ct[pt],ft>>>=0;return ft<=127?!1:(ut.place=pt,ft)}function st(ct){for(var ut=0,lt=ct.length-1;!ct[ut]&&!(ct[ut+1]&128)&&ut<lt;)ut++;return ut===0?ct:ct.slice(ut)}nt.prototype._importDER=function(ct,ut){ct=tt.toArray(ct,ut);var lt=new it;if(ct[lt.place++]!==48)return!1;var ht=ot(ct,lt);if(ht===!1||ht+lt.place!==ct.length||ct[lt.place++]!==2)return!1;var ft=ot(ct,lt);if(ft===!1)return!1;var dt=ct.slice(lt.place,ft+lt.place);if(lt.place+=ft,ct[lt.place++]!==2)return!1;var pt=ot(ct,lt);if(pt===!1||ct.length!==pt+lt.place)return!1;var gt=ct.slice(lt.place,pt+lt.place);if(dt[0]===0)if(dt[1]&128)dt=dt.slice(1);else return!1;if(gt[0]===0)if(gt[1]&128)gt=gt.slice(1);else return!1;return this.r=new et(dt),this.s=new et(gt),this.recoveryParam=null,!0};function at(ct,ut){if(ut<128){ct.push(ut);return}var lt=1+(Math.log(ut)/Math.LN2>>>3);for(ct.push(lt|128);--lt;)ct.push(ut>>>(lt<<3)&255);ct.push(ut)}return nt.prototype.toDER=function(ct){var ut=this.r.toArray(),lt=this.s.toArray();for(ut[0]&128&&(ut=[0].concat(ut)),lt[0]&128&&(lt=[0].concat(lt)),ut=st(ut),lt=st(lt);!lt[0]&&!(lt[1]&128);)lt=lt.slice(1);var ht=[2];at(ht,ut.length),ht=ht.concat(ut),ht.push(2),at(ht,lt.length);var ft=ht.concat(lt),dt=[48];return at(dt,ft.length),dt=dt.concat(ft),tt.encode(dt,ct)},signature$1}var ec,hasRequiredEc;function requireEc(){if(hasRequiredEc)return ec;hasRequiredEc=1;var et=requireBn(),tt=requireHmacDrbg(),rt=requireUtils$4(),nt=requireCurves(),it=requireBrorand(),ot=rt.assert,st=requireKey$1(),at=requireSignature$1();function ct(ut){if(!(this instanceof ct))return new ct(ut);typeof ut=="string"&&(ot(Object.prototype.hasOwnProperty.call(nt,ut),"Unknown curve "+ut),ut=nt[ut]),ut instanceof nt.PresetCurve&&(ut={curve:ut}),this.curve=ut.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=ut.curve.g,this.g.precompute(ut.curve.n.bitLength()+1),this.hash=ut.hash||ut.curve.hash}return ec=ct,ct.prototype.keyPair=function(ut){return new st(this,ut)},ct.prototype.keyFromPrivate=function(ut,lt){return st.fromPrivate(this,ut,lt)},ct.prototype.keyFromPublic=function(ut,lt){return st.fromPublic(this,ut,lt)},ct.prototype.genKeyPair=function(ut){ut||(ut={});for(var lt=new tt({hash:this.hash,pers:ut.pers,persEnc:ut.persEnc||"utf8",entropy:ut.entropy||it(this.hash.hmacStrength),entropyEnc:ut.entropy&&ut.entropyEnc||"utf8",nonce:this.n.toArray()}),ht=this.n.byteLength(),ft=this.n.sub(new et(2));;){var dt=new et(lt.generate(ht));if(!(dt.cmp(ft)>0))return dt.iaddn(1),this.keyFromPrivate(dt)}},ct.prototype._truncateToN=function(ut,lt){var ht=ut.byteLength()*8-this.n.bitLength();return ht>0&&(ut=ut.ushrn(ht)),!lt&&ut.cmp(this.n)>=0?ut.sub(this.n):ut},ct.prototype.sign=function(ut,lt,ht,ft){typeof ht=="object"&&(ft=ht,ht=null),ft||(ft={}),lt=this.keyFromPrivate(lt,ht),ut=this._truncateToN(new et(ut,16));for(var dt=this.n.byteLength(),pt=lt.getPrivate().toArray("be",dt),gt=ut.toArray("be",dt),_t=new tt({hash:this.hash,entropy:pt,nonce:gt,pers:ft.pers,persEnc:ft.persEnc||"utf8"}),mt=this.n.sub(new et(1)),At=0;;At++){var It=ft.k?ft.k(At):new et(_t.generate(this.n.byteLength()));if(It=this._truncateToN(It,!0),!(It.cmpn(1)<=0||It.cmp(mt)>=0)){var Mt=this.g.mul(It);if(!Mt.isInfinity()){var kt=Mt.getX(),Ct=kt.umod(this.n);if(Ct.cmpn(0)!==0){var Ut=It.invm(this.n).mul(Ct.mul(lt.getPrivate()).iadd(ut));if(Ut=Ut.umod(this.n),Ut.cmpn(0)!==0){var Wt=(Mt.getY().isOdd()?1:0)|(kt.cmp(Ct)!==0?2:0);return ft.canonical&&Ut.cmp(this.nh)>0&&(Ut=this.n.sub(Ut),Wt^=1),new at({r:Ct,s:Ut,recoveryParam:Wt})}}}}}},ct.prototype.verify=function(ut,lt,ht,ft){ut=this._truncateToN(new et(ut,16)),ht=this.keyFromPublic(ht,ft),lt=new at(lt,"hex");var dt=lt.r,pt=lt.s;if(dt.cmpn(1)<0||dt.cmp(this.n)>=0||pt.cmpn(1)<0||pt.cmp(this.n)>=0)return!1;var gt=pt.invm(this.n),_t=gt.mul(ut).umod(this.n),mt=gt.mul(dt).umod(this.n),At;return this.curve._maxwellTrick?(At=this.g.jmulAdd(_t,ht.getPublic(),mt),At.isInfinity()?!1:At.eqXToP(dt)):(At=this.g.mulAdd(_t,ht.getPublic(),mt),At.isInfinity()?!1:At.getX().umod(this.n).cmp(dt)===0)},ct.prototype.recoverPubKey=function(ut,lt,ht,ft){ot((3&ht)===ht,"The recovery param is more than two bits"),lt=new at(lt,ft);var dt=this.n,pt=new et(ut),gt=lt.r,_t=lt.s,mt=ht&1,At=ht>>1;if(gt.cmp(this.curve.p.umod(this.curve.n))>=0&&At)throw new Error("Unable to find sencond key candinate");At?gt=this.curve.pointFromX(gt.add(this.curve.n),mt):gt=this.curve.pointFromX(gt,mt);var It=lt.r.invm(dt),Mt=dt.sub(pt).mul(It).umod(dt),kt=_t.mul(It).umod(dt);return this.g.mulAdd(Mt,gt,kt)},ct.prototype.getKeyRecoveryParam=function(ut,lt,ht,ft){if(lt=new at(lt,ft),lt.recoveryParam!==null)return lt.recoveryParam;for(var dt=0;dt<4;dt++){var pt;try{pt=this.recoverPubKey(ut,lt,dt)}catch{continue}if(pt.eq(ht))return dt}throw new Error("Unable to find valid recovery factor")},ec}var key$1,hasRequiredKey;function requireKey(){if(hasRequiredKey)return key$1;hasRequiredKey=1;var et=requireUtils$4(),tt=et.assert,rt=et.parseBytes,nt=et.cachedProperty;function it(ot,st){this.eddsa=ot,this._secret=rt(st.secret),ot.isPoint(st.pub)?this._pub=st.pub:this._pubBytes=rt(st.pub)}return it.fromPublic=function(ot,st){return st instanceof it?st:new it(ot,{pub:st})},it.fromSecret=function(ot,st){return st instanceof it?st:new it(ot,{secret:st})},it.prototype.secret=function(){return this._secret},nt(it,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),nt(it,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),nt(it,"privBytes",function(){var ot=this.eddsa,st=this.hash(),at=ot.encodingLength-1,ct=st.slice(0,ot.encodingLength);return ct[0]&=248,ct[at]&=127,ct[at]|=64,ct}),nt(it,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),nt(it,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),nt(it,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),it.prototype.sign=function(ot){return tt(this._secret,"KeyPair can only verify"),this.eddsa.sign(ot,this)},it.prototype.verify=function(ot,st){return this.eddsa.verify(ot,st,this)},it.prototype.getSecret=function(ot){return tt(this._secret,"KeyPair is public only"),et.encode(this.secret(),ot)},it.prototype.getPublic=function(ot){return et.encode(this.pubBytes(),ot)},key$1=it,key$1}var signature,hasRequiredSignature;function requireSignature(){if(hasRequiredSignature)return signature;hasRequiredSignature=1;var et=requireBn(),tt=requireUtils$4(),rt=tt.assert,nt=tt.cachedProperty,it=tt.parseBytes;function ot(st,at){this.eddsa=st,typeof at!="object"&&(at=it(at)),Array.isArray(at)&&(at={R:at.slice(0,st.encodingLength),S:at.slice(st.encodingLength)}),rt(at.R&&at.S,"Signature without R or S"),st.isPoint(at.R)&&(this._R=at.R),at.S instanceof et&&(this._S=at.S),this._Rencoded=Array.isArray(at.R)?at.R:at.Rencoded,this._Sencoded=Array.isArray(at.S)?at.S:at.Sencoded}return nt(ot,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),nt(ot,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),nt(ot,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),nt(ot,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),ot.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},ot.prototype.toHex=function(){return tt.encode(this.toBytes(),"hex").toUpperCase()},signature=ot,signature}var eddsa,hasRequiredEddsa;function requireEddsa(){if(hasRequiredEddsa)return eddsa;hasRequiredEddsa=1;var et=requireHash(),tt=requireCurves(),rt=requireUtils$4(),nt=rt.assert,it=rt.parseBytes,ot=requireKey(),st=requireSignature();function at(ct){if(nt(ct==="ed25519","only tested with ed25519 so far"),!(this instanceof at))return new at(ct);ct=tt[ct].curve,this.curve=ct,this.g=ct.g,this.g.precompute(ct.n.bitLength()+1),this.pointClass=ct.point().constructor,this.encodingLength=Math.ceil(ct.n.bitLength()/8),this.hash=et.sha512}return eddsa=at,at.prototype.sign=function(ct,ut){ct=it(ct);var lt=this.keyFromSecret(ut),ht=this.hashInt(lt.messagePrefix(),ct),ft=this.g.mul(ht),dt=this.encodePoint(ft),pt=this.hashInt(dt,lt.pubBytes(),ct).mul(lt.priv()),gt=ht.add(pt).umod(this.curve.n);return this.makeSignature({R:ft,S:gt,Rencoded:dt})},at.prototype.verify=function(ct,ut,lt){ct=it(ct),ut=this.makeSignature(ut);var ht=this.keyFromPublic(lt),ft=this.hashInt(ut.Rencoded(),ht.pubBytes(),ct),dt=this.g.mul(ut.S()),pt=ut.R().add(ht.pub().mul(ft));return pt.eq(dt)},at.prototype.hashInt=function(){for(var ct=this.hash(),ut=0;ut<arguments.length;ut++)ct.update(arguments[ut]);return rt.intFromLE(ct.digest()).umod(this.curve.n)},at.prototype.keyFromPublic=function(ct){return ot.fromPublic(this,ct)},at.prototype.keyFromSecret=function(ct){return ot.fromSecret(this,ct)},at.prototype.makeSignature=function(ct){return ct instanceof st?ct:new st(this,ct)},at.prototype.encodePoint=function(ct){var ut=ct.getY().toArray("le",this.encodingLength);return ut[this.encodingLength-1]|=ct.getX().isOdd()?128:0,ut},at.prototype.decodePoint=function(ct){ct=rt.parseBytes(ct);var ut=ct.length-1,lt=ct.slice(0,ut).concat(ct[ut]&-129),ht=(ct[ut]&128)!==0,ft=rt.intFromLE(lt);return this.curve.pointFromY(ft,ht)},at.prototype.encodeInt=function(ct){return ct.toArray("le",this.encodingLength)},at.prototype.decodeInt=function(ct){return rt.intFromLE(ct)},at.prototype.isPoint=function(ct){return ct instanceof this.pointClass},eddsa}var hasRequiredElliptic$2;function requireElliptic$2(){return hasRequiredElliptic$2||(hasRequiredElliptic$2=1,function(et){var tt=et;tt.version=require$$0$2.version,tt.utils=requireUtils$4(),tt.rand=requireBrorand(),tt.curve=requireCurve(),tt.curves=requireCurves(),tt.ec=requireEc(),tt.eddsa=requireEddsa()}(elliptic$2)),elliptic$2}var elliptic$1,hasRequiredElliptic$1;function requireElliptic$1(){if(hasRequiredElliptic$1)return elliptic$1;hasRequiredElliptic$1=1;const et=requireElliptic$2().ec,tt=new et("secp256k1"),rt=tt.curve,nt=rt.n.constructor;function it(ct,ut){let lt=new nt(ut);if(lt.cmp(rt.p)>=0)return null;lt=lt.toRed(rt.red);let ht=lt.redSqr().redIMul(lt).redIAdd(rt.b).redSqrt();return ct===3!==ht.isOdd()&&(ht=ht.redNeg()),tt.keyPair({pub:{x:lt,y:ht}})}function ot(ct,ut,lt){let ht=new nt(ut),ft=new nt(lt);if(ht.cmp(rt.p)>=0||ft.cmp(rt.p)>=0||(ht=ht.toRed(rt.red),ft=ft.toRed(rt.red),(ct===6||ct===7)&&ft.isOdd()!==(ct===7)))return null;const dt=ht.redSqr().redIMul(ht);return ft.redSqr().redISub(dt.redIAdd(rt.b)).isZero()?tt.keyPair({pub:{x:ht,y:ft}}):null}function st(ct){const ut=ct[0];switch(ut){case 2:case 3:return ct.length!==33?null:it(ut,ct.subarray(1,33));case 4:case 6:case 7:return ct.length!==65?null:ot(ut,ct.subarray(1,33),ct.subarray(33,65));default:return null}}function at(ct,ut){const lt=ut.encode(null,ct.length===33);for(let ht=0;ht<ct.length;++ht)ct[ht]=lt[ht]}return elliptic$1={contextRandomize(){return 0},privateKeyVerify(ct){const ut=new nt(ct);return ut.cmp(rt.n)<0&&!ut.isZero()?0:1},privateKeyNegate(ct){const ut=new nt(ct),lt=rt.n.sub(ut).umod(rt.n).toArrayLike(Uint8Array,"be",32);return ct.set(lt),0},privateKeyTweakAdd(ct,ut){const lt=new nt(ut);if(lt.cmp(rt.n)>=0||(lt.iadd(new nt(ct)),lt.cmp(rt.n)>=0&&lt.isub(rt.n),lt.isZero()))return 1;const ht=lt.toArrayLike(Uint8Array,"be",32);return ct.set(ht),0},privateKeyTweakMul(ct,ut){let lt=new nt(ut);if(lt.cmp(rt.n)>=0||lt.isZero())return 1;lt.imul(new nt(ct)),lt.cmp(rt.n)>=0&&(lt=lt.umod(rt.n));const ht=lt.toArrayLike(Uint8Array,"be",32);return ct.set(ht),0},publicKeyVerify(ct){return st(ct)===null?1:0},publicKeyCreate(ct,ut){const lt=new nt(ut);if(lt.cmp(rt.n)>=0||lt.isZero())return 1;const ht=tt.keyFromPrivate(ut).getPublic();return at(ct,ht),0},publicKeyConvert(ct,ut){const lt=st(ut);if(lt===null)return 1;const ht=lt.getPublic();return at(ct,ht),0},publicKeyNegate(ct,ut){const lt=st(ut);if(lt===null)return 1;const ht=lt.getPublic();return ht.y=ht.y.redNeg(),at(ct,ht),0},publicKeyCombine(ct,ut){const lt=new Array(ut.length);for(let ft=0;ft<ut.length;++ft)if(lt[ft]=st(ut[ft]),lt[ft]===null)return 1;let ht=lt[0].getPublic();for(let ft=1;ft<lt.length;++ft)ht=ht.add(lt[ft].pub);return ht.isInfinity()?2:(at(ct,ht),0)},publicKeyTweakAdd(ct,ut,lt){const ht=st(ut);if(ht===null)return 1;if(lt=new nt(lt),lt.cmp(rt.n)>=0)return 2;const ft=ht.getPublic().add(rt.g.mul(lt));return ft.isInfinity()?2:(at(ct,ft),0)},publicKeyTweakMul(ct,ut,lt){const ht=st(ut);if(ht===null)return 1;if(lt=new nt(lt),lt.cmp(rt.n)>=0||lt.isZero())return 2;const ft=ht.getPublic().mul(lt);return at(ct,ft),0},signatureNormalize(ct){const ut=new nt(ct.subarray(0,32)),lt=new nt(ct.subarray(32,64));return ut.cmp(rt.n)>=0||lt.cmp(rt.n)>=0?1:(lt.cmp(tt.nh)===1&&ct.set(rt.n.sub(lt).toArrayLike(Uint8Array,"be",32),32),0)},signatureExport(ct,ut){const lt=ut.subarray(0,32),ht=ut.subarray(32,64);if(new nt(lt).cmp(rt.n)>=0||new nt(ht).cmp(rt.n)>=0)return 1;const{output:ft}=ct;let dt=ft.subarray(4,4+33);dt[0]=0,dt.set(lt,1);let pt=33,gt=0;for(;pt>1&&dt[gt]===0&&!(dt[gt+1]&128);--pt,++gt);if(dt=dt.subarray(gt),dt[0]&128||pt>1&&dt[0]===0&&!(dt[1]&128))return 1;let _t=ft.subarray(6+33,6+33+33);_t[0]=0,_t.set(ht,1);let mt=33,At=0;for(;mt>1&&_t[At]===0&&!(_t[At+1]&128);--mt,++At);return _t=_t.subarray(At),_t[0]&128||mt>1&&_t[0]===0&&!(_t[1]&128)?1:(ct.outputlen=6+pt+mt,ft[0]=48,ft[1]=ct.outputlen-2,ft[2]=2,ft[3]=dt.length,ft.set(dt,4),ft[4+pt]=2,ft[5+pt]=_t.length,ft.set(_t,6+pt),0)},signatureImport(ct,ut){if(ut.length<8||ut.length>72||ut[0]!==48||ut[1]!==ut.length-2||ut[2]!==2)return 1;const lt=ut[3];if(lt===0||5+lt>=ut.length||ut[4+lt]!==2)return 1;const ht=ut[5+lt];if(ht===0||6+lt+ht!==ut.length||ut[4]&128||lt>1&&ut[4]===0&&!(ut[5]&128)||ut[lt+6]&128||ht>1&&ut[lt+6]===0&&!(ut[lt+7]&128))return 1;let ft=ut.subarray(4,4+lt);if(ft.length===33&&ft[0]===0&&(ft=ft.subarray(1)),ft.length>32)return 1;let dt=ut.subarray(6+lt);if(dt.length===33&&dt[0]===0&&(dt=dt.slice(1)),dt.length>32)throw new Error("S length is too long");let pt=new nt(ft);pt.cmp(rt.n)>=0&&(pt=new nt(0));let gt=new nt(ut.subarray(6+lt));return gt.cmp(rt.n)>=0&&(gt=new nt(0)),ct.set(pt.toArrayLike(Uint8Array,"be",32),0),ct.set(gt.toArrayLike(Uint8Array,"be",32),32),0},ecdsaSign(ct,ut,lt,ht,ft){if(ft){const gt=ft;ft=_t=>{const mt=gt(ut,lt,null,ht,_t);if(!(mt instanceof Uint8Array&&mt.length===32))throw new Error("This is the way");return new nt(mt)}}const dt=new nt(lt);if(dt.cmp(rt.n)>=0||dt.isZero())return 1;let pt;try{pt=tt.sign(ut,lt,{canonical:!0,k:ft,pers:ht})}catch{return 1}return ct.signature.set(pt.r.toArrayLike(Uint8Array,"be",32),0),ct.signature.set(pt.s.toArrayLike(Uint8Array,"be",32),32),ct.recid=pt.recoveryParam,0},ecdsaVerify(ct,ut,lt){const ht={r:ct.subarray(0,32),s:ct.subarray(32,64)},ft=new nt(ht.r),dt=new nt(ht.s);if(ft.cmp(rt.n)>=0||dt.cmp(rt.n)>=0)return 1;if(dt.cmp(tt.nh)===1||ft.isZero()||dt.isZero())return 3;const pt=st(lt);if(pt===null)return 2;const gt=pt.getPublic();return tt.verify(ut,ht,gt)?0:3},ecdsaRecover(ct,ut,lt,ht){const ft={r:ut.slice(0,32),s:ut.slice(32,64)},dt=new nt(ft.r),pt=new nt(ft.s);if(dt.cmp(rt.n)>=0||pt.cmp(rt.n)>=0)return 1;if(dt.isZero()||pt.isZero())return 2;let gt;try{gt=tt.recoverPubKey(ht,ft,lt)}catch{return 2}return at(ct,gt),0},ecdh(ct,ut,lt,ht,ft,dt,pt){const gt=st(ut);if(gt===null)return 1;const _t=new nt(lt);if(_t.cmp(rt.n)>=0||_t.isZero())return 2;const mt=gt.getPublic().mul(_t);if(ft===void 0){const At=mt.encode(null,!0),It=tt.hash().update(At).digest();for(let Mt=0;Mt<32;++Mt)ct[Mt]=It[Mt]}else{dt||(dt=new Uint8Array(32));const At=mt.getX().toArray("be",32);for(let kt=0;kt<32;++kt)dt[kt]=At[kt];pt||(pt=new Uint8Array(32));const It=mt.getY().toArray("be",32);for(let kt=0;kt<32;++kt)pt[kt]=It[kt];const Mt=ft(dt,pt,ht);if(!(Mt instanceof Uint8Array&&Mt.length===ct.length))return 2;ct.set(Mt)}return 0}},elliptic$1}var elliptic,hasRequiredElliptic;function requireElliptic(){return hasRequiredElliptic||(hasRequiredElliptic=1,elliptic=requireLib$1()(requireElliptic$1())),elliptic}var secp256k1_1,hasRequiredSecp256k1$1;function requireSecp256k1$1(){if(hasRequiredSecp256k1$1)return secp256k1_1;hasRequiredSecp256k1$1=1;const et=requireElliptic(),{sha256:tt}=require$$1$4;return secp256k1_1=rt=>{function nt(){let ht;do ht=rt(32);while(!et.privateKeyVerify(ht));return ht}async function it(ht,ft){const{digest:dt}=await tt.digest(ft),pt=et.ecdsaSign(dt,ht);return et.signatureExport(pt.signature)}async function ot(ht,ft,dt){const{digest:pt}=await tt.digest(dt);return ft=et.signatureImport(ft),et.ecdsaVerify(ft,pt,ht)}function st(ht){if(!et.publicKeyVerify(ht))throw new Error("Invalid public key");return et.publicKeyConvert(ht,!0)}function at(ht){return et.publicKeyConvert(ht,!1)}function ct(ht){if(!et.privateKeyVerify(ht))throw new Error("Invalid private key")}function ut(ht){if(!et.publicKeyVerify(ht))throw new Error("Invalid public key")}function lt(ht){return ct(ht),et.publicKeyCreate(ht)}return{generateKey:nt,privateKeyLength:32,hashAndSign:it,hashAndVerify:ot,compressPublicKey:st,decompressPublicKey:at,validatePrivateKey:ct,validatePublicKey:ut,computePublicKey:lt}},secp256k1_1}const{sha256:sha256$7}=require$$1$4,errcode$d=errCode$i,{equals:uint8ArrayEquals$5}=require$$1$3,{toString:uint8ArrayToString$l}=require$$1$2,exporter$4=exporter$7;var secp256k1Class$1=(et,tt,rt)=>{rt=rt||requireSecp256k1$1()(tt);class nt{constructor(ut){rt.validatePublicKey(ut),this._key=ut}verify(ut,lt){return rt.hashAndVerify(this._key,lt,ut)}marshal(){return rt.compressPublicKey(this._key)}get bytes(){return et.PublicKey.encode({Type:et.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(ut){return uint8ArrayEquals$5(this.bytes,ut.bytes)}async hash(){const{bytes:ut}=await sha256$7.digest(this.bytes);return ut}}class it{constructor(ut,lt){this._key=ut,this._publicKey=lt||rt.computePublicKey(ut),rt.validatePrivateKey(this._key),rt.validatePublicKey(this._publicKey)}sign(ut){return rt.hashAndSign(this._key,ut)}get public(){return new nt(this._publicKey)}marshal(){return this._key}get bytes(){return et.PrivateKey.encode({Type:et.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(ut){return uint8ArrayEquals$5(this.bytes,ut.bytes)}async hash(){const{bytes:ut}=await sha256$7.digest(this.bytes);return ut}async id(){const ut=await this.public.hash();return uint8ArrayToString$l(ut,"base58btc")}async export(ut,lt="libp2p-key"){if(lt==="libp2p-key")return exporter$4.export(this.bytes,ut);throw errcode$d(new Error(`export format '${lt}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function ot(ct){return new it(ct)}function st(ct){return new nt(ct)}async function at(){const ct=await rt.generateKey();return new it(ct)}return{Secp256k1PublicKey:nt,Secp256k1PrivateKey:it,unmarshalSecp256k1PrivateKey:ot,unmarshalSecp256k1PublicKey:st,generateKeyPair:at}},keyStretcher$1,hasRequiredKeyStretcher$1;function requireKeyStretcher$1(){if(hasRequiredKeyStretcher$1)return keyStretcher$1;hasRequiredKeyStretcher$1=1;const et=errCode$i,{concat:tt}=require$$7$1,{fromString:rt}=require$$9$2,nt=indexBrowser$1,it={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};return keyStretcher$1=async(ot,st,at)=>{const ct=it[ot];if(!ct){const Ut=Object.keys(it).join(" / ");throw et(new Error(`unknown cipher type '${ot}'. Must be ${Ut}`),"ERR_INVALID_CIPHER_TYPE")}if(!st)throw et(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");const ut=ct.keySize,lt=ct.ivSize,ht=20,ft=rt("key expansion"),dt=2*(lt+ut+ht),pt=await nt.create(st,at);let gt=await pt.digest(ft);const _t=[];let mt=0;for(;mt<dt;){const Ut=await pt.digest(tt([gt,ft]));let Wt=Ut.length;mt+Wt>dt&&(Wt=dt-mt),_t.push(Ut),mt+=Wt,gt=await pt.digest(gt)}const At=dt/2,It=tt(_t),Mt=It.slice(0,At),kt=It.slice(At,dt),Ct=Ut=>({iv:Ut.slice(0,lt),cipherKey:Ut.slice(lt,lt+ut),macKey:Ut.slice(lt+ut)});return{k1:Ct(Mt),k2:Ct(kt)}},keyStretcher$1}var ecdhBrowser$1={},validateCurveType$1,hasRequiredValidateCurveType$1;function requireValidateCurveType$1(){if(hasRequiredValidateCurveType$1)return validateCurveType$1;hasRequiredValidateCurveType$1=1;const et=errCode$i;return validateCurveType$1=function(tt,rt){if(!tt.includes(rt)){const nt=tt.join(" / ");throw et(new Error(`Unknown curve: ${rt}. Must be ${nt}`),"ERR_INVALID_CURVE")}},validateCurveType$1}var hasRequiredEcdhBrowser$1;function requireEcdhBrowser$1(){if(hasRequiredEcdhBrowser$1)return ecdhBrowser$1;hasRequiredEcdhBrowser$1=1;const et=errCode$i,tt=webcrypto$6,{base64urlToBuffer:rt}=util$3,nt=requireValidateCurveType$1(),{toString:it}=require$$1$2,{concat:ot}=require$$7$1,{equals:st}=require$$1$3,at={"P-256":256,"P-384":384,"P-521":521};ecdhBrowser$1.generateEphmeralKeyPair=async function(ft){nt(Object.keys(at),ft);const dt=await tt.get().subtle.generateKey({name:"ECDH",namedCurve:ft},!0,["deriveBits"]),pt=async(_t,mt)=>{let At;mt?At=await tt.get().subtle.importKey("jwk",ht(ft,mt),{name:"ECDH",namedCurve:ft},!1,["deriveBits"]):At=dt.privateKey;const It=[await tt.get().subtle.importKey("jwk",lt(ft,_t),{name:"ECDH",namedCurve:ft},!1,[]),At],Mt=await tt.get().subtle.deriveBits({name:"ECDH",namedCurve:ft,public:It[0]},It[1],at[ft]);return new Uint8Array(Mt,Mt.byteOffset,Mt.byteLength)},gt=await tt.get().subtle.exportKey("jwk",dt.publicKey);return{key:ut(gt),genSharedKey:pt}};const ct={"P-256":32,"P-384":48,"P-521":66};function ut(ft){const dt=ct[ft.crv];return ot([Uint8Array.from([4]),rt(ft.x,dt),rt(ft.y,dt)],1+dt*2)}function lt(ft,dt){const pt=ct[ft];if(st(!dt.slice(0,1),Uint8Array.from([4])))throw et(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:ft,x:it(dt.slice(1,pt+1),"base64url"),y:it(dt.slice(1+pt),"base64url"),ext:!0}}const ht=(ft,dt)=>({...lt(ft,dt.public),d:it(dt.private,"base64url")});return ecdhBrowser$1}var ephemeralKeys$1,hasRequiredEphemeralKeys$1;function requireEphemeralKeys$1(){if(hasRequiredEphemeralKeys$1)return ephemeralKeys$1;hasRequiredEphemeralKeys$1=1;const et=requireEcdhBrowser$1();return ephemeralKeys$1=async tt=>et.generateEphmeralKeyPair(tt),ephemeralKeys$1}const keysPBM$1=keys$4,forge$q=forge$W,errcode$c=errCode$i,{fromString:uint8ArrayFromString$h}=require$$9$2,importer$2=importer$3,supportedKeys$1={rsa:rsaClass$1,ed25519:ed25519Class$1,secp256k1:secp256k1Class$1(keysPBM$1,randomBytes_1$2)},ErrMissingSecp256K1$1={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function typeToKey$1(et){const tt=supportedKeys$1[et.toLowerCase()];if(!tt){const rt=Object.keys(supportedKeys$1).join(" / ");throw errcode$c(new Error(`invalid or unsupported key type ${et}. Must be ${rt}`),"ERR_UNSUPPORTED_KEY_TYPE")}return tt}const generateKeyPair$4=async(et,tt)=>typeToKey$1(et).generateKeyPair(tt),generateKeyPairFromSeed$2=async(et,tt,rt)=>{const nt=typeToKey$1(et);if(et.toLowerCase()!=="ed25519")throw errcode$c(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return nt.generateKeyPairFromSeed(tt,rt)},unmarshalPublicKey$1=et=>{const tt=keysPBM$1.PublicKey.decode(et),rt=tt.Data;switch(tt.Type){case keysPBM$1.KeyType.RSA:return supportedKeys$1.rsa.unmarshalRsaPublicKey(rt);case keysPBM$1.KeyType.Ed25519:return supportedKeys$1.ed25519.unmarshalEd25519PublicKey(rt);case keysPBM$1.KeyType.Secp256k1:if(supportedKeys$1.secp256k1)return supportedKeys$1.secp256k1.unmarshalSecp256k1PublicKey(rt);throw errcode$c(new Error(ErrMissingSecp256K1$1.message),ErrMissingSecp256K1$1.code);default:typeToKey$1(tt.Type)}},marshalPublicKey$1=(et,tt)=>(tt=(tt||"rsa").toLowerCase(),typeToKey$1(tt),et.bytes),unmarshalPrivateKey$1=async et=>{const tt=keysPBM$1.PrivateKey.decode(et),rt=tt.Data;switch(tt.Type){case keysPBM$1.KeyType.RSA:return supportedKeys$1.rsa.unmarshalRsaPrivateKey(rt);case keysPBM$1.KeyType.Ed25519:return supportedKeys$1.ed25519.unmarshalEd25519PrivateKey(rt);case keysPBM$1.KeyType.Secp256k1:if(supportedKeys$1.secp256k1)return supportedKeys$1.secp256k1.unmarshalSecp256k1PrivateKey(rt);throw errcode$c(new Error(ErrMissingSecp256K1$1.message),ErrMissingSecp256K1$1.code);default:typeToKey$1(tt.Type)}},marshalPrivateKey$1=(et,tt)=>(tt=(tt||"rsa").toLowerCase(),typeToKey$1(tt),et.bytes),importKey$1=async(et,tt)=>{try{const it=await importer$2.import(et,tt);return unmarshalPrivateKey$1(it)}catch{}const rt=forge$q.pki.decryptRsaPrivateKey(et,tt);if(rt===null)throw errcode$c(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let nt=forge$q.asn1.toDer(forge$q.pki.privateKeyToAsn1(rt));return nt=uint8ArrayFromString$h(nt.getBytes(),"ascii"),supportedKeys$1.rsa.unmarshalRsaPrivateKey(nt)};var keys$3={supportedKeys:supportedKeys$1,keysPBM:keysPBM$1,keyStretcher:requireKeyStretcher$1(),generateEphemeralKeyPair:requireEphemeralKeys$1(),generateKeyPair:generateKeyPair$4,generateKeyPairFromSeed:generateKeyPairFromSeed$2,unmarshalPublicKey:unmarshalPublicKey$1,marshalPublicKey:marshalPublicKey$1,unmarshalPrivateKey:unmarshalPrivateKey$1,marshalPrivateKey:marshalPrivateKey$1,import:importKey$1};const forgePbkdf2=pbkdf2$1,forgeUtil=utilExports,errcode$b=errCode$i,hashName={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function pbkdf2(et,tt,rt,nt,it){const ot=hashName[it];if(!ot){const at=Object.keys(hashName).join(" / ");throw errcode$b(new Error(`Hash '${it}' is unknown or not supported. Must be ${at}`),"ERR_UNSUPPORTED_HASH_TYPE")}const st=forgePbkdf2(et,tt,rt,nt,ot);return forgeUtil.encode64(st)}var pbkdf2_1=pbkdf2;const hmac$1=indexBrowser$1,aes=aes$1,keys$2=keys$3;src$g.aes=aes,src$g.hmac=hmac$1,src$g.keys=keys$2,src$g.randomBytes=randomBytes_1$2,src$g.pbkdf2=pbkdf2_1;const word="[a-fA-F\\d:]",b$3=et=>et&&et.includeBoundaries?`(?:(?<=\\s|^)(?=${word})|(?<=${word})(?=\\s|$))`:"",v4="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",v6seg="[a-fA-F\\d]{1,4}",v6=`
(?:
(?:${v6seg}:){7}(?:${v6seg}|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:${v6seg}:){6}(?:${v4}|:${v6seg}|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:${v6seg}:){5}(?::${v4}|(?::${v6seg}){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:${v6seg}:){4}(?:(?::${v6seg}){0,1}:${v4}|(?::${v6seg}){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:${v6seg}:){3}(?:(?::${v6seg}){0,2}:${v4}|(?::${v6seg}){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:${v6seg}:){2}(?:(?::${v6seg}){0,3}:${v4}|(?::${v6seg}){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:${v6seg}:){1}(?:(?::${v6seg}){0,4}:${v4}|(?::${v6seg}){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::${v6seg}){0,5}:${v4}|(?::${v6seg}){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`.replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),v46Exact=new RegExp(`(?:^${v4}$)|(?:^${v6}$)`),v4exact=new RegExp(`^${v4}$`),v6exact=new RegExp(`^${v6}$`),ip$2=et=>et&&et.exact?v46Exact:new RegExp(`(?:${b$3(et)}${v4}${b$3(et)})|(?:${b$3(et)}${v6}${b$3(et)})`,"g");ip$2.v4=et=>et&&et.exact?v4exact:new RegExp(`${b$3(et)}${v4}${b$3(et)}`,"g"),ip$2.v6=et=>et&&et.exact?v6exact:new RegExp(`${b$3(et)}${v6}${b$3(et)}`,"g");var ipRegex$1=ip$2;const ipRegex=ipRegex$1,isIp$1=et=>ipRegex({exact:!0}).test(et);isIp$1.v4=et=>ipRegex.v4({exact:!0}).test(et),isIp$1.v6=et=>ipRegex.v6({exact:!0}).test(et),isIp$1.version=et=>isIp$1(et)?isIp$1.v4(et)?4:6:void 0;var isIp_1=isIp$1;const isIp=isIp_1,{toString:uint8ArrayToString$k}=require$$1$2,isIP=isIp,isV4=isIp.v4,isV6=isIp.v6,toBytes=function(et,tt,rt){rt=~~rt;let nt;if(isV4(et))nt=tt||new Uint8Array(rt+4),et.split(/\./g).map(function(it){nt[rt++]=parseInt(it,10)&255});else if(isV6(et)){const it=et.split(":",8);let ot;for(ot=0;ot<it.length;ot++){const st=isV4(it[ot]);let at;st&&(at=toBytes(it[ot]),it[ot]=uint8ArrayToString$k(at.slice(0,2),"base16")),at&&++ot<8&&it.splice(ot,0,uint8ArrayToString$k(at.slice(2,4),"base16"))}if(it[0]==="")for(;it.length<8;)it.unshift("0");else if(it[it.length-1]==="")for(;it.length<8;)it.push("0");else if(it.length<8){for(ot=0;ot<it.length&&it[ot]!=="";ot++);const st=[ot,"1"];for(ot=9-it.length;ot>0;ot--)st.push("0");it.splice.apply(it,st)}for(nt=tt||new Uint8Array(rt+16),ot=0;ot<it.length;ot++){const st=parseInt(it[ot],16);nt[rt++]=st>>8&255,nt[rt++]=st&255}}if(!nt)throw Error("Invalid ip address: "+et);return nt},toString$5=function(et,tt,rt){tt=~~tt,rt=rt||et.length-tt;const nt=[];let it;const ot=new DataView(et.buffer);if(rt===4){for(let st=0;st<rt;st++)nt.push(et[tt+st]);it=nt.join(".")}else if(rt===16){for(let st=0;st<rt;st+=2)nt.push(ot.getUint16(tt+st).toString(16));it=nt.join(":"),it=it.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),it=it.replace(/:{3,4}/,"::")}return it};var ip$1={isIP,isV4,isV6,toBytes,toString:toString$5};function Protocols(et){if(typeof et=="number"){if(Protocols.codes[et])return Protocols.codes[et];throw new Error("no protocol with code: "+et)}else if(typeof et=="string"){if(Protocols.names[et])return Protocols.names[et];throw new Error("no protocol with name: "+et)}throw new Error("invalid protocol id type: "+et)}const V$2=-1;Protocols.lengthPrefixedVarSize=V$2,Protocols.V=V$2,Protocols.table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,V$2,"ip6zone"],[53,V$2,"dns","resolvable"],[54,V$2,"dns4","resolvable"],[55,V$2,"dns6","resolvable"],[56,V$2,"dnsaddr","resolvable"],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,V$2,"unix",!1,"path"],[421,V$2,"ipfs"],[421,V$2,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,V$2,"garlic64"],[460,0,"quic"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,V$2,"memory"]],Protocols.names={},Protocols.codes={},Protocols.table.map(et=>{const tt=p$4.apply(null,et);return Protocols.codes[tt.code]=tt,Protocols.names[tt.name]=tt,null}),Protocols.object=p$4;function p$4(et,tt,rt,nt,it){return{code:et,size:tt,name:rt,resolvable:!!nt,path:!!it}}var protocolsTable=Protocols,encode_1$1=encode$7,MSB$3=128,REST$3=127,MSBALL$1=~REST$3,INT$1=Math.pow(2,31);function encode$7(et,tt,rt){if(Number.MAX_SAFE_INTEGER&&et>Number.MAX_SAFE_INTEGER)throw encode$7.bytes=0,new RangeError("Could not encode varint");tt=tt||[],rt=rt||0;for(var nt=rt;et>=INT$1;)tt[rt++]=et&255|MSB$3,et/=128;for(;et&MSBALL$1;)tt[rt++]=et&255|MSB$3,et>>>=7;return tt[rt]=et|0,encode$7.bytes=rt-nt+1,tt}var decode$a=read$1,MSB$2=128,REST$2=127;function read$1(et,nt){var rt=0,nt=nt||0,it=0,ot=nt,st,at=et.length;do{if(ot>=at||it>49)throw read$1.bytes=0,new RangeError("Could not decode varint");st=et[ot++],rt+=it<28?(st&REST$2)<<it:(st&REST$2)*Math.pow(2,it),it+=7}while(st>=MSB$2);return read$1.bytes=ot-nt,rt}var N1$1=Math.pow(2,7),N2$1=Math.pow(2,14),N3$1=Math.pow(2,21),N4$1=Math.pow(2,28),N5$1=Math.pow(2,35),N6$1=Math.pow(2,42),N7$1=Math.pow(2,49),N8$1=Math.pow(2,56),N9$1=Math.pow(2,63),length$4=function(et){return et<N1$1?1:et<N2$1?2:et<N3$1?3:et<N4$1?4:et<N5$1?5:et<N6$1?6:et<N7$1?7:et<N8$1?8:et<N9$1?9:10},varint$7={encode:encode_1$1,decode:decode$a,encodingLength:length$4};const ip=ip$1,protocols$2=protocolsTable,{CID:CID$e}=require$$6$2,{base32:base32$6}=require$$4$1,{base58btc:base58btc$4}=require$$1$5,Digest$3=require$$6$1,varint$6=varint$7,{toString:uint8ArrayToString$j}=require$$1$2,{fromString:uint8ArrayFromString$g}=require$$9$2,{concat:uint8ArrayConcat$5}=require$$7$1;var convert$1=Convert;function Convert(et,tt){return tt instanceof Uint8Array?Convert.toString(et,tt):Convert.toBytes(et,tt)}Convert.toString=function et(tt,rt){switch(protocols$2(tt).code){case 4:case 41:return bytes2ip(rt);case 6:case 273:case 33:case 132:return bytes2port(rt).toString();case 53:case 54:case 55:case 56:case 400:case 777:return bytes2str(rt);case 421:return bytes2mh(rt);case 444:return bytes2onion(rt);case 445:return bytes2onion(rt);default:return uint8ArrayToString$j(rt,"base16")}},Convert.toBytes=function et(tt,rt){switch(protocols$2(tt).code){case 4:return ip2bytes(rt);case 41:return ip2bytes(rt);case 6:case 273:case 33:case 132:return port2bytes(parseInt(rt,10));case 53:case 54:case 55:case 56:case 400:case 777:return str2bytes(rt);case 421:return mh2bytes(rt);case 444:return onion2bytes(rt);case 445:return onion32bytes(rt);default:return uint8ArrayFromString$g(rt,"base16")}};function ip2bytes(et){if(!ip.isIP(et))throw new Error("invalid ip address");return ip.toBytes(et)}function bytes2ip(et){const tt=ip.toString(et);if(!tt||!ip.isIP(tt))throw new Error("invalid ip address");return tt}function port2bytes(et){const tt=new ArrayBuffer(2);return new DataView(tt).setUint16(0,et),new Uint8Array(tt)}function bytes2port(et){return new DataView(et.buffer).getUint16(et.byteOffset)}function str2bytes(et){const tt=uint8ArrayFromString$g(et),rt=Uint8Array.from(varint$6.encode(tt.length));return uint8ArrayConcat$5([rt,tt],rt.length+tt.length)}function bytes2str(et){const tt=varint$6.decode(et);if(et=et.slice(varint$6.decode.bytes),et.length!==tt)throw new Error("inconsistent lengths");return uint8ArrayToString$j(et)}function mh2bytes(et){let tt;et[0]==="Q"||et[0]==="1"?tt=Digest$3.decode(base58btc$4.decode(`z${et}`)).bytes:tt=CID$e.parse(et).multihash.bytes;const rt=Uint8Array.from(varint$6.encode(tt.length));return uint8ArrayConcat$5([rt,tt],rt.length+tt.length)}function bytes2mh(et){const tt=varint$6.decode(et),rt=et.slice(varint$6.decode.bytes);if(rt.length!==tt)throw new Error("inconsistent lengths");return uint8ArrayToString$j(rt,"base58btc")}function onion2bytes(et){const tt=et.split(":");if(tt.length!==2)throw new Error("failed to parse onion addr: "+tt+" does not contain a port number");if(tt[0].length!==16)throw new Error("failed to parse onion addr: "+tt[0]+" not a Tor onion address.");const rt=base32$6.decode("b"+tt[0]),nt=parseInt(tt[1],10);if(nt<1||nt>65536)throw new Error("Port number is not in range(1, 65536)");const it=port2bytes(nt);return uint8ArrayConcat$5([rt,it],rt.length+it.length)}function onion32bytes(et){const tt=et.split(":");if(tt.length!==2)throw new Error("failed to parse onion addr: "+tt+" does not contain a port number");if(tt[0].length!==56)throw new Error("failed to parse onion addr: "+tt[0]+" not a Tor onion3 address.");const rt=base32$6.decode("b"+tt[0]),nt=parseInt(tt[1],10);if(nt<1||nt>65536)throw new Error("Port number is not in range(1, 65536)");const it=port2bytes(nt);return uint8ArrayConcat$5([rt,it],rt.length+it.length)}function bytes2onion(et){const tt=et.slice(0,et.length-2),rt=et.slice(et.length-2),nt=uint8ArrayToString$j(tt,"base32"),it=bytes2port(rt);return nt+":"+it}const convert=convert$1,protocols$1=protocolsTable,varint$5=varint$7,{concat:uint8ArrayConcat$4}=require$$7$1,{toString:uint8ArrayToString$i}=require$$1$2;var codec$1={stringToStringTuples,stringTuplesToString,tuplesToStringTuples,stringTuplesToTuples,bytesToTuples,tuplesToBytes,bytesToString,stringToBytes,fromString:fromString$6,fromBytes,validateBytes,isValidBytes,cleanPath,ParseError,protoFromTuple,sizeForAddr};function stringToStringTuples(et){const tt=[],rt=et.split("/").slice(1);if(rt.length===1&&rt[0]==="")return[];for(let nt=0;nt<rt.length;nt++){const it=rt[nt],ot=protocols$1(it);if(ot.size===0){tt.push([it]);continue}if(nt++,nt>=rt.length)throw ParseError("invalid address: "+et);if(ot.path){tt.push([it,cleanPath(rt.slice(nt).join("/"))]);break}tt.push([it,rt[nt]])}return tt}function stringTuplesToString(et){const tt=[];return et.map(rt=>{const nt=protoFromTuple(rt);return tt.push(nt.name),rt.length>1&&tt.push(rt[1]),null}),cleanPath(tt.join("/"))}function stringTuplesToTuples(et){return et.map(tt=>{Array.isArray(tt)||(tt=[tt]);const rt=protoFromTuple(tt);return tt.length>1?[rt.code,convert.toBytes(rt.code,tt[1])]:[rt.code]})}function tuplesToStringTuples(et){return et.map(tt=>{const rt=protoFromTuple(tt);return tt[1]?[rt.code,convert.toString(rt.code,tt[1])]:[rt.code]})}function tuplesToBytes(et){return fromBytes(uint8ArrayConcat$4(et.map(tt=>{const rt=protoFromTuple(tt);let nt=Uint8Array.from(varint$5.encode(rt.code));return tt.length>1&&(nt=uint8ArrayConcat$4([nt,tt[1]])),nt})))}function sizeForAddr(et,tt){return et.size>0?et.size/8:et.size===0?0:varint$5.decode(tt)+varint$5.decode.bytes}function bytesToTuples(et){const tt=[];let rt=0;for(;rt<et.length;){const nt=varint$5.decode(et,rt),it=varint$5.decode.bytes,ot=protocols$1(nt),st=sizeForAddr(ot,et.slice(rt+it));if(st===0){tt.push([nt]),rt+=it;continue}const at=et.slice(rt+it,rt+it+st);if(rt+=st+it,rt>et.length)throw ParseError("Invalid address Uint8Array: "+uint8ArrayToString$i(et,"base16"));tt.push([nt,at])}return tt}function bytesToString(et){const tt=bytesToTuples(et),rt=tuplesToStringTuples(tt);return stringTuplesToString(rt)}function stringToBytes(et){et=cleanPath(et);const tt=stringToStringTuples(et),rt=stringTuplesToTuples(tt);return tuplesToBytes(rt)}function fromString$6(et){return stringToBytes(et)}function fromBytes(et){const tt=validateBytes(et);if(tt)throw tt;return Uint8Array.from(et)}function validateBytes(et){try{bytesToTuples(et)}catch(tt){return tt}}function isValidBytes(et){return validateBytes(et)===void 0}function cleanPath(et){return"/"+et.trim().split("/").filter(tt=>tt).join("/")}function ParseError(et){return new Error("Error parsing address: "+et)}function protoFromTuple(et){return protocols$1(et[0])}const codec=codec$1,protocols=protocolsTable,varint$4=varint$7,{CID:CID$d}=require$$6$2,{base58btc:base58btc$3}=require$$1$5,errCode$h=errCode$i,inspect=Symbol.for("nodejs.util.inspect.custom"),{toString:uint8ArrayToString$h}=require$$1$2,{equals:uint8ArrayEquals$4}=require$$1$3,resolvers=new Map,symbol=Symbol.for("@multiformats/js-multiaddr/multiaddr");let Multiaddr$2=class jr{constructor(tt){if(tt==null&&(tt=""),Object.defineProperty(this,symbol,{value:!0}),tt instanceof Uint8Array)this.bytes=codec.fromBytes(tt);else if(typeof tt=="string"){if(tt.length>0&&tt.charAt(0)!=="/")throw new Error(`multiaddr "${tt}" must start with a "/"`);this.bytes=codec.fromString(tt)}else if(jr.isMultiaddr(tt))this.bytes=codec.fromBytes(tt.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return codec.bytesToString(this.bytes)}toJSON(){return this.toString()}toOptions(){const tt={},rt=this.toString().split("/");return tt.family=rt[1]==="ip4"?4:6,tt.host=rt[2],tt.transport=rt[3],tt.port=parseInt(rt[4]),tt}protos(){return this.protoCodes().map(tt=>Object.assign({},protocols(tt)))}protoCodes(){const tt=[],rt=this.bytes;let nt=0;for(;nt<rt.length;){const it=varint$4.decode(rt,nt),ot=varint$4.decode.bytes,st=protocols(it),at=codec.sizeForAddr(st,rt.slice(nt+ot));nt+=at+ot,tt.push(it)}return tt}protoNames(){return this.protos().map(tt=>tt.name)}tuples(){return codec.bytesToTuples(this.bytes)}stringTuples(){const tt=codec.bytesToTuples(this.bytes);return codec.tuplesToStringTuples(tt)}encapsulate(tt){return tt=new jr(tt),new jr(this.toString()+tt.toString())}decapsulate(tt){const rt=tt.toString(),nt=this.toString(),it=nt.lastIndexOf(rt);if(it<0)throw new Error("Address "+this+" does not contain subaddress: "+tt);return new jr(nt.slice(0,it))}decapsulateCode(tt){const rt=this.tuples();for(let nt=rt.length-1;nt>=0;nt--)if(rt[nt][0]===tt)return new jr(codec.tuplesToBytes(rt.slice(0,nt)));return this}getPeerId(){try{const tt=this.stringTuples().filter(rt=>rt[0]===protocols.names.ipfs.code).pop();if(tt&&tt[1]){const rt=tt[1];return rt[0]==="Q"||rt[0]==="1"?uint8ArrayToString$h(base58btc$3.decode(`z${rt}`),"base58btc"):uint8ArrayToString$h(CID$d.parse(rt).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let tt=null;try{tt=this.stringTuples().filter(rt=>!!protocols(rt[0]).path)[0][1],tt||(tt=null)}catch{tt=null}return tt}equals(tt){return uint8ArrayEquals$4(this.bytes,tt.bytes)}async resolve(){const tt=this.protos().find(nt=>nt.resolvable);if(!tt)return[this];const rt=resolvers.get(tt.name);if(!rt)throw errCode$h(new Error(`no available resolver for ${tt.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await rt(this)).map(nt=>new jr(nt))}nodeAddress(){const tt=this.protoCodes(),rt=this.protoNames(),nt=this.toString().split("/").slice(1);if(nt.length<4)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6}/{address}/{tcp, udp}/{port}".');if(tt[0]!==4&&tt[0]!==41&&tt[0]!==54&&tt[0]!==55)throw new Error(`no protocol with name: "'${rt[0]}'". Must have a valid family name: "{ip4, ip6, dns4, dns6}".`);if(nt[2]!=="tcp"&&nt[2]!=="udp")throw new Error(`no protocol with name: "'${rt[1]}'". Must have a valid transport protocol: "{tcp, udp}".`);return{family:tt[0]===41||tt[0]===55?6:4,address:nt[1],port:parseInt(nt[3])}}isThinWaistAddress(tt){const rt=(tt||this).protos();return!(rt.length!==2||rt[0].code!==4&&rt[0].code!==41||rt[1].code!==6&&rt[1].code!==273)}static fromNodeAddress(tt,rt){if(!tt)throw new Error("requires node address object");if(!rt)throw new Error("requires transport protocol");let nt;switch(tt.family){case 4:nt="ip4";break;case 6:nt="ip6";break;default:throw Error(`Invalid addr family. Got '${tt.family}' instead of 4 or 6`)}return new jr("/"+[nt,tt.address,rt,tt.port].join("/"))}static isName(tt){return jr.isMultiaddr(tt)?tt.protos().some(rt=>rt.resolvable):!1}static isMultiaddr(tt){return tt instanceof jr||!!(tt&&tt[symbol])}[inspect](){return"<Multiaddr "+uint8ArrayToString$h(this.bytes,"base16")+" - "+codec.bytesToString(this.bytes)+">"}inspect(){return"<Multiaddr "+uint8ArrayToString$h(this.bytes,"base16")+" - "+codec.bytesToString(this.bytes)+">"}};Multiaddr$2.protocols=protocols,Multiaddr$2.resolvers=resolvers;function multiaddr(et){return new Multiaddr$2(et)}var src$f={Multiaddr:Multiaddr$2,multiaddr,protocols,resolvers};const{Multiaddr:Multiaddr$1}=src$f,DNS4=base("dns4"),DNS6=base("dns6"),DNSADDR=base("dnsaddr"),DNS=or(base("dns"),DNSADDR,DNS4,DNS6),IP=or(base("ip4"),base("ip6")),TCP=or(and(IP,base("tcp")),and(DNS,base("tcp"))),UDP=and(IP,base("udp")),UTP=and(UDP,base("utp")),QUIC=and(UDP,base("quic")),WebSockets=or(and(TCP,base("ws")),and(DNS,base("ws"))),WebSocketsSecure=or(and(TCP,base("wss")),and(DNS,base("wss"))),HTTP=or(and(TCP,base("http")),and(IP,base("http")),and(DNS,base("http"))),HTTPS=or(and(TCP,base("https")),and(IP,base("https")),and(DNS,base("https"))),WebRTCStar=or(and(WebSockets,base("p2p-webrtc-star"),base("p2p")),and(WebSocketsSecure,base("p2p-webrtc-star"),base("p2p")),and(WebSockets,base("p2p-webrtc-star")),and(WebSocketsSecure,base("p2p-webrtc-star"))),WebSocketStar=or(and(WebSockets,base("p2p-websocket-star"),base("p2p")),and(WebSocketsSecure,base("p2p-websocket-star"),base("p2p")),and(WebSockets,base("p2p-websocket-star")),and(WebSocketsSecure,base("p2p-websocket-star"))),WebRTCDirect=or(and(HTTP,base("p2p-webrtc-direct"),base("p2p")),and(HTTPS,base("p2p-webrtc-direct"),base("p2p")),and(HTTP,base("p2p-webrtc-direct")),and(HTTPS,base("p2p-webrtc-direct"))),Reliable=or(WebSockets,WebSocketsSecure,HTTP,HTTPS,WebRTCStar,WebRTCDirect,TCP,UTP,QUIC,DNS),Stardust=or(and(Reliable,base("p2p-stardust"),base("p2p")),and(Reliable,base("p2p-stardust"))),_P2P=or(and(Reliable,base("p2p")),WebRTCStar,WebRTCDirect,base("p2p")),_Circuit=or(and(_P2P,base("p2p-circuit"),_P2P),and(_P2P,base("p2p-circuit")),and(base("p2p-circuit"),_P2P),and(Reliable,base("p2p-circuit")),and(base("p2p-circuit"),Reliable),base("p2p-circuit")),CircuitRecursive=()=>or(and(_Circuit,CircuitRecursive),_Circuit),Circuit=CircuitRecursive(),P2P=or(and(Circuit,_P2P,Circuit),and(_P2P,Circuit),and(Circuit,_P2P),Circuit,_P2P);var src$e={DNS,DNS4,DNS6,DNSADDR,IP,TCP,UDP,QUIC,UTP,HTTP,HTTPS,WebSockets,WebSocketsSecure,WebSocketStar,WebRTCStar,WebRTCDirect,Reliable,Stardust,Circuit,P2P,IPFS:P2P};function makeMatchesFunction(et){function tt(rt){if(!Multiaddr$1.isMultiaddr(rt))try{rt=new Multiaddr$1(rt)}catch{return!1}const nt=et(rt.protoNames());return nt===null?!1:nt===!0||nt===!1?nt:nt.length===0}return tt}function and(...et){function tt(rt){if(rt.length<et.length)return null;let nt=rt;return et.some(it=>(nt=typeof it=="function"?it().partialMatch(rt):it.partialMatch(rt),Array.isArray(nt)&&(rt=nt),nt===null)),nt}return{toString:function(){return"{ "+et.join(" ")+" }"},input:et,matches:makeMatchesFunction(tt),partialMatch:tt}}function or(...et){function tt(rt){let nt=null;return et.some(it=>{const ot=typeof it=="function"?it().partialMatch(rt):it.partialMatch(rt);return ot?(nt=ot,!0):!1}),nt}return{toString:function(){return"{ "+et.join(" ")+" }"},input:et,matches:makeMatchesFunction(tt),partialMatch:tt}}function base(et){const tt=et;function rt(it){let ot;if(typeof it=="string"||it instanceof Uint8Array)try{ot=new Multiaddr$1(it)}catch{return!1}else ot=it;const st=ot.protoNames();return st.length===1&&st[0]===tt}function nt(it){return it.length===0?null:it[0]===tt?it.slice(1):null}return{toString:function(){return tt},matches:rt,partialMatch:nt}}const{base58btc:base58btc$2}=require$$1$5,{base32:base32$5}=require$$4$1,Digest$2=require$$6$1,{Multiaddr}=src$f,mafmt=src$e,{CID:CID$c}=require$$6$2,{URL:URL$1}=isoUrl,{toString:uint8ArrayToString$g}=require$$1$2,pathGatewayPattern=/^https?:\/\/[^/]+\/(ip[fn]s)\/([^/?#]+)/,pathPattern=/^\/(ip[fn]s)\/([^/?#]+)/,defaultProtocolMatch=1,defaultHashMath=2,subdomainGatewayPattern=/^https?:\/\/([^/]+)\.(ip[fn]s)\.[^/?]+/,subdomainIdMatch=1,subdomainProtocolMatch=2,fqdnWithTld=/^(([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])\.)+([a-z0-9]|[a-z0-9][a-z0-9-]*[a-z0-9])$/;function isMultihash(et){const tt=convertToString(et);try{Digest$2.decode(base58btc$2.decode("z"+tt))}catch{return!1}return!0}function isBase32EncodedMultibase(et){try{base32$5.decode(et)}catch{return!1}return!0}function isCID(et){try{return typeof et=="string"?!!CID$c.parse(et):et instanceof Uint8Array?!!CID$c.decode(et):!!CID$c.asCID(et)}catch{return!1}}function isMultiaddr(et){if(!et)return!1;if(Multiaddr.isMultiaddr(et))return!0;try{return new Multiaddr(et),!0}catch{return!1}}function isPeerMultiaddr(et){return isMultiaddr(et)&&mafmt.P2P.matches(et)}function isIpfs$1(et,tt,rt=defaultProtocolMatch,nt=defaultHashMath){const it=convertToString(et);if(!it)return!1;const ot=it.match(tt);if(!ot||ot[rt]!=="ipfs")return!1;let st=ot[nt];return st&&tt===subdomainGatewayPattern&&(st=st.toLowerCase()),isCID(st)}function isIpns(et,tt,rt=defaultProtocolMatch,nt=defaultHashMath){const it=convertToString(et);if(!it)return!1;const ot=it.match(tt);if(!ot||ot[rt]!=="ipns")return!1;let st=ot[nt];if(st&&tt===subdomainGatewayPattern){if(st=st.toLowerCase(),isCID(st))return!0;try{!st.includes(".")&&st.includes("-")&&(st=st.replace(/--/g,"@").replace(/-/g,".").replace(/@/g,"-"));const{hostname:at}=new URL$1(`http://${st}`);return fqdnWithTld.test(at)}catch{return!1}}return!0}function isString(et){return typeof et=="string"}function convertToString(et){return et instanceof Uint8Array?uint8ArrayToString$g(et,"base58btc"):isString(et)?et:!1}const ipfsSubdomain=et=>isIpfs$1(et,subdomainGatewayPattern,subdomainProtocolMatch,subdomainIdMatch),ipnsSubdomain=et=>isIpns(et,subdomainGatewayPattern,subdomainProtocolMatch,subdomainIdMatch),subdomain=et=>ipfsSubdomain(et)||ipnsSubdomain(et),ipfsUrl=et=>isIpfs$1(et,pathGatewayPattern)||ipfsSubdomain(et),ipnsUrl=et=>isIpns(et,pathGatewayPattern)||ipnsSubdomain(et),url=et=>ipfsUrl(et)||ipnsUrl(et)||subdomain(et),path=et=>isIpfs$1(et,pathPattern)||isIpns(et,pathPattern);var src$d={multihash:isMultihash,multiaddr:isMultiaddr,peerMultiaddr:isPeerMultiaddr,cid:isCID,base32cid:et=>isBase32EncodedMultibase(et)&&isCID(et),ipfsSubdomain,ipnsSubdomain,subdomain,subdomainGatewayPattern,ipfsUrl,ipnsUrl,url,pathGatewayPattern,ipfsPath:et=>isIpfs$1(et,pathPattern),ipnsPath:et=>isIpns(et,pathPattern),path,pathPattern,urlOrPath:et=>url(et)||path(et),cidPath:et=>isString(et)&&!isCID(et)&&isIpfs$1(`/ipfs/${et}`,pathPattern)},browser$2={exports:{}},ms,hasRequiredMs;function requireMs(){if(hasRequiredMs)return ms;hasRequiredMs=1;var et=1e3,tt=et*60,rt=tt*60,nt=rt*24,it=nt*7,ot=nt*365.25;ms=function(lt,ht){ht=ht||{};var ft=typeof lt;if(ft==="string"&&lt.length>0)return st(lt);if(ft==="number"&&isFinite(lt))return ht.long?ct(lt):at(lt);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(lt))};function st(lt){if(lt=String(lt),!(lt.length>100)){var ht=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(lt);if(ht){var ft=parseFloat(ht[1]),dt=(ht[2]||"ms").toLowerCase();switch(dt){case"years":case"year":case"yrs":case"yr":case"y":return ft*ot;case"weeks":case"week":case"w":return ft*it;case"days":case"day":case"d":return ft*nt;case"hours":case"hour":case"hrs":case"hr":case"h":return ft*rt;case"minutes":case"minute":case"mins":case"min":case"m":return ft*tt;case"seconds":case"second":case"secs":case"sec":case"s":return ft*et;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return ft;default:return}}}}function at(lt){var ht=Math.abs(lt);return ht>=nt?Math.round(lt/nt)+"d":ht>=rt?Math.round(lt/rt)+"h":ht>=tt?Math.round(lt/tt)+"m":ht>=et?Math.round(lt/et)+"s":lt+"ms"}function ct(lt){var ht=Math.abs(lt);return ht>=nt?ut(lt,ht,nt,"day"):ht>=rt?ut(lt,ht,rt,"hour"):ht>=tt?ut(lt,ht,tt,"minute"):ht>=et?ut(lt,ht,et,"second"):lt+" ms"}function ut(lt,ht,ft,dt){var pt=ht>=ft*1.5;return Math.round(lt/ft)+" "+dt+(pt?"s":"")}return ms}function setup(et){rt.debug=rt,rt.default=rt,rt.coerce=ct,rt.disable=ot,rt.enable=it,rt.enabled=st,rt.humanize=requireMs(),rt.destroy=ut,Object.keys(et).forEach(lt=>{rt[lt]=et[lt]}),rt.names=[],rt.skips=[],rt.formatters={};function tt(lt){let ht=0;for(let ft=0;ft<lt.length;ft++)ht=(ht<<5)-ht+lt.charCodeAt(ft),ht|=0;return rt.colors[Math.abs(ht)%rt.colors.length]}rt.selectColor=tt;function rt(lt){let ht,ft=null,dt,pt;function gt(..._t){if(!gt.enabled)return;const mt=gt,At=Number(new Date),It=At-(ht||At);mt.diff=It,mt.prev=ht,mt.curr=At,ht=At,_t[0]=rt.coerce(_t[0]),typeof _t[0]!="string"&&_t.unshift("%O");let Mt=0;_t[0]=_t[0].replace(/%([a-zA-Z%])/g,(kt,Ct)=>{if(kt==="%%")return"%";Mt++;const Ut=rt.formatters[Ct];if(typeof Ut=="function"){const Wt=_t[Mt];kt=Ut.call(mt,Wt),_t.splice(Mt,1),Mt--}return kt}),rt.formatArgs.call(mt,_t),(mt.log||rt.log).apply(mt,_t)}return gt.namespace=lt,gt.useColors=rt.useColors(),gt.color=rt.selectColor(lt),gt.extend=nt,gt.destroy=rt.destroy,Object.defineProperty(gt,"enabled",{enumerable:!0,configurable:!1,get:()=>ft!==null?ft:(dt!==rt.namespaces&&(dt=rt.namespaces,pt=rt.enabled(lt)),pt),set:_t=>{ft=_t}}),typeof rt.init=="function"&&rt.init(gt),gt}function nt(lt,ht){const ft=rt(this.namespace+(typeof ht>"u"?":":ht)+lt);return ft.log=this.log,ft}function it(lt){rt.save(lt),rt.namespaces=lt,rt.names=[],rt.skips=[];let ht;const ft=(typeof lt=="string"?lt:"").split(/[\s,]+/),dt=ft.length;for(ht=0;ht<dt;ht++)ft[ht]&&(lt=ft[ht].replace(/\*/g,".*?"),lt[0]==="-"?rt.skips.push(new RegExp("^"+lt.slice(1)+"$")):rt.names.push(new RegExp("^"+lt+"$")))}function ot(){const lt=[...rt.names.map(at),...rt.skips.map(at).map(ht=>"-"+ht)].join(",");return rt.enable(""),lt}function st(lt){if(lt[lt.length-1]==="*")return!0;let ht,ft;for(ht=0,ft=rt.skips.length;ht<ft;ht++)if(rt.skips[ht].test(lt))return!1;for(ht=0,ft=rt.names.length;ht<ft;ht++)if(rt.names[ht].test(lt))return!0;return!1}function at(lt){return lt.toString().substring(2,lt.toString().length-2).replace(/\.\*\?$/,"*")}function ct(lt){return lt instanceof Error?lt.stack||lt.message:lt}function ut(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return rt.enable(rt.load()),rt}var common=setup;(function(et,tt){tt.formatArgs=nt,tt.save=it,tt.load=ot,tt.useColors=rt,tt.storage=st(),tt.destroy=(()=>{let ct=!1;return()=>{ct||(ct=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),tt.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function rt(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function nt(ct){if(ct[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+ct[0]+(this.useColors?"%c ":" ")+"+"+et.exports.humanize(this.diff),!this.useColors)return;const ut="color: "+this.color;ct.splice(1,0,ut,"color: inherit");let lt=0,ht=0;ct[0].replace(/%[a-zA-Z%]/g,ft=>{ft!=="%%"&&(lt++,ft==="%c"&&(ht=lt))}),ct.splice(ht,0,ut)}tt.log=console.debug||console.log||(()=>{});function it(ct){try{ct?tt.storage.setItem("debug",ct):tt.storage.removeItem("debug")}catch{}}function ot(){let ct;try{ct=tt.storage.getItem("debug")}catch{}return!ct&&typeof process<"u"&&"env"in process&&(ct={}.DEBUG),ct}function st(){try{return localStorage}catch{}}et.exports=common(tt);const{formatters:at}=et.exports;at.j=function(ct){try{return JSON.stringify(ct)}catch(ut){return"[UnexpectedJSONParseError]: "+ut.message}}})(browser$2,browser$2.exports);var browserExports=browser$2.exports,$protobuf$7=minimal,$Reader$7=$protobuf$7.Reader,$Writer$7=$protobuf$7.Writer,$util$6=$protobuf$7.util,$root$7=$protobuf$7.roots["ipfs-unixfs"]||($protobuf$7.roots["ipfs-unixfs"]={});$root$7.Data=function(){function et(tt){if(this.blocksizes=[],tt)for(var rt=Object.keys(tt),nt=0;nt<rt.length;++nt)tt[rt[nt]]!=null&&(this[rt[nt]]=tt[rt[nt]])}return et.prototype.Type=0,et.prototype.Data=$util$6.newBuffer([]),et.prototype.filesize=$util$6.Long?$util$6.Long.fromBits(0,0,!0):0,et.prototype.blocksizes=$util$6.emptyArray,et.prototype.hashType=$util$6.Long?$util$6.Long.fromBits(0,0,!0):0,et.prototype.fanout=$util$6.Long?$util$6.Long.fromBits(0,0,!0):0,et.prototype.mode=0,et.prototype.mtime=null,et.encode=function(tt,rt){if(rt||(rt=$Writer$7.create()),rt.uint32(8).int32(tt.Type),tt.Data!=null&&Object.hasOwnProperty.call(tt,"Data")&&rt.uint32(18).bytes(tt.Data),tt.filesize!=null&&Object.hasOwnProperty.call(tt,"filesize")&&rt.uint32(24).uint64(tt.filesize),tt.blocksizes!=null&&tt.blocksizes.length)for(var nt=0;nt<tt.blocksizes.length;++nt)rt.uint32(32).uint64(tt.blocksizes[nt]);return tt.hashType!=null&&Object.hasOwnProperty.call(tt,"hashType")&&rt.uint32(40).uint64(tt.hashType),tt.fanout!=null&&Object.hasOwnProperty.call(tt,"fanout")&&rt.uint32(48).uint64(tt.fanout),tt.mode!=null&&Object.hasOwnProperty.call(tt,"mode")&&rt.uint32(56).uint32(tt.mode),tt.mtime!=null&&Object.hasOwnProperty.call(tt,"mtime")&&$root$7.UnixTime.encode(tt.mtime,rt.uint32(66).fork()).ldelim(),rt},et.decode=function(tt,rt){tt instanceof $Reader$7||(tt=$Reader$7.create(tt));for(var nt=rt===void 0?tt.len:tt.pos+rt,it=new $root$7.Data;tt.pos<nt;){var ot=tt.uint32();switch(ot>>>3){case 1:it.Type=tt.int32();break;case 2:it.Data=tt.bytes();break;case 3:it.filesize=tt.uint64();break;case 4:if(it.blocksizes&&it.blocksizes.length||(it.blocksizes=[]),(ot&7)===2)for(var st=tt.uint32()+tt.pos;tt.pos<st;)it.blocksizes.push(tt.uint64());else it.blocksizes.push(tt.uint64());break;case 5:it.hashType=tt.uint64();break;case 6:it.fanout=tt.uint64();break;case 7:it.mode=tt.uint32();break;case 8:it.mtime=$root$7.UnixTime.decode(tt,tt.uint32());break;default:tt.skipType(ot&7);break}}if(!it.hasOwnProperty("Type"))throw $util$6.ProtocolError("missing required 'Type'",{instance:it});return it},et.fromObject=function(tt){if(tt instanceof $root$7.Data)return tt;var rt=new $root$7.Data;switch(tt.Type){case"Raw":case 0:rt.Type=0;break;case"Directory":case 1:rt.Type=1;break;case"File":case 2:rt.Type=2;break;case"Metadata":case 3:rt.Type=3;break;case"Symlink":case 4:rt.Type=4;break;case"HAMTShard":case 5:rt.Type=5;break}if(tt.Data!=null&&(typeof tt.Data=="string"?$util$6.base64.decode(tt.Data,rt.Data=$util$6.newBuffer($util$6.base64.length(tt.Data)),0):tt.Data.length&&(rt.Data=tt.Data)),tt.filesize!=null&&($util$6.Long?(rt.filesize=$util$6.Long.fromValue(tt.filesize)).unsigned=!0:typeof tt.filesize=="string"?rt.filesize=parseInt(tt.filesize,10):typeof tt.filesize=="number"?rt.filesize=tt.filesize:typeof tt.filesize=="object"&&(rt.filesize=new $util$6.LongBits(tt.filesize.low>>>0,tt.filesize.high>>>0).toNumber(!0))),tt.blocksizes){if(!Array.isArray(tt.blocksizes))throw TypeError(".Data.blocksizes: array expected");rt.blocksizes=[];for(var nt=0;nt<tt.blocksizes.length;++nt)$util$6.Long?(rt.blocksizes[nt]=$util$6.Long.fromValue(tt.blocksizes[nt])).unsigned=!0:typeof tt.blocksizes[nt]=="string"?rt.blocksizes[nt]=parseInt(tt.blocksizes[nt],10):typeof tt.blocksizes[nt]=="number"?rt.blocksizes[nt]=tt.blocksizes[nt]:typeof tt.blocksizes[nt]=="object"&&(rt.blocksizes[nt]=new $util$6.LongBits(tt.blocksizes[nt].low>>>0,tt.blocksizes[nt].high>>>0).toNumber(!0))}if(tt.hashType!=null&&($util$6.Long?(rt.hashType=$util$6.Long.fromValue(tt.hashType)).unsigned=!0:typeof tt.hashType=="string"?rt.hashType=parseInt(tt.hashType,10):typeof tt.hashType=="number"?rt.hashType=tt.hashType:typeof tt.hashType=="object"&&(rt.hashType=new $util$6.LongBits(tt.hashType.low>>>0,tt.hashType.high>>>0).toNumber(!0))),tt.fanout!=null&&($util$6.Long?(rt.fanout=$util$6.Long.fromValue(tt.fanout)).unsigned=!0:typeof tt.fanout=="string"?rt.fanout=parseInt(tt.fanout,10):typeof tt.fanout=="number"?rt.fanout=tt.fanout:typeof tt.fanout=="object"&&(rt.fanout=new $util$6.LongBits(tt.fanout.low>>>0,tt.fanout.high>>>0).toNumber(!0))),tt.mode!=null&&(rt.mode=tt.mode>>>0),tt.mtime!=null){if(typeof tt.mtime!="object")throw TypeError(".Data.mtime: object expected");rt.mtime=$root$7.UnixTime.fromObject(tt.mtime)}return rt},et.toObject=function(tt,rt){rt||(rt={});var nt={};if((rt.arrays||rt.defaults)&&(nt.blocksizes=[]),rt.defaults){if(nt.Type=rt.enums===String?"Raw":0,rt.bytes===String?nt.Data="":(nt.Data=[],rt.bytes!==Array&&(nt.Data=$util$6.newBuffer(nt.Data))),$util$6.Long){var it=new $util$6.Long(0,0,!0);nt.filesize=rt.longs===String?it.toString():rt.longs===Number?it.toNumber():it}else nt.filesize=rt.longs===String?"0":0;if($util$6.Long){var it=new $util$6.Long(0,0,!0);nt.hashType=rt.longs===String?it.toString():rt.longs===Number?it.toNumber():it}else nt.hashType=rt.longs===String?"0":0;if($util$6.Long){var it=new $util$6.Long(0,0,!0);nt.fanout=rt.longs===String?it.toString():rt.longs===Number?it.toNumber():it}else nt.fanout=rt.longs===String?"0":0;nt.mode=0,nt.mtime=null}if(tt.Type!=null&&tt.hasOwnProperty("Type")&&(nt.Type=rt.enums===String?$root$7.Data.DataType[tt.Type]:tt.Type),tt.Data!=null&&tt.hasOwnProperty("Data")&&(nt.Data=rt.bytes===String?$util$6.base64.encode(tt.Data,0,tt.Data.length):rt.bytes===Array?Array.prototype.slice.call(tt.Data):tt.Data),tt.filesize!=null&&tt.hasOwnProperty("filesize")&&(typeof tt.filesize=="number"?nt.filesize=rt.longs===String?String(tt.filesize):tt.filesize:nt.filesize=rt.longs===String?$util$6.Long.prototype.toString.call(tt.filesize):rt.longs===Number?new $util$6.LongBits(tt.filesize.low>>>0,tt.filesize.high>>>0).toNumber(!0):tt.filesize),tt.blocksizes&&tt.blocksizes.length){nt.blocksizes=[];for(var ot=0;ot<tt.blocksizes.length;++ot)typeof tt.blocksizes[ot]=="number"?nt.blocksizes[ot]=rt.longs===String?String(tt.blocksizes[ot]):tt.blocksizes[ot]:nt.blocksizes[ot]=rt.longs===String?$util$6.Long.prototype.toString.call(tt.blocksizes[ot]):rt.longs===Number?new $util$6.LongBits(tt.blocksizes[ot].low>>>0,tt.blocksizes[ot].high>>>0).toNumber(!0):tt.blocksizes[ot]}return tt.hashType!=null&&tt.hasOwnProperty("hashType")&&(typeof tt.hashType=="number"?nt.hashType=rt.longs===String?String(tt.hashType):tt.hashType:nt.hashType=rt.longs===String?$util$6.Long.prototype.toString.call(tt.hashType):rt.longs===Number?new $util$6.LongBits(tt.hashType.low>>>0,tt.hashType.high>>>0).toNumber(!0):tt.hashType),tt.fanout!=null&&tt.hasOwnProperty("fanout")&&(typeof tt.fanout=="number"?nt.fanout=rt.longs===String?String(tt.fanout):tt.fanout:nt.fanout=rt.longs===String?$util$6.Long.prototype.toString.call(tt.fanout):rt.longs===Number?new $util$6.LongBits(tt.fanout.low>>>0,tt.fanout.high>>>0).toNumber(!0):tt.fanout),tt.mode!=null&&tt.hasOwnProperty("mode")&&(nt.mode=tt.mode),tt.mtime!=null&&tt.hasOwnProperty("mtime")&&(nt.mtime=$root$7.UnixTime.toObject(tt.mtime,rt)),nt},et.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf$7.util.toJSONOptions)},et.DataType=function(){var tt={},rt=Object.create(tt);return rt[tt[0]="Raw"]=0,rt[tt[1]="Directory"]=1,rt[tt[2]="File"]=2,rt[tt[3]="Metadata"]=3,rt[tt[4]="Symlink"]=4,rt[tt[5]="HAMTShard"]=5,rt}(),et}(),$root$7.UnixTime=function(){function et(tt){if(tt)for(var rt=Object.keys(tt),nt=0;nt<rt.length;++nt)tt[rt[nt]]!=null&&(this[rt[nt]]=tt[rt[nt]])}return et.prototype.Seconds=$util$6.Long?$util$6.Long.fromBits(0,0,!1):0,et.prototype.FractionalNanoseconds=0,et.encode=function(tt,rt){return rt||(rt=$Writer$7.create()),rt.uint32(8).int64(tt.Seconds),tt.FractionalNanoseconds!=null&&Object.hasOwnProperty.call(tt,"FractionalNanoseconds")&&rt.uint32(21).fixed32(tt.FractionalNanoseconds),rt},et.decode=function(tt,rt){tt instanceof $Reader$7||(tt=$Reader$7.create(tt));for(var nt=rt===void 0?tt.len:tt.pos+rt,it=new $root$7.UnixTime;tt.pos<nt;){var ot=tt.uint32();switch(ot>>>3){case 1:it.Seconds=tt.int64();break;case 2:it.FractionalNanoseconds=tt.fixed32();break;default:tt.skipType(ot&7);break}}if(!it.hasOwnProperty("Seconds"))throw $util$6.ProtocolError("missing required 'Seconds'",{instance:it});return it},et.fromObject=function(tt){if(tt instanceof $root$7.UnixTime)return tt;var rt=new $root$7.UnixTime;return tt.Seconds!=null&&($util$6.Long?(rt.Seconds=$util$6.Long.fromValue(tt.Seconds)).unsigned=!1:typeof tt.Seconds=="string"?rt.Seconds=parseInt(tt.Seconds,10):typeof tt.Seconds=="number"?rt.Seconds=tt.Seconds:typeof tt.Seconds=="object"&&(rt.Seconds=new $util$6.LongBits(tt.Seconds.low>>>0,tt.Seconds.high>>>0).toNumber())),tt.FractionalNanoseconds!=null&&(rt.FractionalNanoseconds=tt.FractionalNanoseconds>>>0),rt},et.toObject=function(tt,rt){rt||(rt={});var nt={};if(rt.defaults){if($util$6.Long){var it=new $util$6.Long(0,0,!1);nt.Seconds=rt.longs===String?it.toString():rt.longs===Number?it.toNumber():it}else nt.Seconds=rt.longs===String?"0":0;nt.FractionalNanoseconds=0}return tt.Seconds!=null&&tt.hasOwnProperty("Seconds")&&(typeof tt.Seconds=="number"?nt.Seconds=rt.longs===String?String(tt.Seconds):tt.Seconds:nt.Seconds=rt.longs===String?$util$6.Long.prototype.toString.call(tt.Seconds):rt.longs===Number?new $util$6.LongBits(tt.Seconds.low>>>0,tt.Seconds.high>>>0).toNumber():tt.Seconds),tt.FractionalNanoseconds!=null&&tt.hasOwnProperty("FractionalNanoseconds")&&(nt.FractionalNanoseconds=tt.FractionalNanoseconds),nt},et.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf$7.util.toJSONOptions)},et}(),$root$7.Metadata=function(){function et(tt){if(tt)for(var rt=Object.keys(tt),nt=0;nt<rt.length;++nt)tt[rt[nt]]!=null&&(this[rt[nt]]=tt[rt[nt]])}return et.prototype.MimeType="",et.encode=function(tt,rt){return rt||(rt=$Writer$7.create()),tt.MimeType!=null&&Object.hasOwnProperty.call(tt,"MimeType")&&rt.uint32(10).string(tt.MimeType),rt},et.decode=function(tt,rt){tt instanceof $Reader$7||(tt=$Reader$7.create(tt));for(var nt=rt===void 0?tt.len:tt.pos+rt,it=new $root$7.Metadata;tt.pos<nt;){var ot=tt.uint32();switch(ot>>>3){case 1:it.MimeType=tt.string();break;default:tt.skipType(ot&7);break}}return it},et.fromObject=function(tt){if(tt instanceof $root$7.Metadata)return tt;var rt=new $root$7.Metadata;return tt.MimeType!=null&&(rt.MimeType=String(tt.MimeType)),rt},et.toObject=function(tt,rt){rt||(rt={});var nt={};return rt.defaults&&(nt.MimeType=""),tt.MimeType!=null&&tt.hasOwnProperty("MimeType")&&(nt.MimeType=tt.MimeType),nt},et.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf$7.util.toJSONOptions)},et}();var unixfs=$root$7;const{Data:PBData}=unixfs,errcode$a=errCode$i,types=["raw","directory","file","metadata","symlink","hamt-sharded-directory"],dirTypes=["directory","hamt-sharded-directory"],DEFAULT_FILE_MODE=parseInt("0644",8),DEFAULT_DIRECTORY_MODE=parseInt("0755",8);function parseMode(et){if(et!=null)return typeof et=="number"?et&4095:(et=et.toString(),et.substring(0,1)==="0"?parseInt(et,8)&4095:parseInt(et,10)&4095)}function parseMtime(et){if(et==null)return;let tt;if(et.secs!=null&&(tt={secs:et.secs,nsecs:et.nsecs}),et.Seconds!=null&&(tt={secs:et.Seconds,nsecs:et.FractionalNanoseconds}),Array.isArray(et)&&(tt={secs:et[0],nsecs:et[1]}),et instanceof Date){const rt=et.getTime(),nt=Math.floor(rt/1e3);tt={secs:nt,nsecs:(rt-nt*1e3)*1e3}}if(Object.prototype.hasOwnProperty.call(tt,"secs")){if(tt!=null&&tt.nsecs!=null&&(tt.nsecs<0||tt.nsecs>999999999))throw errcode$a(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return tt}}class Data{static unmarshal(tt){const rt=PBData.decode(tt),nt=PBData.toObject(rt,{defaults:!1,arrays:!0,longs:Number,objects:!1}),it=new Data({type:types[nt.Type],data:nt.Data,blockSizes:nt.blocksizes,mode:nt.mode,mtime:nt.mtime?{secs:nt.mtime.Seconds,nsecs:nt.mtime.FractionalNanoseconds}:void 0});return it._originalMode=nt.mode||0,it}constructor(tt={type:"file"}){const{type:rt,data:nt,blockSizes:it,hashType:ot,fanout:st,mtime:at,mode:ct}=tt;if(rt&&!types.includes(rt))throw errcode$a(new Error("Type: "+rt+" is not valid"),"ERR_INVALID_TYPE");this.type=rt||"file",this.data=nt,this.hashType=ot,this.fanout=st,this.blockSizes=it||[],this._originalMode=0,this.mode=parseMode(ct),at&&(this.mtime=parseMtime(at),this.mtime&&!this.mtime.nsecs&&(this.mtime.nsecs=0))}set mode(tt){this._mode=this.isDirectory()?DEFAULT_DIRECTORY_MODE:DEFAULT_FILE_MODE;const rt=parseMode(tt);rt!==void 0&&(this._mode=rt)}get mode(){return this._mode}isDirectory(){return!!(this.type&&dirTypes.includes(this.type))}addBlockSize(tt){this.blockSizes.push(tt)}removeBlockSize(tt){this.blockSizes.splice(tt,1)}fileSize(){if(this.isDirectory())return 0;let tt=0;return this.blockSizes.forEach(rt=>{tt+=rt}),this.data&&(tt+=this.data.length),tt}marshal(){let tt;switch(this.type){case"raw":tt=PBData.DataType.Raw;break;case"directory":tt=PBData.DataType.Directory;break;case"file":tt=PBData.DataType.File;break;case"metadata":tt=PBData.DataType.Metadata;break;case"symlink":tt=PBData.DataType.Symlink;break;case"hamt-sharded-directory":tt=PBData.DataType.HAMTShard;break;default:throw errcode$a(new Error("Type: "+tt+" is not valid"),"ERR_INVALID_TYPE")}let rt=this.data;(!this.data||!this.data.length)&&(rt=void 0);let nt;this.mode!=null&&(nt=this._originalMode&4294963200|(parseMode(this.mode)||0),nt===DEFAULT_FILE_MODE&&!this.isDirectory()&&(nt=void 0),nt===DEFAULT_DIRECTORY_MODE&&this.isDirectory()&&(nt=void 0));let it;if(this.mtime!=null){const st=parseMtime(this.mtime);st&&(it={Seconds:st.secs,FractionalNanoseconds:st.nsecs},it.FractionalNanoseconds===0&&delete it.FractionalNanoseconds)}const ot={Type:tt,Data:rt,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:nt,mtime:it};return PBData.encode(ot).finish()}}var src$c={UnixFS:Data,parseMode,parseMtime};const textDecoder$1=new TextDecoder;function decodeVarint(et,tt){let rt=0;for(let nt=0;;nt+=7){if(nt>=64)throw new Error("protobuf: varint overflow");if(tt>=et.length)throw new Error("protobuf: unexpected end of data");const it=et[tt++];if(rt+=nt<28?(it&127)<<nt:(it&127)*2**nt,it<128)break}return[rt,tt]}function decodeBytes(et,tt){let rt;[rt,tt]=decodeVarint(et,tt);const nt=tt+rt;if(rt<0||nt<0)throw new Error("protobuf: invalid length");if(nt>et.length)throw new Error("protobuf: unexpected end of data");return[et.subarray(tt,nt),nt]}function decodeKey(et,tt){let rt;return[rt,tt]=decodeVarint(et,tt),[rt&7,rt>>3,tt]}function decodeLink(et){const tt={},rt=et.length;let nt=0;for(;nt<rt;){let it,ot;if([it,ot,nt]=decodeKey(et,nt),ot===1){if(tt.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(it!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${it}) for Hash`);if(tt.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(tt.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[tt.Hash,nt]=decodeBytes(et,nt)}else if(ot===2){if(tt.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(it!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${it}) for Name`);if(tt.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let st;[st,nt]=decodeBytes(et,nt),tt.Name=textDecoder$1.decode(st)}else if(ot===3){if(tt.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(it!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${it}) for Tsize`);[tt.Tsize,nt]=decodeVarint(et,nt)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${ot}`)}if(nt>rt)throw new Error("protobuf: (PBLink) unexpected end of data");return tt}function decodeNode(et){const tt=et.length;let rt=0,nt,it=!1,ot;for(;rt<tt;){let at,ct;if([at,ct,rt]=decodeKey(et,rt),at!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${at}`);if(ct===1){if(ot)throw new Error("protobuf: (PBNode) duplicate Data section");[ot,rt]=decodeBytes(et,rt),nt&&(it=!0)}else if(ct===2){if(it)throw new Error("protobuf: (PBNode) duplicate Links section");nt||(nt=[]);let ut;[ut,rt]=decodeBytes(et,rt),nt.push(decodeLink(ut))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${ct}`)}if(rt>tt)throw new Error("protobuf: (PBNode) unexpected end of data");const st={};return ot&&(st.Data=ot),st.Links=nt||[],st}const textEncoder$2=new TextEncoder,maxInt32=2**32,maxUInt32=2**31;function encodeLink(et,tt){let rt=tt.length;if(typeof et.Tsize=="number"){if(et.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(et.Tsize))throw new Error("Tsize too large for encoding");rt=encodeVarint(tt,rt,et.Tsize)-1,tt[rt]=24}if(typeof et.Name=="string"){const nt=textEncoder$2.encode(et.Name);rt-=nt.length,tt.set(nt,rt),rt=encodeVarint(tt,rt,nt.length)-1,tt[rt]=18}return et.Hash&&(rt-=et.Hash.length,tt.set(et.Hash,rt),rt=encodeVarint(tt,rt,et.Hash.length)-1,tt[rt]=10),tt.length-rt}function encodeNode(et){const tt=sizeNode(et),rt=new Uint8Array(tt);let nt=tt;if(et.Data&&(nt-=et.Data.length,rt.set(et.Data,nt),nt=encodeVarint(rt,nt,et.Data.length)-1,rt[nt]=10),et.Links)for(let it=et.Links.length-1;it>=0;it--){const ot=encodeLink(et.Links[it],rt.subarray(0,nt));nt-=ot,nt=encodeVarint(rt,nt,ot)-1,rt[nt]=18}return rt}function sizeLink(et){let tt=0;if(et.Hash){const rt=et.Hash.length;tt+=1+rt+sov(rt)}if(typeof et.Name=="string"){const rt=textEncoder$2.encode(et.Name).length;tt+=1+rt+sov(rt)}return typeof et.Tsize=="number"&&(tt+=1+sov(et.Tsize)),tt}function sizeNode(et){let tt=0;if(et.Data){const rt=et.Data.length;tt+=1+rt+sov(rt)}if(et.Links)for(const rt of et.Links){const nt=sizeLink(rt);tt+=1+nt+sov(nt)}return tt}function encodeVarint(et,tt,rt){tt-=sov(rt);const nt=tt;for(;rt>=maxUInt32;)et[tt++]=rt&127|128,rt/=128;for(;rt>=128;)et[tt++]=rt&127|128,rt>>>=7;return et[tt]=rt,nt}function sov(et){return et%2===0&&et++,Math.floor((len64(et)+6)/7)}function len64(et){let tt=0;return et>=maxInt32&&(et=Math.floor(et/maxInt32),tt=32),et>=65536&&(et>>>=16,tt+=16),et>=256&&(et>>>=8,tt+=8),tt+len8tab[et]}const len8tab=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],pbNodeProperties=["Data","Links"],pbLinkProperties=["Hash","Name","Tsize"],textEncoder$1=new TextEncoder;function linkComparator(et,tt){if(et===tt)return 0;const rt=et.Name?textEncoder$1.encode(et.Name):[],nt=tt.Name?textEncoder$1.encode(tt.Name):[];let it=rt.length,ot=nt.length;for(let st=0,at=Math.min(it,ot);st<at;++st)if(rt[st]!==nt[st]){it=rt[st],ot=nt[st];break}return it<ot?-1:ot<it?1:0}function hasOnlyProperties(et,tt){return!Object.keys(et).some(rt=>!tt.includes(rt))}function asLink(et){if(typeof et.asCID=="object"){const rt=CID$f.asCID(et);if(!rt)throw new TypeError("Invalid DAG-PB form");return{Hash:rt}}if(typeof et!="object"||Array.isArray(et))throw new TypeError("Invalid DAG-PB form");const tt={};if(et.Hash){let rt=CID$f.asCID(et.Hash);try{rt||(typeof et.Hash=="string"?rt=CID$f.parse(et.Hash):et.Hash instanceof Uint8Array&&(rt=CID$f.decode(et.Hash)))}catch(nt){throw new TypeError(`Invalid DAG-PB form: ${nt.message}`)}rt&&(tt.Hash=rt)}if(!tt.Hash)throw new TypeError("Invalid DAG-PB form");return typeof et.Name=="string"&&(tt.Name=et.Name),typeof et.Tsize=="number"&&(tt.Tsize=et.Tsize),tt}function prepare(et){if((et instanceof Uint8Array||typeof et=="string")&&(et={Data:et}),typeof et!="object"||Array.isArray(et))throw new TypeError("Invalid DAG-PB form");const tt={};if(et.Data!==void 0)if(typeof et.Data=="string")tt.Data=textEncoder$1.encode(et.Data);else if(et.Data instanceof Uint8Array)tt.Data=et.Data;else throw new TypeError("Invalid DAG-PB form");if(et.Links!==void 0)if(Array.isArray(et.Links))tt.Links=et.Links.map(asLink),tt.Links.sort(linkComparator);else throw new TypeError("Invalid DAG-PB form");else tt.Links=[];return tt}function validate$1(et){if(!et||typeof et!="object"||Array.isArray(et))throw new TypeError("Invalid DAG-PB form");if(!hasOnlyProperties(et,pbNodeProperties))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(et.Data!==void 0&&!(et.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be a Uint8Array)");if(!Array.isArray(et.Links))throw new TypeError("Invalid DAG-PB form (Links must be an array)");for(let tt=0;tt<et.Links.length;tt++){const rt=et.Links[tt];if(!rt||typeof rt!="object"||Array.isArray(rt))throw new TypeError("Invalid DAG-PB form (bad link object)");if(!hasOnlyProperties(rt,pbLinkProperties))throw new TypeError("Invalid DAG-PB form (extraneous properties on link object)");if(!rt.Hash)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(rt.Hash.asCID!==rt.Hash)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(rt.Name!==void 0&&typeof rt.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(rt.Tsize!==void 0&&(typeof rt.Tsize!="number"||rt.Tsize%1!==0))throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(tt>0&&linkComparator(rt,et.Links[tt-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function createNode(et,tt=[]){return prepare({Data:et,Links:tt})}function createLink(et,tt,rt){return asLink({Hash:rt,Name:et,Tsize:tt})}const name$1="dag-pb",code$1=112;function encode$6(et){validate$1(et);const tt={};return et.Links&&(tt.Links=et.Links.map(rt=>{const nt={};return rt.Hash&&(nt.Hash=rt.Hash.bytes),rt.Name!==void 0&&(nt.Name=rt.Name),rt.Tsize!==void 0&&(nt.Tsize=rt.Tsize),nt})),et.Data&&(tt.Data=et.Data),encodeNode(tt)}function decode$9(et){const tt=decodeNode(et),rt={};return tt.Data&&(rt.Data=tt.Data),tt.Links&&(rt.Links=tt.Links.map(nt=>{const it={};try{it.Hash=CID$f.decode(nt.Hash)}catch{}if(!it.Hash)throw new Error("Invalid Hash field found in link, expected CID");return nt.Name!==void 0&&(it.Name=nt.Name),nt.Tsize!==void 0&&(it.Tsize=nt.Tsize),it})),rt}const src$b=Object.freeze(Object.defineProperty({__proto__:null,code:code$1,createLink,createNode,decode:decode$9,encode:encode$6,name:name$1,prepare,validate:validate$1},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(src$b),typeofs=["string","number","bigint","symbol"],objectTypeNames=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function is(et){if(et===null)return"null";if(et===void 0)return"undefined";if(et===!0||et===!1)return"boolean";const tt=typeof et;return typeofs.includes(tt)?tt:tt==="function"?"Function":Array.isArray(et)?"Array":isBuffer$1(et)?"Buffer":getObjectType(et)||"Object"}function isBuffer$1(et){return et&&et.constructor&&et.constructor.isBuffer&&et.constructor.isBuffer.call(null,et)}function getObjectType(et){const tt=Object.prototype.toString.call(et).slice(8,-1);if(objectTypeNames.includes(tt))return tt}class Type{constructor(tt,rt,nt){this.major=tt,this.majorEncoded=tt<<5,this.name=rt,this.terminal=nt}toString(){return`Type[${this.major}].${this.name}`}compare(tt){return this.major<tt.major?-1:this.major>tt.major?1:0}}Type.uint=new Type(0,"uint",!0),Type.negint=new Type(1,"negint",!0),Type.bytes=new Type(2,"bytes",!0),Type.string=new Type(3,"string",!0),Type.array=new Type(4,"array",!1),Type.map=new Type(5,"map",!1),Type.tag=new Type(6,"tag",!1),Type.float=new Type(7,"float",!0),Type.false=new Type(7,"false",!0),Type.true=new Type(7,"true",!0),Type.null=new Type(7,"null",!0),Type.undefined=new Type(7,"undefined",!0),Type.break=new Type(7,"break",!0);class Token{constructor(tt,rt,nt){this.type=tt,this.value=rt,this.encodedLength=nt,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const useBuffer=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",textDecoder=new TextDecoder,textEncoder=new TextEncoder;function isBuffer(et){return useBuffer&&globalThis.Buffer.isBuffer(et)}function asU8A(et){return et instanceof Uint8Array?isBuffer(et)?new Uint8Array(et.buffer,et.byteOffset,et.byteLength):et:Uint8Array.from(et)}const toString$4=useBuffer?(et,tt,rt)=>rt-tt>64?globalThis.Buffer.from(et.subarray(tt,rt)).toString("utf8"):utf8Slice(et,tt,rt):(et,tt,rt)=>rt-tt>64?textDecoder.decode(et.subarray(tt,rt)):utf8Slice(et,tt,rt),fromString$5=useBuffer?et=>et.length>64?globalThis.Buffer.from(et):utf8ToBytes(et):et=>et.length>64?textEncoder.encode(et):utf8ToBytes(et),fromArray=et=>Uint8Array.from(et),slice=useBuffer?(et,tt,rt)=>isBuffer(et)?new Uint8Array(et.subarray(tt,rt)):et.slice(tt,rt):(et,tt,rt)=>et.slice(tt,rt),concat$2=useBuffer?(et,tt)=>(et=et.map(rt=>rt instanceof Uint8Array?rt:globalThis.Buffer.from(rt)),asU8A(globalThis.Buffer.concat(et,tt))):(et,tt)=>{const rt=new Uint8Array(tt);let nt=0;for(let it of et)nt+it.length>rt.length&&(it=it.subarray(0,rt.length-nt)),rt.set(it,nt),nt+=it.length;return rt},alloc=useBuffer?et=>globalThis.Buffer.allocUnsafe(et):et=>new Uint8Array(et);function compare$1(et,tt){if(isBuffer(et)&&isBuffer(tt))return et.compare(tt);for(let rt=0;rt<et.length;rt++)if(et[rt]!==tt[rt])return et[rt]<tt[rt]?-1:1;return 0}function utf8ToBytes(et,tt=1/0){let rt;const nt=et.length;let it=null;const ot=[];for(let st=0;st<nt;++st){if(rt=et.charCodeAt(st),rt>55295&&rt<57344){if(!it){if(rt>56319){(tt-=3)>-1&&ot.push(239,191,189);continue}else if(st+1===nt){(tt-=3)>-1&&ot.push(239,191,189);continue}it=rt;continue}if(rt<56320){(tt-=3)>-1&&ot.push(239,191,189),it=rt;continue}rt=(it-55296<<10|rt-56320)+65536}else it&&(tt-=3)>-1&&ot.push(239,191,189);if(it=null,rt<128){if((tt-=1)<0)break;ot.push(rt)}else if(rt<2048){if((tt-=2)<0)break;ot.push(rt>>6|192,rt&63|128)}else if(rt<65536){if((tt-=3)<0)break;ot.push(rt>>12|224,rt>>6&63|128,rt&63|128)}else if(rt<1114112){if((tt-=4)<0)break;ot.push(rt>>18|240,rt>>12&63|128,rt>>6&63|128,rt&63|128)}else throw new Error("Invalid code point")}return ot}function utf8Slice(et,tt,rt){const nt=[];for(;tt<rt;){const it=et[tt];let ot=null,st=it>239?4:it>223?3:it>191?2:1;if(tt+st<=rt){let at,ct,ut,lt;switch(st){case 1:it<128&&(ot=it);break;case 2:at=et[tt+1],(at&192)===128&&(lt=(it&31)<<6|at&63,lt>127&&(ot=lt));break;case 3:at=et[tt+1],ct=et[tt+2],(at&192)===128&&(ct&192)===128&&(lt=(it&15)<<12|(at&63)<<6|ct&63,lt>2047&&(lt<55296||lt>57343)&&(ot=lt));break;case 4:at=et[tt+1],ct=et[tt+2],ut=et[tt+3],(at&192)===128&&(ct&192)===128&&(ut&192)===128&&(lt=(it&15)<<18|(at&63)<<12|(ct&63)<<6|ut&63,lt>65535&&lt<1114112&&(ot=lt))}}ot===null?(ot=65533,st=1):ot>65535&&(ot-=65536,nt.push(ot>>>10&1023|55296),ot=56320|ot&1023),nt.push(ot),tt+=st}return decodeCodePointsArray(nt)}const MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(et){const tt=et.length;if(tt<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,et);let rt="",nt=0;for(;nt<tt;)rt+=String.fromCharCode.apply(String,et.slice(nt,nt+=MAX_ARGUMENTS_LENGTH));return rt}const defaultChunkSize=256;class Bl{constructor(tt=defaultChunkSize){this.chunkSize=tt,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(tt){let rt=this.chunks[this.chunks.length-1];if(this.cursor+tt.length<=this.maxCursor+1){const nt=rt.length-(this.maxCursor-this.cursor)-1;rt.set(tt,nt)}else{if(rt){const nt=rt.length-(this.maxCursor-this.cursor)-1;nt<rt.length&&(this.chunks[this.chunks.length-1]=rt.subarray(0,nt),this.maxCursor=this.cursor-1)}tt.length<64&&tt.length<this.chunkSize?(rt=alloc(this.chunkSize),this.chunks.push(rt),this.maxCursor+=rt.length,this._initReuseChunk===null&&(this._initReuseChunk=rt),rt.set(tt,0)):(this.chunks.push(tt),this.maxCursor+=tt.length)}this.cursor+=tt.length}toBytes(tt=!1){let rt;if(this.chunks.length===1){const nt=this.chunks[0];tt&&this.cursor>nt.length/2?(rt=this.cursor===nt.length?nt:nt.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):rt=slice(nt,0,this.cursor)}else rt=concat$2(this.chunks,this.cursor);return tt&&this.reset(),rt}}const decodeErrPrefix="CBOR decode error:",encodeErrPrefix="CBOR encode error:";function assertEnoughData(et,tt,rt){if(et.length-tt<rt)throw new Error(`${decodeErrPrefix} not enough data for type`)}const uintBoundaries=[24,256,65536,4294967296,BigInt("18446744073709551616")];function readUint8(et,tt,rt){assertEnoughData(et,tt,1);const nt=et[tt];if(rt.strict===!0&&nt<uintBoundaries[0])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return nt}function readUint16(et,tt,rt){assertEnoughData(et,tt,2);const nt=et[tt]<<8|et[tt+1];if(rt.strict===!0&&nt<uintBoundaries[1])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return nt}function readUint32(et,tt,rt){assertEnoughData(et,tt,4);const nt=et[tt]*16777216+(et[tt+1]<<16)+(et[tt+2]<<8)+et[tt+3];if(rt.strict===!0&&nt<uintBoundaries[2])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return nt}function readUint64(et,tt,rt){assertEnoughData(et,tt,8);const nt=et[tt]*16777216+(et[tt+1]<<16)+(et[tt+2]<<8)+et[tt+3],it=et[tt+4]*16777216+(et[tt+5]<<16)+(et[tt+6]<<8)+et[tt+7],ot=(BigInt(nt)<<BigInt(32))+BigInt(it);if(rt.strict===!0&&ot<uintBoundaries[3])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);if(ot<=Number.MAX_SAFE_INTEGER)return Number(ot);if(rt.allowBigInt===!0)return ot;throw new Error(`${decodeErrPrefix} integers outside of the safe integer range are not supported`)}function decodeUint8(et,tt,rt,nt){return new Token(Type.uint,readUint8(et,tt+1,nt),2)}function decodeUint16(et,tt,rt,nt){return new Token(Type.uint,readUint16(et,tt+1,nt),3)}function decodeUint32(et,tt,rt,nt){return new Token(Type.uint,readUint32(et,tt+1,nt),5)}function decodeUint64(et,tt,rt,nt){return new Token(Type.uint,readUint64(et,tt+1,nt),9)}function encodeUint(et,tt){return encodeUintValue(et,0,tt.value)}function encodeUintValue(et,tt,rt){if(rt<uintBoundaries[0]){const nt=Number(rt);et.push([tt|nt])}else if(rt<uintBoundaries[1]){const nt=Number(rt);et.push([tt|24,nt])}else if(rt<uintBoundaries[2]){const nt=Number(rt);et.push([tt|25,nt>>>8,nt&255])}else if(rt<uintBoundaries[3]){const nt=Number(rt);et.push([tt|26,nt>>>24&255,nt>>>16&255,nt>>>8&255,nt&255])}else{const nt=BigInt(rt);if(nt<uintBoundaries[4]){const it=[tt|27,0,0,0,0,0,0,0];let ot=Number(nt&BigInt(4294967295)),st=Number(nt>>BigInt(32)&BigInt(4294967295));it[8]=ot&255,ot=ot>>8,it[7]=ot&255,ot=ot>>8,it[6]=ot&255,ot=ot>>8,it[5]=ot&255,it[4]=st&255,st=st>>8,it[3]=st&255,st=st>>8,it[2]=st&255,st=st>>8,it[1]=st&255,et.push(it)}else throw new Error(`${decodeErrPrefix} encountered BigInt larger than allowable range`)}}encodeUint.encodedSize=function et(tt){return encodeUintValue.encodedSize(tt.value)},encodeUintValue.encodedSize=function et(tt){return tt<uintBoundaries[0]?1:tt<uintBoundaries[1]?2:tt<uintBoundaries[2]?3:tt<uintBoundaries[3]?5:9},encodeUint.compareTokens=function et(tt,rt){return tt.value<rt.value?-1:tt.value>rt.value?1:0};function decodeNegint8(et,tt,rt,nt){return new Token(Type.negint,-1-readUint8(et,tt+1,nt),2)}function decodeNegint16(et,tt,rt,nt){return new Token(Type.negint,-1-readUint16(et,tt+1,nt),3)}function decodeNegint32(et,tt,rt,nt){return new Token(Type.negint,-1-readUint32(et,tt+1,nt),5)}const neg1b=BigInt(-1),pos1b=BigInt(1);function decodeNegint64(et,tt,rt,nt){const it=readUint64(et,tt+1,nt);if(typeof it!="bigint"){const ot=-1-it;if(ot>=Number.MIN_SAFE_INTEGER)return new Token(Type.negint,ot,9)}if(nt.allowBigInt!==!0)throw new Error(`${decodeErrPrefix} integers outside of the safe integer range are not supported`);return new Token(Type.negint,neg1b-BigInt(it),9)}function encodeNegint(et,tt){const rt=tt.value,nt=typeof rt=="bigint"?rt*neg1b-pos1b:rt*-1-1;encodeUintValue(et,tt.type.majorEncoded,nt)}encodeNegint.encodedSize=function et(tt){const rt=tt.value,nt=typeof rt=="bigint"?rt*neg1b-pos1b:rt*-1-1;return nt<uintBoundaries[0]?1:nt<uintBoundaries[1]?2:nt<uintBoundaries[2]?3:nt<uintBoundaries[3]?5:9},encodeNegint.compareTokens=function et(tt,rt){return tt.value<rt.value?1:tt.value>rt.value?-1:0};function toToken$3(et,tt,rt,nt){assertEnoughData(et,tt,rt+nt);const it=slice(et,tt+rt,tt+rt+nt);return new Token(Type.bytes,it,rt+nt)}function decodeBytesCompact(et,tt,rt,nt){return toToken$3(et,tt,1,rt)}function decodeBytes8(et,tt,rt,nt){return toToken$3(et,tt,2,readUint8(et,tt+1,nt))}function decodeBytes16(et,tt,rt,nt){return toToken$3(et,tt,3,readUint16(et,tt+1,nt))}function decodeBytes32(et,tt,rt,nt){return toToken$3(et,tt,5,readUint32(et,tt+1,nt))}function decodeBytes64(et,tt,rt,nt){const it=readUint64(et,tt+1,nt);if(typeof it=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer bytes lengths not supported`);return toToken$3(et,tt,9,it)}function tokenBytes(et){return et.encodedBytes===void 0&&(et.encodedBytes=et.type===Type.string?fromString$5(et.value):et.value),et.encodedBytes}function encodeBytes(et,tt){const rt=tokenBytes(tt);encodeUintValue(et,tt.type.majorEncoded,rt.length),et.push(rt)}encodeBytes.encodedSize=function et(tt){const rt=tokenBytes(tt);return encodeUintValue.encodedSize(rt.length)+rt.length},encodeBytes.compareTokens=function et(tt,rt){return compareBytes(tokenBytes(tt),tokenBytes(rt))};function compareBytes(et,tt){return et.length<tt.length?-1:et.length>tt.length?1:compare$1(et,tt)}function toToken$2(et,tt,rt,nt,it){const ot=rt+nt;assertEnoughData(et,tt,ot);const st=new Token(Type.string,toString$4(et,tt+rt,tt+ot),ot);return it.retainStringBytes===!0&&(st.byteValue=slice(et,tt+rt,tt+ot)),st}function decodeStringCompact(et,tt,rt,nt){return toToken$2(et,tt,1,rt,nt)}function decodeString8(et,tt,rt,nt){return toToken$2(et,tt,2,readUint8(et,tt+1,nt),nt)}function decodeString16(et,tt,rt,nt){return toToken$2(et,tt,3,readUint16(et,tt+1,nt),nt)}function decodeString32(et,tt,rt,nt){return toToken$2(et,tt,5,readUint32(et,tt+1,nt),nt)}function decodeString64(et,tt,rt,nt){const it=readUint64(et,tt+1,nt);if(typeof it=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer string lengths not supported`);return toToken$2(et,tt,9,it,nt)}const encodeString$1=encodeBytes;function toToken$1(et,tt,rt,nt){return new Token(Type.array,nt,rt)}function decodeArrayCompact(et,tt,rt,nt){return toToken$1(et,tt,1,rt)}function decodeArray8(et,tt,rt,nt){return toToken$1(et,tt,2,readUint8(et,tt+1,nt))}function decodeArray16(et,tt,rt,nt){return toToken$1(et,tt,3,readUint16(et,tt+1,nt))}function decodeArray32(et,tt,rt,nt){return toToken$1(et,tt,5,readUint32(et,tt+1,nt))}function decodeArray64(et,tt,rt,nt){const it=readUint64(et,tt+1,nt);if(typeof it=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer array lengths not supported`);return toToken$1(et,tt,9,it)}function decodeArrayIndefinite(et,tt,rt,nt){if(nt.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return toToken$1(et,tt,1,1/0)}function encodeArray(et,tt){encodeUintValue(et,Type.array.majorEncoded,tt.value)}encodeArray.compareTokens=encodeUint.compareTokens,encodeArray.encodedSize=function et(tt){return encodeUintValue.encodedSize(tt.value)};function toToken(et,tt,rt,nt){return new Token(Type.map,nt,rt)}function decodeMapCompact(et,tt,rt,nt){return toToken(et,tt,1,rt)}function decodeMap8(et,tt,rt,nt){return toToken(et,tt,2,readUint8(et,tt+1,nt))}function decodeMap16(et,tt,rt,nt){return toToken(et,tt,3,readUint16(et,tt+1,nt))}function decodeMap32(et,tt,rt,nt){return toToken(et,tt,5,readUint32(et,tt+1,nt))}function decodeMap64(et,tt,rt,nt){const it=readUint64(et,tt+1,nt);if(typeof it=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer map lengths not supported`);return toToken(et,tt,9,it)}function decodeMapIndefinite(et,tt,rt,nt){if(nt.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return toToken(et,tt,1,1/0)}function encodeMap(et,tt){encodeUintValue(et,Type.map.majorEncoded,tt.value)}encodeMap.compareTokens=encodeUint.compareTokens,encodeMap.encodedSize=function et(tt){return encodeUintValue.encodedSize(tt.value)};function decodeTagCompact(et,tt,rt,nt){return new Token(Type.tag,rt,1)}function decodeTag8(et,tt,rt,nt){return new Token(Type.tag,readUint8(et,tt+1,nt),2)}function decodeTag16(et,tt,rt,nt){return new Token(Type.tag,readUint16(et,tt+1,nt),3)}function decodeTag32(et,tt,rt,nt){return new Token(Type.tag,readUint32(et,tt+1,nt),5)}function decodeTag64(et,tt,rt,nt){return new Token(Type.tag,readUint64(et,tt+1,nt),9)}function encodeTag(et,tt){encodeUintValue(et,Type.tag.majorEncoded,tt.value)}encodeTag.compareTokens=encodeUint.compareTokens,encodeTag.encodedSize=function et(tt){return encodeUintValue.encodedSize(tt.value)};const MINOR_FALSE=20,MINOR_TRUE=21,MINOR_NULL=22,MINOR_UNDEFINED=23;function decodeUndefined(et,tt,rt,nt){if(nt.allowUndefined===!1)throw new Error(`${decodeErrPrefix} undefined values are not supported`);return nt.coerceUndefinedToNull===!0?new Token(Type.null,null,1):new Token(Type.undefined,void 0,1)}function decodeBreak(et,tt,rt,nt){if(nt.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return new Token(Type.break,void 0,1)}function createToken(et,tt,rt){if(rt){if(rt.allowNaN===!1&&Number.isNaN(et))throw new Error(`${decodeErrPrefix} NaN values are not supported`);if(rt.allowInfinity===!1&&(et===1/0||et===-1/0))throw new Error(`${decodeErrPrefix} Infinity values are not supported`)}return new Token(Type.float,et,tt)}function decodeFloat16(et,tt,rt,nt){return createToken(readFloat16(et,tt+1),3,nt)}function decodeFloat32(et,tt,rt,nt){return createToken(readFloat32(et,tt+1),5,nt)}function decodeFloat64(et,tt,rt,nt){return createToken(readFloat64(et,tt+1),9,nt)}function encodeFloat(et,tt,rt){const nt=tt.value;if(nt===!1)et.push([Type.float.majorEncoded|MINOR_FALSE]);else if(nt===!0)et.push([Type.float.majorEncoded|MINOR_TRUE]);else if(nt===null)et.push([Type.float.majorEncoded|MINOR_NULL]);else if(nt===void 0)et.push([Type.float.majorEncoded|MINOR_UNDEFINED]);else{let it,ot=!1;(!rt||rt.float64!==!0)&&(encodeFloat16(nt),it=readFloat16(ui8a,1),nt===it||Number.isNaN(nt)?(ui8a[0]=249,et.push(ui8a.slice(0,3)),ot=!0):(encodeFloat32(nt),it=readFloat32(ui8a,1),nt===it&&(ui8a[0]=250,et.push(ui8a.slice(0,5)),ot=!0))),ot||(encodeFloat64(nt),it=readFloat64(ui8a,1),ui8a[0]=251,et.push(ui8a.slice(0,9)))}}encodeFloat.encodedSize=function et(tt,rt){const nt=tt.value;if(nt===!1||nt===!0||nt===null||nt===void 0)return 1;if(!rt||rt.float64!==!0){encodeFloat16(nt);let it=readFloat16(ui8a,1);if(nt===it||Number.isNaN(nt))return 3;if(encodeFloat32(nt),it=readFloat32(ui8a,1),nt===it)return 5}return 9};const buffer$1=new ArrayBuffer(9),dataView=new DataView(buffer$1,1),ui8a=new Uint8Array(buffer$1,0);function encodeFloat16(et){if(et===1/0)dataView.setUint16(0,31744,!1);else if(et===-1/0)dataView.setUint16(0,64512,!1);else if(Number.isNaN(et))dataView.setUint16(0,32256,!1);else{dataView.setFloat32(0,et);const tt=dataView.getUint32(0),rt=(tt&2139095040)>>23,nt=tt&8388607;if(rt===255)dataView.setUint16(0,31744,!1);else if(rt===0)dataView.setUint16(0,(et&2147483648)>>16|nt>>13,!1);else{const it=rt-127;it<-24?dataView.setUint16(0,0):it<-14?dataView.setUint16(0,(tt&2147483648)>>16|1<<24+it,!1):dataView.setUint16(0,(tt&2147483648)>>16|it+15<<10|nt>>13,!1)}}}function readFloat16(et,tt){if(et.length-tt<2)throw new Error(`${decodeErrPrefix} not enough data for float16`);const rt=(et[tt]<<8)+et[tt+1];if(rt===31744)return 1/0;if(rt===64512)return-1/0;if(rt===32256)return NaN;const nt=rt>>10&31,it=rt&1023;let ot;return nt===0?ot=it*2**-24:nt!==31?ot=(it+1024)*2**(nt-25):ot=it===0?1/0:NaN,rt&32768?-ot:ot}function encodeFloat32(et){dataView.setFloat32(0,et,!1)}function readFloat32(et,tt){if(et.length-tt<4)throw new Error(`${decodeErrPrefix} not enough data for float32`);const rt=(et.byteOffset||0)+tt;return new DataView(et.buffer,rt,4).getFloat32(0,!1)}function encodeFloat64(et){dataView.setFloat64(0,et,!1)}function readFloat64(et,tt){if(et.length-tt<8)throw new Error(`${decodeErrPrefix} not enough data for float64`);const rt=(et.byteOffset||0)+tt;return new DataView(et.buffer,rt,8).getFloat64(0,!1)}encodeFloat.compareTokens=encodeUint.compareTokens;function invalidMinor(et,tt,rt){throw new Error(`${decodeErrPrefix} encountered invalid minor (${rt}) for major ${et[tt]>>>5}`)}function errorer(et){return()=>{throw new Error(`${decodeErrPrefix} ${et}`)}}const jump=[];for(let et=0;et<=23;et++)jump[et]=invalidMinor;jump[24]=decodeUint8,jump[25]=decodeUint16,jump[26]=decodeUint32,jump[27]=decodeUint64,jump[28]=invalidMinor,jump[29]=invalidMinor,jump[30]=invalidMinor,jump[31]=invalidMinor;for(let et=32;et<=55;et++)jump[et]=invalidMinor;jump[56]=decodeNegint8,jump[57]=decodeNegint16,jump[58]=decodeNegint32,jump[59]=decodeNegint64,jump[60]=invalidMinor,jump[61]=invalidMinor,jump[62]=invalidMinor,jump[63]=invalidMinor;for(let et=64;et<=87;et++)jump[et]=decodeBytesCompact;jump[88]=decodeBytes8,jump[89]=decodeBytes16,jump[90]=decodeBytes32,jump[91]=decodeBytes64,jump[92]=invalidMinor,jump[93]=invalidMinor,jump[94]=invalidMinor,jump[95]=errorer("indefinite length bytes/strings are not supported");for(let et=96;et<=119;et++)jump[et]=decodeStringCompact;jump[120]=decodeString8,jump[121]=decodeString16,jump[122]=decodeString32,jump[123]=decodeString64,jump[124]=invalidMinor,jump[125]=invalidMinor,jump[126]=invalidMinor,jump[127]=errorer("indefinite length bytes/strings are not supported");for(let et=128;et<=151;et++)jump[et]=decodeArrayCompact;jump[152]=decodeArray8,jump[153]=decodeArray16,jump[154]=decodeArray32,jump[155]=decodeArray64,jump[156]=invalidMinor,jump[157]=invalidMinor,jump[158]=invalidMinor,jump[159]=decodeArrayIndefinite;for(let et=160;et<=183;et++)jump[et]=decodeMapCompact;jump[184]=decodeMap8,jump[185]=decodeMap16,jump[186]=decodeMap32,jump[187]=decodeMap64,jump[188]=invalidMinor,jump[189]=invalidMinor,jump[190]=invalidMinor,jump[191]=decodeMapIndefinite;for(let et=192;et<=215;et++)jump[et]=decodeTagCompact;jump[216]=decodeTag8,jump[217]=decodeTag16,jump[218]=decodeTag32,jump[219]=decodeTag64,jump[220]=invalidMinor,jump[221]=invalidMinor,jump[222]=invalidMinor,jump[223]=invalidMinor;for(let et=224;et<=243;et++)jump[et]=errorer("simple values are not supported");jump[244]=invalidMinor,jump[245]=invalidMinor,jump[246]=invalidMinor,jump[247]=decodeUndefined,jump[248]=errorer("simple values are not supported"),jump[249]=decodeFloat16,jump[250]=decodeFloat32,jump[251]=decodeFloat64,jump[252]=invalidMinor,jump[253]=invalidMinor,jump[254]=invalidMinor,jump[255]=decodeBreak;const quick=[];for(let et=0;et<24;et++)quick[et]=new Token(Type.uint,et,1);for(let et=-1;et>=-24;et--)quick[31-et]=new Token(Type.negint,et,1);quick[64]=new Token(Type.bytes,new Uint8Array(0),1),quick[96]=new Token(Type.string,"",1),quick[128]=new Token(Type.array,0,1),quick[160]=new Token(Type.map,0,1),quick[244]=new Token(Type.false,!1,1),quick[245]=new Token(Type.true,!0,1),quick[246]=new Token(Type.null,null,1);function quickEncodeToken(et){switch(et.type){case Type.false:return fromArray([244]);case Type.true:return fromArray([245]);case Type.null:return fromArray([246]);case Type.bytes:return et.value.length?void 0:fromArray([64]);case Type.string:return et.value===""?fromArray([96]):void 0;case Type.array:return et.value===0?fromArray([128]):void 0;case Type.map:return et.value===0?fromArray([160]):void 0;case Type.uint:return et.value<24?fromArray([Number(et.value)]):void 0;case Type.negint:if(et.value>=-24)return fromArray([31-Number(et.value)])}}const defaultEncodeOptions={float64:!1,mapSorter,quickEncodeToken};function makeCborEncoders(){const et=[];return et[Type.uint.major]=encodeUint,et[Type.negint.major]=encodeNegint,et[Type.bytes.major]=encodeBytes,et[Type.string.major]=encodeString$1,et[Type.array.major]=encodeArray,et[Type.map.major]=encodeMap,et[Type.tag.major]=encodeTag,et[Type.float.major]=encodeFloat,et}const cborEncoders=makeCborEncoders(),buf=new Bl;class Ref{constructor(tt,rt){this.obj=tt,this.parent=rt}includes(tt){let rt=this;do if(rt.obj===tt)return!0;while(rt=rt.parent);return!1}static createCheck(tt,rt){if(tt&&tt.includes(rt))throw new Error(`${encodeErrPrefix} object contains circular references`);return new Ref(rt,tt)}}const simpleTokens={null:new Token(Type.null,null),undefined:new Token(Type.undefined,void 0),true:new Token(Type.true,!0),false:new Token(Type.false,!1),emptyArray:new Token(Type.array,0),emptyMap:new Token(Type.map,0)},typeEncoders={number(et,tt,rt,nt){return!Number.isInteger(et)||!Number.isSafeInteger(et)?new Token(Type.float,et):et>=0?new Token(Type.uint,et):new Token(Type.negint,et)},bigint(et,tt,rt,nt){return et>=BigInt(0)?new Token(Type.uint,et):new Token(Type.negint,et)},Uint8Array(et,tt,rt,nt){return new Token(Type.bytes,et)},string(et,tt,rt,nt){return new Token(Type.string,et)},boolean(et,tt,rt,nt){return et?simpleTokens.true:simpleTokens.false},null(et,tt,rt,nt){return simpleTokens.null},undefined(et,tt,rt,nt){return simpleTokens.undefined},ArrayBuffer(et,tt,rt,nt){return new Token(Type.bytes,new Uint8Array(et))},DataView(et,tt,rt,nt){return new Token(Type.bytes,new Uint8Array(et.buffer,et.byteOffset,et.byteLength))},Array(et,tt,rt,nt){if(!et.length)return rt.addBreakTokens===!0?[simpleTokens.emptyArray,new Token(Type.break)]:simpleTokens.emptyArray;nt=Ref.createCheck(nt,et);const it=[];let ot=0;for(const st of et)it[ot++]=objectToTokens(st,rt,nt);return rt.addBreakTokens?[new Token(Type.array,et.length),it,new Token(Type.break)]:[new Token(Type.array,et.length),it]},Object(et,tt,rt,nt){const it=tt!=="Object",ot=it?et.keys():Object.keys(et),st=it?et.size:ot.length;if(!st)return rt.addBreakTokens===!0?[simpleTokens.emptyMap,new Token(Type.break)]:simpleTokens.emptyMap;nt=Ref.createCheck(nt,et);const at=[];let ct=0;for(const ut of ot)at[ct++]=[objectToTokens(ut,rt,nt),objectToTokens(it?et.get(ut):et[ut],rt,nt)];return sortMapEntries(at,rt),rt.addBreakTokens?[new Token(Type.map,st),at,new Token(Type.break)]:[new Token(Type.map,st),at]}};typeEncoders.Map=typeEncoders.Object,typeEncoders.Buffer=typeEncoders.Uint8Array;for(const et of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))typeEncoders[`${et}Array`]=typeEncoders.DataView;function objectToTokens(et,tt={},rt){const nt=is(et),it=tt&&tt.typeEncoders&&tt.typeEncoders[nt]||typeEncoders[nt];if(typeof it=="function"){const st=it(et,nt,tt,rt);if(st!=null)return st}const ot=typeEncoders[nt];if(!ot)throw new Error(`${encodeErrPrefix} unsupported type: ${nt}`);return ot(et,nt,tt,rt)}function sortMapEntries(et,tt){tt.mapSorter&&et.sort(tt.mapSorter)}function mapSorter(et,tt){const rt=Array.isArray(et[0])?et[0][0]:et[0],nt=Array.isArray(tt[0])?tt[0][0]:tt[0];if(rt.type!==nt.type)return rt.type.compare(nt.type);const it=rt.type.major,ot=cborEncoders[it].compareTokens(rt,nt);return ot===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),ot}function tokensToEncoded(et,tt,rt,nt){if(Array.isArray(tt))for(const it of tt)tokensToEncoded(et,it,rt,nt);else rt[tt.type.major](et,tt,nt)}function encodeCustom(et,tt,rt){const nt=objectToTokens(et,rt);if(!Array.isArray(nt)&&rt.quickEncodeToken){const it=rt.quickEncodeToken(nt);if(it)return it;const ot=tt[nt.type.major];if(ot.encodedSize){const st=ot.encodedSize(nt,rt),at=new Bl(st);if(ot(at,nt,rt),at.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${nt} was wrong`);return asU8A(at.chunks[0])}}return buf.reset(),tokensToEncoded(buf,nt,tt,rt),buf.toBytes(!0)}function encode$5(et,tt){return tt=Object.assign({},defaultEncodeOptions,tt),encodeCustom(et,cborEncoders,tt)}const defaultDecodeOptions={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Tokeniser{constructor(tt,rt={}){this.pos=0,this.data=tt,this.options=rt}done(){return this.pos>=this.data.length}next(){const tt=this.data[this.pos];let rt=quick[tt];if(rt===void 0){const nt=jump[tt];if(!nt)throw new Error(`${decodeErrPrefix} no decoder for major type ${tt>>>5} (byte 0x${tt.toString(16).padStart(2,"0")})`);const it=tt&31;rt=nt(this.data,this.pos,it,this.options)}return this.pos+=rt.encodedLength,rt}}const DONE=Symbol.for("DONE"),BREAK=Symbol.for("BREAK");function tokenToArray(et,tt,rt){const nt=[];for(let it=0;it<et.value;it++){const ot=tokensToObject(tt,rt);if(ot===BREAK){if(et.value===1/0)break;throw new Error(`${decodeErrPrefix} got unexpected break to lengthed array`)}if(ot===DONE)throw new Error(`${decodeErrPrefix} found array but not enough entries (got ${it}, expected ${et.value})`);nt[it]=ot}return nt}function tokenToMap(et,tt,rt){const nt=rt.useMaps===!0,it=nt?void 0:{},ot=nt?new Map:void 0;for(let st=0;st<et.value;st++){const at=tokensToObject(tt,rt);if(at===BREAK){if(et.value===1/0)break;throw new Error(`${decodeErrPrefix} got unexpected break to lengthed map`)}if(at===DONE)throw new Error(`${decodeErrPrefix} found map but not enough entries (got ${st} [no key], expected ${et.value})`);if(nt!==!0&&typeof at!="string")throw new Error(`${decodeErrPrefix} non-string keys not supported (got ${typeof at})`);if(rt.rejectDuplicateMapKeys===!0&&(nt&&ot.has(at)||!nt&&at in it))throw new Error(`${decodeErrPrefix} found repeat map key "${at}"`);const ct=tokensToObject(tt,rt);if(ct===DONE)throw new Error(`${decodeErrPrefix} found map but not enough entries (got ${st} [no value], expected ${et.value})`);nt?ot.set(at,ct):it[at]=ct}return nt?ot:it}function tokensToObject(et,tt){if(et.done())return DONE;const rt=et.next();if(rt.type===Type.break)return BREAK;if(rt.type.terminal)return rt.value;if(rt.type===Type.array)return tokenToArray(rt,et,tt);if(rt.type===Type.map)return tokenToMap(rt,et,tt);if(rt.type===Type.tag){if(tt.tags&&typeof tt.tags[rt.value]=="function"){const nt=tokensToObject(et,tt);return tt.tags[rt.value](nt)}throw new Error(`${decodeErrPrefix} tag not supported (${rt.value})`)}throw new Error("unsupported")}function decode$8(et,tt){if(!(et instanceof Uint8Array))throw new Error(`${decodeErrPrefix} data to decode must be a Uint8Array`);tt=Object.assign({},defaultDecodeOptions,tt);const rt=tt.tokenizer||new Tokeniser(et,tt),nt=tokensToObject(rt,tt);if(nt===DONE)throw new Error(`${decodeErrPrefix} did not find any content to decode`);if(nt===BREAK)throw new Error(`${decodeErrPrefix} got unexpected break`);if(!rt.done())throw new Error(`${decodeErrPrefix} too many terminals, data makes no sense`);return nt}const cborg$2=Object.freeze(Object.defineProperty({__proto__:null,Token,Type,decode:decode$8,encode:encode$5},Symbol.toStringTag,{value:"Module"})),CID_CBOR_TAG=42;function cidEncoder(et){if(et.asCID!==et)return null;const tt=CID$f.asCID(et);if(!tt)return null;const rt=new Uint8Array(tt.bytes.byteLength+1);return rt.set(tt.bytes,1),[new Token(Type.tag,CID_CBOR_TAG),new Token(Type.bytes,rt)]}function undefinedEncoder(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function numberEncoder(et){if(Number.isNaN(et))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(et===1/0||et===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const encodeOptions={float64:!0,typeEncoders:{Object:cidEncoder,undefined:undefinedEncoder,number:numberEncoder}};function cidDecoder(et){if(et[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return CID$f.decode(et.subarray(1))}const decodeOptions={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,tags:[]};decodeOptions.tags[CID_CBOR_TAG]=cidDecoder;const name="dag-cbor",code=113,encode$4=et=>encode$5(et,encodeOptions),decode$7=et=>decode$8(et,decodeOptions),esm=Object.freeze(Object.defineProperty({__proto__:null,code,decode:decode$7,encode:encode$4,name},Symbol.toStringTag,{value:"Module"})),require$$6=getAugmentedNamespace(esm),require$$8=getAugmentedNamespace(basics);class NotInitializedError extends Error{constructor(tt="not initialized"){super(tt),this.name="NotInitializedError",this.code=NotInitializedError.code}}NotInitializedError.code="ERR_NOT_INITIALIZED";class AlreadyInitializingError extends Error{constructor(tt="cannot initialize an initializing node"){super(tt),this.name="AlreadyInitializingError",this.code=AlreadyInitializedError.code}}AlreadyInitializingError.code="ERR_ALREADY_INITIALIZING";class AlreadyInitializedError extends Error{constructor(tt="cannot re-initialize an initialized node"){super(tt),this.name="AlreadyInitializedError",this.code=AlreadyInitializedError.code}}AlreadyInitializedError.code="ERR_ALREADY_INITIALIZED";class NotStartedError extends Error{constructor(tt="not started"){super(tt),this.name="NotStartedError",this.code=NotStartedError.code}}NotStartedError.code="ERR_NOT_STARTED";class AlreadyStartingError extends Error{constructor(tt="cannot start, already startin"){super(tt),this.name="AlreadyStartingError",this.code=AlreadyStartingError.code}}AlreadyStartingError.code="ERR_ALREADY_STARTING";class AlreadyStartedError extends Error{constructor(tt="cannot start, already started"){super(tt),this.name="AlreadyStartedError",this.code=AlreadyStartedError.code}}AlreadyStartedError.code="ERR_ALREADY_STARTED";class NotEnabledError extends Error{constructor(tt="not enabled"){super(tt),this.name="NotEnabledError",this.code=NotEnabledError.code}}NotEnabledError.code="ERR_NOT_ENABLED";const{bases:bases$8}=require$$8;function createCodec$4(et,tt,rt,nt){return{name:et,prefix:tt,encoder:{name:et,prefix:tt,encode:rt},decoder:{decode:nt}}}const string$4=createCodec$4("utf8","u",et=>"u"+new TextDecoder("utf8").decode(et),et=>new TextEncoder().encode(et.substring(1))),ascii$4=createCodec$4("ascii","a",et=>{let tt="a";for(let rt=0;rt<et.length;rt++)tt+=String.fromCharCode(et[rt]);return tt},et=>{et=et.substring(1);const tt=new Uint8Array(et.length);for(let rt=0;rt<et.length;rt++)tt[rt]=et.charCodeAt(rt);return tt}),BASES$2={utf8:string$4,"utf-8":string$4,hex:bases$8.base16,latin1:ascii$4,ascii:ascii$4,binary:ascii$4,...bases$8};var bases_1$2=BASES$2;let urlAlphabet="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",random=et=>crypto.getRandomValues(new Uint8Array(et)),customRandom=(et,tt,rt)=>{let nt=(2<<Math.log(et.length-1)/Math.LN2)-1,it=-~(1.6*nt*tt/et.length);return(ot=tt)=>{let st="";for(;;){let at=rt(it),ct=it;for(;ct--;)if(st+=et[at[ct]&nt]||"",st.length===ot)return st}}},customAlphabet=(et,tt=21)=>customRandom(et,tt,random),nanoid$4=(et=21)=>crypto.getRandomValues(new Uint8Array(et)).reduce((tt,rt)=>(rt&=63,rt<36?tt+=rt.toString(36):rt<62?tt+=(rt-26).toString(36).toUpperCase():rt>62?tt+="-":tt+="_",tt),"");const index_browser=Object.freeze(Object.defineProperty({__proto__:null,customAlphabet,customRandom,nanoid:nanoid$4,random,urlAlphabet},Symbol.toStringTag,{value:"Module"})),require$$1$1=getAugmentedNamespace(index_browser),{nanoid:nanoid$3}=require$$1$1,{toString:uint8ArrayToString$f}=require$$1$2,{fromString:uint8ArrayFromString$f}=require$$9$2,pathSepS="/",pathSepB=new TextEncoder().encode(pathSepS),pathSep=pathSepB[0];let Key$f=class Kr{constructor(tt,rt){if(typeof tt=="string")this._buf=uint8ArrayFromString$f(tt);else if(tt instanceof Uint8Array)this._buf=tt;else throw new Error("Invalid key, should be String of Uint8Array");if(rt==null&&(rt=!0),rt&&this.clean(),this._buf.byteLength===0||this._buf[0]!==pathSep)throw new Error("Invalid key")}toString(tt="utf8"){return uint8ArrayToString$f(this._buf,tt)}uint8Array(){return this._buf}get[Symbol.toStringTag](){return`Key(${this.toString()})`}static withNamespaces(tt){return new Kr(tt.join(pathSepS))}static random(){return new Kr(nanoid$3().replace(/-/g,""))}static asKey(tt){return tt instanceof Uint8Array||typeof tt=="string"?new Kr(tt):tt.uint8Array?new Kr(tt.uint8Array()):null}clean(){if((!this._buf||this._buf.byteLength===0)&&(this._buf=pathSepB),this._buf[0]!==pathSep){const tt=new Uint8Array(this._buf.byteLength+1);tt.fill(pathSep,0,1),tt.set(this._buf,1),this._buf=tt}for(;this._buf.byteLength>1&&this._buf[this._buf.byteLength-1]===pathSep;)this._buf=this._buf.subarray(0,-1)}less(tt){const rt=this.list(),nt=tt.list();for(let it=0;it<rt.length;it++){if(nt.length<it+1)return!1;const ot=rt[it],st=nt[it];if(ot<st)return!0;if(ot>st)return!1}return rt.length<nt.length}reverse(){return Kr.withNamespaces(this.list().slice().reverse())}namespaces(){return this.list()}baseNamespace(){const tt=this.namespaces();return tt[tt.length-1]}list(){return this.toString().split(pathSepS).slice(1)}type(){return namespaceType(this.baseNamespace())}name(){return namespaceValue(this.baseNamespace())}instance(tt){return new Kr(this.toString()+":"+tt)}path(){let tt=this.parent().toString();return tt.endsWith(pathSepS)||(tt+=pathSepS),tt+=this.type(),new Kr(tt)}parent(){const tt=this.list();return tt.length===1?new Kr(pathSepS):new Kr(tt.slice(0,-1).join(pathSepS))}child(tt){return this.toString()===pathSepS?tt:tt.toString()===pathSepS?this:new Kr(this.toString()+tt.toString(),!1)}isAncestorOf(tt){return tt.toString()===this.toString()?!1:tt.toString().startsWith(this.toString())}isDecendantOf(tt){return tt.toString()===this.toString()?!1:this.toString().startsWith(tt.toString())}isTopLevel(){return this.list().length===1}concat(...tt){return Kr.withNamespaces([...this.namespaces(),...flatten(tt.map(rt=>rt.namespaces()))])}};function namespaceType(et){const tt=et.split(":");return tt.length<2?"":tt.slice(0,-1).join(":")}function namespaceValue(et){const tt=et.split(":");return tt[tt.length-1]}function flatten(et){return[].concat(...et)}var key=Key$f;const{nanoid:nanoid$2}=require$$1$1,tempdir$1=(et=tt=>tt)=>et(nanoid$2());var tempDir_browser=tempdir$1;const all$1=async et=>{const tt=[];for await(const rt of et)tt.push(rt);return tt};var itAll=all$1;const tempdir=tempDir_browser,all=itAll,sortAll$1=(et,tt)=>async function*(){yield*(await all(et)).sort(tt)}(),replaceStartWith=(et,tt)=>{const rt=new RegExp("^"+tt);return et.replace(rt,"")};var utils$e={sortAll:sortAll$1,tmpdir:tempdir,replaceStartWith};const drain$2=async et=>{for await(const tt of et);};var itDrain=drain$2;const filter$3=async function*(et,tt){for await(const rt of et)await tt(rt)&&(yield rt)};var itFilter=filter$3;const take$1=async function*(et,tt){let rt=0;if(!(tt<1)){for await(const nt of et)if(yield nt,rt++,rt===tt)return}};var itTake=take$1;const{sortAll}=utils$e,drain$1=itDrain,filter$2=itFilter,take=itTake;let Adapter$3=class{open(){return Promise.reject(new Error(".open is not implemented"))}close(){return Promise.reject(new Error(".close is not implemented"))}put(et,tt,rt){return Promise.reject(new Error(".put is not implemented"))}get(et,tt){return Promise.reject(new Error(".get is not implemented"))}has(et,tt){return Promise.reject(new Error(".has is not implemented"))}delete(et,tt){return Promise.reject(new Error(".delete is not implemented"))}async*putMany(et,tt={}){for await(const{key:rt,value:nt}of et)await this.put(rt,nt,tt),yield{key:rt,value:nt}}async*getMany(et,tt={}){for await(const rt of et)yield this.get(rt,tt)}async*deleteMany(et,tt={}){for await(const rt of et)await this.delete(rt,tt),yield rt}batch(){let et=[],tt=[];return{put(rt,nt){et.push({key:rt,value:nt})},delete(rt){tt.push(rt)},commit:async rt=>{await drain$1(this.putMany(et,rt)),et=[],await drain$1(this.deleteMany(tt,rt)),tt=[]}}}async*_all(et,tt){throw new Error("._all is not implemented")}async*_allKeys(et,tt){throw new Error("._allKeys is not implemented")}query(et,tt){let rt=this._all(et,tt);if(et.prefix!=null&&(rt=filter$2(rt,nt=>nt.key.toString().startsWith(et.prefix))),Array.isArray(et.filters)&&(rt=et.filters.reduce((nt,it)=>filter$2(nt,it),rt)),Array.isArray(et.orders)&&(rt=et.orders.reduce((nt,it)=>sortAll(nt,it),rt)),et.offset!=null){let nt=0;rt=filter$2(rt,()=>nt++>=et.offset)}return et.limit!=null&&(rt=take(rt,et.limit)),rt}queryKeys(et,tt){let rt=this._allKeys(et,tt);if(et.prefix!=null&&(rt=filter$2(rt,nt=>nt.toString().startsWith(et.prefix))),Array.isArray(et.filters)&&(rt=et.filters.reduce((nt,it)=>filter$2(nt,it),rt)),Array.isArray(et.orders)&&(rt=et.orders.reduce((nt,it)=>sortAll(nt,it),rt)),et.offset!=null){let nt=0;rt=filter$2(rt,()=>nt++>=et.offset)}return et.limit!=null&&(rt=take(rt,et.limit)),rt}};var adapter=Adapter$3;const errCode$g=errCode$i;function dbOpenFailedError(et){return et=et||new Error("Cannot open database"),errCode$g(et,"ERR_DB_OPEN_FAILED")}function dbDeleteFailedError(et){return et=et||new Error("Delete failed"),errCode$g(et,"ERR_DB_DELETE_FAILED")}function dbWriteFailedError(et){return et=et||new Error("Write failed"),errCode$g(et,"ERR_DB_WRITE_FAILED")}function notFoundError(et){return et=et||new Error("Not Found"),errCode$g(et,"ERR_NOT_FOUND")}function abortedError(et){return et=et||new Error("Aborted"),errCode$g(et,"ERR_ABORTED")}var errors$9={dbOpenFailedError,dbDeleteFailedError,dbWriteFailedError,notFoundError,abortedError};const Key$e=key,Adapter$2=adapter,Errors$5=errors$9;let MemoryDatastore$1=class extends Adapter$2{constructor(){super(),this.data={}}open(){return Promise.resolve()}close(){return Promise.resolve()}async put(et,tt){this.data[et.toString()]=tt}async get(et){if(!await this.has(et))throw Errors$5.notFoundError();return this.data[et.toString()]}async has(et){return this.data[et.toString()]!==void 0}async delete(et){delete this.data[et.toString()]}async*_all(){yield*Object.entries(this.data).map(([et,tt])=>({key:new Key$e(et),value:tt}))}async*_allKeys(){yield*Object.entries(this.data).map(([et])=>new Key$e(et))}};var memory$2=MemoryDatastore$1;const Key$d=key,MemoryDatastore=memory$2,utils$d=utils$e,Errors$4=errors$9,Adapter$1=adapter;var src$a={Key:Key$d,MemoryDatastore,utils:utils$d,Errors:Errors$4,Adapter:Adapter$1},timeoutAbortController={exports:{}},timeBrowser=function et(){return Date.now()},getTime=timeBrowser;function Retimer(et,tt,rt){var nt=this;this._started=getTime(),this._rescheduled=0,this._scheduled=tt,this._args=rt,this._timer=setTimeout(it,tt);function it(){nt._rescheduled>0?(nt._scheduled=nt._rescheduled-(getTime()-nt._started),nt._timer=setTimeout(it,nt._scheduled),nt._rescheduled=0):et.apply(null,nt._args)}}Retimer.prototype.reschedule=function(et){var tt=getTime();return tt+et-(this._started+this._scheduled)<0?!1:(this._started=tt,this._rescheduled=et,!0)},Retimer.prototype.clear=function(){clearTimeout(this._timer)};function retimer$1(){if(typeof arguments[0]!="function")throw new Error("callback needed");if(typeof arguments[1]!="number")throw new Error("timeout needed");var et;if(arguments.length>0){et=new Array(arguments.length-2);for(var tt=0;tt<et.length;tt++)et[tt]=arguments[tt+2]}return new Retimer(arguments[0],arguments[1],et)}var retimer_1=retimer$1;const{AbortController:AbortController$1}=typeof self<"u"?self:typeof window<"u"?window:requireBrowser(),retimer=retimer_1;let TimeoutController$1=class Zr extends AbortController$1{constructor(tt){super(),this._ms=tt,this._timer=retimer(()=>this.abort(),tt),Object.setPrototypeOf(this,Zr.prototype)}abort(){return this._timer.clear(),super.abort()}clear(){this._timer.clear()}reset(){this._timer.clear(),this._timer=retimer(()=>this.abort(),this._ms)}};timeoutAbortController.exports=TimeoutController$1,timeoutAbortController.exports.TimeoutController=TimeoutController$1;var timeoutAbortControllerExports=timeoutAbortController.exports,parseDuration$1={exports:{}},durationRE=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/uig;parseDuration$1.exports=parse$1,parseDuration$1.exports.default=parse$1,parse$1.nanosecond=parse$1.ns=1/1e6,parse$1.\u00B5s=parse$1.\u03BCs=parse$1.us=parse$1.microsecond=1/1e3,parse$1.millisecond=parse$1.ms=parse$1[""]=1,parse$1.second=parse$1.sec=parse$1.s=parse$1.ms*1e3,parse$1.minute=parse$1.min=parse$1.m=parse$1.s*60,parse$1.hour=parse$1.hr=parse$1.h=parse$1.m*60,parse$1.day=parse$1.d=parse$1.h*24,parse$1.week=parse$1.wk=parse$1.w=parse$1.d*7,parse$1.month=parse$1.b=parse$1.d*(365.25/12),parse$1.year=parse$1.yr=parse$1.y=parse$1.d*365.25;function parse$1(et="",tt="ms"){var rt=null;et=(et+"").replace(/(\d)[,_](\d)/g,"$1$2");var nt=et[0]==="-";return et.replace(durationRE,function(it,ot,st){st=unitRatio(st),st&&(rt=(rt||0)+Math.abs(parseFloat(ot,10))*st)}),rt&&rt/(unitRatio(tt)||1)*(nt?-1:1)}function unitRatio(et){return parse$1[et]||parse$1[et.toLowerCase().replace(/s$/,"")]}var parseDurationExports=parseDuration$1.exports,errors$8={};let TimeoutError$3=class $n extends Error{constructor(tt="request timed out"){super(tt),this.name="TimeoutError",this.code=$n.code}};TimeoutError$3.code="ERR_TIMEOUT",errors$8.TimeoutError=TimeoutError$3;const TimeoutController=timeoutAbortControllerExports,{anySignal}=anySignalExports,{default:parseDuration}=parseDurationExports,{TimeoutError:TimeoutError$2}=errors$8;function withTimeoutOption$3(et,tt){return(...rt)=>{const nt=rt[tt??rt.length-1];if(!nt||!nt.timeout)return et(...rt);const it=typeof nt.timeout=="string"?parseDuration(nt.timeout):nt.timeout,ot=new TimeoutController(it);nt.signal=anySignal([nt.signal,ot.signal]);const st=et(...rt),at=new Promise((lt,ht)=>{ot.signal.addEventListener("abort",()=>{ht(new TimeoutError$2)})}),ct=Date.now(),ut=()=>{if(ot.signal.aborted)throw new TimeoutError$2;if(Date.now()-ct>it)throw ot.abort(),new TimeoutError$2};return st[Symbol.asyncIterator]?async function*(){const lt=st[Symbol.asyncIterator]();try{for(;;){const{value:ht,done:ft}=await Promise.race([lt.next(),at]);if(ft)break;ut(),yield ht}}catch(ht){throw ut(),ht}finally{ot.clear(),lt.return&&lt.return()}}():(async()=>{try{const lt=await Promise.race([st,at]);return ut(),lt}catch(lt){throw ut(),lt}finally{ot.clear()}})()}}var withTimeoutOption_1=withTimeoutOption$3;const{CID:CID$b}=require$$6$2,errCode$f=errCode$i,IPFS_PREFIX="/ipfs/",toCidAndPath$1=et=>{if(et instanceof Uint8Array)try{et=CID$b.decode(et)}catch(it){throw errCode$f(it,"ERR_INVALID_CID")}if(et instanceof CID$b)return{cid:et,path:void 0};et.startsWith(IPFS_PREFIX)&&(et=et.substring(IPFS_PREFIX.length));const tt=et.split("/");let rt,nt;try{rt=CID$b.parse(tt.shift()||"")}catch(it){throw errCode$f(it,"ERR_INVALID_CID")}return tt.length&&(nt=`/${tt.join("/")}`),{cid:rt,path:nt}};var toCidAndPath_1=toCidAndPath$1;const isIpfs=src$d,{CID:CID$a}=require$$6$2,Key$c=src$a.Key,errCode$e=errCode$i,withTimeoutOption$2=withTimeoutOption_1,toCidAndPath=toCidAndPath_1,dagPb$6=require$$5,ERR_BAD_PATH="ERR_BAD_PATH",normalizePath=et=>{if(et instanceof CID$a)return`/ipfs/${et}`;try{CID$a.parse(et),et=`/ipfs/${et}`}catch{}if(isIpfs.path(et))return et;throw errCode$e(new Error(`invalid path: ${et}`),ERR_BAD_PATH)},normalizeCidPath=et=>et instanceof Uint8Array?CID$a.decode(et).toString():et instanceof CID$a?et.toString():(et.indexOf("/ipfs/")===0&&(et=et.substring(6)),et.charAt(et.length-1)==="/"&&(et=et.substring(0,et.length-1)),et),resolvePath=async function(et,tt,rt,nt={}){const{cid:it,path:ot}=toCidAndPath(rt);ot&&(nt.path=ot);let st=it,at=nt.path||"";if(at.startsWith("/")&&(at=at.substring(1)),nt.path)try{for await(const{value:ct,remainderPath:ut}of resolve$3(it,nt.path,tt,et,{signal:nt.signal})){if(!(ct instanceof CID$a))break;at=ut,st=ct}}catch(ct){throw ct.message.startsWith("Object has no property")&&(ct.message=`no link named "${at.split("/")[0]}" under ${st}`,ct.code="ERR_NO_LINK"),ct}return{cid:st,remainderPath:at||""}},mapFile=(et,tt={})=>{if(et.type!=="file"&&et.type!=="directory"&&et.type!=="raw")throw new Error(`Unknown node type '${et.type}'`);const rt={cid:et.cid,path:et.path,name:et.name,depth:et.path.split("/").length,size:et.size,type:"file"};return et.type==="directory"&&(rt.type="dir"),et.type==="file"&&(rt.size=et.unixfs.fileSize()),(et.type==="file"||et.type==="directory")&&(rt.mode=et.unixfs.mode,et.unixfs.mtime!==void 0&&(rt.mtime=et.unixfs.mtime)),tt.includeContent&&(et.type==="file"||et.type==="raw")&&(rt.content=et.content()),rt},withTimeout=withTimeoutOption$2(async(et,tt)=>await et),resolve$3=async function*(et,tt,rt,nt,it){const ot=async ut=>{const lt=await rt.getCodec(ut.code),ht=await nt.blocks.get(ut,it);return lt.decode(ht)},st=tt.split("/").filter(Boolean);let at=await ot(et),ct=et;for(st.length||(yield{value:at,remainderPath:""});st.length;){const ut=st.shift();if(!ut)throw errCode$e(new Error(`Could not resolve path "${tt}"`),"ERR_INVALID_PATH");if(et.code===dagPb$6.code&&Array.isArray(at.Links)){const lt=at.Links.find(ht=>ht.Name===ut);if(lt){yield{value:lt.Hash,remainderPath:st.join("/")},at=await ot(lt.Hash),ct=lt.Hash;continue}}if(Object.prototype.hasOwnProperty.call(at,ut))at=at[ut],yield{value:at,remainderPath:st.join("/")};else throw errCode$e(new Error(`no link named "${ut}" under ${ct}`),"ERR_NO_LINK");at instanceof CID$a&&(ct=at,at=await ot(at))}};var utils$c={normalizePath,normalizeCidPath,resolvePath,mapFile,withTimeout,resolve:resolve$3,OFFLINE_ERROR:"This command must be run in online mode. Try running 'ipfs daemon' first.",MFS_ROOT_KEY:new Key$c("/local/filesroot"),MFS_MAX_CHUNK_SIZE:262144,MFS_MAX_LINKS:174},hashlru$1=function(et){if(!et)throw Error("hashlru must have a max value, of type number, greater than 0");var tt=0,rt=Object.create(null),nt=Object.create(null);function it(ot,st){rt[ot]=st,tt++,tt>=et&&(tt=0,nt=rt,rt=Object.create(null))}return{has:function(ot){return rt[ot]!==void 0||nt[ot]!==void 0},remove:function(ot){rt[ot]!==void 0&&(rt[ot]=void 0),nt[ot]!==void 0&&(nt[ot]=void 0)},get:function(ot){var st=rt[ot];if(st!==void 0)return st;if((st=nt[ot])!==void 0)return it(ot,st),st},set:function(ot,st){rt[ot]!==void 0?rt[ot]=st:it(ot,st)},clear:function(){rt=Object.create(null),nt=Object.create(null)}}};const hashlru=hashlru$1;let TLRU$1=class{constructor(et){this.lru=hashlru(et)}get(et){const tt=this.lru.get(et);if(tt){if(tt.expire&&tt.expire<Date.now()){this.lru.remove(et);return}return tt.value}}set(et,tt,rt){this.lru.set(et,{value:tt,expire:Date.now()+rt})}has(et){return!!this.get(et)}remove(et){this.lru.remove(et)}clear(){this.lru.clear()}};var tlru=TLRU$1,dist$1={},eventemitter3={exports:{}};(function(et){var tt=Object.prototype.hasOwnProperty,rt="~";function nt(){}Object.create&&(nt.prototype=Object.create(null),new nt().__proto__||(rt=!1));function it(ct,ut,lt){this.fn=ct,this.context=ut,this.once=lt||!1}function ot(ct,ut,lt,ht,ft){if(typeof lt!="function")throw new TypeError("The listener must be a function");var dt=new it(lt,ht||ct,ft),pt=rt?rt+ut:ut;return ct._events[pt]?ct._events[pt].fn?ct._events[pt]=[ct._events[pt],dt]:ct._events[pt].push(dt):(ct._events[pt]=dt,ct._eventsCount++),ct}function st(ct,ut){--ct._eventsCount===0?ct._events=new nt:delete ct._events[ut]}function at(){this._events=new nt,this._eventsCount=0}at.prototype.eventNames=function(){var ct=[],ut,lt;if(this._eventsCount===0)return ct;for(lt in ut=this._events)tt.call(ut,lt)&&ct.push(rt?lt.slice(1):lt);return Object.getOwnPropertySymbols?ct.concat(Object.getOwnPropertySymbols(ut)):ct},at.prototype.listeners=function(ct){var ut=rt?rt+ct:ct,lt=this._events[ut];if(!lt)return[];if(lt.fn)return[lt.fn];for(var ht=0,ft=lt.length,dt=new Array(ft);ht<ft;ht++)dt[ht]=lt[ht].fn;return dt},at.prototype.listenerCount=function(ct){var ut=rt?rt+ct:ct,lt=this._events[ut];return lt?lt.fn?1:lt.length:0},at.prototype.emit=function(ct,ut,lt,ht,ft,dt){var pt=rt?rt+ct:ct;if(!this._events[pt])return!1;var gt=this._events[pt],_t=arguments.length,mt,At;if(gt.fn){switch(gt.once&&this.removeListener(ct,gt.fn,void 0,!0),_t){case 1:return gt.fn.call(gt.context),!0;case 2:return gt.fn.call(gt.context,ut),!0;case 3:return gt.fn.call(gt.context,ut,lt),!0;case 4:return gt.fn.call(gt.context,ut,lt,ht),!0;case 5:return gt.fn.call(gt.context,ut,lt,ht,ft),!0;case 6:return gt.fn.call(gt.context,ut,lt,ht,ft,dt),!0}for(At=1,mt=new Array(_t-1);At<_t;At++)mt[At-1]=arguments[At];gt.fn.apply(gt.context,mt)}else{var It=gt.length,Mt;for(At=0;At<It;At++)switch(gt[At].once&&this.removeListener(ct,gt[At].fn,void 0,!0),_t){case 1:gt[At].fn.call(gt[At].context);break;case 2:gt[At].fn.call(gt[At].context,ut);break;case 3:gt[At].fn.call(gt[At].context,ut,lt);break;case 4:gt[At].fn.call(gt[At].context,ut,lt,ht);break;default:if(!mt)for(Mt=1,mt=new Array(_t-1);Mt<_t;Mt++)mt[Mt-1]=arguments[Mt];gt[At].fn.apply(gt[At].context,mt)}}return!0},at.prototype.on=function(ct,ut,lt){return ot(this,ct,ut,lt,!1)},at.prototype.once=function(ct,ut,lt){return ot(this,ct,ut,lt,!0)},at.prototype.removeListener=function(ct,ut,lt,ht){var ft=rt?rt+ct:ct;if(!this._events[ft])return this;if(!ut)return st(this,ft),this;var dt=this._events[ft];if(dt.fn)dt.fn===ut&&(!ht||dt.once)&&(!lt||dt.context===lt)&&st(this,ft);else{for(var pt=0,gt=[],_t=dt.length;pt<_t;pt++)(dt[pt].fn!==ut||ht&&!dt[pt].once||lt&&dt[pt].context!==lt)&&gt.push(dt[pt]);gt.length?this._events[ft]=gt.length===1?gt[0]:gt:st(this,ft)}return this},at.prototype.removeAllListeners=function(ct){var ut;return ct?(ut=rt?rt+ct:ct,this._events[ut]&&st(this,ut)):(this._events=new nt,this._eventsCount=0),this},at.prototype.off=at.prototype.removeListener,at.prototype.addListener=at.prototype.on,at.prefixed=rt,at.EventEmitter=at,et.exports=at})(eventemitter3);var eventemitter3Exports=eventemitter3.exports,pTimeout$1={exports:{}},pFinally$1=(et,tt)=>(tt=tt||(()=>{}),et.then(rt=>new Promise(nt=>{nt(tt())}).then(()=>rt),rt=>new Promise(nt=>{nt(tt())}).then(()=>{throw rt})));const pFinally=pFinally$1;let TimeoutError$1=class extends Error{constructor(et){super(et),this.name="TimeoutError"}};const pTimeout=(et,tt,rt)=>new Promise((nt,it)=>{if(typeof tt!="number"||tt<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(tt===1/0){nt(et);return}const ot=setTimeout(()=>{if(typeof rt=="function"){try{nt(rt())}catch(ct){it(ct)}return}const st=typeof rt=="string"?rt:`Promise timed out after ${tt} milliseconds`,at=rt instanceof Error?rt:new TimeoutError$1(st);typeof et.cancel=="function"&&et.cancel(),it(at)},tt);pFinally(et.then(nt,it),()=>{clearTimeout(ot)})});pTimeout$1.exports=pTimeout,pTimeout$1.exports.default=pTimeout,pTimeout$1.exports.TimeoutError=TimeoutError$1;var pTimeoutExports=pTimeout$1.exports,priorityQueue={},lowerBound$1={};Object.defineProperty(lowerBound$1,"__esModule",{value:!0});function lowerBound(et,tt,rt){let nt=0,it=et.length;for(;it>0;){const ot=it/2|0;let st=nt+ot;rt(et[st],tt)<=0?(nt=++st,it-=ot+1):it=ot}return nt}lowerBound$1.default=lowerBound,Object.defineProperty(priorityQueue,"__esModule",{value:!0});const lower_bound_1=lowerBound$1;class PriorityQueue{constructor(){this._queue=[]}enqueue(tt,rt){rt=Object.assign({priority:0},rt);const nt={priority:rt.priority,run:tt};if(this.size&&this._queue[this.size-1].priority>=rt.priority){this._queue.push(nt);return}const it=lower_bound_1.default(this._queue,nt,(ot,st)=>st.priority-ot.priority);this._queue.splice(it,0,nt)}dequeue(){const tt=this._queue.shift();return tt==null?void 0:tt.run}filter(tt){return this._queue.filter(rt=>rt.priority===tt.priority).map(rt=>rt.run)}get size(){return this._queue.length}}priorityQueue.default=PriorityQueue,Object.defineProperty(dist$1,"__esModule",{value:!0});const EventEmitter$5=eventemitter3Exports,p_timeout_1=pTimeoutExports,priority_queue_1=priorityQueue,empty=()=>{},timeoutError=new p_timeout_1.TimeoutError;let PQueue$2=class extends EventEmitter$5{constructor(et){var tt,rt,nt,it;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=empty,this._resolveIdle=empty,et=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:priority_queue_1.default},et),!(typeof et.intervalCap=="number"&&et.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(rt=(tt=et.intervalCap)===null||tt===void 0?void 0:tt.toString())!==null&&rt!==void 0?rt:""}\` (${typeof et.intervalCap})`);if(et.interval===void 0||!(Number.isFinite(et.interval)&&et.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(it=(nt=et.interval)===null||nt===void 0?void 0:nt.toString())!==null&&it!==void 0?it:""}\` (${typeof et.interval})`);this._carryoverConcurrencyCount=et.carryoverConcurrencyCount,this._isIntervalIgnored=et.intervalCap===1/0||et.interval===0,this._intervalCap=et.intervalCap,this._interval=et.interval,this._queue=new et.queueClass,this._queueClass=et.queueClass,this.concurrency=et.concurrency,this._timeout=et.timeout,this._throwOnTimeout=et.throwOnTimeout===!0,this._isPaused=et.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=empty,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=empty,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const et=Date.now();if(this._intervalId===void 0){const tt=this._intervalEnd-et;if(tt<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},tt)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const et=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const tt=this._queue.dequeue();return tt?(this.emit("active"),tt(),et&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(et){if(!(typeof et=="number"&&et>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${et}\` (${typeof et})`);this._concurrency=et,this._processQueue()}async add(et,tt={}){return new Promise((rt,nt)=>{const it=async()=>{this._pendingCount++,this._intervalCount++;try{const ot=this._timeout===void 0&&tt.timeout===void 0?et():p_timeout_1.default(Promise.resolve(et()),tt.timeout===void 0?this._timeout:tt.timeout,()=>{(tt.throwOnTimeout===void 0?this._throwOnTimeout:tt.throwOnTimeout)&&nt(timeoutError)});rt(await ot)}catch(ot){nt(ot)}this._next()};this._queue.enqueue(it,tt),this._tryToStartAnother(),this.emit("add")})}async addAll(et,tt){return Promise.all(et.map(async rt=>this.add(rt,tt)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(et=>{const tt=this._resolveEmpty;this._resolveEmpty=()=>{tt(),et()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(et=>{const tt=this._resolveIdle;this._resolveIdle=()=>{tt(),et()}})}get size(){return this._queue.size}sizeBy(et){return this._queue.filter(et).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(et){this._timeout=et}};dist$1.default=PQueue$2;const TLRU=tlru,{default:PQueue$1}=dist$1;new TLRU(1e3),new PQueue$1({concurrency:4});var justSafeGet=get$1;function get$1(et,tt,rt){if(!et)return rt;var nt,it;if(Array.isArray(tt)&&(nt=tt.slice(0)),typeof tt=="string"&&(nt=tt.split(".")),typeof tt=="symbol"&&(nt=[tt]),!Array.isArray(nt))throw new Error("props arg must be an array, a string or a symbol");for(;nt.length;)if(it=nt.shift(),!et||(et=et[it],et===void 0))return rt;return et}const length$3=async et=>{let tt=0;for await(const rt of et)tt++;return tt};var itLength=length$3;const require$$9$1=getAugmentedNamespace(raw$6),{CID:CID$9}=require$$6$2,Key$b=src$a.Key,log$d=browserExports("ipfs:repo:migrator:migration-8"),length$2=itLength,{base32:base32$4}=require$$4$1,raw$5=require$$9$1,mhd$1=require$$6$1;function unwrap$1(et){return et.child?unwrap$1(et.child):et}function keyToMultihash$2(et){try{const tt=base32$4.decode(`b${et.toString().toLowerCase().slice(1)}`);let rt=CID$9.decode(tt).multihash.bytes;const nt=base32$4.encode(rt).slice(1).toUpperCase();return new Key$b(`/${nt}`,!1)}catch{return et}}function keyToCid$1(et){try{const tt=base32$4.decode(`b${et.toString().toLowerCase().slice(1)}`),rt=mhd$1.decode(tt),nt=base32$4.encode(CID$9.createV1(raw$5.code,rt).bytes).slice(1);return new Key$b(`/${nt.toUpperCase()}`,!1)}catch{return et}}async function process$3(et,tt,rt){const nt=et.blocks;await nt.open();const it=unwrap$1(nt);let ot;ot=await length$2(it.queryKeys({filters:[st=>rt(st).toString()!==st.toString()]}));try{let st=0;for await(const at of it.query({})){const ct=rt(at.key);ct.toString()!==at.key.toString()&&(st+=1,log$d(`Migrating Block from ${at.key} to ${ct}`,await it.has(at.key)),await it.delete(at.key),await it.put(ct,at.value),tt(st/ot*100,`Migrated Block from ${at.key} to ${ct}`))}}finally{await nt.close()}}var migration8={version:8,description:"Transforms key names into base32 encoding and converts Block store to use bare multihashes encoded as base32",migrate:(et,tt=()=>{})=>process$3(et,tt,keyToMultihash$2),revert:(et,tt=()=>{})=>process$3(et,tt,keyToCid$1)};const require$$12=getAugmentedNamespace(cborg$2);var $protobuf$6=minimal,$Reader$6=$protobuf$6.Reader,$Writer$6=$protobuf$6.Writer;$protobuf$6.util;var $root$6=$protobuf$6.roots.default||($protobuf$6.roots.default={});$root$6.ipfs=function(){var et={};return et.pin=function(){var tt={};return tt.Set=function(){function rt(nt){if(nt)for(var it=Object.keys(nt),ot=0;ot<it.length;++ot)nt[it[ot]]!=null&&(this[it[ot]]=nt[it[ot]])}return rt.prototype.version=0,rt.prototype.fanout=0,rt.prototype.seed=0,rt.encode=function(nt,it){return it||(it=$Writer$6.create()),nt.version!=null&&Object.hasOwnProperty.call(nt,"version")&&it.uint32(8).uint32(nt.version),nt.fanout!=null&&Object.hasOwnProperty.call(nt,"fanout")&&it.uint32(16).uint32(nt.fanout),nt.seed!=null&&Object.hasOwnProperty.call(nt,"seed")&&it.uint32(29).fixed32(nt.seed),it},rt.decode=function(nt,it){nt instanceof $Reader$6||(nt=$Reader$6.create(nt));for(var ot=it===void 0?nt.len:nt.pos+it,st=new $root$6.ipfs.pin.Set;nt.pos<ot;){var at=nt.uint32();switch(at>>>3){case 1:st.version=nt.uint32();break;case 2:st.fanout=nt.uint32();break;case 3:st.seed=nt.fixed32();break;default:nt.skipType(at&7);break}}return st},rt.fromObject=function(nt){if(nt instanceof $root$6.ipfs.pin.Set)return nt;var it=new $root$6.ipfs.pin.Set;return nt.version!=null&&(it.version=nt.version>>>0),nt.fanout!=null&&(it.fanout=nt.fanout>>>0),nt.seed!=null&&(it.seed=nt.seed>>>0),it},rt.toObject=function(nt,it){it||(it={});var ot={};return it.defaults&&(ot.version=0,ot.fanout=0,ot.seed=0),nt.version!=null&&nt.hasOwnProperty("version")&&(ot.version=nt.version),nt.fanout!=null&&nt.hasOwnProperty("fanout")&&(ot.fanout=nt.fanout),nt.seed!=null&&nt.hasOwnProperty("seed")&&(ot.seed=nt.seed),ot},rt.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf$6.util.toJSONOptions)},rt}(),tt}(),et}();var pin=$root$6,fnv1a$1={exports:{}};(function(et,tt){Object.defineProperty(tt,"__esModule",{value:!0}),rt.BASE=2166136261;function rt(nt,it=rt.BASE){const ot=nt.length;for(let st=0;st<ot;st++)it^=nt.charCodeAt(st),it+=(it<<1)+(it<<4)+(it<<7)+(it<<8)+(it<<24);return it>>>0}tt.default=rt,et.exports=rt})(fnv1a$1,fnv1a$1.exports);var fnv1aExports=fnv1a$1.exports;const require$$9=getAugmentedNamespace(src$h),{Key:Key$a}=src$a,{base32:base32$3}=require$$4$1,{CID:CID$8}=require$$9,PIN_DS_KEY$1=new Key$a("/local/pins"),DEFAULT_FANOUT$1=256,MAX_ITEMS$1=8192,EMPTY_KEY$1=CID$8.parse("QmdfTbBqBPQ7VNxZEYEj14VmRuZBkqFbiwReogJgS1zR1n"),PinTypes$4={direct:"direct",recursive:"recursive"};function cidToKey$3(et){return new Key$a(`/${base32$3.encode(et.multihash.bytes).toUpperCase().substring(1)}`)}var utils$b={PIN_DS_KEY:PIN_DS_KEY$1,DEFAULT_FANOUT:DEFAULT_FANOUT$1,MAX_ITEMS:MAX_ITEMS$1,EMPTY_KEY:EMPTY_KEY$1,PinTypes:PinTypes$4,cidToKey:cidToKey$3};function concat$1(et,tt){tt||(tt=et.reduce((it,ot)=>it+ot.length,0));const rt=new Uint8Array(tt);let nt=0;for(const it of et)rt.set(it,nt),nt+=it.length;return rt}var concat_1=concat$1;function compare(et,tt){for(let rt=0;rt<et.byteLength;rt++){if(et[rt]<tt[rt])return-1;if(et[rt]>tt[rt])return 1}return et.byteLength>tt.byteLength?1:et.byteLength<tt.byteLength?-1:0}var compare_1=compare;const{bases:bases$7}=require$$8;function createCodec$3(et,tt,rt,nt){return{name:et,prefix:tt,encoder:{name:et,prefix:tt,encode:rt},decoder:{decode:nt}}}const string$3=createCodec$3("utf8","u",et=>"u"+new TextDecoder("utf8").decode(et),et=>new TextEncoder().encode(et.substring(1))),ascii$3=createCodec$3("ascii","a",et=>{let tt="a";for(let rt=0;rt<et.length;rt++)tt+=String.fromCharCode(et[rt]);return tt},et=>{et=et.substring(1);const tt=new Uint8Array(et.length);for(let rt=0;rt<et.length;rt++)tt[rt]=et.charCodeAt(rt);return tt}),BASES$1={utf8:string$3,"utf-8":string$3,hex:bases$7.base16,latin1:ascii$3,ascii:ascii$3,binary:ascii$3,...bases$7};var bases_1$1=BASES$1;const bases$6=bases_1$1;function toString$3(et,tt="utf8"){const rt=bases$6[tt];if(!rt)throw new Error(`Unsupported encoding "${tt}"`);return rt.encoder.encode(et).substring(1)}var toString_1$1=toString$3;const bases$5=bases_1$1;function fromString$4(et,tt="utf8"){const rt=bases$5[tt];if(!rt)throw new Error(`Unsupported encoding "${tt}"`);return rt.decoder.decode(`${rt.prefix}${et}`)}var fromString_1$1=fromString$4;const{CID:CID$7}=require$$6$2,{ipfs:{pin:{Set:PinSet}}}=pin,fnv1a=fnv1aExports,varint$3=varint$7,dagPb$5=require$$5,{DEFAULT_FANOUT,MAX_ITEMS,EMPTY_KEY}=utils$b,uint8ArrayConcat$3=concat_1,uint8ArrayCompare=compare_1,uint8ArrayToString$e=toString_1$1,uint8ArrayFromString$e=fromString_1$1,{sha256:sha256$6}=require$$1$4;function readHeader(et){const tt=et.Data;if(!tt)throw new Error("No data present");const rt=varint$3.decode(tt),nt=varint$3.decode.bytes;if(nt<=0)throw new Error("Invalid Set header length");if(nt+rt>tt.length)throw new Error("Impossibly large set header length");const it=tt.slice(nt,rt+nt),ot=PinSet.toObject(PinSet.decode(it),{defaults:!1,arrays:!0,longs:Number,objects:!1});if(ot.version!==1)throw new Error(`Unsupported Set version: ${ot.version}`);if(ot.fanout>et.Links.length)throw new Error("Impossibly large fanout");return{header:ot,data:tt.slice(rt+nt)}}function hash$1(et,tt){const rt=new Uint8Array(4);new DataView(rt.buffer).setUint32(0,et,!0);const nt=uint8ArrayFromString$e(tt.toString()),it=uint8ArrayConcat$3([rt,nt],rt.byteLength+nt.byteLength);return fnv1a(uint8ArrayToString$e(it))}async function*walkItems(et,tt){const rt=readHeader(tt);let nt=0;for(const it of tt.Links){if(nt<rt.header.fanout){const ot=it.Hash;if(!EMPTY_KEY.equals(ot)){const st=await et.get(ot),at=dagPb$5.decode(st);yield*walkItems(et,at)}}else yield it.Hash;nt++}}async function*loadSet(et,tt,rt){const nt=tt.Links.find(st=>st.Name===rt);if(!nt)throw new Error("No link found with name "+rt);const it=await et.get(nt.Hash),ot=dagPb$5.decode(it);yield*walkItems(et,ot)}function storeItems(et,tt){return rt(tt,0);async function rt(nt,it){const ot=PinSet.encode({version:1,fanout:DEFAULT_FANOUT,seed:it}).finish(),st=varint$3.encode(ot.length),at=uint8ArrayConcat$3([st,ot]),ct=[];for(let lt=0;lt<DEFAULT_FANOUT;lt++)ct.push({Name:"",Tsize:1,Hash:EMPTY_KEY});if(nt.length<=MAX_ITEMS){const lt=nt.map(ft=>({link:{Name:"",Tsize:1,Hash:ft.key},data:ft.data||new Uint8Array})).sort((ft,dt)=>uint8ArrayCompare(ft.link.Hash.bytes,dt.link.Hash.bytes)),ht=ct.concat(lt.map(ft=>ft.link));return{Data:uint8ArrayConcat$3([at,...lt.map(ft=>ft.data)]),Links:ht}}else{const lt=nt.reduce((ft,dt)=>{const pt=hash$1(it,dt.key)%DEFAULT_FANOUT;return ft[pt]=pt in ft?ft[pt].concat([dt]):[dt],ft},[]);let ht=0;for(const ft of lt){const dt=await rt(ft,it+1);await ut(dt,ht),ht++}return{Data:at,Links:ct}}async function ut(lt,ht){const ft=dagPb$5.encode(lt),dt=await sha256$6.digest(ft),pt=CID$7.createV0(dt);await et.put(pt,ft);let gt=lt.Links.reduce((_t,mt)=>_t+(mt.Tsize||0),0)+ft.length;ct[ht]={Name:"",Tsize:gt,Hash:pt}}}}async function storeSet(et,tt,rt){const nt=await storeItems(et,rt.map(ct=>({key:ct}))),it=dagPb$5.encode(nt),ot=await sha256$6.digest(it),st=CID$7.createV0(ot);await et.put(st,it);let at=nt.Links.reduce((ct,ut)=>ct+ut.Tsize,0)+it.length;return{Name:tt,Tsize:at,Hash:st}}var pinSet={loadSet,storeSet};const{CID:CID$6}=require$$6$2,dagPb$4=require$$5,cbor=require$$12,pinset=pinSet,{cidToKey:cidToKey$2,PIN_DS_KEY,PinTypes:PinTypes$3}=utils$b,length$1=itLength,{sha256:sha256$5}=require$$1$4,mhd=require$$6$1,{base32:base32$2}=require$$4$1;async function pinsToDatastore(et,tt,rt,nt){if(!await tt.has(PIN_DS_KEY))return;const it=await tt.get(PIN_DS_KEY),ot=CID$6.decode(it),st=await et.get(ot),at=dagPb$4.decode(st);let ct=0,ut;ut=await length$1(pinset.loadSet(et,at,PinTypes$3.recursive))+await length$1(pinset.loadSet(et,at,PinTypes$3.direct));for await(const lt of pinset.loadSet(et,at,PinTypes$3.recursive)){ct++;const ht={depth:1/0};lt.version!==0&&(ht.version=lt.version),lt.code!==dagPb$4.code&&(ht.codec=lt.code),await rt.put(cidToKey$2(lt),cbor.encode(ht)),nt(ct/ut*100,`Migrated recursive pin ${lt}`)}for await(const lt of pinset.loadSet(et,at,PinTypes$3.direct)){ct++;const ht={depth:0};lt.version!==0&&(ht.version=lt.version),lt.code!==dagPb$4.code&&(ht.codec=lt.code),await rt.put(cidToKey$2(lt),cbor.encode(ht)),nt(ct/ut*100,`Migrated direct pin ${lt}`)}await et.delete(ot),await tt.delete(PIN_DS_KEY)}async function pinsToDAG(et,tt,rt,nt){let it=[],ot=[],st=0;const at=await length$1(rt.queryKeys({}));for await(const{key:ft,value:dt}of rt.query({})){st++;const pt=cbor.decode(dt),gt=CID$6.create(pt.version||0,pt.codec||dagPb$4.code,mhd.decode(base32$2.decode("b"+ft.toString().toLowerCase().split("/").pop())));pt.depth===0?(nt(st/at*100,`Reverted direct pin ${gt}`),ot.push(gt)):(nt(st/at*100,`Reverted recursive pin ${gt}`),it.push(gt))}nt(100,"Updating pin root");const ct={Links:[await pinset.storeSet(et,PinTypes$3.direct,ot),await pinset.storeSet(et,PinTypes$3.recursive,it)]},ut=dagPb$4.encode(ct),lt=await sha256$5.digest(ut),ht=CID$6.createV0(lt);await et.put(ht,ut),await tt.put(PIN_DS_KEY,ht.bytes)}async function process$2(et,tt,rt){const nt=et.blocks,it=et.datastore,ot=et.pins;await nt.open(),await it.open(),await ot.open();try{await rt(nt,it,ot,tt)}finally{await ot.close(),await it.close(),await nt.close()}}var migration9={version:9,description:"Migrates pins to datastore",migrate:(et,tt=()=>{})=>process$2(et,tt,pinsToDatastore),revert:(et,tt=()=>{})=>process$2(et,tt,pinsToDAG)};const{Key:Key$9,Errors:Errors$3}=src$a,CONFIG_KEY$1=new Key$9("/config"),VERSION_KEY$2=new Key$9("/version");function findLevelJs$1(et){let tt=et;for(;tt.db||tt.child;)if(tt=tt.db||tt.child,tt.type==="level-js"||tt.constructor.name==="Level")return tt}async function hasWithFallback$2(et,tt,rt){const nt=await tt(et);if(nt)return nt;const it=findLevelJs$1(rt);return it?new Promise((ot,st)=>{const at=it.store("readonly").get(et.toString());at.transaction.onabort=()=>{st(at.transaction.error)},at.transaction.oncomplete=()=>{ot(!!at.result)}}):!1}async function getWithFallback$2(et,tt,rt,nt){if(await rt(et))return tt(et);const it=findLevelJs$1(nt);if(!it)throw Errors$3.notFoundError();return new Promise((ot,st)=>{const at=it.store("readonly").get(et.toString());at.transaction.onabort=()=>{st(at.transaction.error)},at.transaction.oncomplete=()=>{if(at.result)return ot(at.result);st(Errors$3.notFoundError())}})}function wrapStore(et){const tt=et.get.bind(et),rt=et.has.bind(et);return et.get=nt=>getWithFallback$2(nt,tt,rt,et),et.has=nt=>hasWithFallback$2(nt,rt,et),et}function wrapBackends$1(et){return{...et,root:wrapStore(et.root),datastore:wrapStore(et.datastore),pins:wrapStore(et.pins),keys:wrapStore(et.keys)}}var utils$a={wrapBackends:wrapBackends$1,hasWithFallback:hasWithFallback$2,getWithFallback:getWithFallback$2,findLevelJs:findLevelJs$1,CONFIG_KEY:CONFIG_KEY$1,VERSION_KEY:VERSION_KEY$2};const{findLevelJs}=utils$a,fromString$3=fromString_1$1,toString$2=toString_1$1;async function keysToBinary(et,tt,rt=()=>{}){let nt=findLevelJs(tt);if(!nt){rt(`${et} did not need an upgrade`);return}rt(`Upgrading ${et}`),await withEach(nt,(it,ot)=>[{type:"del",key:it},{type:"put",key:fromString$3(it),value:ot}])}async function keysToStrings(et,tt,rt=()=>{}){let nt=findLevelJs(tt);if(!nt){rt(`${et} did not need a downgrade`);return}rt(`Downgrading ${et}`),await withEach(nt,(it,ot)=>[{type:"del",key:it},{type:"put",key:toString$2(it),value:ot}])}function unwrap(et){return et.child?unwrap(et.child):et}async function process$1(et,tt,rt){const nt=Object.entries(et).map(([ot,st])=>({key:ot,backend:unwrap(st)})).filter(({key:ot,backend:st})=>st.constructor.name==="LevelDatastore").map(({key:ot,backend:st})=>({name:ot,store:st}));tt(0,`Migrating ${nt.length} dbs`);let it=0;for(const{name:ot,store:st}of nt){await st.open();try{await rt(ot,st,at=>{tt(Math.round(it/nt.length*100),at)})}finally{it++,st.close()}}tt(100,`Migrated ${nt.length} dbs`)}var migration10={version:10,description:"Migrates datastore-level keys to binary",migrate:(et,tt=()=>{})=>process$1(et,tt,keysToBinary),revert:(et,tt=()=>{})=>process$1(et,tt,keysToStrings)};function withEach(et,tt){function rt(nt,it){const ot=et.store("readwrite"),st=ot.transaction;let at=0,ct;st.onabort=()=>it(ct||st.error||new Error("aborted by user")),st.oncomplete=()=>it();function ut(){var lt=nt[at++],ht=lt.key;try{var ft=lt.type==="del"?ot.delete(ht):ot.put(lt.value,ht)}catch(dt){ct=dt,st.abort();return}at<nt.length&&(ft.onsuccess=ut)}ut()}return new Promise((nt,it)=>{const ot=et.iterator(),st=ct=>ct;ot._deserializeKey=ot._deserializeValue=st,at();function at(){const ct=(ut,lt,ht)=>{if(ut||lt===void 0){const ft=dt=>{if(dt){it(dt);return}nt()};ot.end(ft);return}rt(tt(lt,ht),at)};ot.next(ct)}})}const emptyMigration={description:"Empty migration.",migrate:()=>{},revert:()=>{},empty:!0};var migrations=[Object.assign({version:1},emptyMigration),Object.assign({version:2},emptyMigration),Object.assign({version:3},emptyMigration),Object.assign({version:4},emptyMigration),Object.assign({version:5},emptyMigration),Object.assign({version:6},emptyMigration),Object.assign({version:7},emptyMigration),migration8,migration9,migration10];class NonReversibleMigrationError extends Error{constructor(tt){super(tt),this.name="NonReversibleMigrationError",this.code="ERR_NON_REVERSIBLE_MIGRATION",this.message=tt}}NonReversibleMigrationError.code="ERR_NON_REVERSIBLE_MIGRATION";let NotInitializedRepoError$1=class extends Error{constructor(et){super(et),this.name="NotInitializedRepoError",this.code="ERR_NOT_INITIALIZED_REPO",this.message=et}};NotInitializedRepoError$1.code="ERR_NOT_INITIALIZED_REPO";class RequiredParameterError extends Error{constructor(tt){super(tt),this.name="RequiredParameterError",this.code="ERR_REQUIRED_PARAMETER",this.message=tt}}RequiredParameterError.code="ERR_REQUIRED_PARAMETER";class InvalidValueError extends Error{constructor(tt){super(tt),this.name="InvalidValueError",this.code="ERR_INVALID_VALUE",this.message=tt}}InvalidValueError.code="ERR_INVALID_VALUE";let MissingRepoOptionsError$2=class extends Error{constructor(et){super(et),this.name="MissingRepoOptionsError",this.code="ERR_MISSING_REPO_OPTIONS",this.message=et}};MissingRepoOptionsError$2.code="ERR_MISSING_REPO_OPTIONS";var errors$7={NonReversibleMigrationError,NotInitializedRepoError:NotInitializedRepoError$1,RequiredParameterError,InvalidValueError,MissingRepoOptionsError:MissingRepoOptionsError$2};const log$c=browserExports("ipfs:repo:migrator:repo:init"),{CONFIG_KEY,VERSION_KEY:VERSION_KEY$1}=utils$a,{MissingRepoOptionsError:MissingRepoOptionsError$1}=errors$7;async function isRepoInitialized(et){if(!et)throw new MissingRepoOptionsError$1("Please pass repo options when trying to open a repo");const tt=et.root;try{await tt.open();const rt=await tt.has(VERSION_KEY$1),nt=await tt.has(CONFIG_KEY);return!rt||!nt?(log$c(`Version entry present: ${rt}`),log$c(`Config entry present: ${nt}`),!1):!0}catch(rt){return log$c("While checking if repo is initialized error was thrown: "+rt.message),!1}finally{if(tt!==void 0)try{await tt.close()}catch{}}}var init$1={isRepoInitialized};const repoInit=init$1,{MissingRepoOptionsError,NotInitializedRepoError}=errors$7,{VERSION_KEY}=utils$a,uint8ArrayFromString$d=fromString_1$1,uint8ArrayToString$d=toString_1$1;async function getVersion(et){if(!await repoInit.isRepoInitialized(et))throw new NotInitializedRepoError("Repo is not initialized!");const tt=et.root;await tt.open();try{return parseInt(uint8ArrayToString$d(await tt.get(VERSION_KEY)))}finally{await tt.close()}}async function setVersion(et,tt){if(!tt)throw new MissingRepoOptionsError("Please pass repo options when trying to open a repo");const rt=tt.root;await rt.open(),await rt.put(VERSION_KEY,uint8ArrayFromString$d(String(et))),await rt.close()}var version$2={getVersion,setVersion};const defaultMigrations=migrations,repoVersion=version$2,errors$6=errors$7,{wrapBackends}=utils$a,log$b=browserExports("ipfs:repo:migrator");function getLatestMigrationVersion(et){return et=et||defaultMigrations,!Array.isArray(et)||et.length===0?0:et[et.length-1].version}async function migrate(et,tt,rt,nt,{ignoreLock:it=!1,onProgress:ot,isDryRun:st=!1,migrations:at}){if(at=at||defaultMigrations,!et)throw new errors$6.RequiredParameterError("Path argument is required!");if(!rt)throw new errors$6.RequiredParameterError("repoOptions argument is required!");if(!nt)throw new errors$6.RequiredParameterError("toVersion argument is required!");if(!Number.isInteger(nt)||nt<=0)throw new errors$6.InvalidValueError("Version has to be positive integer!");tt=wrapBackends(tt);const ct=await repoVersion.getVersion(tt);if(ct===nt){log$b("Nothing to migrate.");return}if(ct>nt)throw new errors$6.InvalidValueError(`Current repo's version (${ct}) is higher then toVersion (${nt}), you probably wanted to revert it?`);verifyAvailableMigrations(at,ct,nt);let ut;!st&&!it&&(ut=await rt.repoLock.lock(et));try{for(const lt of at){if(nt!==void 0&&lt.version>nt)break;if(!(lt.version<=ct)){log$b(`Migrating version ${lt.version}`);try{if(!st){let ht=()=>{};ot&&(ht=(ft,dt)=>ot(lt.version,ft.toFixed(2),dt)),await lt.migrate(tt,ht)}}catch(ht){const ft=lt.version-1;throw log$b(`An exception was raised during execution of migration. Setting the repo's version to last successfully migrated version: ${ft}`),await repoVersion.setVersion(ft,tt),new Error(`During migration to version ${lt.version} exception was raised: ${ht.stack||ht.message||ht}`)}log$b(`Migrating to version ${lt.version} finished`)}}st||await repoVersion.setVersion(nt||getLatestMigrationVersion(at),tt),log$b("Repo successfully migrated",nt!==void 0?`to version ${nt}!`:"to latest version!")}finally{!st&&!it&&ut&&await ut.close()}}async function revert(et,tt,rt,nt,{ignoreLock:it=!1,onProgress:ot,isDryRun:st=!1,migrations:at}){if(at=at||defaultMigrations,!et)throw new errors$6.RequiredParameterError("Path argument is required!");if(!rt)throw new errors$6.RequiredParameterError("repoOptions argument is required!");if(!nt)throw new errors$6.RequiredParameterError("When reverting migrations, you have to specify to which version to revert!");if(!Number.isInteger(nt)||nt<=0)throw new errors$6.InvalidValueError("Version has to be positive integer!");tt=wrapBackends(tt);const ct=await repoVersion.getVersion(tt);if(ct===nt){log$b("Nothing to revert.");return}if(ct<nt)throw new errors$6.InvalidValueError(`Current repo's version (${ct}) is lower then toVersion (${nt}), you probably wanted to migrate it?`);verifyAvailableMigrations(at,nt,ct,!0);let ut;!st&&!it&&(ut=await rt.repoLock.lock(et)),log$b(`Reverting from version ${ct} to ${nt}`);try{const lt=at.slice().reverse();for(const ht of lt){if(ht.version<=nt)break;if(!(ht.version>ct)){log$b(`Reverting migration version ${ht.version}`);try{if(!st){let ft=()=>{};ot&&(ft=(dt,pt)=>ot(ht.version,dt.toFixed(2),pt)),await ht.revert(tt,ft)}}catch(ft){const dt=ht.version;throw log$b(`An exception was raised during execution of migration. Setting the repo's version to last successfully reverted version: ${dt}`),await repoVersion.setVersion(dt,tt),ft.message=`During reversion to version ${ht.version} exception was raised: ${ft.message}`,ft}log$b(`Reverting to version ${ht.version} finished`)}}st||await repoVersion.setVersion(nt,tt),log$b(`All migrations successfully reverted to version ${nt}!`)}finally{!st&&!it&&ut&&await ut.close()}}function verifyAvailableMigrations(et,tt,rt,nt=!1){let it=0;for(const ot of et){if(ot.version>rt)break;if(ot.version>tt){if(nt&&!ot.revert)throw new errors$6.NonReversibleMigrationError(`It is not possible to revert to version ${tt} because migration version ${ot.version} is not reversible. Cancelling reversion.`);it++}}if(it!==rt-tt)throw new errors$6.InvalidValueError(`The ipfs-repo-migrations package does not have all migration to migrate from version ${tt} to ${rt}`)}var src$9={getCurrentRepoVersion:repoVersion.getVersion,getLatestMigrationVersion,errors:errors$6,migrate,revert},bytes$2={exports:{}};bytes$2.exports=bytes$1,bytes$2.exports.format=format,bytes$2.exports.parse=parse;var formatThousandsRegExp=/\B(?=(\d{3})+(?!\d))/g,formatDecimalsRegExp=/(?:\.0*|(\.[^0]+)0+)$/,map$3={b:1,kb:1024,mb:1<<20,gb:1<<30,tb:Math.pow(1024,4),pb:Math.pow(1024,5)},parseRegExp=/^((-|\+)?(\d+(?:\.\d+)?)) *(kb|mb|gb|tb|pb)$/i;function bytes$1(et,tt){return typeof et=="string"?parse(et):typeof et=="number"?format(et,tt):null}function format(et,tt){if(!Number.isFinite(et))return null;var rt=Math.abs(et),nt=tt&&tt.thousandsSeparator||"",it=tt&&tt.unitSeparator||"",ot=tt&&tt.decimalPlaces!==void 0?tt.decimalPlaces:2,st=!!(tt&&tt.fixedDecimals),at=tt&&tt.unit||"";(!at||!map$3[at.toLowerCase()])&&(rt>=map$3.pb?at="PB":rt>=map$3.tb?at="TB":rt>=map$3.gb?at="GB":rt>=map$3.mb?at="MB":rt>=map$3.kb?at="KB":at="B");var ct=et/map$3[at.toLowerCase()],ut=ct.toFixed(ot);return st||(ut=ut.replace(formatDecimalsRegExp,"$1")),nt&&(ut=ut.split(".").map(function(lt,ht){return ht===0?lt.replace(formatThousandsRegExp,nt):lt}).join(".")),ut+it+at}function parse(et){if(typeof et=="number"&&!isNaN(et))return et;if(typeof et!="string")return null;var tt=parseRegExp.exec(et),rt,nt="b";return tt?(rt=parseFloat(tt[1]),nt=tt[4].toLowerCase()):(rt=parseInt(et,10),nt="b"),isNaN(rt)?null:Math.floor(map$3[nt]*rt)}var bytesExports=bytes$2.exports,constants$6={repoVersion:10};const Key$8=src$a.Key,debug$g=browserExports,log$a=debug$g("ipfs:repo:version"),{toString:uint8ArrayToString$c}=require$$1$2,{fromString:uint8ArrayFromString$c}=require$$9$2,{hasWithFallback:hasWithFallback$1,getWithFallback:getWithFallback$1}=utils$a,versionKey=new Key$8("version");var version$1=et=>({async exists(){return hasWithFallback$1(versionKey,et.has.bind(et),et)},async get(){const tt=await getWithFallback$1(versionKey,et.get.bind(et),et.has.bind(et),et);return parseInt(uint8ArrayToString$c(tt),10)},set(tt){return et.put(versionKey,uint8ArrayFromString$c(String(tt)))},async check(tt){const rt=await this.get();return log$a("comparing version: %s and %s",rt,tt),rt===tt||rt===6&&tt===7||tt===6&&rt===7}}),justSafeSet=set$1;function set$1(et,tt,rt){var nt,it;if(Array.isArray(tt)&&(nt=tt.slice(0)),typeof tt=="string"&&(nt=tt.split(".")),typeof tt=="symbol"&&(nt=[tt]),!Array.isArray(nt))throw new Error("props arg must be an array, a string or a symbol");if(it=nt.pop(),!it)return!1;prototypeCheck(it);for(var ot;ot=nt.shift();)if(prototypeCheck(ot),typeof et[ot]>"u"&&(et[ot]={}),et=et[ot],!et||typeof et!="object")return!1;return et[it]=rt,!0}function prototypeCheck(et){if(et==="__proto__"||et==="constructor"||et==="prototype")throw new Error("setting of prototype values not supported")}var errors$5={};class LockExistsError extends Error{constructor(tt){super(tt),this.name="LockExistsError",this.code=LockExistsError.code}}LockExistsError.code="ERR_LOCK_EXISTS",errors$5.LockExistsError=LockExistsError;class NotFoundError extends Error{constructor(tt){super(tt),this.name="NotFoundError",this.code=NotFoundError.code}}NotFoundError.code="ERR_NOT_FOUND",errors$5.NotFoundError=NotFoundError;class InvalidRepoVersionError extends Error{constructor(tt){super(tt),this.name="InvalidRepoVersionError",this.code=InvalidRepoVersionError.code}}InvalidRepoVersionError.code="ERR_INVALID_REPO_VERSION",errors$5.InvalidRepoVersionError=InvalidRepoVersionError,errors$5.ERR_REPO_NOT_INITIALIZED="ERR_REPO_NOT_INITIALIZED",errors$5.ERR_REPO_ALREADY_OPEN="ERR_REPO_ALREADY_OPEN",errors$5.ERR_REPO_ALREADY_CLOSED="ERR_REPO_ALREADY_CLOSED";const{Key:Key$7}=src$a,{default:Queue$2}=dist$1,_get$1=justSafeGet,_set=justSafeSet,errCode$d=errCode$i,errors$4=errors$5,{toString:uint8ArrayToString$b}=require$$1$2,{fromString:uint8ArrayFromString$b}=require$$9$2,{hasWithFallback,getWithFallback}=utils$a,configKey=new Key$7("config");var config$2=et=>{const tt=new Queue$2({concurrency:1}),rt={async getAll(ot={}){const st=await getWithFallback(configKey,et.get.bind(et),et.has.bind(et),et,{signal:ot.signal});return JSON.parse(uint8ArrayToString$b(st))},async get(ot,st={}){if(ot==null)throw new errors$4.NotFoundError(`Key ${ot} does not exist in config`);const at=await this.getAll(st),ct=_get$1(at,ot);if(ct===void 0)throw new errors$4.NotFoundError(`Key ${ot} does not exist in config`);return ct},set(ot,st,at={}){if(typeof ot!="string"&&!(ot instanceof String))throw errCode$d(new Error("Invalid key type: "+typeof ot),"ERR_INVALID_KEY");if(st===void 0||st instanceof Uint8Array)throw errCode$d(new Error("Invalid value type: "+typeof st),"ERR_INVALID_VALUE");return tt.add(()=>nt({key:ot,value:st},at.signal))},replace(ot,st={}){if(!ot||ot instanceof Uint8Array)throw errCode$d(new Error("Invalid value type: "+typeof ot),"ERR_INVALID_VALUE");return tt.add(()=>nt({key:void 0,value:ot},st.signal))},async exists(){return hasWithFallback(configKey,et.has.bind(et),et)}};return rt;async function nt(ot,st){if(st&&st.aborted)return;const at=ot.key,ct=ot.value;if(at){const ut=await rt.getAll();return typeof ut=="object"&&ut!==null&&_set(ut,at,ct),it(ut)}return it(ct)}function it(ot){const st=uint8ArrayFromString$b(JSON.stringify(ot,null,2));return et.put(configKey,st)}};const isPlainObject=isPlainObj;var sortKeys$1=(et,tt={})=>{if(!isPlainObject(et)&&!Array.isArray(et))throw new TypeError("Expected a plain object or array");const{deep:rt}=tt,nt=[],it=[],ot=at=>{const ct=nt.indexOf(at);if(ct!==-1)return it[ct];const ut=[];return nt.push(at),it.push(ut),ut.push(...at.map(lt=>Array.isArray(lt)?ot(lt):isPlainObject(lt)?st(lt):lt)),ut},st=at=>{const ct=nt.indexOf(at);if(ct!==-1)return it[ct];const ut={},lt=Object.keys(at).sort(tt.compare);nt.push(at),it.push(ut);for(const ht of lt){const ft=at[ht];let dt;rt&&Array.isArray(ft)?dt=ot(ft):dt=rt&&isPlainObject(ft)?st(ft):ft,Object.defineProperty(ut,ht,{...Object.getOwnPropertyDescriptor(at,ht),value:dt})}return ut};return Array.isArray(et)?rt?ot(et):et.slice():st(et)};const Key$6=src$a.Key,sortKeys=sortKeys$1,{toString:uint8ArrayToString$a}=require$$1$2,{fromString:uint8ArrayFromString$a}=require$$9$2,specKey=new Key$6("datastore_spec");var spec$1=et=>({exists(){return et.has(specKey)},async get(){const tt=await et.get(specKey);return JSON.parse(uint8ArrayToString$a(tt))},async set(tt){return et.put(specKey,uint8ArrayFromString$a(JSON.stringify(sortKeys(tt,{deep:!0}))))}});const Key$5=src$a.Key,{fromString:uint8ArrayFromString$9}=require$$9$2,apiFile=new Key$5("api");var apiAddr$1=et=>({async get(){const tt=await et.get(apiFile);return tt&&tt.toString()},set(tt){return et.put(apiFile,uint8ArrayFromString$9(tt.toString()))},delete(){return et.delete(apiFile)}}),fixedSize=class{constructor(et){if(!(et>0)||et-1&et)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(et),this.mask=et-1,this.top=0,this.btm=0,this.next=null}clear(){this.top=this.btm=0,this.next=null,this.buffer.fill(void 0)}push(et){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=et,this.top=this.top+1&this.mask,!0)}shift(){const et=this.buffer[this.btm];if(et!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,et}peek(){return this.buffer[this.btm]}isEmpty(){return this.buffer[this.btm]===void 0}};const FixedFIFO=fixedSize;var fastFifo=class{constructor(et){this.hwm=et||16,this.head=new FixedFIFO(this.hwm),this.tail=this.head,this.length=0}clear(){this.head=this.tail,this.head.clear(),this.length=0}push(et){if(this.length++,!this.head.push(et)){const tt=this.head;this.head=tt.next=new FixedFIFO(2*this.head.buffer.length),this.head.push(et)}}shift(){this.length!==0&&this.length--;const et=this.tail.shift();if(et===void 0&&this.tail.next){const tt=this.tail.next;return this.tail.next=null,this.tail=tt,this.tail.shift()}return et}peek(){return this.tail.peek()}isEmpty(){return this.head.isEmpty()}};const FIFO=fastFifo;var itPushable=et=>{et=et||{};let tt;typeof et=="function"?(tt=et,et={}):tt=et.onEnd;let rt=new FIFO,nt,it,ot;const st=()=>{if(!rt.isEmpty()){if(et.writev){let gt;const _t=[];for(;!rt.isEmpty();){if(gt=rt.shift(),gt.error)throw gt.error;_t.push(gt.value)}return{done:gt.done,value:_t}}const pt=rt.shift();if(pt.error)throw pt.error;return pt}return ot?{done:!0}:new Promise((pt,gt)=>{it=_t=>(it=null,_t.error?gt(_t.error):et.writev&&!_t.done?pt({done:_t.done,value:[_t.value]}):pt(_t),nt)})},at=pt=>it?it(pt):(rt.push(pt),nt),ct=pt=>(rt=new FIFO,it?it({error:pt}):(rt.push({error:pt}),nt)),ut=pt=>ot?nt:at({done:!1,value:pt}),lt=pt=>ot?nt:(ot=!0,pt?ct(pt):at({done:!0})),ht=()=>(rt=new FIFO,lt(),{done:!0}),ft=pt=>(lt(pt),{done:!0});if(nt={[Symbol.asyncIterator](){return this},next:st,return:ht,throw:ft,push:ut,end:lt},!tt)return nt;const dt=nt;return nt={[Symbol.asyncIterator](){return this},next(){return dt.next()},throw(pt){return dt.throw(pt),tt&&(tt(pt),tt=null),{done:!0}},return(){return dt.return(),tt&&(tt(),tt=null),{done:!0}},push:ut,end(pt){return dt.end(pt),tt&&(tt(pt),tt=null),nt}},nt};const filter$1=itFilter,pushable$2=itPushable,drain=itDrain,{CID:CID$5}=require$$6$2,errCode$c=errCode$i,{identity:identity$4}=require$$7;var idstore=createIdStore;function createIdStore(et){return{open(){return et.open()},close(){return et.close()},query(tt,rt){return et.query(tt,rt)},queryKeys(tt,rt){return et.queryKeys(tt,rt)},async get(tt,rt){const nt=extractContents(tt);return nt.isIdentity?Promise.resolve(nt.digest):et.get(tt,rt)},async*getMany(tt,rt){for await(const nt of tt)yield this.get(nt,rt)},async put(tt,rt,nt){const{isIdentity:it}=extractContents(tt);it||await et.put(tt,rt,nt)},async*putMany(tt,rt){const nt=pushable$2();(process&&process.nextTick?process.nextTick:setImmediate)(async()=>{try{await drain(et.putMany(async function*(){for await(const{key:it,value:ot}of tt)extractContents(it).isIdentity||(yield{key:it,value:ot}),nt.push({key:it,value:ot})}())),nt.end()}catch(it){nt.end(it)}}),yield*nt},has(tt,rt){const{isIdentity:nt}=extractContents(tt);return nt?Promise.resolve(!0):et.has(tt,rt)},delete(tt,rt){const{isIdentity:nt}=extractContents(tt);return nt?Promise.resolve():et.delete(tt,rt)},deleteMany(tt,rt){return et.deleteMany(filter$1(tt,nt=>!extractContents(nt).isIdentity),rt)},batch(){const tt=et.batch();return{put(rt,nt){const{isIdentity:it}=extractContents(rt);it||tt.put(rt,nt)},delete(rt){const{isIdentity:nt}=extractContents(rt);nt||tt.delete(rt)},commit:rt=>tt.commit(rt)}}}}function extractContents(et){const tt=CID$5.asCID(et);if(tt==null)throw errCode$c(new Error("Not a valid cid"),"ERR_INVALID_CID");return tt.multihash.code!==identity$4.code?{isIdentity:!1}:{isIdentity:!0,digest:tt.multihash.digest}}var memory$1={};const errors$3=errors$5,debug$f=browserExports,log$9=debug$f("ipfs:repo:lock:memory"),lockFile="repo.lock",LOCKS={};memory$1.lock=async et=>{const tt=et+"/"+lockFile;if(log$9("locking %s",tt),LOCKS[tt]===!0)throw new errors$3.LockExistsError(`Lock already being held for file: ${tt}`);return LOCKS[tt]=!0,{async close(){LOCKS[tt]&&delete LOCKS[tt]}}},memory$1.locked=async et=>{const tt=et+"/"+lockFile;return log$9(`checking lock: ${tt}`),!!LOCKS[tt]};var defaultOptions_browser={autoMigrate:!0,onMigrationProgress:()=>{},repoOwner:!0,repoLock:memory$1},defaultDatastore$1={Spec:{type:"mount",mounts:[{mountpoint:"/blocks",type:"measure",prefix:"flatfs.datastore",child:{type:"flatfs",path:"blocks",sync:!0,shardFunc:"/repo/flatfs/shard/v1/next-to-last/2"}},{mountpoint:"/",type:"measure",prefix:"leveldb.datastore",child:{type:"levelds",path:"datastore",compression:"none"}}]}};const first$1=async et=>{for await(const tt of et)return tt};var itFirst=first$1;const readonly=({enumerable:et=!0,configurable:tt=!1}={})=>({enumerable:et,configurable:tt,writable:!1}),links$1=function*(et,tt){if(et!=null&&!(et instanceof Uint8Array))for(const[rt,nt]of Object.entries(et)){const it=[...tt,rt];if(nt!=null&&typeof nt=="object")if(Array.isArray(nt))for(const[ot,st]of nt.entries()){const at=[...it,ot],ct=CID$f.asCID(st);ct?yield[at.join("/"),ct]:typeof st=="object"&&(yield*links$1(st,at))}else{const ot=CID$f.asCID(nt);ot?yield[it.join("/"),ot]:yield*links$1(nt,it)}}},tree=function*(et,tt){if(et!=null)for(const[rt,nt]of Object.entries(et)){const it=[...tt,rt];if(yield it.join("/"),nt!=null&&!(nt instanceof Uint8Array)&&typeof nt=="object"&&!CID$f.asCID(nt))if(Array.isArray(nt))for(const[ot,st]of nt.entries()){const at=[...it,ot];yield at.join("/"),typeof st=="object"&&!CID$f.asCID(st)&&(yield*tree(st,at))}else yield*tree(nt,it)}},get=(et,tt)=>{let rt=et;for(const[nt,it]of tt.entries()){if(rt=rt[it],rt==null)throw new Error(`Object has no property at ${tt.slice(0,nt+1).map(st=>`[${JSON.stringify(st)}]`).join("")}`);const ot=CID$f.asCID(rt);if(ot)return{value:ot,remaining:tt.slice(nt+1).join("/")}}return{value:rt}};let Block$2=class{constructor({cid:et,bytes:tt,value:rt}){if(!et||!tt||typeof rt>"u")throw new Error("Missing required argument");this.cid=et,this.bytes=tt,this.value=rt,this.asBlock=this,Object.defineProperties(this,{cid:readonly(),bytes:readonly(),value:readonly(),asBlock:readonly()})}links(){return links$1(this.value,[])}tree(){return tree(this.value,[])}get(et="/"){return get(this.value,et.split("/").filter(Boolean))}};const encode$3=async({value:et,codec:tt,hasher:rt})=>{if(typeof et>"u")throw new Error('Missing required argument "value"');if(!tt||!rt)throw new Error("Missing required argument: codec or hasher");const nt=tt.encode(et),it=await rt.digest(nt),ot=CID$f.create(1,tt.code,it);return new Block$2({value:et,bytes:nt,cid:ot})},decode$6=async({bytes:et,codec:tt,hasher:rt})=>{if(!et)throw new Error('Missing required argument "bytes"');if(!tt||!rt)throw new Error("Missing required argument: codec or hasher");const nt=tt.decode(et),it=await rt.digest(et),ot=CID$f.create(1,tt.code,it);return new Block$2({value:nt,bytes:et,cid:ot})},createUnsafe=({bytes:et,cid:tt,value:rt,codec:nt})=>{const it=rt!==void 0?rt:nt&&nt.decode(et);if(it===void 0)throw new Error('Missing required argument, must either provide "value" or "codec"');return new Block$2({cid:tt,bytes:et,value:it})},create$4=async({bytes:et,cid:tt,hasher:rt,codec:nt})=>{if(!et)throw new Error('Missing required argument "bytes"');if(!rt)throw new Error('Missing required argument "hasher"');const it=nt.decode(et),ot=await rt.digest(et);if(!equals$3(tt.multihash.bytes,ot.bytes))throw new Error("CID hash does not match bytes");return createUnsafe({bytes:et,cid:tt,value:it,codec:nt})},block=Object.freeze(Object.defineProperty({__proto__:null,Block:Block$2,create:create$4,createUnsafe,decode:decode$6,encode:encode$3},Symbol.toStringTag,{value:"Module"})),require$$1=getAugmentedNamespace(block),{Key:Key$4}=src$a,{CID:CID$4}=require$$9,raw$4=require$$9$1,errCode$b=errCode$i,{base32:base32$1}=require$$4$1,Digest$1=require$$6$1;function cidToKey$1(et){const tt=CID$4.asCID(et);if(tt==null)throw errCode$b(new Error("Not a valid cid"),"ERR_INVALID_CID");const rt=base32$1.encode(tt.multihash.bytes);return new Key$4("/"+rt.slice(1).toUpperCase(),!1)}function keyToCid(et){return CID$4.createV1(raw$4.code,keyToMultihash$1(et))}function keyToMultihash$1(et){return Digest$1.decode(base32$1.decode(`b${et.toString().toLowerCase().substring(1)}`))}var blockstore={cidToKey:cidToKey$1,keyToCid,keyToMultihash:keyToMultihash$1};const log$8=browserExports("ipfs:repo:utils:walk-dag"),Block$1=require$$1;async function*walkDag$2(et,tt,rt,nt){try{const it=await tt.get(et,nt),ot=await rt(et.code),st=Block$1.createUnsafe({bytes:it,cid:et,codec:ot});for(const[,at]of st.links())yield at,yield*walkDag$2(at,tt,rt,nt)}catch(it){throw log$8("Could not walk DAG for CID",et.toString(),it),it}}var walkDag_1=walkDag$2;const{CID:CID$3}=require$$6$2,errCode$a=errCode$i,debug$e=browserExports,first=itFirst,Block=require$$1,cborg$1=require$$12,dagPb$3=require$$5,{cidToKey,keyToMultihash}=blockstore,walkDag$1=walkDag_1;function invalidPinTypeErr(et){const tt=`Invalid type '${et}', must be one of {direct, indirect, recursive, all}`;return errCode$a(new Error(tt),"ERR_INVALID_PIN_TYPE")}const PinTypes$2={direct:"direct",recursive:"recursive",indirect:"indirect",all:"all"};let PinManager$1=class{constructor({pinstore:et,blockstore:tt,loadCodec:rt}){this.pinstore=et,this.blockstore=tt,this.loadCodec=rt,this.log=debug$e("ipfs:repo:pin"),this.directPins=new Set,this.recursivePins=new Set}async pinDirectly(et,tt={}){await this.blockstore.get(et,tt);const rt={depth:0};return et.version!==0&&(rt.version=et.version),et.code!==dagPb$3.code&&(rt.codec=et.code),tt.metadata&&(rt.metadata=tt.metadata),this.pinstore.put(cidToKey(et),cborg$1.encode(rt))}unpin(et,tt){return this.pinstore.delete(cidToKey(et),tt)}async pinRecursively(et,tt={}){await this.fetchCompleteDag(et,tt);const rt={depth:1/0};et.version!==0&&(rt.version=et.version),et.code!==dagPb$3.code&&(rt.codec=et.code),tt.metadata&&(rt.metadata=tt.metadata),await this.pinstore.put(cidToKey(et),cborg$1.encode(rt))}async*directKeys(et){for await(const tt of this.pinstore.query({filters:[rt=>cborg$1.decode(rt.value).depth===0]})){const rt=cborg$1.decode(tt.value),nt=rt.version||0,it=rt.codec!=null?rt.codec:dagPb$3.code,ot=keyToMultihash(tt.key);yield{cid:CID$3.create(nt,it,ot),metadata:rt.metadata}}}async*recursiveKeys(et){for await(const tt of this.pinstore.query({filters:[rt=>cborg$1.decode(rt.value).depth===1/0]})){const rt=cborg$1.decode(tt.value),nt=rt.version||0,it=rt.codec!=null?rt.codec:dagPb$3.code,ot=keyToMultihash(tt.key);yield{cid:CID$3.create(nt,it,ot),metadata:rt.metadata}}}async*indirectKeys(et){for await(const{cid:tt}of this.recursiveKeys())for await(const rt of walkDag$1(tt,this.blockstore,this.loadCodec,et)){const nt=[PinTypes$2.recursive];(await this.isPinnedWithType(rt,nt)).pinned||(yield rt)}}async isPinnedWithType(et,tt,rt){Array.isArray(tt)||(tt=[tt]);const nt=tt.includes(PinTypes$2.all),it=tt.includes(PinTypes$2.direct),ot=tt.includes(PinTypes$2.recursive),st=tt.includes(PinTypes$2.indirect);if(ot||it||nt){const ut=await first(this.pinstore.query({prefix:cidToKey(et).toString(),filters:[lt=>{if(nt)return!0;const ht=cborg$1.decode(lt.value);return tt.includes(ht.depth===0?PinTypes$2.direct:PinTypes$2.recursive)}],limit:1}));if(ut){const lt=cborg$1.decode(ut.value);return{cid:et,pinned:!0,reason:lt.depth===0?PinTypes$2.direct:PinTypes$2.recursive,metadata:lt.metadata}}}const at=this;async function*ct(ut,lt){for await(const{cid:ht}of lt)for await(const ft of walkDag$1(ht,at.blockstore,at.loadCodec))if(ft.equals(ut)){yield ht;return}}if(nt||st){const ut=await first(ct(et,this.recursiveKeys()));if(ut)return{cid:et,pinned:!0,reason:PinTypes$2.indirect,parent:ut}}return{cid:et,pinned:!1}}async fetchCompleteDag(et,tt){const rt=new Set,nt=async(it,ot)=>{if(rt.has(it.toString()))return;rt.add(it.toString());const st=await this.blockstore.get(it,ot),at=await this.loadCodec(it.code),ct=Block.createUnsafe({bytes:st,cid:it,codec:at});await Promise.all([...ct.links()].map(([,ut])=>nt(ut,ot)))};await nt(et,tt)}static checkPinType(et){if(typeof et!="string"||!Object.keys(PinTypes$2).includes(et))throw invalidPinTypeErr(et);return!0}};var pins={PinManager:PinManager$1,PinTypes:PinTypes$2};const map$2=async function*(et,tt){for await(const rt of et)yield tt(rt)};var itMap=map$2;const map$1=itMap,errCode$9=errCode$i,{PinTypes:PinTypes$1}=pins;var pinnedBlockstore=createPinnedBlockstore$1;function createPinnedBlockstore$1(et,tt){return{open(){return tt.open()},close(){return tt.close()},query(rt,nt){return tt.query(rt,nt)},queryKeys(rt,nt){return tt.queryKeys(rt,nt)},async get(rt,nt){return tt.get(rt,nt)},async*getMany(rt,nt){yield*tt.getMany(rt,nt)},async put(rt,nt,it){await tt.put(rt,nt,it)},async*putMany(rt,nt){yield*tt.putMany(rt,nt)},has(rt,nt){return tt.has(rt,nt)},async delete(rt,nt){return await ensureNotPinned(rt,et),tt.delete(rt,nt)},deleteMany(rt,nt){return tt.deleteMany(map$1(rt,async it=>(await ensureNotPinned(it,et),it)),nt)},batch(){return tt.batch()}}}async function ensureNotPinned(et,tt){const{pinned:rt,reason:nt}=await tt.isPinnedWithType(et,PinTypes$1.all);if(rt)throw errCode$9(new Error(`pinned: ${nt}`),"ERR_BLOCK_PINNED")}var lib$3={exports:{}},events$1={exports:{}},R$1=typeof Reflect=="object"?Reflect:null,ReflectApply=R$1&&typeof R$1.apply=="function"?R$1.apply:function et(tt,rt,nt){return Function.prototype.apply.call(tt,rt,nt)},ReflectOwnKeys;R$1&&typeof R$1.ownKeys=="function"?ReflectOwnKeys=R$1.ownKeys:Object.getOwnPropertySymbols?ReflectOwnKeys=function(et){return Object.getOwnPropertyNames(et).concat(Object.getOwnPropertySymbols(et))}:ReflectOwnKeys=function(et){return Object.getOwnPropertyNames(et)};function ProcessEmitWarning(et){console&&console.warn&&console.warn(et)}var NumberIsNaN=Number.isNaN||function et(tt){return tt!==tt};function EventEmitter$4(){EventEmitter$4.init.call(this)}events$1.exports=EventEmitter$4,events$1.exports.once=once,EventEmitter$4.EventEmitter=EventEmitter$4,EventEmitter$4.prototype._events=void 0,EventEmitter$4.prototype._eventsCount=0,EventEmitter$4.prototype._maxListeners=void 0;var defaultMaxListeners=10;function checkListener(et){if(typeof et!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof et)}Object.defineProperty(EventEmitter$4,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(et){if(typeof et!="number"||et<0||NumberIsNaN(et))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+et+".");defaultMaxListeners=et}}),EventEmitter$4.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter$4.prototype.setMaxListeners=function et(tt){if(typeof tt!="number"||tt<0||NumberIsNaN(tt))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+tt+".");return this._maxListeners=tt,this};function _getMaxListeners(et){return et._maxListeners===void 0?EventEmitter$4.defaultMaxListeners:et._maxListeners}EventEmitter$4.prototype.getMaxListeners=function et(){return _getMaxListeners(this)},EventEmitter$4.prototype.emit=function et(tt){for(var rt=[],nt=1;nt<arguments.length;nt++)rt.push(arguments[nt]);var it=tt==="error",ot=this._events;if(ot!==void 0)it=it&&ot.error===void 0;else if(!it)return!1;if(it){var st;if(rt.length>0&&(st=rt[0]),st instanceof Error)throw st;var at=new Error("Unhandled error."+(st?" ("+st.message+")":""));throw at.context=st,at}var ct=ot[tt];if(ct===void 0)return!1;if(typeof ct=="function")ReflectApply(ct,this,rt);else for(var ut=ct.length,lt=arrayClone(ct,ut),nt=0;nt<ut;++nt)ReflectApply(lt[nt],this,rt);return!0};function _addListener(et,tt,rt,nt){var it,ot,st;if(checkListener(rt),ot=et._events,ot===void 0?(ot=et._events=Object.create(null),et._eventsCount=0):(ot.newListener!==void 0&&(et.emit("newListener",tt,rt.listener?rt.listener:rt),ot=et._events),st=ot[tt]),st===void 0)st=ot[tt]=rt,++et._eventsCount;else if(typeof st=="function"?st=ot[tt]=nt?[rt,st]:[st,rt]:nt?st.unshift(rt):st.push(rt),it=_getMaxListeners(et),it>0&&st.length>it&&!st.warned){st.warned=!0;var at=new Error("Possible EventEmitter memory leak detected. "+st.length+" "+String(tt)+" listeners added. Use emitter.setMaxListeners() to increase limit");at.name="MaxListenersExceededWarning",at.emitter=et,at.type=tt,at.count=st.length,ProcessEmitWarning(at)}return et}EventEmitter$4.prototype.addListener=function et(tt,rt){return _addListener(this,tt,rt,!1)},EventEmitter$4.prototype.on=EventEmitter$4.prototype.addListener,EventEmitter$4.prototype.prependListener=function et(tt,rt){return _addListener(this,tt,rt,!0)};function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(et,tt,rt){var nt={fired:!1,wrapFn:void 0,target:et,type:tt,listener:rt},it=onceWrapper.bind(nt);return it.listener=rt,nt.wrapFn=it,it}EventEmitter$4.prototype.once=function et(tt,rt){return checkListener(rt),this.on(tt,_onceWrap(this,tt,rt)),this},EventEmitter$4.prototype.prependOnceListener=function et(tt,rt){return checkListener(rt),this.prependListener(tt,_onceWrap(this,tt,rt)),this},EventEmitter$4.prototype.removeListener=function et(tt,rt){var nt,it,ot,st,at;if(checkListener(rt),it=this._events,it===void 0)return this;if(nt=it[tt],nt===void 0)return this;if(nt===rt||nt.listener===rt)--this._eventsCount===0?this._events=Object.create(null):(delete it[tt],it.removeListener&&this.emit("removeListener",tt,nt.listener||rt));else if(typeof nt!="function"){for(ot=-1,st=nt.length-1;st>=0;st--)if(nt[st]===rt||nt[st].listener===rt){at=nt[st].listener,ot=st;break}if(ot<0)return this;ot===0?nt.shift():spliceOne(nt,ot),nt.length===1&&(it[tt]=nt[0]),it.removeListener!==void 0&&this.emit("removeListener",tt,at||rt)}return this},EventEmitter$4.prototype.off=EventEmitter$4.prototype.removeListener,EventEmitter$4.prototype.removeAllListeners=function et(tt){var rt,nt,it;if(nt=this._events,nt===void 0)return this;if(nt.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):nt[tt]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete nt[tt]),this;if(arguments.length===0){var ot=Object.keys(nt),st;for(it=0;it<ot.length;++it)st=ot[it],st!=="removeListener"&&this.removeAllListeners(st);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(rt=nt[tt],typeof rt=="function")this.removeListener(tt,rt);else if(rt!==void 0)for(it=rt.length-1;it>=0;it--)this.removeListener(tt,rt[it]);return this};function _listeners(et,tt,rt){var nt=et._events;if(nt===void 0)return[];var it=nt[tt];return it===void 0?[]:typeof it=="function"?rt?[it.listener||it]:[it]:rt?unwrapListeners(it):arrayClone(it,it.length)}EventEmitter$4.prototype.listeners=function et(tt){return _listeners(this,tt,!0)},EventEmitter$4.prototype.rawListeners=function et(tt){return _listeners(this,tt,!1)},EventEmitter$4.listenerCount=function(et,tt){return typeof et.listenerCount=="function"?et.listenerCount(tt):listenerCount.call(et,tt)},EventEmitter$4.prototype.listenerCount=listenerCount;function listenerCount(et){var tt=this._events;if(tt!==void 0){var rt=tt[et];if(typeof rt=="function")return 1;if(rt!==void 0)return rt.length}return 0}EventEmitter$4.prototype.eventNames=function et(){return this._eventsCount>0?ReflectOwnKeys(this._events):[]};function arrayClone(et,tt){for(var rt=new Array(tt),nt=0;nt<tt;++nt)rt[nt]=et[nt];return rt}function spliceOne(et,tt){for(;tt+1<et.length;tt++)et[tt]=et[tt+1];et.pop()}function unwrapListeners(et){for(var tt=new Array(et.length),rt=0;rt<tt.length;++rt)tt[rt]=et[rt].listener||et[rt];return tt}function once(et,tt){return new Promise(function(rt,nt){function it(st){et.removeListener(tt,ot),nt(st)}function ot(){typeof et.removeListener=="function"&&et.removeListener("error",it),rt([].slice.call(arguments))}eventTargetAgnosticAddListener(et,tt,ot,{once:!0}),tt!=="error"&&addErrorHandlerIfEventEmitter(et,it,{once:!0})})}function addErrorHandlerIfEventEmitter(et,tt,rt){typeof et.on=="function"&&eventTargetAgnosticAddListener(et,"error",tt,rt)}function eventTargetAgnosticAddListener(et,tt,rt,nt){if(typeof et.on=="function")nt.once?et.once(tt,rt):et.on(tt,rt);else if(typeof et.addEventListener=="function")et.addEventListener(tt,function it(ot){nt.once&&et.removeEventListener(tt,it),rt(ot)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof et)}var eventsExports=events$1.exports,constants$5={WORKER_REQUEST_READ_LOCK:"lock:worker:request-read",WORKER_RELEASE_READ_LOCK:"lock:worker:release-read",MASTER_GRANT_READ_LOCK:"lock:master:grant-read",WORKER_REQUEST_WRITE_LOCK:"lock:worker:request-write",WORKER_RELEASE_WRITE_LOCK:"lock:worker:release-write",MASTER_GRANT_WRITE_LOCK:"lock:master:grant-write"};const EventEmitter$3=eventsExports.EventEmitter,{nanoid:nanoid$1}=require$$1$1,{WORKER_REQUEST_READ_LOCK:WORKER_REQUEST_READ_LOCK$1,WORKER_RELEASE_READ_LOCK:WORKER_RELEASE_READ_LOCK$1,MASTER_GRANT_READ_LOCK:MASTER_GRANT_READ_LOCK$1,WORKER_REQUEST_WRITE_LOCK:WORKER_REQUEST_WRITE_LOCK$1,WORKER_RELEASE_WRITE_LOCK:WORKER_RELEASE_WRITE_LOCK$1,MASTER_GRANT_WRITE_LOCK:MASTER_GRANT_WRITE_LOCK$1}=constants$5;let cluster;const handleWorkerLockRequest$1=(et,tt,rt,nt,it)=>(ot,st)=>{st&&st.type===rt&&et.emit(tt,st.name,()=>(ot.send({type:it,name:st.name,identifier:st.identifier}),new Promise(at=>{const ct=ut=>{ut&&ut.type===nt&&ut.identifier===st.identifier&&(ot.removeListener("message",ct),at())};ot.on("message",ct)})))},makeWorkerLockRequest$1=(et,tt,rt,nt)=>()=>{const it=nanoid$1();return process.send({type:tt,identifier:it,name:et}),new Promise(ot=>{const st=at=>{at&&at.type===rt&&at.identifier===it&&(process.removeListener("message",st),ot(()=>{process.send({type:nt,identifier:it,name:et})}))};process.on("message",st)})};var node$1=et=>{try{if(cluster=require$$0$3,!Object.keys(cluster).length)return}catch{return}if(cluster.isMaster||et.singleProcess){const tt=new EventEmitter$3;return cluster.on("message",handleWorkerLockRequest$1(tt,"requestReadLock",WORKER_REQUEST_READ_LOCK$1,WORKER_RELEASE_READ_LOCK$1,MASTER_GRANT_READ_LOCK$1)),cluster.on("message",handleWorkerLockRequest$1(tt,"requestWriteLock",WORKER_REQUEST_WRITE_LOCK$1,WORKER_RELEASE_WRITE_LOCK$1,MASTER_GRANT_WRITE_LOCK$1)),tt}return{isWorker:!0,readLock:tt=>makeWorkerLockRequest$1(tt,WORKER_REQUEST_READ_LOCK$1,MASTER_GRANT_READ_LOCK$1,WORKER_RELEASE_READ_LOCK$1),writeLock:tt=>makeWorkerLockRequest$1(tt,WORKER_REQUEST_WRITE_LOCK$1,MASTER_GRANT_WRITE_LOCK$1,WORKER_RELEASE_WRITE_LOCK$1)}};const events={},observable=et=>{et.addEventListener("message",tt=>{observable.dispatchEvent("message",et,tt)}),et.port&&et.port.addEventListener("message",tt=>{observable.dispatchEvent("message",et,tt)})};observable.addEventListener=(et,tt)=>{events[et]||(events[et]=[]),events[et].push(tt)},observable.removeEventListener=(et,tt)=>{events[et]&&(events[et]=events[et].filter(rt=>rt===tt))},observable.dispatchEvent=function(){const et=Array.prototype.slice.call(arguments),tt=et.shift();events[tt]&&events[tt].forEach(rt=>rt.apply(null,et))};var lib$2=observable;const EventEmitter$2=eventsExports.EventEmitter,{nanoid}=require$$1$1,{WORKER_REQUEST_READ_LOCK,WORKER_RELEASE_READ_LOCK,MASTER_GRANT_READ_LOCK,WORKER_REQUEST_WRITE_LOCK,WORKER_RELEASE_WRITE_LOCK,MASTER_GRANT_WRITE_LOCK}=constants$5,observer=lib$2,handleWorkerLockRequest=(et,tt,rt,nt,it)=>(ot,st)=>{if(!st||!st.data||st.data.type!==rt)return;const at={type:st.data.type,name:st.data.name,identifier:st.data.identifier};et.emit(tt,at.name,()=>(ot.postMessage({type:it,name:at.name,identifier:at.identifier}),new Promise(ct=>{const ut=lt=>{if(!lt||!lt.data)return;const ht={type:lt.data.type,name:lt.data.name,identifier:lt.data.identifier};ht&&ht.type===nt&&ht.identifier===at.identifier&&(ot.removeEventListener("message",ut),ct())};ot.addEventListener("message",ut)})))},makeWorkerLockRequest=(et,tt,rt,nt)=>()=>{const it=nanoid();return globalThis.postMessage({type:tt,identifier:it,name:et}),new Promise(ot=>{const st=at=>{if(!at||!at.data)return;const ct={type:at.data.type,identifier:at.data.identifier};ct&&ct.type===rt&&ct.identifier===it&&(globalThis.removeEventListener("message",st),ot(()=>{globalThis.postMessage({type:nt,identifier:it,name:et})}))};globalThis.addEventListener("message",st)})},defaultOptions$2={singleProcess:!1};var browser$1=et=>{if(et=Object.assign({},defaultOptions$2,et),!!globalThis.document||et.singleProcess){const tt=new EventEmitter$2;return observer.addEventListener("message",handleWorkerLockRequest(tt,"requestReadLock",WORKER_REQUEST_READ_LOCK,WORKER_RELEASE_READ_LOCK,MASTER_GRANT_READ_LOCK)),observer.addEventListener("message",handleWorkerLockRequest(tt,"requestWriteLock",WORKER_REQUEST_WRITE_LOCK,WORKER_RELEASE_WRITE_LOCK,MASTER_GRANT_WRITE_LOCK)),tt}return{isWorker:!0,readLock:tt=>makeWorkerLockRequest(tt,WORKER_REQUEST_READ_LOCK,MASTER_GRANT_READ_LOCK,WORKER_RELEASE_READ_LOCK),writeLock:tt=>makeWorkerLockRequest(tt,WORKER_REQUEST_WRITE_LOCK,MASTER_GRANT_WRITE_LOCK,WORKER_RELEASE_WRITE_LOCK)}},promiseTimeout={},TimeoutError;promiseTimeout.timeout=function(et,tt){var rt=new TimeoutError,nt;return Promise.race([et,new Promise(function(it,ot){nt=setTimeout(function(){ot(rt)},tt)})]).then(function(it){return clearTimeout(nt),it},function(it){throw clearTimeout(nt),it})},TimeoutError=promiseTimeout.TimeoutError=function(){Error.call(this),this.stack=Error().stack,this.message="Timeout"},TimeoutError.prototype=Object.create(Error.prototype),TimeoutError.prototype.name="TimeoutError";const node=node$1,browser=browser$1,{default:Queue$1}=dist$1,{timeout}=promiseTimeout,observe=lib$2,mutexes={};let implementation;function createReleaseable(et,tt){let rt;const nt=new Promise(it=>{rt=it});return et.add(()=>timeout((()=>new Promise(it=>{rt(()=>{it()})}))(),tt.timeout)),nt}const createMutex=(et,tt)=>{if(implementation.isWorker)return{readLock:implementation.readLock(et,tt),writeLock:implementation.writeLock(et,tt)};const rt=new Queue$1({concurrency:1});let nt=null;return{readLock:()=>{if(nt)return createReleaseable(nt,tt);nt=new Queue$1({concurrency:tt.concurrency,autoStart:!1});const it=nt,ot=createReleaseable(nt,tt);return rt.add(()=>(it.start(),it.onIdle().then(()=>{nt===it&&(nt=null)}))),ot},writeLock:()=>(nt=null,createReleaseable(rt,tt))}},defaultOptions$1={concurrency:1/0,timeout:846e5,window,singleProcess:!1};lib$3.exports=(et,tt)=>(tt||(tt={}),typeof et=="object"&&(tt=et,et="lock"),et||(et="lock"),tt=Object.assign({},defaultOptions$1,tt),implementation||(implementation=node(tt)||browser(tt),implementation.isWorker||(implementation.on("requestReadLock",(rt,nt)=>{mutexes[rt]&&mutexes[rt].readLock().then(it=>nt().finally(()=>it()))}),implementation.on("requestWriteLock",async(rt,nt)=>{mutexes[rt]&&mutexes[rt].writeLock().then(it=>nt().finally(()=>it()))}))),mutexes[et]||(mutexes[et]=createMutex(et,tt)),mutexes[et]),lib$3.exports.Worker=function(et,tt){tt=tt||window.Worker;let rt;try{rt=new tt(et)}catch(nt){nt.message.includes("not a constructor")&&(rt=tt(et))}if(!rt)throw new Error("Could not create Worker from",tt);return observe(rt),rt};var libExports=lib$3.exports;async function*batch$1(et,tt=1){let rt=[];tt<1&&(tt=1);for await(const nt of et)for(rt.push(nt);rt.length>=tt;)yield rt.slice(0,tt),rt=rt.slice(tt);for(;rt.length;)yield rt.slice(0,tt),rt=rt.slice(tt)}var itBatch=batch$1;const batch=itBatch;async function*parallelBatch$1(et,tt=1){for await(const rt of batch(et,tt)){const nt=rt.map(it=>it().then(ot=>({ok:!0,value:ot}),ot=>({ok:!1,err:ot})));for(let it=0;it<nt.length;it++){const ot=await nt[it];if(ot.ok)yield ot.value;else throw ot.err}}}var itParallelBatch=parallelBatch$1,itPipe={exports:{}};const rawPipe=(...et)=>{let tt;for(;et.length;)tt=et.shift()(tt);return tt},isIterable=et=>et&&(typeof et[Symbol.asyncIterator]=="function"||typeof et[Symbol.iterator]=="function"||typeof et.next=="function"),isDuplex=et=>et&&typeof et.sink=="function"&&isIterable(et.source),duplexPipelineFn=et=>tt=>(et.sink(tt),et.source),pipe$3=(...et)=>{if(isDuplex(et[0])){const tt=et[0];et[0]=()=>tt.source}else if(isIterable(et[0])){const tt=et[0];et[0]=()=>tt}if(et.length>1&&isDuplex(et[et.length-1])&&(et[et.length-1]=et[et.length-1].sink),et.length>2)for(let tt=1;tt<et.length-1;tt++)isDuplex(et[tt])&&(et[tt]=duplexPipelineFn(et[tt]));return rawPipe(...et)};itPipe.exports=pipe$3,itPipe.exports.pipe=pipe$3,itPipe.exports.rawPipe=rawPipe,itPipe.exports.isIterable=isIterable,itPipe.exports.isDuplex=isDuplex;var itPipeExports=itPipe.exports;const pushable$1=itPushable,merge$2=async function*(...et){const tt=pushable$1();setTimeout(async()=>{try{await Promise.all(et.map(async rt=>{for await(const nt of rt)tt.push(nt)})),tt.end()}catch(rt){tt.end(rt)}},0),yield*tt};var itMerge=merge$2;const{CID:CID$2}=require$$6$2,log$7=browserExports("ipfs:repo:gc"),{Errors:Errors$2}=src$a,ERR_NOT_FOUND$1=Errors$2.notFoundError().code,parallelBatch=itParallelBatch,{pipe:pipe$2}=itPipeExports,merge$1=itMerge,map=itMap,filter=itFilter,{Key:Key$3}=src$a,{base32}=require$$4$1,walkDag=walkDag_1,BLOCK_RM_CONCURRENCY=256,MFS_ROOT_KEY=new Key$3("/local/filesroot");var gc$1=({gcLock:et,pins:tt,blockstore:rt,root:nt,loadCodec:it})=>{async function*ot(){const st=Date.now();log$7("Creating set of marked blocks");const at=await et.writeLock();try{const ct=await createMarkedSet({pins:tt,blockstore:rt,root:nt,loadCodec:it}),ut=rt.queryKeys({});yield*deleteUnmarkedBlocks({blockstore:rt},ct,ut),log$7(`Complete (${Date.now()-st}ms)`)}finally{at()}}return ot};async function createMarkedSet({pins:et,blockstore:tt,loadCodec:rt,root:nt}){const it=async function*(){let at;try{at=await nt.get(MFS_ROOT_KEY)}catch(ut){if(ut.code===ERR_NOT_FOUND$1){log$7("No blocks in MFS");return}throw ut}const ct=CID$2.decode(at);yield ct,yield*walkDag(ct,tt,rt)}(),ot=merge$1(map(et.recursiveKeys(),({cid:at})=>at),et.indirectKeys(),map(et.directKeys(),({cid:at})=>at),it),st=new Set;for await(const at of merge$1(ot,it))st.add(base32.encode(at.multihash.bytes));return st}async function*deleteUnmarkedBlocks({blockstore:et},tt,rt){let nt=0,it=0;yield*pipe$2(parallelBatch(map(rt,async ot=>async function(){nt++;try{const st=base32.encode(ot.multihash.bytes);if(tt.has(st))return null;try{await et.delete(ot),it++}catch(at){return{err:new Error(`Could not delete block with CID ${ot}: ${at.message}`)}}return{cid:ot}}catch(st){const at=`Could delete block with CID ${ot}`;return log$7(at,st),{err:new Error(at+`: ${st.message}`)}}}),BLOCK_RM_CONCURRENCY),ot=>filter(ot,Boolean)),log$7(`Marked set has ${tt.size} unique blocks. Blockstore has ${nt} blocks. Deleted ${it} blocks.`)}const _get=justSafeGet,debug$d=browserExports,errCode$8=errCode$i,migrator=src$9,bytes=bytesExports,merge=mergeOptions,constants$4=constants$6,version=version$1,config$1=config$2,spec=spec$1,apiAddr=apiAddr$1,createIdstore=idstore,defaultOptions=defaultOptions_browser,defaultDatastore=defaultDatastore$1,ERRORS$1=errors$5,{PinManager,PinTypes}=pins,createPinnedBlockstore=pinnedBlockstore,mortice=libExports,gc=gc$1,MemoryLock=memory$1,FSLock=memory$1,log$6=debug$d("ipfs:repo"),noLimit=Number.MAX_SAFE_INTEGER,AUTO_MIGRATE_CONFIG_KEY="repoAutoMigrate";class Repo{constructor(tt,rt,nt,it){if(typeof tt!="string")throw new Error("missing repo path");if(typeof rt!="function")throw new Error("missing codec loader");this.options=merge(defaultOptions,it),this.closed=!0,this.path=tt,this.root=nt.root,this.datastore=nt.datastore,this.keys=nt.keys;const ot=nt.blocks,st=nt.pins;this.pins=new PinManager({pinstore:st,blockstore:ot,loadCodec:rt});const at=createPinnedBlockstore(this.pins,ot);this.blocks=createIdstore(at),this.version=version(this.root),this.config=config$1(this.root),this.spec=spec(this.root),this.apiAddr=apiAddr(this.root),this.gcLock=mortice(tt,{singleProcess:this.options.repoOwner!==!1}),this.gc=gc({gcLock:this.gcLock,pins:this.pins,blockstore:this.blocks,root:this.root,loadCodec:rt})}async init(tt){log$6("initializing at: %s",this.path),await this._openRoot(),await this.config.replace(buildConfig(tt)),await this.spec.set(buildDatastoreSpec(tt)),await this.version.set(constants$4.repoVersion)}async isInitialized(){if(!this.closed)return!0;try{return await this._openRoot(),await this._checkInitialized(),await this.root.close(),!0}catch{return!1}}async open(){if(!this.closed)throw errCode$8(new Error("repo is already open"),ERRORS$1.ERR_REPO_ALREADY_OPEN);log$6("opening at: %s",this.path);try{if(await this._openRoot(),await this._checkInitialized(),this._lockfile=await this._openLock(),log$6("acquired repo.lock"),!await this.version.check(constants$4.repoVersion))if(await this._isAutoMigrationEnabled())await this._migrate(constants$4.repoVersion,{root:this.root,datastore:this.datastore,pins:this.pins.pinstore,blocks:this.pins.blockstore,keys:this.keys});else throw new ERRORS$1.InvalidRepoVersionError("Incompatible repo versions. Automatic migrations disabled. Please migrate the repo manually.");log$6("creating datastore"),await this.datastore.open(),log$6("creating blocks"),this.blocks.open(),log$6("creating keystore"),await this.keys.open(),log$6("creating pins"),await this.pins.pinstore.open(),this.closed=!1,log$6("all opened")}catch(tt){if(this._lockfile)try{await this._closeLock(),this._lockfile=null}catch(rt){log$6("error removing lock",rt)}throw tt}}async _openRoot(){try{await this.root.open()}catch(tt){if(tt.message!=="Already open")throw tt}}async _openLock(){const tt=await this.options.repoLock.lock(this.path);if(typeof tt.close!="function")throw errCode$8(new Error("Locks must have a close method"),"ERR_NO_CLOSE_FUNCTION");return tt}_closeLock(){return this._lockfile&&this._lockfile.close()}async _checkInitialized(){log$6("init check");let tt;try{[tt]=await Promise.all([this.config.exists(),this.spec.exists(),this.version.exists()])}catch(rt){throw rt.code==="ERR_NOT_FOUND"?errCode$8(new Error("repo is not initialized yet"),ERRORS$1.ERR_REPO_NOT_INITIALIZED,{path:this.path}):rt}if(!tt)throw errCode$8(new Error("repo is not initialized yet"),ERRORS$1.ERR_REPO_NOT_INITIALIZED,{path:this.path})}async close(){if(this.closed)throw errCode$8(new Error("repo is already closed"),ERRORS$1.ERR_REPO_ALREADY_CLOSED);log$6("closing at: %s",this.path);try{await this.apiAddr.delete()}catch(tt){if(tt.code!==ERRORS$1.ERR_REPO_NOT_INITIALIZED&&!tt.message.startsWith("ENOENT"))throw tt}await Promise.all([this.root,this.blocks,this.keys,this.datastore,this.pins.pinstore].map(tt=>tt&&tt.close())),log$6("unlocking"),this.closed=!0,await this._closeLock()}exists(){return this.version.exists()}async stat(){if(this.datastore&&this.keys){const[tt,rt,nt,it,ot]=await Promise.all([this._storageMaxStat(),this._blockStat(),this.version.get(),getSize(this.datastore),getSize(this.keys)]),st=rt.size+it+ot;return{repoPath:this.path,storageMax:tt,version:nt,numObjects:rt.count,repoSize:st}}throw errCode$8(new Error("repo is not initialized yet"),ERRORS$1.ERR_REPO_NOT_INITIALIZED,{path:this.path})}async _isAutoMigrationEnabled(){if(this.options.autoMigrate!==void 0)return this.options.autoMigrate;let tt;try{tt=await this.config.get(AUTO_MIGRATE_CONFIG_KEY)}catch(rt){if(rt.code===ERRORS$1.NotFoundError.code)tt=!0;else throw rt}return tt}async _migrate(tt,rt){return await this.version.get()>tt?(log$6(`reverting to version ${tt}`),migrator.revert(this.path,rt,this.options,tt,{ignoreLock:!0,onProgress:this.options.onMigrationProgress})):(log$6(`migrating to version ${tt}`),migrator.migrate(this.path,rt,this.options,tt,{ignoreLock:!0,onProgress:this.options.onMigrationProgress}))}async _storageMaxStat(){try{const tt=await this.config.get("Datastore.StorageMax");return BigInt(bytes(tt))}catch{return BigInt(noLimit)}}async _blockStat(){let tt=BigInt(0),rt=BigInt(0);if(this.blocks)for await(const{key:nt,value:it}of this.blocks.query({}))tt+=BigInt(1),rt+=BigInt(it.byteLength),rt+=BigInt(nt.bytes.byteLength);return{count:tt,size:rt}}}async function getSize(et){let tt=BigInt(0);for await(const rt of et.query({}))tt+=BigInt(rt.value.byteLength),tt+=BigInt(rt.key.uint8Array().byteLength);return tt}function createRepo(et,tt,rt,nt){return new Repo(et,tt,rt,nt)}var src$8={createRepo,repoVersion:constants$4.repoVersion,errors:ERRORS$1,utils:{blockstore},locks:{memory:MemoryLock,fs:FSLock},PinTypes};function buildConfig(et){return et.Datastore=Object.assign({},defaultDatastore,_get(et,"datastore")),et}function buildDatastoreSpec(et){const tt={...defaultDatastore.Spec,..._get(et,"Datastore.Spec")};return{type:tt.type,mounts:tt.mounts.map(rt=>({mountpoint:rt.mountpoint,type:rt.child.type,path:rt.child.path,shardFunc:rt.child.shardFunc}))}}var publisher={exports:{}};const bases$4=bases_1$2;function toString$1(et,tt="utf8"){const rt=bases$4[tt];if(!rt)throw new Error(`Unsupported encoding "${tt}"`);return rt.encoder.encode(et).substring(1)}var toString_1=toString$1,equals_1,hasRequiredEquals;function requireEquals(){if(hasRequiredEquals)return equals_1;hasRequiredEquals=1;function et(tt,rt){if(tt===rt)return!0;if(tt.byteLength!==rt.byteLength)return!1;for(let nt=0;nt<tt.byteLength;nt++)if(tt[nt]!==rt[nt])return!1;return!0}return equals_1=et,equals_1}var timestamp_min={exports:{}};(function(et){(function(){et.exports=_t;var tt=86400,rt=3200,nt=146097*rt/400,it=tt*nt,ot=1e3*it,st=864e13,at=4294967296,ct=1e6,ut="000000000",lt=Math.trunc||function(Ft){var Ce=Ft-Ft%1;return Ce==0&&(Ft<0||Ft===0&&1/Ft!=1/0)?-0:Ce},ht=_t.prototype,ft=(_t.fromDate=function(Ft){return new _t(+Ft)},_t.fromInt64BE=kt(0,1,2,3,0,4),_t.fromInt64LE=kt(3,2,1,0,4,0),_t.fromString=function(yt){var Ce,bt=new _t,yt=(yt+="").replace(/^\s*[+\-]?\d+/,function(Et){var Et=+Et,Tt=1970+(Et-1970)%400;return bt.year=Et-Tt,Tt}).replace(/(?:Z|([+\-]\d{2}):?(\d{2}))$/,function($t,Et,Tt){return Et<0&&(Tt*=-1),Ce=6e4*(60*+Et+ +Tt),""}).replace(/\.\d+$/,function($t){return bt.nano=+($t+ut).substr(1,9),""}).split(/\D+/);if(1<yt.length?yt[1]--:yt[1]=0,bt.time=Ce=Date.UTC.apply(Date,yt)-(Ce||0),isNaN(Ce))throw new TypeError("Invalid Date");return mt(bt)},_t.fromTimeT=function(Ft){return It(Ft,0)},ht.year=0,ht.time=0,ht.nano=0,ht.addNano=function(Ft){return this.nano+=+Ft||0,this},ht.getNano=function(){var Ft=mt(this);return(Ft.time%1e3*ct+ +Ft.nano+1e9)%1e9},ht.getTimeT=function(){var Ce=mt(this),Ft=Math.floor(Ce.time/1e3),Ce=Ce.year;return Ce&&(Ft+=Ce*nt*tt/rt),Ft},ht.getYear=function(){return this.toDate().getUTCFullYear()+this.year},ht.toDate=function(){return At(mt(this).time)},ht.toJSON=function(){return this.toString().replace(/0{1,6}Z$/,"Z")},ht.toString=function(Ft){var Ce=this,bt=Ce.toDate(),yt={H:function(){return Ut(bt.getUTCHours())},L:function(){return Wt(bt.getUTCMilliseconds(),3)},M:function(){return Ut(bt.getUTCMinutes())},N:function(){return Wt(Ce.getNano(),9)},S:function(){return Ut(bt.getUTCSeconds())},Y:function(){var $t=Ce.getYear();return 999999<$t?"+"+$t:9999<$t?"+"+Wt($t,6):0<=$t?Wt($t,4):-999999<=$t?"-"+Wt(-$t,6):$t},a:function(){return pt[bt.getUTCDay()]},b:function(){return dt[bt.getUTCMonth()]},d:function(){return Ut(bt.getUTCDate())},e:function(){return function($t){return(9<$t?"":" ")+(0|$t)}(bt.getUTCDate())},m:function(){return Ut(bt.getUTCMonth()+1)}};return function $t(Et){return Et.replace(/%./g,function(Tt){var St=Tt[1],Pt=gt[St],St=yt[St];return Pt?$t(Pt):St?St():Tt})}(Ft||ft)},ht.writeInt64BE=Mt(0,1,2,3,0,4),ht.writeInt64LE=Mt(3,2,1,0,4,0),"%Y-%m-%dT%H:%M:%S.%NZ"),dt=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],pt=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],gt={"%":"%",F:"%Y-%m-%d",n:`
`,R:"%H:%M",T:"%H:%M:%S",t:"	",X:"%T",Z:"GMT",z:"+0000"};return _t;function _t(Ft,Ce,bt){var yt=this;if(!(yt instanceof _t))return new _t(Ft,Ce,bt);yt.time=+Ft||0,yt.nano=+Ce||0,yt.year=+bt||0,mt(yt)}function mt(Ft){var Ce,bt,yt,$t=Ft.year,Et=Ft.time,Tt=Ft.nano,Pt=((Tt<0||ct<=Tt)&&(Tt-=(bt=Math.floor(Tt/ct))*ct,Et+=bt,bt=1),$t%rt);return(Et<-st||st<Et||Pt)&&((Ce=lt(Et/ot))&&($t+=Ce*rt,Et-=Ce*ot),(yt=At(Et)).setUTCFullYear(Pt+yt.getUTCFullYear()),yt=(Et=+yt)+(Ce=lt(($t-=Pt)/rt))*ot,Ce&&-st<=yt&&yt<=st&&($t-=Ce*rt,Et=yt),bt=1),bt&&(Ft.year=$t,Ft.time=Et,Ft.nano=Tt),Ft}function At(Ft){var Ce=new Date(0);return Ce.setTime(Ft),Ce}function It($t,yt){$t=+$t||0;var bt=lt((yt=(yt|0)*at)/it)+lt($t/it),yt=yt%it+$t%it,$t=lt(yt/it);return $t&&(bt+=$t,yt-=$t*it),new _t(1e3*yt,0,bt*rt)}function Mt(Ft,Ce,bt,yt,$t,Et){return function(Pt,St){var wt=mt(this);Pt=Pt||new Array(8),Ct(Pt,St|=0);var xt=Math.floor(wt.time/1e3),wt=wt.year*(nt*tt/rt),Dt=lt(wt/at)+lt(xt/at),wt=wt%at+xt%at,xt=Math.floor(wt/at);return xt&&(Dt+=xt,wt-=xt*at),Tt(Pt,St+$t,Dt),Tt(Pt,St+Et,wt),Pt};function Tt(Pt,St,Dt){Pt[St+Ft]=Dt>>24&255,Pt[St+Ce]=Dt>>16&255,Pt[St+bt]=Dt>>8&255,Pt[St+yt]=255&Dt}}function kt(Ft,Ce,bt,yt,$t,Et){return function(Pt,St){Ct(Pt,St|=0);var Dt=Tt(Pt,St+$t);return It(Tt(Pt,St+Et),Dt)};function Tt(Pt,St){return 16777216*Pt[St+Ft]+(Pt[St+Ce]<<16|Pt[St+bt]<<8|Pt[St+yt])}}function Ct(Ft,Ce){if(Ft=Ft&&Ft.length,Ft==null)throw new TypeError("Invalid Buffer");if(Ft<Ce+8)throw new RangeError("Out of range")}function Ut(Ft){return(9<Ft?"":"0")+(0|Ft)}function Wt(Ft,Ce){return(ut+(0|Ft)).substr(-Ce)}})()})(timestamp_min);var timestamp_minExports=timestamp_min.exports,long=Long$1,wasm$2=null;try{wasm$2=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(et){}function Long$1(et,tt,rt){this.low=et|0,this.high=tt|0,this.unsigned=!!rt}Long$1.prototype.__isLong__,Object.defineProperty(Long$1.prototype,"__isLong__",{value:!0});function isLong(et){return(et&&et.__isLong__)===!0}Long$1.isLong=isLong;var INT_CACHE={},UINT_CACHE={};function fromInt(et,tt){var rt,nt,it;return tt?(et>>>=0,(it=0<=et&&et<256)&&(nt=UINT_CACHE[et],nt)?nt:(rt=fromBits(et,(et|0)<0?-1:0,!0),it&&(UINT_CACHE[et]=rt),rt)):(et|=0,(it=-128<=et&&et<128)&&(nt=INT_CACHE[et],nt)?nt:(rt=fromBits(et,et<0?-1:0,!1),it&&(INT_CACHE[et]=rt),rt))}Long$1.fromInt=fromInt;function fromNumber(et,tt){if(isNaN(et))return tt?UZERO:ZERO;if(tt){if(et<0)return UZERO;if(et>=TWO_PWR_64_DBL)return MAX_UNSIGNED_VALUE}else{if(et<=-TWO_PWR_63_DBL)return MIN_VALUE;if(et+1>=TWO_PWR_63_DBL)return MAX_VALUE}return et<0?fromNumber(-et,tt).neg():fromBits(et%TWO_PWR_32_DBL|0,et/TWO_PWR_32_DBL|0,tt)}Long$1.fromNumber=fromNumber;function fromBits(et,tt,rt){return new Long$1(et,tt,rt)}Long$1.fromBits=fromBits;var pow_dbl=Math.pow;function fromString$2(et,tt,rt){if(et.length===0)throw Error("empty string");if(et==="NaN"||et==="Infinity"||et==="+Infinity"||et==="-Infinity")return ZERO;if(typeof tt=="number"?(rt=tt,tt=!1):tt=!!tt,rt=rt||10,rt<2||36<rt)throw RangeError("radix");var nt;if((nt=et.indexOf("-"))>0)throw Error("interior hyphen");if(nt===0)return fromString$2(et.substring(1),tt,rt).neg();for(var it=fromNumber(pow_dbl(rt,8)),ot=ZERO,st=0;st<et.length;st+=8){var at=Math.min(8,et.length-st),ct=parseInt(et.substring(st,st+at),rt);if(at<8){var ut=fromNumber(pow_dbl(rt,at));ot=ot.mul(ut).add(fromNumber(ct))}else ot=ot.mul(it),ot=ot.add(fromNumber(ct))}return ot.unsigned=tt,ot}Long$1.fromString=fromString$2;function fromValue(et,tt){return typeof et=="number"?fromNumber(et,tt):typeof et=="string"?fromString$2(et,tt):fromBits(et.low,et.high,typeof tt=="boolean"?tt:et.unsigned)}Long$1.fromValue=fromValue;var TWO_PWR_16_DBL=65536,TWO_PWR_24_DBL=1<<24,TWO_PWR_32_DBL=TWO_PWR_16_DBL*TWO_PWR_16_DBL,TWO_PWR_64_DBL=TWO_PWR_32_DBL*TWO_PWR_32_DBL,TWO_PWR_63_DBL=TWO_PWR_64_DBL/2,TWO_PWR_24=fromInt(TWO_PWR_24_DBL),ZERO=fromInt(0);Long$1.ZERO=ZERO;var UZERO=fromInt(0,!0);Long$1.UZERO=UZERO;var ONE=fromInt(1);Long$1.ONE=ONE;var UONE=fromInt(1,!0);Long$1.UONE=UONE;var NEG_ONE=fromInt(-1);Long$1.NEG_ONE=NEG_ONE;var MAX_VALUE=fromBits(-1,2147483647,!1);Long$1.MAX_VALUE=MAX_VALUE;var MAX_UNSIGNED_VALUE=fromBits(-1,-1,!0);Long$1.MAX_UNSIGNED_VALUE=MAX_UNSIGNED_VALUE;var MIN_VALUE=fromBits(0,-2147483648,!1);Long$1.MIN_VALUE=MIN_VALUE;var LongPrototype=Long$1.prototype;LongPrototype.toInt=function et(){return this.unsigned?this.low>>>0:this.low},LongPrototype.toNumber=function et(){return this.unsigned?(this.high>>>0)*TWO_PWR_32_DBL+(this.low>>>0):this.high*TWO_PWR_32_DBL+(this.low>>>0)},LongPrototype.toString=function et(tt){if(tt=tt||10,tt<2||36<tt)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(MIN_VALUE)){var rt=fromNumber(tt),nt=this.div(rt),it=nt.mul(rt).sub(this);return nt.toString(tt)+it.toInt().toString(tt)}else return"-"+this.neg().toString(tt);for(var ot=fromNumber(pow_dbl(tt,6),this.unsigned),st=this,at="";;){var ct=st.div(ot),ut=st.sub(ct.mul(ot)).toInt()>>>0,lt=ut.toString(tt);if(st=ct,st.isZero())return lt+at;for(;lt.length<6;)lt="0"+lt;at=""+lt+at}},LongPrototype.getHighBits=function et(){return this.high},LongPrototype.getHighBitsUnsigned=function et(){return this.high>>>0},LongPrototype.getLowBits=function et(){return this.low},LongPrototype.getLowBitsUnsigned=function et(){return this.low>>>0},LongPrototype.getNumBitsAbs=function et(){if(this.isNegative())return this.eq(MIN_VALUE)?64:this.neg().getNumBitsAbs();for(var tt=this.high!=0?this.high:this.low,rt=31;rt>0&&!(tt&1<<rt);rt--);return this.high!=0?rt+33:rt+1},LongPrototype.isZero=function et(){return this.high===0&&this.low===0},LongPrototype.eqz=LongPrototype.isZero,LongPrototype.isNegative=function et(){return!this.unsigned&&this.high<0},LongPrototype.isPositive=function et(){return this.unsigned||this.high>=0},LongPrototype.isOdd=function et(){return(this.low&1)===1},LongPrototype.isEven=function et(){return(this.low&1)===0},LongPrototype.equals=function et(tt){return isLong(tt)||(tt=fromValue(tt)),this.unsigned!==tt.unsigned&&this.high>>>31===1&&tt.high>>>31===1?!1:this.high===tt.high&&this.low===tt.low},LongPrototype.eq=LongPrototype.equals,LongPrototype.notEquals=function et(tt){return!this.eq(tt)},LongPrototype.neq=LongPrototype.notEquals,LongPrototype.ne=LongPrototype.notEquals,LongPrototype.lessThan=function et(tt){return this.comp(tt)<0},LongPrototype.lt=LongPrototype.lessThan,LongPrototype.lessThanOrEqual=function et(tt){return this.comp(tt)<=0},LongPrototype.lte=LongPrototype.lessThanOrEqual,LongPrototype.le=LongPrototype.lessThanOrEqual,LongPrototype.greaterThan=function et(tt){return this.comp(tt)>0},LongPrototype.gt=LongPrototype.greaterThan,LongPrototype.greaterThanOrEqual=function et(tt){return this.comp(tt)>=0},LongPrototype.gte=LongPrototype.greaterThanOrEqual,LongPrototype.ge=LongPrototype.greaterThanOrEqual,LongPrototype.compare=function et(tt){if(isLong(tt)||(tt=fromValue(tt)),this.eq(tt))return 0;var rt=this.isNegative(),nt=tt.isNegative();return rt&&!nt?-1:!rt&&nt?1:this.unsigned?tt.high>>>0>this.high>>>0||tt.high===this.high&&tt.low>>>0>this.low>>>0?-1:1:this.sub(tt).isNegative()?-1:1},LongPrototype.comp=LongPrototype.compare,LongPrototype.negate=function et(){return!this.unsigned&&this.eq(MIN_VALUE)?MIN_VALUE:this.not().add(ONE)},LongPrototype.neg=LongPrototype.negate,LongPrototype.add=function et(tt){isLong(tt)||(tt=fromValue(tt));var rt=this.high>>>16,nt=this.high&65535,it=this.low>>>16,ot=this.low&65535,st=tt.high>>>16,at=tt.high&65535,ct=tt.low>>>16,ut=tt.low&65535,lt=0,ht=0,ft=0,dt=0;return dt+=ot+ut,ft+=dt>>>16,dt&=65535,ft+=it+ct,ht+=ft>>>16,ft&=65535,ht+=nt+at,lt+=ht>>>16,ht&=65535,lt+=rt+st,lt&=65535,fromBits(ft<<16|dt,lt<<16|ht,this.unsigned)},LongPrototype.subtract=function et(tt){return isLong(tt)||(tt=fromValue(tt)),this.add(tt.neg())},LongPrototype.sub=LongPrototype.subtract,LongPrototype.multiply=function et(tt){if(this.isZero())return ZERO;if(isLong(tt)||(tt=fromValue(tt)),wasm$2){var rt=wasm$2.mul(this.low,this.high,tt.low,tt.high);return fromBits(rt,wasm$2.get_high(),this.unsigned)}if(tt.isZero())return ZERO;if(this.eq(MIN_VALUE))return tt.isOdd()?MIN_VALUE:ZERO;if(tt.eq(MIN_VALUE))return this.isOdd()?MIN_VALUE:ZERO;if(this.isNegative())return tt.isNegative()?this.neg().mul(tt.neg()):this.neg().mul(tt).neg();if(tt.isNegative())return this.mul(tt.neg()).neg();if(this.lt(TWO_PWR_24)&&tt.lt(TWO_PWR_24))return fromNumber(this.toNumber()*tt.toNumber(),this.unsigned);var nt=this.high>>>16,it=this.high&65535,ot=this.low>>>16,st=this.low&65535,at=tt.high>>>16,ct=tt.high&65535,ut=tt.low>>>16,lt=tt.low&65535,ht=0,ft=0,dt=0,pt=0;return pt+=st*lt,dt+=pt>>>16,pt&=65535,dt+=ot*lt,ft+=dt>>>16,dt&=65535,dt+=st*ut,ft+=dt>>>16,dt&=65535,ft+=it*lt,ht+=ft>>>16,ft&=65535,ft+=ot*ut,ht+=ft>>>16,ft&=65535,ft+=st*ct,ht+=ft>>>16,ft&=65535,ht+=nt*lt+it*ut+ot*ct+st*at,ht&=65535,fromBits(dt<<16|pt,ht<<16|ft,this.unsigned)},LongPrototype.mul=LongPrototype.multiply,LongPrototype.divide=function et(tt){if(isLong(tt)||(tt=fromValue(tt)),tt.isZero())throw Error("division by zero");if(wasm$2){if(!this.unsigned&&this.high===-2147483648&&tt.low===-1&&tt.high===-1)return this;var rt=(this.unsigned?wasm$2.div_u:wasm$2.div_s)(this.low,this.high,tt.low,tt.high);return fromBits(rt,wasm$2.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?UZERO:ZERO;var nt,it,ot;if(this.unsigned){if(tt.unsigned||(tt=tt.toUnsigned()),tt.gt(this))return UZERO;if(tt.gt(this.shru(1)))return UONE;ot=UZERO}else{if(this.eq(MIN_VALUE)){if(tt.eq(ONE)||tt.eq(NEG_ONE))return MIN_VALUE;if(tt.eq(MIN_VALUE))return ONE;var st=this.shr(1);return nt=st.div(tt).shl(1),nt.eq(ZERO)?tt.isNegative()?ONE:NEG_ONE:(it=this.sub(tt.mul(nt)),ot=nt.add(it.div(tt)),ot)}else if(tt.eq(MIN_VALUE))return this.unsigned?UZERO:ZERO;if(this.isNegative())return tt.isNegative()?this.neg().div(tt.neg()):this.neg().div(tt).neg();if(tt.isNegative())return this.div(tt.neg()).neg();ot=ZERO}for(it=this;it.gte(tt);){nt=Math.max(1,Math.floor(it.toNumber()/tt.toNumber()));for(var at=Math.ceil(Math.log(nt)/Math.LN2),ct=at<=48?1:pow_dbl(2,at-48),ut=fromNumber(nt),lt=ut.mul(tt);lt.isNegative()||lt.gt(it);)nt-=ct,ut=fromNumber(nt,this.unsigned),lt=ut.mul(tt);ut.isZero()&&(ut=ONE),ot=ot.add(ut),it=it.sub(lt)}return ot},LongPrototype.div=LongPrototype.divide,LongPrototype.modulo=function et(tt){if(isLong(tt)||(tt=fromValue(tt)),wasm$2){var rt=(this.unsigned?wasm$2.rem_u:wasm$2.rem_s)(this.low,this.high,tt.low,tt.high);return fromBits(rt,wasm$2.get_high(),this.unsigned)}return this.sub(this.div(tt).mul(tt))},LongPrototype.mod=LongPrototype.modulo,LongPrototype.rem=LongPrototype.modulo,LongPrototype.not=function et(){return fromBits(~this.low,~this.high,this.unsigned)},LongPrototype.and=function et(tt){return isLong(tt)||(tt=fromValue(tt)),fromBits(this.low&tt.low,this.high&tt.high,this.unsigned)},LongPrototype.or=function et(tt){return isLong(tt)||(tt=fromValue(tt)),fromBits(this.low|tt.low,this.high|tt.high,this.unsigned)},LongPrototype.xor=function et(tt){return isLong(tt)||(tt=fromValue(tt)),fromBits(this.low^tt.low,this.high^tt.high,this.unsigned)},LongPrototype.shiftLeft=function et(tt){return isLong(tt)&&(tt=tt.toInt()),(tt&=63)===0?this:tt<32?fromBits(this.low<<tt,this.high<<tt|this.low>>>32-tt,this.unsigned):fromBits(0,this.low<<tt-32,this.unsigned)},LongPrototype.shl=LongPrototype.shiftLeft,LongPrototype.shiftRight=function et(tt){return isLong(tt)&&(tt=tt.toInt()),(tt&=63)===0?this:tt<32?fromBits(this.low>>>tt|this.high<<32-tt,this.high>>tt,this.unsigned):fromBits(this.high>>tt-32,this.high>=0?0:-1,this.unsigned)},LongPrototype.shr=LongPrototype.shiftRight,LongPrototype.shiftRightUnsigned=function et(tt){if(isLong(tt)&&(tt=tt.toInt()),tt&=63,tt===0)return this;var rt=this.high;if(tt<32){var nt=this.low;return fromBits(nt>>>tt|rt<<32-tt,rt>>>tt,this.unsigned)}else return tt===32?fromBits(rt,0,this.unsigned):fromBits(rt>>>tt-32,0,this.unsigned)},LongPrototype.shru=LongPrototype.shiftRightUnsigned,LongPrototype.shr_u=LongPrototype.shiftRightUnsigned,LongPrototype.toSigned=function et(){return this.unsigned?fromBits(this.low,this.high,!1):this},LongPrototype.toUnsigned=function et(){return this.unsigned?this:fromBits(this.low,this.high,!0)},LongPrototype.toBytes=function et(tt){return tt?this.toBytesLE():this.toBytesBE()},LongPrototype.toBytesLE=function et(){var tt=this.high,rt=this.low;return[rt&255,rt>>>8&255,rt>>>16&255,rt>>>24,tt&255,tt>>>8&255,tt>>>16&255,tt>>>24]},LongPrototype.toBytesBE=function et(){var tt=this.high,rt=this.low;return[tt>>>24,tt>>>16&255,tt>>>8&255,tt&255,rt>>>24,rt>>>16&255,rt>>>8&255,rt&255]},Long$1.fromBytes=function et(tt,rt,nt){return nt?Long$1.fromBytesLE(tt,rt):Long$1.fromBytesBE(tt,rt)},Long$1.fromBytesLE=function et(tt,rt){return new Long$1(tt[0]|tt[1]<<8|tt[2]<<16|tt[3]<<24,tt[4]|tt[5]<<8|tt[6]<<16|tt[7]<<24,rt)},Long$1.fromBytesBE=function et(tt,rt){return new Long$1(tt[4]<<24|tt[5]<<16|tt[6]<<8|tt[7],tt[0]<<24|tt[1]<<16|tt[2]<<8|tt[3],rt)};var ipns$1,hasRequiredIpns;function requireIpns(){if(hasRequiredIpns)return ipns$1;hasRequiredIpns=1;var et=minimal,tt=et.Reader,rt=et.Writer,nt=et.util,it=et.roots["ipfs-ipns"]||(et.roots["ipfs-ipns"]={});return it.IpnsEntry=function(){function ot(st){if(st)for(var at=Object.keys(st),ct=0;ct<at.length;++ct)st[at[ct]]!=null&&(this[at[ct]]=st[at[ct]])}return ot.prototype.value=nt.newBuffer([]),ot.prototype.signature=nt.newBuffer([]),ot.prototype.validityType=0,ot.prototype.validity=nt.newBuffer([]),ot.prototype.sequence=nt.Long?nt.Long.fromBits(0,0,!0):0,ot.prototype.ttl=nt.Long?nt.Long.fromBits(0,0,!0):0,ot.prototype.pubKey=nt.newBuffer([]),ot.prototype.signatureV2=nt.newBuffer([]),ot.prototype.data=nt.newBuffer([]),ot.encode=function(st,at){return at||(at=rt.create()),st.value!=null&&Object.hasOwnProperty.call(st,"value")&&at.uint32(10).bytes(st.value),st.signature!=null&&Object.hasOwnProperty.call(st,"signature")&&at.uint32(18).bytes(st.signature),st.validityType!=null&&Object.hasOwnProperty.call(st,"validityType")&&at.uint32(24).int32(st.validityType),st.validity!=null&&Object.hasOwnProperty.call(st,"validity")&&at.uint32(34).bytes(st.validity),st.sequence!=null&&Object.hasOwnProperty.call(st,"sequence")&&at.uint32(40).uint64(st.sequence),st.ttl!=null&&Object.hasOwnProperty.call(st,"ttl")&&at.uint32(48).uint64(st.ttl),st.pubKey!=null&&Object.hasOwnProperty.call(st,"pubKey")&&at.uint32(58).bytes(st.pubKey),st.signatureV2!=null&&Object.hasOwnProperty.call(st,"signatureV2")&&at.uint32(66).bytes(st.signatureV2),st.data!=null&&Object.hasOwnProperty.call(st,"data")&&at.uint32(74).bytes(st.data),at},ot.decode=function(st,at){st instanceof tt||(st=tt.create(st));for(var ct=at===void 0?st.len:st.pos+at,ut=new it.IpnsEntry;st.pos<ct;){var lt=st.uint32();switch(lt>>>3){case 1:ut.value=st.bytes();break;case 2:ut.signature=st.bytes();break;case 3:ut.validityType=st.int32();break;case 4:ut.validity=st.bytes();break;case 5:ut.sequence=st.uint64();break;case 6:ut.ttl=st.uint64();break;case 7:ut.pubKey=st.bytes();break;case 8:ut.signatureV2=st.bytes();break;case 9:ut.data=st.bytes();break;default:st.skipType(lt&7);break}}return ut},ot.fromObject=function(st){if(st instanceof it.IpnsEntry)return st;var at=new it.IpnsEntry;switch(st.value!=null&&(typeof st.value=="string"?nt.base64.decode(st.value,at.value=nt.newBuffer(nt.base64.length(st.value)),0):st.value.length&&(at.value=st.value)),st.signature!=null&&(typeof st.signature=="string"?nt.base64.decode(st.signature,at.signature=nt.newBuffer(nt.base64.length(st.signature)),0):st.signature.length&&(at.signature=st.signature)),st.validityType){case"EOL":case 0:at.validityType=0;break}return st.validity!=null&&(typeof st.validity=="string"?nt.base64.decode(st.validity,at.validity=nt.newBuffer(nt.base64.length(st.validity)),0):st.validity.length&&(at.validity=st.validity)),st.sequence!=null&&(nt.Long?(at.sequence=nt.Long.fromValue(st.sequence)).unsigned=!0:typeof st.sequence=="string"?at.sequence=parseInt(st.sequence,10):typeof st.sequence=="number"?at.sequence=st.sequence:typeof st.sequence=="object"&&(at.sequence=new nt.LongBits(st.sequence.low>>>0,st.sequence.high>>>0).toNumber(!0))),st.ttl!=null&&(nt.Long?(at.ttl=nt.Long.fromValue(st.ttl)).unsigned=!0:typeof st.ttl=="string"?at.ttl=parseInt(st.ttl,10):typeof st.ttl=="number"?at.ttl=st.ttl:typeof st.ttl=="object"&&(at.ttl=new nt.LongBits(st.ttl.low>>>0,st.ttl.high>>>0).toNumber(!0))),st.pubKey!=null&&(typeof st.pubKey=="string"?nt.base64.decode(st.pubKey,at.pubKey=nt.newBuffer(nt.base64.length(st.pubKey)),0):st.pubKey.length&&(at.pubKey=st.pubKey)),st.signatureV2!=null&&(typeof st.signatureV2=="string"?nt.base64.decode(st.signatureV2,at.signatureV2=nt.newBuffer(nt.base64.length(st.signatureV2)),0):st.signatureV2.length&&(at.signatureV2=st.signatureV2)),st.data!=null&&(typeof st.data=="string"?nt.base64.decode(st.data,at.data=nt.newBuffer(nt.base64.length(st.data)),0):st.data.length&&(at.data=st.data)),at},ot.toObject=function(st,at){at||(at={});var ct={};if(at.defaults){if(at.bytes===String?ct.value="":(ct.value=[],at.bytes!==Array&&(ct.value=nt.newBuffer(ct.value))),at.bytes===String?ct.signature="":(ct.signature=[],at.bytes!==Array&&(ct.signature=nt.newBuffer(ct.signature))),ct.validityType=at.enums===String?"EOL":0,at.bytes===String?ct.validity="":(ct.validity=[],at.bytes!==Array&&(ct.validity=nt.newBuffer(ct.validity))),nt.Long){var ut=new nt.Long(0,0,!0);ct.sequence=at.longs===String?ut.toString():at.longs===Number?ut.toNumber():ut}else ct.sequence=at.longs===String?"0":0;if(nt.Long){var ut=new nt.Long(0,0,!0);ct.ttl=at.longs===String?ut.toString():at.longs===Number?ut.toNumber():ut}else ct.ttl=at.longs===String?"0":0;at.bytes===String?ct.pubKey="":(ct.pubKey=[],at.bytes!==Array&&(ct.pubKey=nt.newBuffer(ct.pubKey))),at.bytes===String?ct.signatureV2="":(ct.signatureV2=[],at.bytes!==Array&&(ct.signatureV2=nt.newBuffer(ct.signatureV2))),at.bytes===String?ct.data="":(ct.data=[],at.bytes!==Array&&(ct.data=nt.newBuffer(ct.data)))}return st.value!=null&&st.hasOwnProperty("value")&&(ct.value=at.bytes===String?nt.base64.encode(st.value,0,st.value.length):at.bytes===Array?Array.prototype.slice.call(st.value):st.value),st.signature!=null&&st.hasOwnProperty("signature")&&(ct.signature=at.bytes===String?nt.base64.encode(st.signature,0,st.signature.length):at.bytes===Array?Array.prototype.slice.call(st.signature):st.signature),st.validityType!=null&&st.hasOwnProperty("validityType")&&(ct.validityType=at.enums===String?it.IpnsEntry.ValidityType[st.validityType]:st.validityType),st.validity!=null&&st.hasOwnProperty("validity")&&(ct.validity=at.bytes===String?nt.base64.encode(st.validity,0,st.validity.length):at.bytes===Array?Array.prototype.slice.call(st.validity):st.validity),st.sequence!=null&&st.hasOwnProperty("sequence")&&(typeof st.sequence=="number"?ct.sequence=at.longs===String?String(st.sequence):st.sequence:ct.sequence=at.longs===String?nt.Long.prototype.toString.call(st.sequence):at.longs===Number?new nt.LongBits(st.sequence.low>>>0,st.sequence.high>>>0).toNumber(!0):st.sequence),st.ttl!=null&&st.hasOwnProperty("ttl")&&(typeof st.ttl=="number"?ct.ttl=at.longs===String?String(st.ttl):st.ttl:ct.ttl=at.longs===String?nt.Long.prototype.toString.call(st.ttl):at.longs===Number?new nt.LongBits(st.ttl.low>>>0,st.ttl.high>>>0).toNumber(!0):st.ttl),st.pubKey!=null&&st.hasOwnProperty("pubKey")&&(ct.pubKey=at.bytes===String?nt.base64.encode(st.pubKey,0,st.pubKey.length):at.bytes===Array?Array.prototype.slice.call(st.pubKey):st.pubKey),st.signatureV2!=null&&st.hasOwnProperty("signatureV2")&&(ct.signatureV2=at.bytes===String?nt.base64.encode(st.signatureV2,0,st.signatureV2.length):at.bytes===Array?Array.prototype.slice.call(st.signatureV2):st.signatureV2),st.data!=null&&st.hasOwnProperty("data")&&(ct.data=at.bytes===String?nt.base64.encode(st.data,0,st.data.length):at.bytes===Array?Array.prototype.slice.call(st.data):st.data),ct},ot.prototype.toJSON=function(){return this.constructor.toObject(this,et.util.toJSONOptions)},ot.ValidityType=function(){var st={},at=Object.create(st);return at[st[0]="EOL"]=0,at}(),ot}(),ipns$1=it,ipns$1}var utils$9={},hasRequiredUtils$2;function requireUtils$2(){return hasRequiredUtils$2||(hasRequiredUtils$2=1,utils$9.toRFC3339=et=>{const tt=et.getUTCFullYear(),rt=String(et.getUTCMonth()+1).padStart(2,"0"),nt=String(et.getUTCDate()).padStart(2,"0"),it=String(et.getUTCHours()).padStart(2,"0"),ot=String(et.getUTCMinutes()).padStart(2,"0"),st=String(et.getUTCSeconds()).padStart(2,"0"),at=et.getUTCMilliseconds()*1e3*1e3;return`${tt}-${rt}-${nt}T${it}:${ot}:${st}.${at}Z`},utils$9.parseRFC3339=et=>{const tt=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),rt=String(et).trim().match(tt);if(!rt)throw new Error("Invalid format");const nt=parseInt(rt[1],10),it=parseInt(rt[2],10)-1,ot=parseInt(rt[3],10),st=parseInt(rt[4],10),at=parseInt(rt[5],10),ct=parseInt(rt[6],10),ut=parseInt(rt[7].slice(0,-6),10);return new Date(Date.UTC(nt,it,ot,st,at,ct,ut))}),utils$9}var errors$2={},hasRequiredErrors$1;function requireErrors$1(){return hasRequiredErrors$1||(hasRequiredErrors$1=1,errors$2.ERR_IPNS_EXPIRED_RECORD="ERR_IPNS_EXPIRED_RECORD",errors$2.ERR_UNRECOGNIZED_VALIDITY="ERR_UNRECOGNIZED_VALIDITY",errors$2.ERR_SIGNATURE_CREATION="ERR_SIGNATURE_CREATION",errors$2.ERR_SIGNATURE_VERIFICATION="ERR_SIGNATURE_VERIFICATION",errors$2.ERR_UNRECOGNIZED_FORMAT="ERR_UNRECOGNIZED_FORMAT",errors$2.ERR_PEER_ID_FROM_PUBLIC_KEY="ERR_PEER_ID_FROM_PUBLIC_KEY",errors$2.ERR_PUBLIC_KEY_FROM_ID="ERR_PUBLIC_KEY_FROM_ID",errors$2.ERR_UNDEFINED_PARAMETER="ERR_UNDEFINED_PARAMETER",errors$2.ERR_INVALID_RECORD_DATA="ERR_INVALID_RECORD_DATA"),errors$2}const NanoDate=timestamp_minExports,{Key:Key$2}=src$a,crypto$4=src$g,PeerId$4=srcExports$1,Digest=require$$6$1,{identity:identity$3}=require$$7,errCode$7=errCode$i,{base32upper}=require$$4$1,{fromString:uint8ArrayFromString$8}=require$$9$2,{toString:uint8ArrayToString$9}=require$$1$2,{concat:uint8ArrayConcat$2}=require$$7$1,{equals:uint8ArrayEquals$3}=require$$1$3,cborg=require$$12,Long=long,debug$c=browserExports,log$5=Object.assign(debug$c("jsipns"),{error:debug$c("jsipns:error")}),{IpnsEntry:ipnsEntryProto}=requireIpns(),{parseRFC3339}=requireUtils$2(),ERRORS=requireErrors$1(),ID_MULTIHASH_CODE=identity$3.code,namespace$1="/ipns/",IPNS_PREFIX=uint8ArrayFromString$8("/ipns/"),create$3=(et,tt,rt,nt)=>{const it=new NanoDate(Date.now()+Number(nt)),ot=ipnsEntryProto.ValidityType.EOL,[st,at]=nt.toString().split("."),ct=BigInt(st)*100000n+BigInt(at||0);return _create(et,tt,rt,ot,it,ct)},createWithExpiration=(et,tt,rt,nt)=>{const it=NanoDate.fromString(nt),ot=ipnsEntryProto.ValidityType.EOL,st=it.toDate().getTime()-Date.now(),at=BigInt(st)*100000n+BigInt(it.getNano());return _create(et,tt,rt,ot,it,at)},_create=async(et,tt,rt,nt,it,ot)=>{rt=BigInt(rt);const st=uint8ArrayFromString$8(it.toString()),at=await sign$1(et,tt,nt,st),ct=createCborData(tt,st,nt,rt,ot),ut=ipnsEntryDataForV2Sig(ct),lt=await et.sign(ut),ht={value:tt,signature:at,validityType:nt,validity:st,sequence:rt,ttl:ot,signatureV2:lt,data:ct};return log$5(`ipns entry for ${tt} created`),ht},createCborData=(et,tt,rt,nt,it)=>{const ot={Value:et,Validity:tt,ValidityType:rt,Sequence:nt,TTL:it};return cborg.encode(ot)},validate=async(et,tt)=>{const{value:rt,validityType:nt,validity:it}=tt;let ot,st;tt.signatureV2&&tt.data?(st=tt.signatureV2,ot=ipnsEntryDataForV2Sig(tt.data),validateCborDataMatchesPbData(tt)):(st=tt.signature,ot=ipnsEntryDataForV1Sig(rt,nt,it));let at;try{at=await et.verify(ot,st)}catch{at=!1}if(!at)throw log$5.error("record signature verification failed"),errCode$7(new Error("record signature verification failed"),ERRORS.ERR_SIGNATURE_VERIFICATION);if(nt===ipnsEntryProto.ValidityType.EOL){let ct;try{ct=parseRFC3339(uint8ArrayToString$9(it))}catch{throw log$5.error("unrecognized validity format (not an rfc3339 format)"),errCode$7(new Error("unrecognized validity format (not an rfc3339 format)"),ERRORS.ERR_UNRECOGNIZED_FORMAT)}if(ct.getTime()<Date.now())throw log$5.error("record has expired"),errCode$7(new Error("record has expired"),ERRORS.ERR_IPNS_EXPIRED_RECORD)}else if(nt)throw log$5.error("unrecognized validity type"),errCode$7(new Error("unrecognized validity type"),ERRORS.ERR_UNRECOGNIZED_VALIDITY);log$5(`ipns entry for ${rt} is valid`)},validateCborDataMatchesPbData=et=>{if(!et.data)throw errCode$7(new Error("Record data is missing"),ERRORS.ERR_INVALID_RECORD_DATA);const tt=cborg.decode(et.data);if(Number.isInteger(tt.Sequence)&&(tt.Sequence=BigInt(tt.Sequence)),Number.isInteger(tt.TTL)&&(tt.TTL=BigInt(tt.TTL)),!uint8ArrayEquals$3(tt.Value,et.value))throw errCode$7(new Error('Field "value" did not match between protobuf and CBOR'),ERRORS.ERR_SIGNATURE_VERIFICATION);if(!uint8ArrayEquals$3(tt.Validity,et.validity))throw errCode$7(new Error('Field "validity" did not match between protobuf and CBOR'),ERRORS.ERR_SIGNATURE_VERIFICATION);if(tt.ValidityType!==et.validityType)throw errCode$7(new Error('Field "validityType" did not match between protobuf and CBOR'),ERRORS.ERR_SIGNATURE_VERIFICATION);if(tt.Sequence!==et.sequence)throw errCode$7(new Error('Field "sequence" did not match between protobuf and CBOR'),ERRORS.ERR_SIGNATURE_VERIFICATION);if(tt.TTL!==et.ttl)throw errCode$7(new Error('Field "ttl" did not match between protobuf and CBOR'),ERRORS.ERR_SIGNATURE_VERIFICATION)},embedPublicKey=async(et,tt)=>{if(!et||!et.bytes||!tt){const it=new Error("one or more of the provided parameters are not defined");throw log$5.error(it),errCode$7(it,ERRORS.ERR_UNDEFINED_PARAMETER)}let rt;try{rt=await PeerId$4.createFromPubKey(et.bytes)}catch(it){throw errCode$7(it,ERRORS.ERR_PEER_ID_FROM_PUBLIC_KEY)}let nt;try{nt=extractPublicKeyFromId(rt)}catch(it){throw log$5.error(it),errCode$7(it,ERRORS.ERR_PUBLIC_KEY_FROM_ID)}if(nt)return null;try{tt.pubKey=crypto$4.keys.marshalPublicKey(et)}catch(it){throw log$5.error(it),it}return tt},extractPublicKey=(et,tt)=>{if(!tt||!et){const rt=new Error("one or more of the provided parameters are not defined");throw log$5.error(rt),errCode$7(rt,ERRORS.ERR_UNDEFINED_PARAMETER)}if(tt.pubKey){let rt;try{rt=crypto$4.keys.unmarshalPublicKey(tt.pubKey)}catch(nt){throw log$5.error(nt),nt}return rt}if(et.pubKey)return et.pubKey;throw Object.assign(new Error("no public key is available"),{code:ERRORS.ERR_UNDEFINED_PARAMETER})},rawStdEncoding=et=>base32upper.encode(et).slice(1),getLocalKey=et=>new Key$2(`/ipns/${rawStdEncoding(et)}`),getIdKeys=et=>{const tt=uint8ArrayFromString$8("/pk/"),rt=uint8ArrayFromString$8("/ipns/");return{routingPubKey:new Key$2(uint8ArrayConcat$2([tt,et]),!1),pkKey:new Key$2(rawStdEncoding(uint8ArrayConcat$2([tt,et]))),routingKey:new Key$2(uint8ArrayConcat$2([rt,et]),!1),ipnsKey:new Key$2(rawStdEncoding(uint8ArrayConcat$2([rt,et])))}},sign$1=(et,tt,rt,nt)=>{try{const it=ipnsEntryDataForV1Sig(tt,rt,nt);return et.sign(it)}catch(it){throw log$5.error("record signature creation failed"),errCode$7(new Error("record signature creation failed: "+it.message),ERRORS.ERR_SIGNATURE_CREATION)}},getValidityType=et=>{if(et.toString()==="0")return"EOL";const tt=new Error(`unrecognized validity type ${et.toString()}`);throw log$5.error(tt),errCode$7(tt,ERRORS.ERR_UNRECOGNIZED_VALIDITY)},ipnsEntryDataForV1Sig=(et,tt,rt)=>{const nt=uint8ArrayFromString$8(getValidityType(tt));return uint8ArrayConcat$2([et,rt,nt])},ipnsEntryDataForV2Sig=et=>{const tt=uint8ArrayFromString$8("ipns-signature:");return uint8ArrayConcat$2([tt,et])},extractPublicKeyFromId=et=>{const tt=Digest.decode(et.id);return tt.code!==ID_MULTIHASH_CODE?null:crypto$4.keys.unmarshalPublicKey(tt.digest)},marshal=et=>ipnsEntryProto.encode({...et,sequence:Long.fromString(et.sequence.toString()),ttl:et.ttl==null?void 0:Long.fromString(et.ttl.toString())}).finish(),unmarshal=et=>{const tt=ipnsEntryProto.decode(et),rt=ipnsEntryProto.toObject(tt,{defaults:!1,arrays:!0,objects:!1});return{value:rt.value,signature:rt.signature,validityType:rt.validityType,validity:rt.validity,sequence:Object.hasOwnProperty.call(rt,"sequence")?BigInt(`${rt.sequence}`):0n,pubKey:rt.pubKey,ttl:Object.hasOwnProperty.call(rt,"ttl")?BigInt(`${rt.ttl}`):void 0}},validator$1={validate:async(et,tt)=>{const rt=unmarshal(et),nt=tt.slice(IPNS_PREFIX.length),it=PeerId$4.createFromBytes(nt),ot=extractPublicKey(it,rt);await validate(ot,rt)},select:(et,tt)=>{const rt=unmarshal(et),nt=unmarshal(tt);return rt.sequence>nt.sequence?0:1}};var src$7={create:create$3,createWithExpiration,validate,embedPublicKey,extractPublicKey,getLocalKey,getIdKeys,marshal,unmarshal,validator:validator$1,namespace:namespace$1,namespaceLength:namespace$1.length},hasRequiredPublisher;function requirePublisher(){return hasRequiredPublisher||(hasRequiredPublisher=1,function(et,tt){const rt=srcExports$1,{Key:nt,Errors:it}=src$a,ot=errCode$i,st=browserExports,at=Object.assign(st("ipfs:ipns:publisher"),{error:st("ipfs:ipns:publisher:error")}),ct=toString_1,ut=requireEquals(),lt=src$7,ht=it.notFoundError().code,ft=60*60*1e3;class dt{constructor(gt,_t){this._routing=gt,this._datastore=_t}async publishWithEOL(gt,_t,mt){if(!gt||!gt.bytes)throw ot(new Error("invalid private key"),"ERR_INVALID_PRIVATE_KEY");const At=await rt.createFromPrivKey(gt.bytes),It=await this._updateOrCreateRecord(gt,_t,mt,At);return this._putRecordToRouting(It,At)}publish(gt,_t){return this.publishWithEOL(gt,_t,ft)}async _putRecordToRouting(gt,_t){if(!rt.isPeerId(_t)){const Mt="peerId received is not valid";throw at.error(Mt),ot(new Error(Mt),"ERR_INVALID_PEER_ID")}const mt=_t._pubKey,At=await lt.embedPublicKey(mt,gt),It=lt.getIdKeys(_t.toBytes());return await this._publishEntry(It.routingKey,At||gt),await this._publishPublicKey(It.routingPubKey,mt),At||gt}async _publishEntry(gt,_t){if(!(gt instanceof nt)){const At="datastore key does not have a valid format";throw at.error(At),ot(new Error(At),"ERR_INVALID_DATASTORE_KEY")}let mt;try{mt=lt.marshal(_t)}catch(At){throw at.error(At),At}try{const At=await this._routing.put(gt.uint8Array(),mt);return at(`ipns record for ${ct(gt.uint8Array(),"base64")} was stored in the routing`),At}catch(At){const It=`ipns record for ${ct(gt.uint8Array(),"base64")} could not be stored in the routing`;throw at.error(It),at.error(At),ot(new Error(It),"ERR_PUTTING_TO_ROUTING")}}async _publishPublicKey(gt,_t){if(!(gt instanceof nt)){const mt="datastore key does not have a valid format";throw at.error(mt),ot(new Error(mt),"ERR_INVALID_DATASTORE_KEY")}if(!_t||!_t.bytes){const mt="one or more of the provided parameters are not defined";throw at.error(mt),ot(new Error(mt),"ERR_UNDEFINED_PARAMETER")}try{const mt=await this._routing.put(gt.uint8Array(),_t.bytes);return at(`public key for ${ct(gt.uint8Array(),"base64")} was stored in the routing`),mt}catch(mt){const At=`public key for ${ct(gt.uint8Array(),"base64")} could not be stored in the routing`;throw at.error(At),at.error(mt),ot(new Error(At),"ERR_PUTTING_TO_ROUTING")}}async _getPublished(gt,_t={}){if(!rt.isPeerId(gt)){const At="peerId received is not valid";throw at.error(At),ot(new Error(At),"ERR_INVALID_PEER_ID")}const mt=_t.checkRouting!==!1;try{const At=await this._datastore.get(lt.getLocalKey(gt.id));return this._unmarshalData(At)}catch(At){if(At.code!==ht){const It=`unexpected error getting the ipns record ${gt.id} from datastore`;throw at.error(It),ot(new Error(It),"ERR_UNEXPECTED_DATASTORE_RESPONSE")}if(!mt)throw ot(At,"ERR_NOT_FOUND_AND_CHECK_ROUTING_NOT_ENABLED");try{const It=lt.getIdKeys(gt.toBytes()),Mt=await this._routing.get(It.routingKey.uint8Array());return this._unmarshalData(Mt)}catch(It){throw at.error(It),It}}}_unmarshalData(gt){try{return lt.unmarshal(gt)}catch(_t){throw ot(_t,"ERR_INVALID_RECORD_DATA")}}async _updateOrCreateRecord(gt,_t,mt,At){if(!rt.isPeerId(At)){const Ut="peerId received is not valid";throw at.error(Ut),ot(new Error(Ut),"ERR_INVALID_PEER_ID")}const It={checkRouting:!0};let Mt;try{Mt=await this._getPublished(At,It)}catch(Ut){if(Ut.code!==ht){const Wt=`unexpected error when determining the last published IPNS record for ${At.id} ${Ut.stack}`;throw at.error(Wt),ot(new Error(Wt),"ERR_DETERMINING_PUBLISHED_RECORD")}}let kt=0n;Mt&&Mt.sequence!==void 0&&(kt=ut(Mt.value,_t)?BigInt(Mt.sequence):BigInt(Mt.sequence)+1n);let Ct;try{Ct=await lt.create(gt,_t,kt,mt)}catch(Ut){const Wt=`ipns record for ${_t} could not be created`;throw at.error(Ut),ot(new Error(Wt),"ERR_CREATING_IPNS_RECORD")}try{const Ut=lt.marshal(Ct);return await this._datastore.put(lt.getLocalKey(At.id),Ut),at(`ipns record for ${ct(_t,"base32")} was stored in the datastore`),Ct}catch{const Ut=`ipns record for ${_t} could not be stored in the datastore`;throw at.error(Ut),ot(new Error(Ut),"ERR_STORING_IN_DATASTORE")}}}dt.defaultRecordLifetime=ft,et.exports=dt}(publisher)),publisher.exports}var republisher={exports:{}},hasRequiredRepublisher;function requireRepublisher(){return hasRequiredRepublisher||(hasRequiredRepublisher=1,function(et,tt){const rt=src$7,nt=src$g,it=srcExports$1,ot=errCode$i,st=browserExports,at=Object.assign(st("ipfs:ipns:republisher"),{error:st("ipfs:ipns:republisher:error")}),ct=60*1e3,ut=60*ct,lt=4*ut,ht=24*ut;class ft{constructor(pt,gt,_t,mt,At={pass:""}){this._publisher=pt,this._datastore=gt,this._peerId=_t,this._keychain=mt,this._options=At,this._republishHandle=null}async start(){if(this._republishHandle)throw ot(new Error("republisher is already running"),"ERR_REPUBLISH_ALREADY_RUNNING");const pt={_task:null,_inflightTask:null,_timeoutId:null,runPeriodically:At=>{pt._timeoutId=setTimeout(async()=>{pt._timeoutId=null;try{pt._inflightTask=pt._task(),await pt._inflightTask,pt._task&&pt.runPeriodically(At)}catch(It){at.error(It)}},At())},cancel:async()=>{pt._timeoutId!=null&&clearTimeout(pt._timeoutId),pt._task=null,await pt._inflightTask}},{privKey:gt}=this._peerId,{pass:_t}=this._options;let mt=!0;pt._task=()=>this._republishEntries(gt,_t),pt.runPeriodically(()=>mt?(mt=!1,this._options.initialBroadcastInterval||ct):this._options.broadcastInterval||lt),this._republishHandle=pt}async stop(){const pt=this._republishHandle;if(!pt)throw ot(new Error("republisher is not running"),"ERR_REPUBLISH_NOT_RUNNING");this._republishHandle=null,await pt.cancel()}async _republishEntries(pt,gt){try{await this._republishEntry(pt)}catch{const _t="cannot republish entry for the node's private key";at.error(_t);return}if(gt)try{const _t=await this._keychain.listKeys();for(const mt of _t){if(mt.name==="self")continue;const At=await this._keychain.exportKey(mt.name,gt),It=await nt.keys.import(At,gt);await this._republishEntry(It)}}catch(_t){at.error(_t)}}async _republishEntry(pt){if(!pt||!pt.bytes)throw ot(new Error("invalid private key"),"ERR_INVALID_PRIVATE_KEY");try{const gt=await it.createFromPrivKey(pt.bytes),_t=await this._getPreviousValue(gt);await this._publisher.publishWithEOL(pt,_t,ht)}catch(gt){if(gt.code==="ERR_NO_ENTRY_FOUND")return;throw gt}}async _getPreviousValue(pt){if(!it.isPeerId(pt))throw ot(new Error("invalid peer ID"),"ERR_INVALID_PEER_ID");try{const gt=await this._datastore.get(rt.getLocalKey(pt.id));if(!(gt instanceof Uint8Array))throw ot(new Error("found ipns record that we couldn't process"),"ERR_INVALID_IPNS_RECORD");try{return rt.unmarshal(gt).value}catch(_t){throw at.error(_t),ot(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_IPNS_RECORD")}}catch(gt){throw gt&&gt.notFound?ot(new Error(`no previous entry for record with id: ${pt.id}`),"ERR_NO_ENTRY_FOUND"):gt}}}et.exports=ft}(republisher)),republisher.exports}var resolver={exports:{}},hasRequiredResolver;function requireResolver(){return hasRequiredResolver||(hasRequiredResolver=1,function(et,tt){const rt=src$7,nt=srcExports$1,it=errCode$i,ot=browserExports,st=Object.assign(ot("ipfs:ipns:resolver"),{error:ot("ipfs:ipns:resolver:error")}),at=toString_1,{Errors:ct}=src$a,ut=ct.notFoundError().code,lt=32;class ht{constructor(dt){this._routing=dt}async resolve(dt,pt={}){if(typeof dt!="string")throw it(new Error("invalid name"),"ERR_INVALID_NAME");const gt=pt.recursive&&pt.recursive.toString()==="true",_t=dt.split("/");if(_t.length!==3||_t[0]!=="")throw it(new Error("invalid name"),"ERR_INVALID_NAME");const mt=_t[2];let At=1/0;gt&&(At=lt);const It=await this.resolver(mt,At);return st(`${dt} was locally resolved correctly`),It}async resolver(dt,pt){if(pt===0){const mt=`could not resolve name (recursion limit of ${lt} exceeded)`;throw st.error(mt),it(new Error(mt),"ERR_RESOLVE_RECURSION_LIMIT")}const gt=await this._resolveName(dt),_t=gt.split("/");return _t[1]==="ipfs"||!pt?gt:this.resolver(_t[2],pt-1)}async _resolveName(dt){const pt=nt.parse(dt),{routingKey:gt}=rt.getIdKeys(pt.toBytes());let _t;try{_t=await this._routing.get(gt.uint8Array())}catch(At){throw st.error("could not get record from routing",At),At.code===ut?it(new Error(`record requested for ${dt} was not found in the network`),"ERR_NO_RECORD_FOUND"):it(new Error(`unexpected error getting the ipns record ${pt.toString()}`),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}let mt;try{mt=rt.unmarshal(_t)}catch(At){throw st.error("could not unmarshal record",At),it(new Error("found ipns record that we couldn't convert to a value"),"ERR_INVALID_RECORD_RECEIVED")}return this._validateRecord(pt,mt)}async _validateRecord(dt,pt){const gt=await rt.extractPublicKey(dt,pt);return await rt.validate(gt,pt),at(pt.value)}}et.exports=ht}(resolver)),resolver.exports}const debug$b=browserExports;Object.assign(debug$b("ipfs:ipns"),{error:debug$b("ipfs:ipns:error")}),requirePublisher(),requireRepublisher(),requireResolver();var shardReadme=`This is a repository of IPLD objects. Each IPLD object is in a single file,
named <base32 encoding of cid>.data. Where <base32 encoding of cid> is the
"base32" encoding of the CID (as specified in
https://github.com/multiformats/multibase) without the 'B' prefix.
All the object files are placed in a tree of directories, based on a
function of the CID. This is a form of sharding similar to
the objects directory in git repositories. Previously, we used
prefixes, we now use the next-to-last two charters.
    func NextToLast(base32cid string) {
      nextToLastLen := 2
      offset := len(base32cid) - nextToLastLen - 1
      return str[offset : offset+nextToLastLen]
    }
For example, an object with a base58 CIDv1 of
    zb2rhYSxw4ZjuzgCnWSt19Q94ERaeFhu9uSqRgjSdx9bsgM6f
has a base32 CIDv1 of
    BAFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA
and will be placed at
    SC/AFKREIA22FLID5AJ2KU7URG47MDLROZIH6YF2KALU2PWEFPVI37YLKRSCA.data
with 'SC' being the last-to-next two characters and the 'B' at the
beginning of the CIDv1 string is the multibase prefix that is not
stored in the filename.
`;const{Key:Key$1}=src$a,readme=shardReadme,PREFIX="/repo/flatfs/shard/",SHARDING_FN="SHARDING",README_FN="_README";class ShardBase{constructor(tt){this.param=tt,this.name="base",this._padding=""}fun(tt){return"implement me"}toString(){return`${PREFIX}v1/${this.name}/${this.param}`}}class Prefix extends ShardBase{constructor(tt){super(tt),this._padding="".padStart(tt,"_"),this.name="prefix"}fun(tt){return(tt+this._padding).slice(0,this.param)}}class Suffix extends ShardBase{constructor(tt){super(tt),this._padding="".padStart(tt,"_"),this.name="suffix"}fun(tt){const rt=this._padding+tt;return rt.slice(rt.length-this.param)}}class NextToLast extends ShardBase{constructor(tt){super(tt),this._padding="".padStart(tt+1,"_"),this.name="next-to-last"}fun(tt){const rt=this._padding+tt,nt=rt.length-this.param-1;return rt.slice(nt,nt+this.param)}}function parseShardFun(et){if(et=et.trim(),et.length===0)throw new Error("empty shard string");if(!et.startsWith(PREFIX))throw new Error(`invalid or no path prefix: ${et}`);const tt=et.slice(PREFIX.length).split("/"),rt=tt[0];if(rt!=="v1")throw new Error(`expect 'v1' version, got '${rt}'`);const nt=tt[1];if(!tt[2])throw new Error("missing param");const it=parseInt(tt[2],10);switch(nt){case"prefix":return new Prefix(it);case"suffix":return new Suffix(it);case"next-to-last":return new NextToLast(it);default:throw new Error(`unkown sharding function: ${nt}`)}}const readShardFun=async(et,tt)=>{const rt=new Key$1(et).child(new Key$1(SHARDING_FN)),nt=await(typeof tt.getRaw=="function"?tt.getRaw.bind(tt):tt.get.bind(tt))(rt);return parseShardFun(new TextDecoder().decode(nt||"").trim())};var shard={readme,parseShardFun,readShardFun,Prefix,Suffix,NextToLast,README_FN,SHARDING_FN,PREFIX};const{Adapter,Key,Errors:Errors$1}=src$a,sh=shard;new Key(sh.SHARDING_FN),new Key(sh.README_FN),browserExports("datastore:core:tiered"),src$a.Key;var dlv_umd={exports:{}};(function(et,tt){(function(rt,nt){et.exports=function(it,ot,st,at,ct){for(ot=ot.split?ot.split("."):ot,at=0;at<ot.length;at++)it=it?it[ot[at]]:ct;return it===ct?st:it}})()})(dlv_umd);var src$6={exports:{}};const errcode$9=errCode$i,{toString:uint8ArrayToString$8}=require$$1$2,{fromString:uint8ArrayFromString$7}=require$$9$2,namespace="/record/";function encodeBase32(et){return uint8ArrayToString$8(et,"base32")}function keyToTopic(et){(typeof et=="string"||et instanceof String)&&(et=uint8ArrayFromString$7(et.toString()));const tt=uint8ArrayToString$8(et,"base64url");return`${namespace}${tt}`}function topicToKey(et){if(et.substring(0,namespace.length)!==namespace)throw errcode$9(new Error("topic received is not from a record"),"ERR_TOPIC_IS_NOT_FROM_RECORD_NAMESPACE");const tt=et.substring(namespace.length);return uint8ArrayFromString$7(tt,"base64url")}var utils$8={encodeBase32,keyToTopic,topicToKey};(function(et,tt){const{Key:rt,Adapter:nt}=src$a,{encodeBase32:it,keyToTopic:ot,topicToKey:st}=utils$8,{equals:at}=require$$1$3,ct=errCode$i,ut=browserExports,lt=Object.assign(ut("datastore-pubsub:publisher"),{error:ut("datastore-pubsub:publisher:error")});class ht extends nt{constructor(dt,pt,gt,_t,mt){if(super(),!_t)throw ct(new TypeError("missing validator"),"ERR_INVALID_PARAMETERS");if(typeof _t.validate!="function")throw ct(new TypeError("missing validate function"),"ERR_INVALID_PARAMETERS");if(typeof _t.select!="function")throw ct(new TypeError("missing select function"),"ERR_INVALID_PARAMETERS");if(mt&&typeof mt!="function")throw ct(new TypeError("invalid subscriptionKeyFn received"),"ERR_INVALID_PARAMETERS");this._pubsub=dt,this._datastore=pt,this._peerId=gt,this._validator=_t,this._handleSubscriptionKeyFn=mt,this._onMessage=this._onMessage.bind(this)}async put(dt,pt){if(!(dt instanceof Uint8Array)){const _t="datastore key does not have a valid format";throw lt.error(_t),ct(new Error(_t),"ERR_INVALID_DATASTORE_KEY")}if(!(pt instanceof Uint8Array)){const _t="received value is not a Uint8Array";throw lt.error(_t),ct(new Error(_t),"ERR_INVALID_VALUE_RECEIVED")}const gt=ot(dt);lt(`publish value for topic ${gt}`),await this._pubsub.publish(gt,pt)}async get(dt){if(!(dt instanceof Uint8Array)){const _t="datastore key does not have a valid format";throw lt.error(_t),ct(new Error(_t),"ERR_INVALID_DATASTORE_KEY")}const pt=ot(dt),gt=await this._pubsub.getTopics();if(gt&&Array.isArray(gt)&&gt.indexOf(pt)>-1)return this._getLocal(dt);try{this._pubsub.on(pt,this._onMessage),await this._pubsub.subscribe(pt)}catch{const _t=`cannot subscribe topic ${pt}`;throw lt.error(_t),ct(new Error(_t),"ERR_SUBSCRIBING_TOPIC")}return lt(`subscribed values for key ${pt}`),this._getLocal(dt)}unsubscribe(dt){const pt=ot(dt);return this._pubsub.removeListener(pt,this._onMessage),this._pubsub.unsubscribe(pt)}async _getLocal(dt){const pt=new rt("/"+it(dt),!1);let gt;try{gt=await this._datastore.get(pt)}catch(_t){if(_t.code!=="ERR_NOT_FOUND"){const At=`unexpected error getting the ipns record for ${pt.toString()}`;throw lt.error(At),ct(new Error(At),"ERR_UNEXPECTED_ERROR_GETTING_RECORD")}const mt=`local record requested was not found for ${pt.toString()}`;throw lt.error(mt),ct(new Error(mt),"ERR_NOT_FOUND")}if(!(gt instanceof Uint8Array)){const _t="found record that we couldn't convert to a value";throw lt.error(_t),ct(new Error(_t),"ERR_INVALID_RECORD_RECEIVED")}return gt}async _onMessage(dt){const{data:pt,from:gt,topicIDs:_t}=dt;let mt;try{mt=st(_t[0])}catch(At){lt.error(At);return}if(lt(`message received for topic ${_t[0]}`),gt===this._peerId.toB58String()){lt("message discarded as it is from the same peer");return}if(this._handleSubscriptionKeyFn){let At;try{At=await this._handleSubscriptionKeyFn(mt)}catch{lt.error("message discarded by the subscriptionKeyFn");return}mt=At}try{await this._storeIfSubscriptionIsBetter(mt,pt)}catch(At){lt.error(At)}}async _storeIfSubscriptionIsBetter(dt,pt){let gt=!1;try{gt=await this._isBetter(dt,pt)}catch(_t){if(_t.code!=="ERR_NOT_VALID_RECORD")throw _t}gt&&await this._storeRecord(dt,pt)}async _validateRecord(dt,pt){return this._validator.validate(dt,pt)}async _selectRecord(dt,pt){return await this._validator.select(dt,pt)===0}async _isBetter(dt,pt){try{await this._validateRecord(pt,dt)}catch{const mt="record received through pubsub is not valid";throw lt.error(mt),ct(new Error(mt),"ERR_NOT_VALID_RECORD")}const gt=new rt(dt);let _t;try{_t=await this._getLocal(gt.uint8Array())}catch{return!0}return at(_t,pt)?!1:this._selectRecord(dt,[_t,pt])}async _storeRecord(dt,pt){const gt=new rt("/"+it(dt),!1);await this._datastore.put(gt,pt),lt(`record for ${ot(dt)} was stored in the datastore`)}}et.exports=ht})(src$6);const debug$a=browserExports;Object.assign(debug$a("ipfs:ipns:pubsub"),{error:debug$a("ipfs:ipns:pubsub:error")});var offlineDatastore={exports:{}},$protobuf$5=minimal,$Reader$5=$protobuf$5.Reader,$Writer$5=$protobuf$5.Writer,$util$5=$protobuf$5.util,$root$5=$protobuf$5.roots["libp2p-record"]||($protobuf$5.roots["libp2p-record"]={});$root$5.Record=function(){function et(tt){if(tt)for(var rt=Object.keys(tt),nt=0;nt<rt.length;++nt)tt[rt[nt]]!=null&&(this[rt[nt]]=tt[rt[nt]])}return et.prototype.key=$util$5.newBuffer([]),et.prototype.value=$util$5.newBuffer([]),et.prototype.timeReceived="",et.encode=function(tt,rt){return rt||(rt=$Writer$5.create()),tt.key!=null&&Object.hasOwnProperty.call(tt,"key")&&rt.uint32(10).bytes(tt.key),tt.value!=null&&Object.hasOwnProperty.call(tt,"value")&&rt.uint32(18).bytes(tt.value),tt.timeReceived!=null&&Object.hasOwnProperty.call(tt,"timeReceived")&&rt.uint32(42).string(tt.timeReceived),rt},et.decode=function(tt,rt){tt instanceof $Reader$5||(tt=$Reader$5.create(tt));for(var nt=rt===void 0?tt.len:tt.pos+rt,it=new $root$5.Record;tt.pos<nt;){var ot=tt.uint32();switch(ot>>>3){case 1:it.key=tt.bytes();break;case 2:it.value=tt.bytes();break;case 5:it.timeReceived=tt.string();break;default:tt.skipType(ot&7);break}}return it},et.fromObject=function(tt){if(tt instanceof $root$5.Record)return tt;var rt=new $root$5.Record;return tt.key!=null&&(typeof tt.key=="string"?$util$5.base64.decode(tt.key,rt.key=$util$5.newBuffer($util$5.base64.length(tt.key)),0):tt.key.length&&(rt.key=tt.key)),tt.value!=null&&(typeof tt.value=="string"?$util$5.base64.decode(tt.value,rt.value=$util$5.newBuffer($util$5.base64.length(tt.value)),0):tt.value.length&&(rt.value=tt.value)),tt.timeReceived!=null&&(rt.timeReceived=String(tt.timeReceived)),rt},et.toObject=function(tt,rt){rt||(rt={});var nt={};return rt.defaults&&(rt.bytes===String?nt.key="":(nt.key=[],rt.bytes!==Array&&(nt.key=$util$5.newBuffer(nt.key))),rt.bytes===String?nt.value="":(nt.value=[],rt.bytes!==Array&&(nt.value=$util$5.newBuffer(nt.value))),nt.timeReceived=""),tt.key!=null&&tt.hasOwnProperty("key")&&(nt.key=rt.bytes===String?$util$5.base64.encode(tt.key,0,tt.key.length):rt.bytes===Array?Array.prototype.slice.call(tt.key):tt.key),tt.value!=null&&tt.hasOwnProperty("value")&&(nt.value=rt.bytes===String?$util$5.base64.encode(tt.value,0,tt.value.length):rt.bytes===Array?Array.prototype.slice.call(tt.value):tt.value),tt.timeReceived!=null&&tt.hasOwnProperty("timeReceived")&&(nt.timeReceived=tt.timeReceived),nt},et.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf$5.util.toJSONOptions)},et}();var record$1=$root$5,utils$7={};utils$7.toRFC3339=et=>{const tt=et.getUTCFullYear(),rt=String(et.getUTCMonth()+1).padStart(2,"0"),nt=String(et.getUTCDate()).padStart(2,"0"),it=String(et.getUTCHours()).padStart(2,"0"),ot=String(et.getUTCMinutes()).padStart(2,"0"),st=String(et.getUTCSeconds()).padStart(2,"0"),at=et.getUTCMilliseconds()*1e3*1e3;return`${tt}-${rt}-${nt}T${it}:${ot}:${st}.${at}Z`},utils$7.parseRFC3339=et=>{const tt=new RegExp("(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z"),rt=String(et).trim().match(tt);if(!rt)throw new Error("Invalid format");const nt=parseInt(rt[1],10),it=parseInt(rt[2],10)-1,ot=parseInt(rt[3],10),st=parseInt(rt[4],10),at=parseInt(rt[5],10),ct=parseInt(rt[6],10),ut=parseInt(rt[7].slice(0,-6),10);return new Date(Date.UTC(nt,it,ot,st,at,ct,ut))};const{Record:PBRecord}=record$1,utils$6=utils$7;class Record{constructor(tt,rt,nt){if(!(tt instanceof Uint8Array))throw new Error("key must be a Uint8Array");if(!(rt instanceof Uint8Array))throw new Error("value must be a Uint8Array");this.key=tt,this.value=rt,this.timeReceived=nt}serialize(){return PBRecord.encode(this.prepareSerialize()).finish()}prepareSerialize(){return{key:this.key,value:this.value,timeReceived:this.timeReceived&&utils$6.toRFC3339(this.timeReceived)}}static deserialize(tt){const rt=PBRecord.decode(tt);return Record.fromDeserialized(PBRecord.toObject(rt,{defaults:!1,arrays:!0,longs:Number,objects:!1}))}static fromDeserialized(tt){let rt;return tt.timeReceived&&(rt=utils$6.parseRFC3339(tt.timeReceived)),new Record(tt.key,tt.value,rt)}}var record=Record,publicKey$1,hasRequiredPublicKey$1;function requirePublicKey$1(){if(hasRequiredPublicKey$1)return publicKey$1;hasRequiredPublicKey$1=1;const{sha256:et}=require$$1$4,tt=errCode$i,{toString:rt}=require$$1$2,{equals:nt}=require$$1$3;return publicKey$1={func:async(it,ot)=>{if(!(it instanceof Uint8Array))throw tt(new Error('"key" must be a Uint8Array'),"ERR_INVALID_RECORD_KEY_NOT_BUFFER");if(it.byteLength<5)throw tt(new Error("invalid public key record"),"ERR_INVALID_RECORD_KEY_TOO_SHORT");if(rt(it.subarray(0,4))!=="/pk/")throw tt(new Error("key was not prefixed with /pk/"),"ERR_INVALID_RECORD_KEY_BAD_PREFIX");const st=it.slice(4),at=await et.digest(ot);if(!nt(st,at.bytes))throw tt(new Error("public key does not match passed in key"),"ERR_INVALID_RECORD_HASH_MISMATCH")},sign:!1},publicKey$1}var validators,hasRequiredValidators;function requireValidators(){return hasRequiredValidators||(hasRequiredValidators=1,validators={pk:requirePublicKey$1()}),validators}const errcode$8=errCode$i,{toString:uint8ArrayToString$7}=require$$1$2,verifyRecord=(et,tt)=>{const rt=tt.key,nt=uint8ArrayToString$7(rt).split("/");if(nt.length<3)return;const it=et[nt[1].toString()];if(!it){const ot="Invalid record keytype";throw errcode$8(new Error(ot),"ERR_INVALID_RECORD_KEY_TYPE")}return it.func(rt,tt.value)};var validator={verifyRecord,validators:requireValidators()},publicKey,hasRequiredPublicKey;function requirePublicKey(){return hasRequiredPublicKey||(hasRequiredPublicKey=1,publicKey=(et,tt)=>0),publicKey}var selectors,hasRequiredSelectors;function requireSelectors(){return hasRequiredSelectors||(hasRequiredSelectors=1,selectors={pk:requirePublicKey()}),selectors}const errcode$7=errCode$i,{toString:uint8ArrayToString$6}=require$$1$2,bestRecord=(et,tt,rt)=>{if(rt.length===0){const ot="No records given";throw errcode$7(new Error(ot),"ERR_NO_RECORDS_RECEIVED")}const nt=uint8ArrayToString$6(tt).split("/");if(nt.length<3){const ot="Record key does not have a selector function";throw errcode$7(new Error(ot),"ERR_NO_SELECTOR_FUNCTION_FOR_RECORD_KEY")}const it=et[nt[1].toString()];if(!it){const ot=`Unrecognized key prefix: ${nt[1]}`;throw errcode$7(new Error(ot),"ERR_UNRECOGNIZED_KEY_PREFIX")}return rt.length===1?0:it(tt,rt)};var selection={bestRecord,selectors:requireSelectors()},src$5={Record:record,validator,selection};const ipns=src$7,uint8ArrayToString$5=toString_1;var utils$5={encodeBase32:et=>uint8ArrayToString$5(et,"base32upper"),validator:{func:(et,tt)=>ipns.validator.validate(tt,et)},selector:(et,tt)=>ipns.validator.select(tt[0],tt[1])};(function(et,tt){const{Key:rt}=src$a,{Record:nt}=src$5,{encodeBase32:it}=utils$5,ot=errCode$i,st=browserExports,at=Object.assign(st("ipfs:ipns:offline-datastore"),{error:st("ipfs:ipns:offline-datastore:error")});class ct{constructor(lt){this._repo=lt,this.stores=[]}async put(lt,ht){if(!(lt instanceof Uint8Array))throw ot(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");if(!(ht instanceof Uint8Array))throw ot(new Error("Offline datastore value must be a Uint8Array"),"ERR_INVALID_VALUE");let ft;try{ft=this._routingKey(lt)}catch(pt){throw at.error(pt),ot(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}const dt=new nt(lt,ht);return this._repo.datastore.put(ft,dt.serialize())}async get(lt){if(!(lt instanceof Uint8Array))throw ot(new Error("Offline datastore key must be a Uint8Array"),"ERR_INVALID_KEY");let ht;try{ht=this._routingKey(lt)}catch(pt){throw at.error(pt),ot(new Error("Not possible to generate the routing key"),"ERR_GENERATING_ROUTING_KEY")}const ft=await this._repo.datastore.get(ht);let dt;try{dt=nt.deserialize(ft)}catch(pt){throw at.error(pt),pt}return dt.value}_routingKey(lt){return new rt("/"+it(lt),!1)}}et.exports=ct})(offlineDatastore),browserExports("ipfs:components:ipns");var utils$4={},hasRequiredUtils$1;function requireUtils$1(){if(hasRequiredUtils$1)return utils$4;hasRequiredUtils$1=1;const et=src$d,tt=toCidAndPath_1,rt=itDrain,{resolve:nt}=utils$c;return utils$4.resolvePath=async({ipns:it,repo:ot,codecs:st},at,ct)=>{if(et.ipnsPath(at))return it.resolve(at);const{cid:ut,path:lt}=tt(at);await rt(nt(ut,lt||"",st,ot,ct))},utils$4}const debug$9=browserExports;Object.assign(debug$9("ipfs:name:publish"),{error:debug$9("ipfs:name:publish:error")}),requireUtils$1();const debug$8=browserExports;mergeOptions.bind({ignoreUndefined:!0}),Object.assign(debug$8("ipfs:name:resolve"),{error:debug$8("ipfs:name:resolve:error")});var refs={exports:{}};const dagPb$2=require$$5,{Errors}=src$a,ERR_NOT_FOUND=Errors.notFoundError().code,withTimeoutOption$1=withTimeoutOption_1,toCIDAndPath=toCidAndPath_1,{CID:CID$1}=require$$6$2,Format={default:"<dst>",edges:"<src> -> <dst>"};refs.exports=function({repo:et,codecs:tt,resolve:rt,preload:nt}){async function*it(ot,st={}){if(st.maxDepth===0)return;if(st.edges&&st.format&&st.format!==Format.default)throw new Error("Cannot set edges to true and also specify format");st.format=st.edges?Format.edges:st.format,typeof st.maxDepth!="number"&&(st.maxDepth=st.recursive?1/0:1);const at=(Array.isArray(ot)?ot:[ot]).map(ct=>getFullPath(nt,ct,st));for(const ct of at)yield*refsStream(rt,et,tt,ct,st)}return withTimeoutOption$1(it)},refs.exports.Format=Format;function getFullPath(et,tt,rt){const{cid:nt,path:it}=toCIDAndPath(tt);return rt.preload!==!1&&et(nt),`/ipfs/${nt}${it||""}`}async function*refsStream(et,tt,rt,nt,it){const ot=await et(nt),{cid:st}=toCIDAndPath(ot),at=it.maxDepth!=null?it.maxDepth:1/0,ct=it.unique||!1;for await(const ut of objectStream(tt,rt,st,at,ct))ut.parent&&(ut.isDuplicate||(yield{ref:formatLink(ut.parent.cid,ut.node.cid,ut.node.name,it.format)}))}function formatLink(et,tt,rt="",nt=Format.default){let it=nt.replace(/<src>/g,et.toString());return it=it.replace(/<dst>/g,tt.toString()),it=it.replace(/<linkname>/g,rt),it}async function*objectStream(et,tt,rt,nt,it){const ot=new Set;async function*st(at,ct){const ut=ct+1;if(!(ut>nt))try{for await(const lt of getLinks(et,tt,at.cid))yield{parent:at,node:lt,isDuplicate:it&&ot.has(lt.cid.toString())},it&&ot.add(lt.cid.toString()),yield*st(lt,ut)}catch(lt){throw lt.code===ERR_NOT_FOUND&&(lt.message=`Could not find object with CID: ${at.cid}`),lt}}yield*st({cid:rt},0)}async function*getLinks(et,tt,rt,nt=[]){const it=await et.blocks.get(rt),ot=(await tt.getCodec(rt.code)).decode(it),st=rt.code===dagPb$2.code;for(const[at,ct]of links(ot,nt)){if(st){const ut=at.match(/^Links\/(\d+)\/Hash$/);if(ut){const lt=Number(ut[1]);if(lt<ot.Links.length){yield{name:ot.Links[lt].Name,cid:ct};continue}}}yield{name:at,cid:ct}}}const links=function*(et,tt){if(et!=null&&!(et instanceof Uint8Array)){for(const[rt,nt]of Object.entries(et)){const it=[...tt,rt];if(nt!=null&&typeof nt=="object")if(Array.isArray(nt))for(const[ot,st]of nt.entries()){const at=[...it,ot],ct=CID$1.asCID(st);ct?yield[at.join("/"),ct]:typeof st=="object"&&(yield*links(st,at))}else{const ot=CID$1.asCID(nt);ot?yield[it.join("/"),ot]:yield*links(nt,it)}}return[]}};src$e.IPFS.matches;var configBrowser=()=>({Addresses:{Swarm:[],Announce:[],NoAnnounce:[],API:"",Gateway:"",RPC:"",Delegates:["/dns4/node0.delegate.ipfs.io/tcp/443/https","/dns4/node1.delegate.ipfs.io/tcp/443/https","/dns4/node2.delegate.ipfs.io/tcp/443/https","/dns4/node3.delegate.ipfs.io/tcp/443/https"]},Discovery:{MDNS:{Enabled:!1,Interval:10},webRTCStar:{Enabled:!0}},Bootstrap:["/dnsaddr/bootstrap.libp2p.io/p2p/QmNnooDu7bfjPFoTZYxMNLWUQJyrVwtbZg5gBMjTezGAJN","/dnsaddr/bootstrap.libp2p.io/p2p/QmbLHAnMoJPWSCR5Zhtx6BHJX9KiKNN6tpvbUcqanj75Nb","/dnsaddr/bootstrap.libp2p.io/p2p/QmZa1sAxajnQjVM8WjWXoMbmPd7NsWhfKsPkErzpm9wGkp","/dnsaddr/bootstrap.libp2p.io/p2p/QmQCU2EcMqAqQPR2i9bChDtGNJchTbq5TbXJJ16u19uLTa","/dnsaddr/bootstrap.libp2p.io/p2p/QmcZf59bWwK5XFi76CZX8cbJ4BhTzzA3gU1ZjYZcYW3dwt","/dns4/node0.preload.ipfs.io/tcp/443/wss/p2p/QmZMxNdpMkewiVZLMRxaNxUeZpDUb34pWjZ1kZvsd16Zic","/dns4/node1.preload.ipfs.io/tcp/443/wss/p2p/Qmbut9Ywz9YEDrz8ySBSgWyJk41Uvm2QJPhwDJzJyGFsD6","/dns4/node2.preload.ipfs.io/tcp/443/wss/p2p/QmV7gnbW5VTcJ3oyM2Xk1rdFBJ3kTkvxc87UFGsun29STS","/dns4/node3.preload.ipfs.io/tcp/443/wss/p2p/QmY7JB6MQXhxHvq7dBDh4HpbH29v4yE9JRadAVpndvzySN"],Pubsub:{Enabled:!0},Swarm:{ConnMgr:{LowWater:200,HighWater:500},DisableNatPortMap:!0},Routing:{Type:"none"}}),dist={exports:{}};(function(et,tt){(function(rt,nt){nt(tt)})(commonjsGlobal,function(rt){async function*nt(Lt,Gt){let Xt=[];for await(const Yt of Gt)Xt.push(Yt),Xt.length===Lt&&(yield Xt,Xt=[]);Xt.length>0&&(yield Xt)}function*it(Lt,Gt){let Xt=[];for(const Yt of Gt)Xt.push(Yt),Xt.length===Lt&&(yield Xt,Xt=[]);Xt.length>0&&(yield Xt)}function ot(Lt,Gt){return Gt===void 0?Xt=>ot(Lt,Xt):Gt[Symbol.asyncIterator]?nt(Lt,Gt):it(Lt,Gt)}const st=Symbol("TIMEOUT"),at=Lt=>{let Gt;return[new Promise(Xt=>{Gt=setTimeout(()=>Xt(st),Lt)}),()=>{clearTimeout(Gt)}]};async function*ct(Lt,Gt,Xt){const Yt=Xt[Symbol.asyncIterator]();let He,ir=[],vt,Rt;const Bt=()=>{Nt(),[vt,Rt]=at(Gt)},Nt=()=>{Rt&&Rt(),vt=void 0};for(He=Yt.next();;){const Ot=await(vt?Promise.race([He,vt]):He);if(Ot===st||Ot.done){if(ir.length&&(yield ir,ir=[]),Nt(),Ot!==st)break;continue}if(He=Yt.next(),ir.push(Ot.value),ir.length===1&&Bt(),ir.length===Lt){yield ir,ir=[],Nt();continue}}}function ut(Lt,Gt,Xt){return Xt===void 0?Yt=>ut(Lt,Gt,Yt):Xt[Symbol.asyncIterator]&&Gt!==1/0?ct(Lt,Gt,Xt):ot(Lt,Xt)}function lt(Lt){if(typeof Lt.next=="function")return Lt;if(typeof Lt[Symbol.iterator]=="function")return Lt[Symbol.iterator]();if(typeof Lt[Symbol.asyncIterator]=="function")return Lt[Symbol.asyncIterator]();throw new TypeError('"values" does not to conform to any of the iterator or iterable protocols')}function ht(){let Lt,Gt;return{promise:new Promise((Xt,Yt)=>{Gt=Xt,Lt=Yt}),reject:Lt,resolve:Gt}}function ft(Lt,Gt){const Xt=lt(Gt),Yt=[],He=[];let ir=!1,vt=!1;function Rt(){for(;He.length>0&&Yt.length>0;){const Kt=He.shift(),{error:$e,value:nr}=Yt.shift();$e?Kt.reject($e):Kt.resolve({done:!1,value:nr})}for(;He.length>0&&vt;){const{resolve:Kt}=He.shift();Kt({done:!0,value:void 0})}}async function Bt(){if(!vt&&!ir&&!(Yt.length>=Lt)){ir=!0;try{const{done:Kt,value:$e}=await Xt.next();Kt?vt=!0:Yt.push({value:$e})}catch(Kt){vt=!0,Yt.push({error:Kt})}Rt(),ir=!1,Bt()}}async function Nt(){if(Yt.length>0){const{error:$e,value:nr}=Yt.shift();if($e)throw $e;return Bt(),{done:!1,value:nr}}if(vt)return{done:!0,value:void 0};const Kt=ht();return He.push(Kt),Bt(),Kt.promise}const Ot={next:Nt,[Symbol.asyncIterator]:()=>Ot};return Ot}function*dt(Lt,Gt){const Xt=[];let Yt;try{for(const He of Gt)Xt.push(He),!(Xt.length<=Lt)&&(yield Xt.shift())}catch(He){Yt=He}for(const He of Xt)yield He;if(Yt)throw Yt}function pt(Lt,Gt){return Gt===void 0?Xt=>pt(Lt,Xt):Lt===0?Gt:Gt[Symbol.asyncIterator]?ft(Lt,Gt):dt(Lt,Gt)}async function gt(Lt){const Gt=[];for await(const Xt of Lt)Gt.push(Xt);return Gt}function _t(Lt){return Lt[Symbol.asyncIterator]?gt(Lt):Array.from(Lt)}async function*mt(Lt){for await(const Gt of Lt)yield*Gt}function*At(Lt){for(const Gt of Lt)yield*Gt}function It(...Lt){return Lt.find(Gt=>Gt[Symbol.asyncIterator]!==void 0)?mt(Lt):At(Lt)}async function Mt(Lt){for await(const Gt of Lt);}function kt(Lt){if(Lt[Symbol.asyncIterator])return Mt(Lt);for(const Gt of Lt);}async function*Ct(Lt,Gt){for await(const Xt of Gt)await Lt(Xt)&&(yield Xt)}function Ut(Lt,Gt){return Gt===void 0?Xt=>Ct(Lt,Xt):Ct(Lt,Gt)}async function*Wt(Lt){for await(const Gt of Lt)Gt&&typeof Gt!="string"&&(Gt[Symbol.iterator]||Gt[Symbol.asyncIterator])?yield*Wt(Gt):yield Gt}async function*Ft(Lt,Gt){for await(const Xt of Gt)yield await Lt(Xt)}function Ce(Lt,Gt){return Gt===void 0?Xt=>Ft(Lt,Xt):Ft(Lt,Gt)}function bt(Lt,Gt){return Gt===void 0?Xt=>bt(Lt,Xt):Ut(Xt=>Xt!=null,Wt(Ce(Lt,Gt)))}function yt(Lt,Gt,Xt){const Yt=lt(Xt),He=[],ir=[];let vt=!1,Rt=!1,Bt=0,Nt=null;function Ot(){for(;ir.length>0&&He.length>0;){const{resolve:tr}=ir.shift(),lr=He.shift();tr({done:!1,value:lr})}for(;ir.length>0&&Bt===0&&vt;){const{resolve:tr,reject:lr}=ir.shift();Nt?(lr(Nt),Nt=null):tr({done:!0,value:void 0})}}async function Kt(){if(vt){Ot();return}if(!Rt&&!(Bt+He.length>=Lt)){Rt=!0,Bt++;try{const{done:tr,value:lr}=await Yt.next();tr?(vt=!0,Bt--,Ot()):$e(lr)}catch(tr){vt=!0,Bt--,Nt=tr,Ot()}Rt=!1,Kt()}}async function $e(tr){try{const lr=await Gt(tr);if(lr&&lr[Symbol.asyncIterator])for await(const dr of lr)He.push(dr);else He.push(lr)}catch(lr){vt=!0,Nt=lr}Bt--,Ot(),Kt()}async function nr(){if(He.length===0){const lr=ht();return ir.push(lr),Kt(),lr.promise}const tr=He.shift();return Kt(),{done:!1,value:tr}}const Ze={next:nr,[Symbol.asyncIterator]:()=>Ze};return Ze}function $t(Lt,Gt,Xt){return Gt===void 0?(Yt,He)=>He?$t(Lt,Yt,He):$t(Lt,Yt):Xt===void 0?Yt=>$t(Lt,Gt,Yt):Ut(Yt=>Yt!=null,Wt(yt(Lt,Gt,Xt)))}async function Et(Lt){return new Promise(Gt=>{Lt.once("readable",()=>{Gt()})})}async function*Tt(Lt){for(;;){const Gt=Lt.read();if(Gt!==null){yield Gt;continue}if(Lt._readableState.ended)break;await Et(Lt)}}function Pt(Lt){return typeof Lt[Symbol.asyncIterator]=="function"?Lt:Tt(Lt)}async function*St(...Lt){const Gt=new Set(Lt.map(lt));for(;Gt.size>0;)for(const Xt of Gt){const Yt=await Xt.next();Yt.done?Gt.delete(Xt):yield Yt.value}}function Dt(Lt,...Gt){let Xt=Lt();for(const Yt of Gt)Xt=Yt(Xt);return Xt}async function*wt(Lt,Gt,Xt){let Yt=null;const He=Bt=>({value:Gt(Bt)}),ir=async function*(Bt){for await(const Nt of Bt){if(Yt)return;yield Nt}},vt=Dt(()=>Xt,pt(1),ir,Ce(He),pt(Lt-1)),Rt=lt(vt);for(;;){const{value:Bt,done:Nt}=await Rt.next();if(Nt)break;try{const Ot=await Bt.value;Yt||(yield Ot)}catch(Ot){Yt=Ot}}if(Yt)throw Yt}function xt(Lt,Gt,Xt){return Gt===void 0?(Yt,He)=>xt(Lt,Yt,He):Xt===void 0?Yt=>xt(Lt,Gt,Yt):Lt===1?Ce(Gt,Xt):wt(Lt,Gt,Xt)}function Ke(Lt,Gt,Xt){return Gt===void 0?(Yt,He)=>He?Ke(Lt,Yt,He):Ke(Lt,Yt):Xt===void 0?Yt=>Ke(Lt,Gt,Yt):Ut(Yt=>Yt!=null,Wt(xt(Lt,Gt,Xt)))}async function*Pe(...Lt){const Gt=Lt.map(lt),Xt=new Set,Yt=new Map;let He=null,ir=null,vt=null;const Rt=Kt=>{He=Kt,ir&&ir(Kt)},Bt=Kt=>{vt&&vt(Kt)},Nt=()=>new Promise((Kt,$e)=>{if(He&&$e(He),Yt.size>0)return Kt();vt=Kt,ir=$e}),Ot=Kt=>{const $e=Promise.resolve(Kt.next()).then(async({done:nr,value:Ze})=>{nr||Yt.set(Kt,Ze),Xt.delete($e)});Xt.add($e),$e.then(Bt,Rt)};for(const Kt of Gt)Ot(Kt);for(;;){if(Xt.size===0&&Yt.size===0)return;await Nt();for(const[Kt,$e]of Yt)Yt.delete(Kt),yield $e,Ot(Kt)}}async function Ht(Lt,Gt,Xt){let Yt=Gt;for await(const He of Xt)Yt=await Lt(Yt,He);return Yt}function zt(Lt,Gt,Xt){return Gt===void 0?(Yt,He)=>He?Ht(Lt,Yt,He):zt(Lt,Yt):Xt===void 0?Yt=>zt(Lt,Gt,Yt):Ht(Lt,Gt,Xt)}async function*jt(Lt,Gt){let Xt=0;for await(const Yt of Gt)if(yield await Yt,Xt++,Xt>=Lt)break}function*qt(Lt,Gt){let Xt=0;for(const Yt of Gt)if(yield Yt,Xt++,Xt>=Lt)break}function Ge(Lt,Gt){return Gt===void 0?Xt=>Ge(Lt,Xt):Gt[Symbol.asyncIterator]?jt(Lt,Gt):qt(Lt,Gt)}async function*Ie(Lt,Gt){for await(const Xt of Gt)await Lt(Xt),yield Xt}function Xe(Lt,Gt){return Gt===void 0?Xt=>Ie(Lt,Xt):Ie(Lt,Gt)}const Je=Lt=>new Promise(Gt=>setTimeout(Gt,Lt));function Qe(Lt,Gt,Xt){if(!Number.isFinite(Lt))throw new TypeError("Expected `limit` to be a finite number");if(Lt<=0)throw new TypeError("Expected `limit` to be greater than 0");if(!Number.isFinite(Gt))throw new TypeError("Expected `interval` to be a finite number");return async function*(){let Yt=0,He;for await(const ir of Xt){if(Yt<Lt){typeof He>"u"&&(He=Date.now()),Yt++,yield ir;continue}const vt=Date.now()-He,Rt=Gt-vt;Rt>0&&await Je(Rt),He=Date.now(),Yt=1,yield ir}}()}function We(Lt,Gt,Xt){return Xt===void 0?Yt=>Qe(Lt,Gt,Yt):Qe(Lt,Gt,Xt)}function ur(Lt,Gt){let Xt=Lt[0]+Gt[0],Yt=Lt[1]+Gt[1];if(Yt>=1e9){const He=Yt%1e9;Xt+=(Yt-He)/1e9,Yt=He}return[Xt,Yt]}async function*ar(Lt,Gt){const Xt=Gt[Symbol.asyncIterator]();let Yt=[0,0];for(;;){const He=process.hrtime(),{value:ir,done:vt}=await Xt.next(),Rt=process.hrtime(He);if(Yt=ur(Yt,Rt),Lt.progress&&Lt.progress(Rt,Yt),vt)return Lt.total&&Lt.total(Yt),ir;yield ir}}function*cr(Lt,Gt){const Xt=Gt[Symbol.iterator]();let Yt=[0,0];for(;;){const He=process.hrtime(),{value:ir,done:vt}=Xt.next(),Rt=process.hrtime(He);if(Yt=ur(Yt,Rt),Lt.progress&&Lt.progress(Rt,Yt),vt)return Lt.total&&Lt.total(Yt),ir;yield ir}}function $r(Lt={},Gt){return Gt===void 0?Xt=>$r(Lt,Xt):Gt[Symbol.asyncIterator]!==void 0?ar(Lt,Gt):cr(Lt,Gt)}function fr(Lt,Gt,Xt){const Yt=lt(Xt),He=[],ir=[];let vt=!1,Rt=!1,Bt=0,Nt=null;function Ot(){for(;ir.length>0&&He.length>0;){const{resolve:tr}=ir.shift(),lr=He.shift();tr({done:!1,value:lr})}for(;ir.length>0&&Bt===0&&vt;){const{resolve:tr,reject:lr}=ir.shift();Nt?(lr(Nt),Nt=null):tr({done:!0,value:void 0})}}async function Kt(){if(vt){Ot();return}if(!Rt&&!(Bt+He.length>=Lt)){Rt=!0,Bt++;try{const{done:tr,value:lr}=await Yt.next();tr?(vt=!0,Bt--,Ot()):$e(lr)}catch(tr){vt=!0,Bt--,Nt=tr,Ot()}Rt=!1,Kt()}}async function $e(tr){try{const lr=await Gt(tr);He.push(lr)}catch(lr){vt=!0,Nt=lr}Bt--,Ot(),Kt()}async function nr(){if(He.length===0){const lr=ht();return ir.push(lr),Kt(),lr.promise}const tr=He.shift();return Kt(),{done:!1,value:tr}}const Ze={next:nr,[Symbol.asyncIterator]:()=>Ze};return Ze}function ue(Lt,Gt,Xt){return Gt===void 0?(Yt,He)=>He?ue(Lt,Yt,He):ue(Lt,Yt):Xt===void 0?Yt=>ue(Lt,Gt,Yt):fr(Lt,Gt,Xt)}async function Qt(Lt,Gt){let Xt=null,Yt=null,He=null;const ir=Nt=>{Xt=Nt,Yt&&Yt(Nt)},vt=()=>{He&&He()},Rt=()=>{Lt.removeListener("error",ir),Lt.removeListener("drain",vt)};Lt.once("error",ir);const Bt=()=>new Promise((Nt,Ot)=>{if(Xt)return Ot(Xt);Lt.once("drain",vt),He=Nt,Yt=Ot});for await(const Nt of Gt)if(Lt.write(Nt)===!1&&await Bt(),Xt)break;if(Rt(),Xt)throw Xt}function me(Lt,Gt){return Gt===void 0?Xt=>Qt(Lt,Xt):Qt(Lt,Gt)}rt.batch=ot,rt.batchWithTimeout=ut,rt.buffer=pt,rt.collect=_t,rt.concat=It,rt.consume=kt,rt.filter=Ut,rt.flatMap=bt,rt.flatTransform=$t,rt.flatten=Wt,rt.fromStream=Pt,rt.getIterator=lt,rt.map=Ce,rt.merge=St,rt.parallelFlatMap=Ke,rt.parallelMap=xt,rt.parallelMerge=Pe,rt.pipeline=Dt,rt.reduce=zt,rt.take=Ge,rt.tap=Xe,rt.throttle=We,rt.time=$r,rt.transform=ue,rt.writeToStream=me,Object.defineProperty(rt,"__esModule",{value:!0})})})(dist,dist.exports);var murmurHash3js={exports:{}};(function(et,tt){(function(rt,nt){var it={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function ot(gt){if(!Array.isArray(gt)&&!ArrayBuffer.isView(gt))return!1;for(var _t=0;_t<gt.length;_t++)if(!Number.isInteger(gt[_t])||gt[_t]<0||gt[_t]>255)return!1;return!0}function st(gt,_t){return(gt&65535)*_t+(((gt>>>16)*_t&65535)<<16)}function at(gt,_t){return gt<<_t|gt>>>32-_t}function ct(gt){return gt^=gt>>>16,gt=st(gt,2246822507),gt^=gt>>>13,gt=st(gt,3266489909),gt^=gt>>>16,gt}function ut(gt,_t){gt=[gt[0]>>>16,gt[0]&65535,gt[1]>>>16,gt[1]&65535],_t=[_t[0]>>>16,_t[0]&65535,_t[1]>>>16,_t[1]&65535];var mt=[0,0,0,0];return mt[3]+=gt[3]+_t[3],mt[2]+=mt[3]>>>16,mt[3]&=65535,mt[2]+=gt[2]+_t[2],mt[1]+=mt[2]>>>16,mt[2]&=65535,mt[1]+=gt[1]+_t[1],mt[0]+=mt[1]>>>16,mt[1]&=65535,mt[0]+=gt[0]+_t[0],mt[0]&=65535,[mt[0]<<16|mt[1],mt[2]<<16|mt[3]]}function lt(gt,_t){gt=[gt[0]>>>16,gt[0]&65535,gt[1]>>>16,gt[1]&65535],_t=[_t[0]>>>16,_t[0]&65535,_t[1]>>>16,_t[1]&65535];var mt=[0,0,0,0];return mt[3]+=gt[3]*_t[3],mt[2]+=mt[3]>>>16,mt[3]&=65535,mt[2]+=gt[2]*_t[3],mt[1]+=mt[2]>>>16,mt[2]&=65535,mt[2]+=gt[3]*_t[2],mt[1]+=mt[2]>>>16,mt[2]&=65535,mt[1]+=gt[1]*_t[3],mt[0]+=mt[1]>>>16,mt[1]&=65535,mt[1]+=gt[2]*_t[2],mt[0]+=mt[1]>>>16,mt[1]&=65535,mt[1]+=gt[3]*_t[1],mt[0]+=mt[1]>>>16,mt[1]&=65535,mt[0]+=gt[0]*_t[3]+gt[1]*_t[2]+gt[2]*_t[1]+gt[3]*_t[0],mt[0]&=65535,[mt[0]<<16|mt[1],mt[2]<<16|mt[3]]}function ht(gt,_t){return _t%=64,_t===32?[gt[1],gt[0]]:_t<32?[gt[0]<<_t|gt[1]>>>32-_t,gt[1]<<_t|gt[0]>>>32-_t]:(_t-=32,[gt[1]<<_t|gt[0]>>>32-_t,gt[0]<<_t|gt[1]>>>32-_t])}function ft(gt,_t){return _t%=64,_t===0?gt:_t<32?[gt[0]<<_t|gt[1]>>>32-_t,gt[1]<<_t]:[gt[1]<<_t-32,0]}function dt(gt,_t){return[gt[0]^_t[0],gt[1]^_t[1]]}function pt(gt){return gt=dt(gt,[0,gt[0]>>>1]),gt=lt(gt,[4283543511,3981806797]),gt=dt(gt,[0,gt[0]>>>1]),gt=lt(gt,[3301882366,444984403]),gt=dt(gt,[0,gt[0]>>>1]),gt}it.x86.hash32=function(gt,_t){if(it.inputValidation&&!ot(gt))return nt;_t=_t||0;for(var mt=gt.length%4,At=gt.length-mt,It=_t,Mt=0,kt=3432918353,Ct=461845907,Ut=0;Ut<At;Ut=Ut+4)Mt=gt[Ut]|gt[Ut+1]<<8|gt[Ut+2]<<16|gt[Ut+3]<<24,Mt=st(Mt,kt),Mt=at(Mt,15),Mt=st(Mt,Ct),It^=Mt,It=at(It,13),It=st(It,5)+3864292196;switch(Mt=0,mt){case 3:Mt^=gt[Ut+2]<<16;case 2:Mt^=gt[Ut+1]<<8;case 1:Mt^=gt[Ut],Mt=st(Mt,kt),Mt=at(Mt,15),Mt=st(Mt,Ct),It^=Mt}return It^=gt.length,It=ct(It),It>>>0},it.x86.hash128=function(gt,_t){if(it.inputValidation&&!ot(gt))return nt;_t=_t||0;for(var mt=gt.length%16,At=gt.length-mt,It=_t,Mt=_t,kt=_t,Ct=_t,Ut=0,Wt=0,Ft=0,Ce=0,bt=597399067,yt=2869860233,$t=951274213,Et=2716044179,Tt=0;Tt<At;Tt=Tt+16)Ut=gt[Tt]|gt[Tt+1]<<8|gt[Tt+2]<<16|gt[Tt+3]<<24,Wt=gt[Tt+4]|gt[Tt+5]<<8|gt[Tt+6]<<16|gt[Tt+7]<<24,Ft=gt[Tt+8]|gt[Tt+9]<<8|gt[Tt+10]<<16|gt[Tt+11]<<24,Ce=gt[Tt+12]|gt[Tt+13]<<8|gt[Tt+14]<<16|gt[Tt+15]<<24,Ut=st(Ut,bt),Ut=at(Ut,15),Ut=st(Ut,yt),It^=Ut,It=at(It,19),It+=Mt,It=st(It,5)+1444728091,Wt=st(Wt,yt),Wt=at(Wt,16),Wt=st(Wt,$t),Mt^=Wt,Mt=at(Mt,17),Mt+=kt,Mt=st(Mt,5)+197830471,Ft=st(Ft,$t),Ft=at(Ft,17),Ft=st(Ft,Et),kt^=Ft,kt=at(kt,15),kt+=Ct,kt=st(kt,5)+2530024501,Ce=st(Ce,Et),Ce=at(Ce,18),Ce=st(Ce,bt),Ct^=Ce,Ct=at(Ct,13),Ct+=It,Ct=st(Ct,5)+850148119;switch(Ut=0,Wt=0,Ft=0,Ce=0,mt){case 15:Ce^=gt[Tt+14]<<16;case 14:Ce^=gt[Tt+13]<<8;case 13:Ce^=gt[Tt+12],Ce=st(Ce,Et),Ce=at(Ce,18),Ce=st(Ce,bt),Ct^=Ce;case 12:Ft^=gt[Tt+11]<<24;case 11:Ft^=gt[Tt+10]<<16;case 10:Ft^=gt[Tt+9]<<8;case 9:Ft^=gt[Tt+8],Ft=st(Ft,$t),Ft=at(Ft,17),Ft=st(Ft,Et),kt^=Ft;case 8:Wt^=gt[Tt+7]<<24;case 7:Wt^=gt[Tt+6]<<16;case 6:Wt^=gt[Tt+5]<<8;case 5:Wt^=gt[Tt+4],Wt=st(Wt,yt),Wt=at(Wt,16),Wt=st(Wt,$t),Mt^=Wt;case 4:Ut^=gt[Tt+3]<<24;case 3:Ut^=gt[Tt+2]<<16;case 2:Ut^=gt[Tt+1]<<8;case 1:Ut^=gt[Tt],Ut=st(Ut,bt),Ut=at(Ut,15),Ut=st(Ut,yt),It^=Ut}return It^=gt.length,Mt^=gt.length,kt^=gt.length,Ct^=gt.length,It+=Mt,It+=kt,It+=Ct,Mt+=It,kt+=It,Ct+=It,It=ct(It),Mt=ct(Mt),kt=ct(kt),Ct=ct(Ct),It+=Mt,It+=kt,It+=Ct,Mt+=It,kt+=It,Ct+=It,("00000000"+(It>>>0).toString(16)).slice(-8)+("00000000"+(Mt>>>0).toString(16)).slice(-8)+("00000000"+(kt>>>0).toString(16)).slice(-8)+("00000000"+(Ct>>>0).toString(16)).slice(-8)},it.x64.hash128=function(gt,_t){if(it.inputValidation&&!ot(gt))return nt;_t=_t||0;for(var mt=gt.length%16,At=gt.length-mt,It=[0,_t],Mt=[0,_t],kt=[0,0],Ct=[0,0],Ut=[2277735313,289559509],Wt=[1291169091,658871167],Ft=0;Ft<At;Ft=Ft+16)kt=[gt[Ft+4]|gt[Ft+5]<<8|gt[Ft+6]<<16|gt[Ft+7]<<24,gt[Ft]|gt[Ft+1]<<8|gt[Ft+2]<<16|gt[Ft+3]<<24],Ct=[gt[Ft+12]|gt[Ft+13]<<8|gt[Ft+14]<<16|gt[Ft+15]<<24,gt[Ft+8]|gt[Ft+9]<<8|gt[Ft+10]<<16|gt[Ft+11]<<24],kt=lt(kt,Ut),kt=ht(kt,31),kt=lt(kt,Wt),It=dt(It,kt),It=ht(It,27),It=ut(It,Mt),It=ut(lt(It,[0,5]),[0,1390208809]),Ct=lt(Ct,Wt),Ct=ht(Ct,33),Ct=lt(Ct,Ut),Mt=dt(Mt,Ct),Mt=ht(Mt,31),Mt=ut(Mt,It),Mt=ut(lt(Mt,[0,5]),[0,944331445]);switch(kt=[0,0],Ct=[0,0],mt){case 15:Ct=dt(Ct,ft([0,gt[Ft+14]],48));case 14:Ct=dt(Ct,ft([0,gt[Ft+13]],40));case 13:Ct=dt(Ct,ft([0,gt[Ft+12]],32));case 12:Ct=dt(Ct,ft([0,gt[Ft+11]],24));case 11:Ct=dt(Ct,ft([0,gt[Ft+10]],16));case 10:Ct=dt(Ct,ft([0,gt[Ft+9]],8));case 9:Ct=dt(Ct,[0,gt[Ft+8]]),Ct=lt(Ct,Wt),Ct=ht(Ct,33),Ct=lt(Ct,Ut),Mt=dt(Mt,Ct);case 8:kt=dt(kt,ft([0,gt[Ft+7]],56));case 7:kt=dt(kt,ft([0,gt[Ft+6]],48));case 6:kt=dt(kt,ft([0,gt[Ft+5]],40));case 5:kt=dt(kt,ft([0,gt[Ft+4]],32));case 4:kt=dt(kt,ft([0,gt[Ft+3]],24));case 3:kt=dt(kt,ft([0,gt[Ft+2]],16));case 2:kt=dt(kt,ft([0,gt[Ft+1]],8));case 1:kt=dt(kt,[0,gt[Ft]]),kt=lt(kt,Ut),kt=ht(kt,31),kt=lt(kt,Wt),It=dt(It,kt)}return It=dt(It,[0,gt.length]),Mt=dt(Mt,[0,gt.length]),It=ut(It,Mt),Mt=ut(Mt,It),It=pt(It),Mt=pt(Mt),It=ut(It,Mt),Mt=ut(Mt,It),("00000000"+(It[0]>>>0).toString(16)).slice(-8)+("00000000"+(It[1]>>>0).toString(16)).slice(-8)+("00000000"+(Mt[0]>>>0).toString(16)).slice(-8)+("00000000"+(Mt[1]>>>0).toString(16)).slice(-8)},et.exports&&(tt=et.exports=it),tt.murmurHash3=it})()})(murmurHash3js,murmurHash3js.exports);var murmurHash3jsExports=murmurHash3js.exports,murmurhash3jsRevisited=murmurHash3jsExports;const{bases:bases$3}=require$$8;function createCodec$2(et,tt,rt,nt){return{name:et,prefix:tt,encoder:{name:et,prefix:tt,encode:rt},decoder:{decode:nt}}}const string$2=createCodec$2("utf8","u",et=>"u"+new TextDecoder("utf8").decode(et),et=>new TextEncoder().encode(et.substring(1))),ascii$2=createCodec$2("ascii","a",et=>{let tt="a";for(let rt=0;rt<et.length;rt++)tt+=String.fromCharCode(et[rt]);return tt},et=>{et=et.substring(1);const tt=new Uint8Array(et.length);for(let rt=0;rt<et.length;rt++)tt[rt]=et.charCodeAt(rt);return tt});({hex:bases$3.base16,...bases$3},mergeOptions.bind({ignoreUndefined:!0}));var buffer={},base64Js={},hasRequiredBase64Js;function requireBase64Js(){if(hasRequiredBase64Js)return base64Js;hasRequiredBase64Js=1,base64Js.byteLength=at,base64Js.toByteArray=ut,base64Js.fromByteArray=ft;for(var et=[],tt=[],rt=typeof Uint8Array<"u"?Uint8Array:Array,nt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",it=0,ot=nt.length;it<ot;++it)et[it]=nt[it],tt[nt.charCodeAt(it)]=it;tt["-".charCodeAt(0)]=62,tt["_".charCodeAt(0)]=63;function st(dt){var pt=dt.length;if(pt%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var gt=dt.indexOf("=");gt===-1&&(gt=pt);var _t=gt===pt?0:4-gt%4;return[gt,_t]}function at(dt){var pt=st(dt),gt=pt[0],_t=pt[1];return(gt+_t)*3/4-_t}function ct(dt,pt,gt){return(pt+gt)*3/4-gt}function ut(dt){var pt,gt=st(dt),_t=gt[0],mt=gt[1],At=new rt(ct(dt,_t,mt)),It=0,Mt=mt>0?_t-4:_t,kt;for(kt=0;kt<Mt;kt+=4)pt=tt[dt.charCodeAt(kt)]<<18|tt[dt.charCodeAt(kt+1)]<<12|tt[dt.charCodeAt(kt+2)]<<6|tt[dt.charCodeAt(kt+3)],At[It++]=pt>>16&255,At[It++]=pt>>8&255,At[It++]=pt&255;return mt===2&&(pt=tt[dt.charCodeAt(kt)]<<2|tt[dt.charCodeAt(kt+1)]>>4,At[It++]=pt&255),mt===1&&(pt=tt[dt.charCodeAt(kt)]<<10|tt[dt.charCodeAt(kt+1)]<<4|tt[dt.charCodeAt(kt+2)]>>2,At[It++]=pt>>8&255,At[It++]=pt&255),At}function lt(dt){return et[dt>>18&63]+et[dt>>12&63]+et[dt>>6&63]+et[dt&63]}function ht(dt,pt,gt){for(var _t,mt=[],At=pt;At<gt;At+=3)_t=(dt[At]<<16&16711680)+(dt[At+1]<<8&65280)+(dt[At+2]&255),mt.push(lt(_t));return mt.join("")}function ft(dt){for(var pt,gt=dt.length,_t=gt%3,mt=[],At=16383,It=0,Mt=gt-_t;It<Mt;It+=At)mt.push(ht(dt,It,It+At>Mt?Mt:It+At));return _t===1?(pt=dt[gt-1],mt.push(et[pt>>2]+et[pt<<4&63]+"==")):_t===2&&(pt=(dt[gt-2]<<8)+dt[gt-1],mt.push(et[pt>>10]+et[pt>>4&63]+et[pt<<2&63]+"=")),mt.join("")}return base64Js}var ieee754={},hasRequiredIeee754;function requireIeee754(){return hasRequiredIeee754||(hasRequiredIeee754=1,ieee754.read=function(et,tt,rt,nt,it){var ot,st,at=it*8-nt-1,ct=(1<<at)-1,ut=ct>>1,lt=-7,ht=rt?it-1:0,ft=rt?-1:1,dt=et[tt+ht];for(ht+=ft,ot=dt&(1<<-lt)-1,dt>>=-lt,lt+=at;lt>0;ot=ot*256+et[tt+ht],ht+=ft,lt-=8);for(st=ot&(1<<-lt)-1,ot>>=-lt,lt+=nt;lt>0;st=st*256+et[tt+ht],ht+=ft,lt-=8);if(ot===0)ot=1-ut;else{if(ot===ct)return st?NaN:(dt?-1:1)*(1/0);st=st+Math.pow(2,nt),ot=ot-ut}return(dt?-1:1)*st*Math.pow(2,ot-nt)},ieee754.write=function(et,tt,rt,nt,it,ot){var st,at,ct,ut=ot*8-it-1,lt=(1<<ut)-1,ht=lt>>1,ft=it===23?Math.pow(2,-24)-Math.pow(2,-77):0,dt=nt?0:ot-1,pt=nt?1:-1,gt=tt<0||tt===0&&1/tt<0?1:0;for(tt=Math.abs(tt),isNaN(tt)||tt===1/0?(at=isNaN(tt)?1:0,st=lt):(st=Math.floor(Math.log(tt)/Math.LN2),tt*(ct=Math.pow(2,-st))<1&&(st--,ct*=2),st+ht>=1?tt+=ft/ct:tt+=ft*Math.pow(2,1-ht),tt*ct>=2&&(st++,ct/=2),st+ht>=lt?(at=0,st=lt):st+ht>=1?(at=(tt*ct-1)*Math.pow(2,it),st=st+ht):(at=tt*Math.pow(2,ht-1)*Math.pow(2,it),st=0));it>=8;et[rt+dt]=at&255,dt+=pt,at/=256,it-=8);for(st=st<<it|at,ut+=it;ut>0;et[rt+dt]=st&255,dt+=pt,st/=256,ut-=8);et[rt+dt-pt]|=gt*128}),ieee754}var hasRequiredBuffer;function requireBuffer(){return hasRequiredBuffer||(hasRequiredBuffer=1,function(et){const tt=requireBase64Js(),rt=requireIeee754(),nt=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;et.Buffer=at,et.SlowBuffer=At,et.INSPECT_MAX_BYTES=50;const it=2147483647;et.kMaxLength=it,at.TYPED_ARRAY_SUPPORT=ot(),!at.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function ot(){try{const vt=new Uint8Array(1),Rt={foo:function(){return 42}};return Object.setPrototypeOf(Rt,Uint8Array.prototype),Object.setPrototypeOf(vt,Rt),vt.foo()===42}catch{return!1}}Object.defineProperty(at.prototype,"parent",{enumerable:!0,get:function(){if(at.isBuffer(this))return this.buffer}}),Object.defineProperty(at.prototype,"offset",{enumerable:!0,get:function(){if(at.isBuffer(this))return this.byteOffset}});function st(vt){if(vt>it)throw new RangeError('The value "'+vt+'" is invalid for option "size"');const Rt=new Uint8Array(vt);return Object.setPrototypeOf(Rt,at.prototype),Rt}function at(vt,Rt,Bt){if(typeof vt=="number"){if(typeof Rt=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return ht(vt)}return ct(vt,Rt,Bt)}at.poolSize=8192;function ct(vt,Rt,Bt){if(typeof vt=="string")return ft(vt,Rt);if(ArrayBuffer.isView(vt))return pt(vt);if(vt==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof vt);if(Gt(vt,ArrayBuffer)||vt&&Gt(vt.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Gt(vt,SharedArrayBuffer)||vt&&Gt(vt.buffer,SharedArrayBuffer)))return gt(vt,Rt,Bt);if(typeof vt=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const Nt=vt.valueOf&&vt.valueOf();if(Nt!=null&&Nt!==vt)return at.from(Nt,Rt,Bt);const Ot=_t(vt);if(Ot)return Ot;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof vt[Symbol.toPrimitive]=="function")return at.from(vt[Symbol.toPrimitive]("string"),Rt,Bt);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof vt)}at.from=function(vt,Rt,Bt){return ct(vt,Rt,Bt)},Object.setPrototypeOf(at.prototype,Uint8Array.prototype),Object.setPrototypeOf(at,Uint8Array);function ut(vt){if(typeof vt!="number")throw new TypeError('"size" argument must be of type number');if(vt<0)throw new RangeError('The value "'+vt+'" is invalid for option "size"')}function lt(vt,Rt,Bt){return ut(vt),vt<=0?st(vt):Rt!==void 0?typeof Bt=="string"?st(vt).fill(Rt,Bt):st(vt).fill(Rt):st(vt)}at.alloc=function(vt,Rt,Bt){return lt(vt,Rt,Bt)};function ht(vt){return ut(vt),st(vt<0?0:mt(vt)|0)}at.allocUnsafe=function(vt){return ht(vt)},at.allocUnsafeSlow=function(vt){return ht(vt)};function ft(vt,Rt){if((typeof Rt!="string"||Rt==="")&&(Rt="utf8"),!at.isEncoding(Rt))throw new TypeError("Unknown encoding: "+Rt);const Bt=It(vt,Rt)|0;let Nt=st(Bt);const Ot=Nt.write(vt,Rt);return Ot!==Bt&&(Nt=Nt.slice(0,Ot)),Nt}function dt(vt){const Rt=vt.length<0?0:mt(vt.length)|0,Bt=st(Rt);for(let Nt=0;Nt<Rt;Nt+=1)Bt[Nt]=vt[Nt]&255;return Bt}function pt(vt){if(Gt(vt,Uint8Array)){const Rt=new Uint8Array(vt);return gt(Rt.buffer,Rt.byteOffset,Rt.byteLength)}return dt(vt)}function gt(vt,Rt,Bt){if(Rt<0||vt.byteLength<Rt)throw new RangeError('"offset" is outside of buffer bounds');if(vt.byteLength<Rt+(Bt||0))throw new RangeError('"length" is outside of buffer bounds');let Nt;return Rt===void 0&&Bt===void 0?Nt=new Uint8Array(vt):Bt===void 0?Nt=new Uint8Array(vt,Rt):Nt=new Uint8Array(vt,Rt,Bt),Object.setPrototypeOf(Nt,at.prototype),Nt}function _t(vt){if(at.isBuffer(vt)){const Rt=mt(vt.length)|0,Bt=st(Rt);return Bt.length===0||vt.copy(Bt,0,0,Rt),Bt}if(vt.length!==void 0)return typeof vt.length!="number"||Xt(vt.length)?st(0):dt(vt);if(vt.type==="Buffer"&&Array.isArray(vt.data))return dt(vt.data)}function mt(vt){if(vt>=it)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+it.toString(16)+" bytes");return vt|0}function At(vt){return+vt!=vt&&(vt=0),at.alloc(+vt)}at.isBuffer=function(vt){return vt!=null&&vt._isBuffer===!0&&vt!==at.prototype},at.compare=function(vt,Rt){if(Gt(vt,Uint8Array)&&(vt=at.from(vt,vt.offset,vt.byteLength)),Gt(Rt,Uint8Array)&&(Rt=at.from(Rt,Rt.offset,Rt.byteLength)),!at.isBuffer(vt)||!at.isBuffer(Rt))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(vt===Rt)return 0;let Bt=vt.length,Nt=Rt.length;for(let Ot=0,Kt=Math.min(Bt,Nt);Ot<Kt;++Ot)if(vt[Ot]!==Rt[Ot]){Bt=vt[Ot],Nt=Rt[Ot];break}return Bt<Nt?-1:Nt<Bt?1:0},at.isEncoding=function(vt){switch(String(vt).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},at.concat=function(vt,Rt){if(!Array.isArray(vt))throw new TypeError('"list" argument must be an Array of Buffers');if(vt.length===0)return at.alloc(0);let Bt;if(Rt===void 0)for(Rt=0,Bt=0;Bt<vt.length;++Bt)Rt+=vt[Bt].length;const Nt=at.allocUnsafe(Rt);let Ot=0;for(Bt=0;Bt<vt.length;++Bt){let Kt=vt[Bt];if(Gt(Kt,Uint8Array))Ot+Kt.length>Nt.length?(at.isBuffer(Kt)||(Kt=at.from(Kt)),Kt.copy(Nt,Ot)):Uint8Array.prototype.set.call(Nt,Kt,Ot);else if(at.isBuffer(Kt))Kt.copy(Nt,Ot);else throw new TypeError('"list" argument must be an Array of Buffers');Ot+=Kt.length}return Nt};function It(vt,Rt){if(at.isBuffer(vt))return vt.length;if(ArrayBuffer.isView(vt)||Gt(vt,ArrayBuffer))return vt.byteLength;if(typeof vt!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof vt);const Bt=vt.length,Nt=arguments.length>2&&arguments[2]===!0;if(!Nt&&Bt===0)return 0;let Ot=!1;for(;;)switch(Rt){case"ascii":case"latin1":case"binary":return Bt;case"utf8":case"utf-8":return fr(vt).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Bt*2;case"hex":return Bt>>>1;case"base64":return me(vt).length;default:if(Ot)return Nt?-1:fr(vt).length;Rt=(""+Rt).toLowerCase(),Ot=!0}}at.byteLength=It;function Mt(vt,Rt,Bt){let Nt=!1;if((Rt===void 0||Rt<0)&&(Rt=0),Rt>this.length||((Bt===void 0||Bt>this.length)&&(Bt=this.length),Bt<=0)||(Bt>>>=0,Rt>>>=0,Bt<=Rt))return"";for(vt||(vt="utf8");;)switch(vt){case"hex":return wt(this,Rt,Bt);case"utf8":case"utf-8":return Et(this,Rt,Bt);case"ascii":return St(this,Rt,Bt);case"latin1":case"binary":return Dt(this,Rt,Bt);case"base64":return $t(this,Rt,Bt);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return xt(this,Rt,Bt);default:if(Nt)throw new TypeError("Unknown encoding: "+vt);vt=(vt+"").toLowerCase(),Nt=!0}}at.prototype._isBuffer=!0;function kt(vt,Rt,Bt){const Nt=vt[Rt];vt[Rt]=vt[Bt],vt[Bt]=Nt}at.prototype.swap16=function(){const vt=this.length;if(vt%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let Rt=0;Rt<vt;Rt+=2)kt(this,Rt,Rt+1);return this},at.prototype.swap32=function(){const vt=this.length;if(vt%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let Rt=0;Rt<vt;Rt+=4)kt(this,Rt,Rt+3),kt(this,Rt+1,Rt+2);return this},at.prototype.swap64=function(){const vt=this.length;if(vt%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let Rt=0;Rt<vt;Rt+=8)kt(this,Rt,Rt+7),kt(this,Rt+1,Rt+6),kt(this,Rt+2,Rt+5),kt(this,Rt+3,Rt+4);return this},at.prototype.toString=function(){const vt=this.length;return vt===0?"":arguments.length===0?Et(this,0,vt):Mt.apply(this,arguments)},at.prototype.toLocaleString=at.prototype.toString,at.prototype.equals=function(vt){if(!at.isBuffer(vt))throw new TypeError("Argument must be a Buffer");return this===vt?!0:at.compare(this,vt)===0},at.prototype.inspect=function(){let vt="";const Rt=et.INSPECT_MAX_BYTES;return vt=this.toString("hex",0,Rt).replace(/(.{2})/g,"$1 ").trim(),this.length>Rt&&(vt+=" ... "),"<Buffer "+vt+">"},nt&&(at.prototype[nt]=at.prototype.inspect),at.prototype.compare=function(vt,Rt,Bt,Nt,Ot){if(Gt(vt,Uint8Array)&&(vt=at.from(vt,vt.offset,vt.byteLength)),!at.isBuffer(vt))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof vt);if(Rt===void 0&&(Rt=0),Bt===void 0&&(Bt=vt?vt.length:0),Nt===void 0&&(Nt=0),Ot===void 0&&(Ot=this.length),Rt<0||Bt>vt.length||Nt<0||Ot>this.length)throw new RangeError("out of range index");if(Nt>=Ot&&Rt>=Bt)return 0;if(Nt>=Ot)return-1;if(Rt>=Bt)return 1;if(Rt>>>=0,Bt>>>=0,Nt>>>=0,Ot>>>=0,this===vt)return 0;let Kt=Ot-Nt,$e=Bt-Rt;const nr=Math.min(Kt,$e),Ze=this.slice(Nt,Ot),tr=vt.slice(Rt,Bt);for(let lr=0;lr<nr;++lr)if(Ze[lr]!==tr[lr]){Kt=Ze[lr],$e=tr[lr];break}return Kt<$e?-1:$e<Kt?1:0};function Ct(vt,Rt,Bt,Nt,Ot){if(vt.length===0)return-1;if(typeof Bt=="string"?(Nt=Bt,Bt=0):Bt>2147483647?Bt=2147483647:Bt<-2147483648&&(Bt=-2147483648),Bt=+Bt,Xt(Bt)&&(Bt=Ot?0:vt.length-1),Bt<0&&(Bt=vt.length+Bt),Bt>=vt.length){if(Ot)return-1;Bt=vt.length-1}else if(Bt<0)if(Ot)Bt=0;else return-1;if(typeof Rt=="string"&&(Rt=at.from(Rt,Nt)),at.isBuffer(Rt))return Rt.length===0?-1:Ut(vt,Rt,Bt,Nt,Ot);if(typeof Rt=="number")return Rt=Rt&255,typeof Uint8Array.prototype.indexOf=="function"?Ot?Uint8Array.prototype.indexOf.call(vt,Rt,Bt):Uint8Array.prototype.lastIndexOf.call(vt,Rt,Bt):Ut(vt,[Rt],Bt,Nt,Ot);throw new TypeError("val must be string, number or Buffer")}function Ut(vt,Rt,Bt,Nt,Ot){let Kt=1,$e=vt.length,nr=Rt.length;if(Nt!==void 0&&(Nt=String(Nt).toLowerCase(),Nt==="ucs2"||Nt==="ucs-2"||Nt==="utf16le"||Nt==="utf-16le")){if(vt.length<2||Rt.length<2)return-1;Kt=2,$e/=2,nr/=2,Bt/=2}function Ze(lr,dr){return Kt===1?lr[dr]:lr.readUInt16BE(dr*Kt)}let tr;if(Ot){let lr=-1;for(tr=Bt;tr<$e;tr++)if(Ze(vt,tr)===Ze(Rt,lr===-1?0:tr-lr)){if(lr===-1&&(lr=tr),tr-lr+1===nr)return lr*Kt}else lr!==-1&&(tr-=tr-lr),lr=-1}else for(Bt+nr>$e&&(Bt=$e-nr),tr=Bt;tr>=0;tr--){let lr=!0;for(let dr=0;dr<nr;dr++)if(Ze(vt,tr+dr)!==Ze(Rt,dr)){lr=!1;break}if(lr)return tr}return-1}at.prototype.includes=function(vt,Rt,Bt){return this.indexOf(vt,Rt,Bt)!==-1},at.prototype.indexOf=function(vt,Rt,Bt){return Ct(this,vt,Rt,Bt,!0)},at.prototype.lastIndexOf=function(vt,Rt,Bt){return Ct(this,vt,Rt,Bt,!1)};function Wt(vt,Rt,Bt,Nt){Bt=Number(Bt)||0;const Ot=vt.length-Bt;Nt?(Nt=Number(Nt),Nt>Ot&&(Nt=Ot)):Nt=Ot;const Kt=Rt.length;Nt>Kt/2&&(Nt=Kt/2);let $e;for($e=0;$e<Nt;++$e){const nr=parseInt(Rt.substr($e*2,2),16);if(Xt(nr))return $e;vt[Bt+$e]=nr}return $e}function Ft(vt,Rt,Bt,Nt){return Lt(fr(Rt,vt.length-Bt),vt,Bt,Nt)}function Ce(vt,Rt,Bt,Nt){return Lt(ue(Rt),vt,Bt,Nt)}function bt(vt,Rt,Bt,Nt){return Lt(me(Rt),vt,Bt,Nt)}function yt(vt,Rt,Bt,Nt){return Lt(Qt(Rt,vt.length-Bt),vt,Bt,Nt)}at.prototype.write=function(vt,Rt,Bt,Nt){if(Rt===void 0)Nt="utf8",Bt=this.length,Rt=0;else if(Bt===void 0&&typeof Rt=="string")Nt=Rt,Bt=this.length,Rt=0;else if(isFinite(Rt))Rt=Rt>>>0,isFinite(Bt)?(Bt=Bt>>>0,Nt===void 0&&(Nt="utf8")):(Nt=Bt,Bt=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Ot=this.length-Rt;if((Bt===void 0||Bt>Ot)&&(Bt=Ot),vt.length>0&&(Bt<0||Rt<0)||Rt>this.length)throw new RangeError("Attempt to write outside buffer bounds");Nt||(Nt="utf8");let Kt=!1;for(;;)switch(Nt){case"hex":return Wt(this,vt,Rt,Bt);case"utf8":case"utf-8":return Ft(this,vt,Rt,Bt);case"ascii":case"latin1":case"binary":return Ce(this,vt,Rt,Bt);case"base64":return bt(this,vt,Rt,Bt);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return yt(this,vt,Rt,Bt);default:if(Kt)throw new TypeError("Unknown encoding: "+Nt);Nt=(""+Nt).toLowerCase(),Kt=!0}},at.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function $t(vt,Rt,Bt){return Rt===0&&Bt===vt.length?tt.fromByteArray(vt):tt.fromByteArray(vt.slice(Rt,Bt))}function Et(vt,Rt,Bt){Bt=Math.min(vt.length,Bt);const Nt=[];let Ot=Rt;for(;Ot<Bt;){const Kt=vt[Ot];let $e=null,nr=Kt>239?4:Kt>223?3:Kt>191?2:1;if(Ot+nr<=Bt){let Ze,tr,lr,dr;switch(nr){case 1:Kt<128&&($e=Kt);break;case 2:Ze=vt[Ot+1],(Ze&192)===128&&(dr=(Kt&31)<<6|Ze&63,dr>127&&($e=dr));break;case 3:Ze=vt[Ot+1],tr=vt[Ot+2],(Ze&192)===128&&(tr&192)===128&&(dr=(Kt&15)<<12|(Ze&63)<<6|tr&63,dr>2047&&(dr<55296||dr>57343)&&($e=dr));break;case 4:Ze=vt[Ot+1],tr=vt[Ot+2],lr=vt[Ot+3],(Ze&192)===128&&(tr&192)===128&&(lr&192)===128&&(dr=(Kt&15)<<18|(Ze&63)<<12|(tr&63)<<6|lr&63,dr>65535&&dr<1114112&&($e=dr))}}$e===null?($e=65533,nr=1):$e>65535&&($e-=65536,Nt.push($e>>>10&1023|55296),$e=56320|$e&1023),Nt.push($e),Ot+=nr}return Pt(Nt)}const Tt=4096;function Pt(vt){const Rt=vt.length;if(Rt<=Tt)return String.fromCharCode.apply(String,vt);let Bt="",Nt=0;for(;Nt<Rt;)Bt+=String.fromCharCode.apply(String,vt.slice(Nt,Nt+=Tt));return Bt}function St(vt,Rt,Bt){let Nt="";Bt=Math.min(vt.length,Bt);for(let Ot=Rt;Ot<Bt;++Ot)Nt+=String.fromCharCode(vt[Ot]&127);return Nt}function Dt(vt,Rt,Bt){let Nt="";Bt=Math.min(vt.length,Bt);for(let Ot=Rt;Ot<Bt;++Ot)Nt+=String.fromCharCode(vt[Ot]);return Nt}function wt(vt,Rt,Bt){const Nt=vt.length;(!Rt||Rt<0)&&(Rt=0),(!Bt||Bt<0||Bt>Nt)&&(Bt=Nt);let Ot="";for(let Kt=Rt;Kt<Bt;++Kt)Ot+=Yt[vt[Kt]];return Ot}function xt(vt,Rt,Bt){const Nt=vt.slice(Rt,Bt);let Ot="";for(let Kt=0;Kt<Nt.length-1;Kt+=2)Ot+=String.fromCharCode(Nt[Kt]+Nt[Kt+1]*256);return Ot}at.prototype.slice=function(vt,Rt){const Bt=this.length;vt=~~vt,Rt=Rt===void 0?Bt:~~Rt,vt<0?(vt+=Bt,vt<0&&(vt=0)):vt>Bt&&(vt=Bt),Rt<0?(Rt+=Bt,Rt<0&&(Rt=0)):Rt>Bt&&(Rt=Bt),Rt<vt&&(Rt=vt);const Nt=this.subarray(vt,Rt);return Object.setPrototypeOf(Nt,at.prototype),Nt};function Ke(vt,Rt,Bt){if(vt%1!==0||vt<0)throw new RangeError("offset is not uint");if(vt+Rt>Bt)throw new RangeError("Trying to access beyond buffer length")}at.prototype.readUintLE=at.prototype.readUIntLE=function(vt,Rt,Bt){vt=vt>>>0,Rt=Rt>>>0,Bt||Ke(vt,Rt,this.length);let Nt=this[vt],Ot=1,Kt=0;for(;++Kt<Rt&&(Ot*=256);)Nt+=this[vt+Kt]*Ot;return Nt},at.prototype.readUintBE=at.prototype.readUIntBE=function(vt,Rt,Bt){vt=vt>>>0,Rt=Rt>>>0,Bt||Ke(vt,Rt,this.length);let Nt=this[vt+--Rt],Ot=1;for(;Rt>0&&(Ot*=256);)Nt+=this[vt+--Rt]*Ot;return Nt},at.prototype.readUint8=at.prototype.readUInt8=function(vt,Rt){return vt=vt>>>0,Rt||Ke(vt,1,this.length),this[vt]},at.prototype.readUint16LE=at.prototype.readUInt16LE=function(vt,Rt){return vt=vt>>>0,Rt||Ke(vt,2,this.length),this[vt]|this[vt+1]<<8},at.prototype.readUint16BE=at.prototype.readUInt16BE=function(vt,Rt){return vt=vt>>>0,Rt||Ke(vt,2,this.length),this[vt]<<8|this[vt+1]},at.prototype.readUint32LE=at.prototype.readUInt32LE=function(vt,Rt){return vt=vt>>>0,Rt||Ke(vt,4,this.length),(this[vt]|this[vt+1]<<8|this[vt+2]<<16)+this[vt+3]*16777216},at.prototype.readUint32BE=at.prototype.readUInt32BE=function(vt,Rt){return vt=vt>>>0,Rt||Ke(vt,4,this.length),this[vt]*16777216+(this[vt+1]<<16|this[vt+2]<<8|this[vt+3])},at.prototype.readBigUInt64LE=He(function(vt){vt=vt>>>0,ur(vt,"offset");const Rt=this[vt],Bt=this[vt+7];(Rt===void 0||Bt===void 0)&&ar(vt,this.length-8);const Nt=Rt+this[++vt]*2**8+this[++vt]*2**16+this[++vt]*2**24,Ot=this[++vt]+this[++vt]*2**8+this[++vt]*2**16+Bt*2**24;return BigInt(Nt)+(BigInt(Ot)<<BigInt(32))}),at.prototype.readBigUInt64BE=He(function(vt){vt=vt>>>0,ur(vt,"offset");const Rt=this[vt],Bt=this[vt+7];(Rt===void 0||Bt===void 0)&&ar(vt,this.length-8);const Nt=Rt*2**24+this[++vt]*2**16+this[++vt]*2**8+this[++vt],Ot=this[++vt]*2**24+this[++vt]*2**16+this[++vt]*2**8+Bt;return(BigInt(Nt)<<BigInt(32))+BigInt(Ot)}),at.prototype.readIntLE=function(vt,Rt,Bt){vt=vt>>>0,Rt=Rt>>>0,Bt||Ke(vt,Rt,this.length);let Nt=this[vt],Ot=1,Kt=0;for(;++Kt<Rt&&(Ot*=256);)Nt+=this[vt+Kt]*Ot;return Ot*=128,Nt>=Ot&&(Nt-=Math.pow(2,8*Rt)),Nt},at.prototype.readIntBE=function(vt,Rt,Bt){vt=vt>>>0,Rt=Rt>>>0,Bt||Ke(vt,Rt,this.length);let Nt=Rt,Ot=1,Kt=this[vt+--Nt];for(;Nt>0&&(Ot*=256);)Kt+=this[vt+--Nt]*Ot;return Ot*=128,Kt>=Ot&&(Kt-=Math.pow(2,8*Rt)),Kt},at.prototype.readInt8=function(vt,Rt){return vt=vt>>>0,Rt||Ke(vt,1,this.length),this[vt]&128?(255-this[vt]+1)*-1:this[vt]},at.prototype.readInt16LE=function(vt,Rt){vt=vt>>>0,Rt||Ke(vt,2,this.length);const Bt=this[vt]|this[vt+1]<<8;return Bt&32768?Bt|4294901760:Bt},at.prototype.readInt16BE=function(vt,Rt){vt=vt>>>0,Rt||Ke(vt,2,this.length);const Bt=this[vt+1]|this[vt]<<8;return Bt&32768?Bt|4294901760:Bt},at.prototype.readInt32LE=function(vt,Rt){return vt=vt>>>0,Rt||Ke(vt,4,this.length),this[vt]|this[vt+1]<<8|this[vt+2]<<16|this[vt+3]<<24},at.prototype.readInt32BE=function(vt,Rt){return vt=vt>>>0,Rt||Ke(vt,4,this.length),this[vt]<<24|this[vt+1]<<16|this[vt+2]<<8|this[vt+3]},at.prototype.readBigInt64LE=He(function(vt){vt=vt>>>0,ur(vt,"offset");const Rt=this[vt],Bt=this[vt+7];(Rt===void 0||Bt===void 0)&&ar(vt,this.length-8);const Nt=this[vt+4]+this[vt+5]*2**8+this[vt+6]*2**16+(Bt<<24);return(BigInt(Nt)<<BigInt(32))+BigInt(Rt+this[++vt]*2**8+this[++vt]*2**16+this[++vt]*2**24)}),at.prototype.readBigInt64BE=He(function(vt){vt=vt>>>0,ur(vt,"offset");const Rt=this[vt],Bt=this[vt+7];(Rt===void 0||Bt===void 0)&&ar(vt,this.length-8);const Nt=(Rt<<24)+this[++vt]*2**16+this[++vt]*2**8+this[++vt];return(BigInt(Nt)<<BigInt(32))+BigInt(this[++vt]*2**24+this[++vt]*2**16+this[++vt]*2**8+Bt)}),at.prototype.readFloatLE=function(vt,Rt){return vt=vt>>>0,Rt||Ke(vt,4,this.length),rt.read(this,vt,!0,23,4)},at.prototype.readFloatBE=function(vt,Rt){return vt=vt>>>0,Rt||Ke(vt,4,this.length),rt.read(this,vt,!1,23,4)},at.prototype.readDoubleLE=function(vt,Rt){return vt=vt>>>0,Rt||Ke(vt,8,this.length),rt.read(this,vt,!0,52,8)},at.prototype.readDoubleBE=function(vt,Rt){return vt=vt>>>0,Rt||Ke(vt,8,this.length),rt.read(this,vt,!1,52,8)};function Pe(vt,Rt,Bt,Nt,Ot,Kt){if(!at.isBuffer(vt))throw new TypeError('"buffer" argument must be a Buffer instance');if(Rt>Ot||Rt<Kt)throw new RangeError('"value" argument is out of bounds');if(Bt+Nt>vt.length)throw new RangeError("Index out of range")}at.prototype.writeUintLE=at.prototype.writeUIntLE=function(vt,Rt,Bt,Nt){if(vt=+vt,Rt=Rt>>>0,Bt=Bt>>>0,!Nt){const $e=Math.pow(2,8*Bt)-1;Pe(this,vt,Rt,Bt,$e,0)}let Ot=1,Kt=0;for(this[Rt]=vt&255;++Kt<Bt&&(Ot*=256);)this[Rt+Kt]=vt/Ot&255;return Rt+Bt},at.prototype.writeUintBE=at.prototype.writeUIntBE=function(vt,Rt,Bt,Nt){if(vt=+vt,Rt=Rt>>>0,Bt=Bt>>>0,!Nt){const $e=Math.pow(2,8*Bt)-1;Pe(this,vt,Rt,Bt,$e,0)}let Ot=Bt-1,Kt=1;for(this[Rt+Ot]=vt&255;--Ot>=0&&(Kt*=256);)this[Rt+Ot]=vt/Kt&255;return Rt+Bt},at.prototype.writeUint8=at.prototype.writeUInt8=function(vt,Rt,Bt){return vt=+vt,Rt=Rt>>>0,Bt||Pe(this,vt,Rt,1,255,0),this[Rt]=vt&255,Rt+1},at.prototype.writeUint16LE=at.prototype.writeUInt16LE=function(vt,Rt,Bt){return vt=+vt,Rt=Rt>>>0,Bt||Pe(this,vt,Rt,2,65535,0),this[Rt]=vt&255,this[Rt+1]=vt>>>8,Rt+2},at.prototype.writeUint16BE=at.prototype.writeUInt16BE=function(vt,Rt,Bt){return vt=+vt,Rt=Rt>>>0,Bt||Pe(this,vt,Rt,2,65535,0),this[Rt]=vt>>>8,this[Rt+1]=vt&255,Rt+2},at.prototype.writeUint32LE=at.prototype.writeUInt32LE=function(vt,Rt,Bt){return vt=+vt,Rt=Rt>>>0,Bt||Pe(this,vt,Rt,4,4294967295,0),this[Rt+3]=vt>>>24,this[Rt+2]=vt>>>16,this[Rt+1]=vt>>>8,this[Rt]=vt&255,Rt+4},at.prototype.writeUint32BE=at.prototype.writeUInt32BE=function(vt,Rt,Bt){return vt=+vt,Rt=Rt>>>0,Bt||Pe(this,vt,Rt,4,4294967295,0),this[Rt]=vt>>>24,this[Rt+1]=vt>>>16,this[Rt+2]=vt>>>8,this[Rt+3]=vt&255,Rt+4};function Ht(vt,Rt,Bt,Nt,Ot){We(Rt,Nt,Ot,vt,Bt,7);let Kt=Number(Rt&BigInt(4294967295));vt[Bt++]=Kt,Kt=Kt>>8,vt[Bt++]=Kt,Kt=Kt>>8,vt[Bt++]=Kt,Kt=Kt>>8,vt[Bt++]=Kt;let $e=Number(Rt>>BigInt(32)&BigInt(4294967295));return vt[Bt++]=$e,$e=$e>>8,vt[Bt++]=$e,$e=$e>>8,vt[Bt++]=$e,$e=$e>>8,vt[Bt++]=$e,Bt}function zt(vt,Rt,Bt,Nt,Ot){We(Rt,Nt,Ot,vt,Bt,7);let Kt=Number(Rt&BigInt(4294967295));vt[Bt+7]=Kt,Kt=Kt>>8,vt[Bt+6]=Kt,Kt=Kt>>8,vt[Bt+5]=Kt,Kt=Kt>>8,vt[Bt+4]=Kt;let $e=Number(Rt>>BigInt(32)&BigInt(4294967295));return vt[Bt+3]=$e,$e=$e>>8,vt[Bt+2]=$e,$e=$e>>8,vt[Bt+1]=$e,$e=$e>>8,vt[Bt]=$e,Bt+8}at.prototype.writeBigUInt64LE=He(function(vt,Rt=0){return Ht(this,vt,Rt,BigInt(0),BigInt("0xffffffffffffffff"))}),at.prototype.writeBigUInt64BE=He(function(vt,Rt=0){return zt(this,vt,Rt,BigInt(0),BigInt("0xffffffffffffffff"))}),at.prototype.writeIntLE=function(vt,Rt,Bt,Nt){if(vt=+vt,Rt=Rt>>>0,!Nt){const nr=Math.pow(2,8*Bt-1);Pe(this,vt,Rt,Bt,nr-1,-nr)}let Ot=0,Kt=1,$e=0;for(this[Rt]=vt&255;++Ot<Bt&&(Kt*=256);)vt<0&&$e===0&&this[Rt+Ot-1]!==0&&($e=1),this[Rt+Ot]=(vt/Kt>>0)-$e&255;return Rt+Bt},at.prototype.writeIntBE=function(vt,Rt,Bt,Nt){if(vt=+vt,Rt=Rt>>>0,!Nt){const nr=Math.pow(2,8*Bt-1);Pe(this,vt,Rt,Bt,nr-1,-nr)}let Ot=Bt-1,Kt=1,$e=0;for(this[Rt+Ot]=vt&255;--Ot>=0&&(Kt*=256);)vt<0&&$e===0&&this[Rt+Ot+1]!==0&&($e=1),this[Rt+Ot]=(vt/Kt>>0)-$e&255;return Rt+Bt},at.prototype.writeInt8=function(vt,Rt,Bt){return vt=+vt,Rt=Rt>>>0,Bt||Pe(this,vt,Rt,1,127,-128),vt<0&&(vt=255+vt+1),this[Rt]=vt&255,Rt+1},at.prototype.writeInt16LE=function(vt,Rt,Bt){return vt=+vt,Rt=Rt>>>0,Bt||Pe(this,vt,Rt,2,32767,-32768),this[Rt]=vt&255,this[Rt+1]=vt>>>8,Rt+2},at.prototype.writeInt16BE=function(vt,Rt,Bt){return vt=+vt,Rt=Rt>>>0,Bt||Pe(this,vt,Rt,2,32767,-32768),this[Rt]=vt>>>8,this[Rt+1]=vt&255,Rt+2},at.prototype.writeInt32LE=function(vt,Rt,Bt){return vt=+vt,Rt=Rt>>>0,Bt||Pe(this,vt,Rt,4,2147483647,-2147483648),this[Rt]=vt&255,this[Rt+1]=vt>>>8,this[Rt+2]=vt>>>16,this[Rt+3]=vt>>>24,Rt+4},at.prototype.writeInt32BE=function(vt,Rt,Bt){return vt=+vt,Rt=Rt>>>0,Bt||Pe(this,vt,Rt,4,2147483647,-2147483648),vt<0&&(vt=4294967295+vt+1),this[Rt]=vt>>>24,this[Rt+1]=vt>>>16,this[Rt+2]=vt>>>8,this[Rt+3]=vt&255,Rt+4},at.prototype.writeBigInt64LE=He(function(vt,Rt=0){return Ht(this,vt,Rt,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),at.prototype.writeBigInt64BE=He(function(vt,Rt=0){return zt(this,vt,Rt,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function jt(vt,Rt,Bt,Nt,Ot,Kt){if(Bt+Nt>vt.length)throw new RangeError("Index out of range");if(Bt<0)throw new RangeError("Index out of range")}function qt(vt,Rt,Bt,Nt,Ot){return Rt=+Rt,Bt=Bt>>>0,Ot||jt(vt,Rt,Bt,4),rt.write(vt,Rt,Bt,Nt,23,4),Bt+4}at.prototype.writeFloatLE=function(vt,Rt,Bt){return qt(this,vt,Rt,!0,Bt)},at.prototype.writeFloatBE=function(vt,Rt,Bt){return qt(this,vt,Rt,!1,Bt)};function Ge(vt,Rt,Bt,Nt,Ot){return Rt=+Rt,Bt=Bt>>>0,Ot||jt(vt,Rt,Bt,8),rt.write(vt,Rt,Bt,Nt,52,8),Bt+8}at.prototype.writeDoubleLE=function(vt,Rt,Bt){return Ge(this,vt,Rt,!0,Bt)},at.prototype.writeDoubleBE=function(vt,Rt,Bt){return Ge(this,vt,Rt,!1,Bt)},at.prototype.copy=function(vt,Rt,Bt,Nt){if(!at.isBuffer(vt))throw new TypeError("argument should be a Buffer");if(Bt||(Bt=0),!Nt&&Nt!==0&&(Nt=this.length),Rt>=vt.length&&(Rt=vt.length),Rt||(Rt=0),Nt>0&&Nt<Bt&&(Nt=Bt),Nt===Bt||vt.length===0||this.length===0)return 0;if(Rt<0)throw new RangeError("targetStart out of bounds");if(Bt<0||Bt>=this.length)throw new RangeError("Index out of range");if(Nt<0)throw new RangeError("sourceEnd out of bounds");Nt>this.length&&(Nt=this.length),vt.length-Rt<Nt-Bt&&(Nt=vt.length-Rt+Bt);const Ot=Nt-Bt;return this===vt&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(Rt,Bt,Nt):Uint8Array.prototype.set.call(vt,this.subarray(Bt,Nt),Rt),Ot},at.prototype.fill=function(vt,Rt,Bt,Nt){if(typeof vt=="string"){if(typeof Rt=="string"?(Nt=Rt,Rt=0,Bt=this.length):typeof Bt=="string"&&(Nt=Bt,Bt=this.length),Nt!==void 0&&typeof Nt!="string")throw new TypeError("encoding must be a string");if(typeof Nt=="string"&&!at.isEncoding(Nt))throw new TypeError("Unknown encoding: "+Nt);if(vt.length===1){const Kt=vt.charCodeAt(0);(Nt==="utf8"&&Kt<128||Nt==="latin1")&&(vt=Kt)}}else typeof vt=="number"?vt=vt&255:typeof vt=="boolean"&&(vt=Number(vt));if(Rt<0||this.length<Rt||this.length<Bt)throw new RangeError("Out of range index");if(Bt<=Rt)return this;Rt=Rt>>>0,Bt=Bt===void 0?this.length:Bt>>>0,vt||(vt=0);let Ot;if(typeof vt=="number")for(Ot=Rt;Ot<Bt;++Ot)this[Ot]=vt;else{const Kt=at.isBuffer(vt)?vt:at.from(vt,Nt),$e=Kt.length;if($e===0)throw new TypeError('The value "'+vt+'" is invalid for argument "value"');for(Ot=0;Ot<Bt-Rt;++Ot)this[Ot+Rt]=Kt[Ot%$e]}return this};const Ie={};function Xe(vt,Rt,Bt){Ie[vt]=class extends Bt{constructor(){super(),Object.defineProperty(this,"message",{value:Rt.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${vt}]`,this.stack,delete this.name}get code(){return vt}set code(Nt){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Nt,writable:!0})}toString(){return`${this.name} [${vt}]: ${this.message}`}}}Xe("ERR_BUFFER_OUT_OF_BOUNDS",function(vt){return vt?`${vt} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Xe("ERR_INVALID_ARG_TYPE",function(vt,Rt){return`The "${vt}" argument must be of type number. Received type ${typeof Rt}`},TypeError),Xe("ERR_OUT_OF_RANGE",function(vt,Rt,Bt){let Nt=`The value of "${vt}" is out of range.`,Ot=Bt;return Number.isInteger(Bt)&&Math.abs(Bt)>2**32?Ot=Je(String(Bt)):typeof Bt=="bigint"&&(Ot=String(Bt),(Bt>BigInt(2)**BigInt(32)||Bt<-(BigInt(2)**BigInt(32)))&&(Ot=Je(Ot)),Ot+="n"),Nt+=` It must be ${Rt}. Received ${Ot}`,Nt},RangeError);function Je(vt){let Rt="",Bt=vt.length;const Nt=vt[0]==="-"?1:0;for(;Bt>=Nt+4;Bt-=3)Rt=`_${vt.slice(Bt-3,Bt)}${Rt}`;return`${vt.slice(0,Bt)}${Rt}`}function Qe(vt,Rt,Bt){ur(Rt,"offset"),(vt[Rt]===void 0||vt[Rt+Bt]===void 0)&&ar(Rt,vt.length-(Bt+1))}function We(vt,Rt,Bt,Nt,Ot,Kt){if(vt>Bt||vt<Rt){const $e=typeof Rt=="bigint"?"n":"";let nr;throw Kt>3?Rt===0||Rt===BigInt(0)?nr=`>= 0${$e} and < 2${$e} ** ${(Kt+1)*8}${$e}`:nr=`>= -(2${$e} ** ${(Kt+1)*8-1}${$e}) and < 2 ** ${(Kt+1)*8-1}${$e}`:nr=`>= ${Rt}${$e} and <= ${Bt}${$e}`,new Ie.ERR_OUT_OF_RANGE("value",nr,vt)}Qe(Nt,Ot,Kt)}function ur(vt,Rt){if(typeof vt!="number")throw new Ie.ERR_INVALID_ARG_TYPE(Rt,"number",vt)}function ar(vt,Rt,Bt){throw Math.floor(vt)!==vt?(ur(vt,Bt),new Ie.ERR_OUT_OF_RANGE(Bt||"offset","an integer",vt)):Rt<0?new Ie.ERR_BUFFER_OUT_OF_BOUNDS:new Ie.ERR_OUT_OF_RANGE(Bt||"offset",`>= ${Bt?1:0} and <= ${Rt}`,vt)}const cr=/[^+/0-9A-Za-z-_]/g;function $r(vt){if(vt=vt.split("=")[0],vt=vt.trim().replace(cr,""),vt.length<2)return"";for(;vt.length%4!==0;)vt=vt+"=";return vt}function fr(vt,Rt){Rt=Rt||1/0;let Bt;const Nt=vt.length;let Ot=null;const Kt=[];for(let $e=0;$e<Nt;++$e){if(Bt=vt.charCodeAt($e),Bt>55295&&Bt<57344){if(!Ot){if(Bt>56319){(Rt-=3)>-1&&Kt.push(239,191,189);continue}else if($e+1===Nt){(Rt-=3)>-1&&Kt.push(239,191,189);continue}Ot=Bt;continue}if(Bt<56320){(Rt-=3)>-1&&Kt.push(239,191,189),Ot=Bt;continue}Bt=(Ot-55296<<10|Bt-56320)+65536}else Ot&&(Rt-=3)>-1&&Kt.push(239,191,189);if(Ot=null,Bt<128){if((Rt-=1)<0)break;Kt.push(Bt)}else if(Bt<2048){if((Rt-=2)<0)break;Kt.push(Bt>>6|192,Bt&63|128)}else if(Bt<65536){if((Rt-=3)<0)break;Kt.push(Bt>>12|224,Bt>>6&63|128,Bt&63|128)}else if(Bt<1114112){if((Rt-=4)<0)break;Kt.push(Bt>>18|240,Bt>>12&63|128,Bt>>6&63|128,Bt&63|128)}else throw new Error("Invalid code point")}return Kt}function ue(vt){const Rt=[];for(let Bt=0;Bt<vt.length;++Bt)Rt.push(vt.charCodeAt(Bt)&255);return Rt}function Qt(vt,Rt){let Bt,Nt,Ot;const Kt=[];for(let $e=0;$e<vt.length&&!((Rt-=2)<0);++$e)Bt=vt.charCodeAt($e),Nt=Bt>>8,Ot=Bt%256,Kt.push(Ot),Kt.push(Nt);return Kt}function me(vt){return tt.toByteArray($r(vt))}function Lt(vt,Rt,Bt,Nt){let Ot;for(Ot=0;Ot<Nt&&!(Ot+Bt>=Rt.length||Ot>=vt.length);++Ot)Rt[Ot+Bt]=vt[Ot];return Ot}function Gt(vt,Rt){return vt instanceof Rt||vt!=null&&vt.constructor!=null&&vt.constructor.name!=null&&vt.constructor.name===Rt.name}function Xt(vt){return vt!==vt}const Yt=function(){const vt="0123456789abcdef",Rt=new Array(256);for(let Bt=0;Bt<16;++Bt){const Nt=Bt*16;for(let Ot=0;Ot<16;++Ot)Rt[Nt+Ot]=vt[Bt]+vt[Ot]}return Rt}();function He(vt){return typeof BigInt>"u"?ir:vt}function ir(){throw new Error("BigInt not supported")}}(buffer)),buffer}var BufferList_1,hasRequiredBufferList;function requireBufferList(){if(hasRequiredBufferList)return BufferList_1;hasRequiredBufferList=1;const{Buffer:et}=requireBuffer(),tt=Symbol.for("BufferList");function rt(nt){if(!(this instanceof rt))return new rt(nt);rt._init.call(this,nt)}return rt._init=function(nt){Object.defineProperty(this,tt,{value:!0}),this._bufs=[],this.length=0,nt&&this.append(nt)},rt.prototype._new=function(nt){return new rt(nt)},rt.prototype._offset=function(nt){if(nt===0)return[0,0];let it=0;for(let ot=0;ot<this._bufs.length;ot++){const st=it+this._bufs[ot].length;if(nt<st||ot===this._bufs.length-1)return[ot,nt-it];it=st}},rt.prototype._reverseOffset=function(nt){const it=nt[0];let ot=nt[1];for(let st=0;st<it;st++)ot+=this._bufs[st].length;return ot},rt.prototype.get=function(nt){if(nt>this.length||nt<0)return;const it=this._offset(nt);return this._bufs[it[0]][it[1]]},rt.prototype.slice=function(nt,it){return typeof nt=="number"&&nt<0&&(nt+=this.length),typeof it=="number"&&it<0&&(it+=this.length),this.copy(null,0,nt,it)},rt.prototype.copy=function(nt,it,ot,st){if((typeof ot!="number"||ot<0)&&(ot=0),(typeof st!="number"||st>this.length)&&(st=this.length),ot>=this.length||st<=0)return nt||et.alloc(0);const at=!!nt,ct=this._offset(ot),ut=st-ot;let lt=ut,ht=at&&it||0,ft=ct[1];if(ot===0&&st===this.length){if(!at)return this._bufs.length===1?this._bufs[0]:et.concat(this._bufs,this.length);for(let dt=0;dt<this._bufs.length;dt++)this._bufs[dt].copy(nt,ht),ht+=this._bufs[dt].length;return nt}if(lt<=this._bufs[ct[0]].length-ft)return at?this._bufs[ct[0]].copy(nt,it,ft,ft+lt):this._bufs[ct[0]].slice(ft,ft+lt);at||(nt=et.allocUnsafe(ut));for(let dt=ct[0];dt<this._bufs.length;dt++){const pt=this._bufs[dt].length-ft;if(lt>pt)this._bufs[dt].copy(nt,ht,ft),ht+=pt;else{this._bufs[dt].copy(nt,ht,ft,ft+lt),ht+=pt;break}lt-=pt,ft&&(ft=0)}return nt.length>ht?nt.slice(0,ht):nt},rt.prototype.shallowSlice=function(nt,it){if(nt=nt||0,it=typeof it!="number"?this.length:it,nt<0&&(nt+=this.length),it<0&&(it+=this.length),nt===it)return this._new();const ot=this._offset(nt),st=this._offset(it),at=this._bufs.slice(ot[0],st[0]+1);return st[1]===0?at.pop():at[at.length-1]=at[at.length-1].slice(0,st[1]),ot[1]!==0&&(at[0]=at[0].slice(ot[1])),this._new(at)},rt.prototype.toString=function(nt,it,ot){return this.slice(it,ot).toString(nt)},rt.prototype.consume=function(nt){if(nt=Math.trunc(nt),Number.isNaN(nt)||nt<=0)return this;for(;this._bufs.length;)if(nt>=this._bufs[0].length)nt-=this._bufs[0].length,this.length-=this._bufs[0].length,this._bufs.shift();else{this._bufs[0]=this._bufs[0].slice(nt),this.length-=nt;break}return this},rt.prototype.duplicate=function(){const nt=this._new();for(let it=0;it<this._bufs.length;it++)nt.append(this._bufs[it]);return nt},rt.prototype.append=function(nt){if(nt==null)return this;if(nt.buffer)this._appendBuffer(et.from(nt.buffer,nt.byteOffset,nt.byteLength));else if(Array.isArray(nt))for(let it=0;it<nt.length;it++)this.append(nt[it]);else if(this._isBufferList(nt))for(let it=0;it<nt._bufs.length;it++)this.append(nt._bufs[it]);else typeof nt=="number"&&(nt=nt.toString()),this._appendBuffer(et.from(nt));return this},rt.prototype._appendBuffer=function(nt){this._bufs.push(nt),this.length+=nt.length},rt.prototype.indexOf=function(nt,it,ot){if(ot===void 0&&typeof it=="string"&&(ot=it,it=void 0),typeof nt=="function"||Array.isArray(nt))throw new TypeError('The "value" argument must be one of type string, Buffer, BufferList, or Uint8Array.');if(typeof nt=="number"?nt=et.from([nt]):typeof nt=="string"?nt=et.from(nt,ot):this._isBufferList(nt)?nt=nt.slice():Array.isArray(nt.buffer)?nt=et.from(nt.buffer,nt.byteOffset,nt.byteLength):et.isBuffer(nt)||(nt=et.from(nt)),it=Number(it||0),isNaN(it)&&(it=0),it<0&&(it=this.length+it),it<0&&(it=0),nt.length===0)return it>this.length?this.length:it;const st=this._offset(it);let at=st[0],ct=st[1];for(;at<this._bufs.length;at++){const ut=this._bufs[at];for(;ct<ut.length;)if(ut.length-ct>=nt.length){const lt=ut.indexOf(nt,ct);if(lt!==-1)return this._reverseOffset([at,lt]);ct=ut.length-nt.length+1}else{const lt=this._reverseOffset([at,ct]);if(this._match(lt,nt))return lt;ct++}ct=0}return-1},rt.prototype._match=function(nt,it){if(this.length-nt<it.length)return!1;for(let ot=0;ot<it.length;ot++)if(this.get(nt+ot)!==it[ot])return!1;return!0},function(){const nt={readDoubleBE:8,readDoubleLE:8,readFloatBE:4,readFloatLE:4,readInt32BE:4,readInt32LE:4,readUInt32BE:4,readUInt32LE:4,readInt16BE:2,readInt16LE:2,readUInt16BE:2,readUInt16LE:2,readInt8:1,readUInt8:1,readIntBE:null,readIntLE:null,readUIntBE:null,readUIntLE:null};for(const it in nt)(function(ot){nt[ot]===null?rt.prototype[ot]=function(st,at){return this.slice(st,st+at)[ot](0,at)}:rt.prototype[ot]=function(st=0){return this.slice(st,st+nt[ot])[ot](0)}})(it)}(),rt.prototype._isBufferList=function(nt){return nt instanceof rt||rt.isBufferList(nt)},rt.isBufferList=function(nt){return nt!=null&&nt[tt]},BufferList_1=rt,BufferList_1}const BITS_PER_BYTE=7;var sparseArray=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(et,tt){let rt=this._internalPositionFor(et,!1);if(tt===void 0)rt!==-1&&(this._unsetInternalPos(rt),this._unsetBit(et),this._changedLength=!0,this._changedData=!0);else{let nt=!1;rt===-1?(rt=this._data.length,this._setBit(et),this._changedData=!0):nt=!0,this._setInternalPos(rt,et,tt,nt),this._changedLength=!0}}unset(et){this.set(et,void 0)}get(et){this._sortData();const tt=this._internalPositionFor(et,!0);if(tt!==-1)return this._data[tt][1]}push(et){return this.set(this.length,et),this.length}get length(){if(this._sortData(),this._changedLength){const et=this._data[this._data.length-1];this._length=et?et[0]+1:0,this._changedLength=!1}return this._length}forEach(et){let tt=0;for(;tt<this.length;)et(this.get(tt),tt,this),tt++}map(et){let tt=0,rt=new Array(this.length);for(;tt<this.length;)rt[tt]=et(this.get(tt),tt,this),tt++;return rt}reduce(et,tt){let rt=0,nt=tt;for(;rt<this.length;){const it=this.get(rt);nt=et(nt,it,rt),rt++}return nt}find(et){let tt=0,rt,nt;for(;tt<this.length&&!rt;)nt=this.get(tt),rt=et(nt),tt++;return rt?nt:void 0}_internalPositionFor(et,tt){const rt=this._bytePosFor(et,tt);if(rt>=this._bitArrays.length)return-1;const nt=this._bitArrays[rt],it=et-rt*BITS_PER_BYTE;if(!((nt&1<<it)>0))return-1;const ot=this._bitArrays.slice(0,rt).reduce(popCountReduce,0),st=~(4294967295<<it+1),at=popCount(nt&st);return ot+at-1}_bytePosFor(et,tt){const rt=Math.floor(et/BITS_PER_BYTE),nt=rt+1;for(;!tt&&this._bitArrays.length<nt;)this._bitArrays.push(0);return rt}_setBit(et){const tt=this._bytePosFor(et,!1);this._bitArrays[tt]|=1<<et-tt*BITS_PER_BYTE}_unsetBit(et){const tt=this._bytePosFor(et,!1);this._bitArrays[tt]&=~(1<<et-tt*BITS_PER_BYTE)}_setInternalPos(et,tt,rt,nt){const it=this._data,ot=[tt,rt];if(nt)this._sortData(),it[et]=ot;else{if(it.length)if(it[it.length-1][0]>=tt)it.push(ot);else if(it[0][0]<=tt)it.unshift(ot);else{const st=Math.round(it.length/2);this._data=it.slice(0,st).concat(ot).concat(it.slice(st))}else this._data.push(ot);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(et){this._data.splice(et,1)}_sortData(){this._changedData&&this._data.sort(sortInternal),this._changedData=!1}bitField(){const et=[];let tt=8,rt=0,nt=0,it;const ot=this._bitArrays.slice();for(;ot.length||rt;){rt===0&&(it=ot.shift(),rt=7);const at=Math.min(rt,tt),ct=~(255<<at),ut=it&ct;nt|=ut<<8-tt,it=it>>>at,rt-=at,tt-=at,(!tt||!rt&&!ot.length)&&(et.push(nt),nt=0,tt=8)}for(var st=et.length-1;st>0&&et[st]===0;st--)et.pop();return et}compactArray(){return this._sortData(),this._data.map(valueOnly)}};function popCountReduce(et,tt){return et+popCount(tt)}function popCount(et){let tt=et;return tt=tt-(tt>>1&1431655765),tt=(tt&858993459)+(tt>>2&858993459),(tt+(tt>>4)&252645135)*16843009>>24}function sortInternal(et,tt){return et[0]-tt[0]}function valueOnly(et){return et[1]}const SparseArray=sparseArray,{fromString:uint8ArrayFromString$6}=require$$9$2;let Bucket$2=class Ur{constructor(tt,rt,nt=0){this._options=tt,this._popCount=0,this._parent=rt,this._posAtParent=nt,this._children=new SparseArray,this.key=null}async put(tt,rt){const nt=await this._findNewBucketAndPos(tt);await nt.bucket._putAt(nt,tt,rt)}async get(tt){const rt=await this._findChild(tt);if(rt)return rt.value}async del(tt){const rt=await this._findPlace(tt),nt=rt.bucket._at(rt.pos);nt&&nt.key===tt&&rt.bucket._delAt(rt.pos)}leafCount(){return this._children.compactArray().reduce((tt,rt)=>rt instanceof Ur?tt+rt.leafCount():tt+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){const tt=this._children.compactArray();for(const rt of tt)rt instanceof Ur?yield*rt.eachLeafSeries():yield rt;return[]}serialize(tt,rt){const nt=[];return rt(this._children.reduce((it,ot,st)=>(ot&&(ot instanceof Ur?it.push(ot.serialize(tt,rt)):it.push(tt(ot,st))),it),nt))}asyncTransform(tt,rt){return asyncTransformBucket(this,tt,rt)}toJSON(){return this.serialize(mapNode,reduceNodes)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(tt){const rt=await this._findPlace(tt),nt=rt.bucket._at(rt.pos);if(!(nt instanceof Ur)&&nt&&nt.key===tt)return nt}async _findPlace(tt){const rt=this._options.hash(typeof tt=="string"?uint8ArrayFromString$6(tt):tt),nt=await rt.take(this._options.bits),it=this._children.get(nt);return it instanceof Ur?it._findPlace(rt):{bucket:this,pos:nt,hash:rt,existingChild:it}}async _findNewBucketAndPos(tt){const rt=await this._findPlace(tt);if(rt.existingChild&&rt.existingChild.key!==tt){const nt=new Ur(this._options,rt.bucket,rt.pos);rt.bucket._putObjectAt(rt.pos,nt);const it=await nt._findPlace(rt.existingChild.hash);return it.bucket._putAt(it,rt.existingChild.key,rt.existingChild.value),nt._findNewBucketAndPos(rt.hash)}return rt}_putAt(tt,rt,nt){this._putObjectAt(tt.pos,{key:rt,value:nt,hash:tt.hash})}_putObjectAt(tt,rt){this._children.get(tt)||this._popCount++,this._children.set(tt,rt)}_delAt(tt){if(tt===-1)throw new Error("Invalid position");this._children.get(tt)&&this._popCount--,this._children.unset(tt),this._level()}_level(){if(this._parent&&this._popCount<=1)if(this._popCount===1){const tt=this._children.find(exists);if(tt&&!(tt instanceof Ur)){const rt=tt.hash;rt.untake(this._options.bits);const nt={pos:this._posAtParent,hash:rt,bucket:this._parent};this._parent._putAt(nt,tt.key,tt.value)}}else this._parent._delAt(this._posAtParent)}_at(tt){return this._children.get(tt)}};function exists(et){return!!et}function mapNode(et,tt){return et.key}function reduceNodes(et){return et}async function asyncTransformBucket(et,tt,rt){const nt=[];for(const it of et._children.compactArray())if(it instanceof Bucket$2)await asyncTransformBucket(it,tt,rt);else{const ot=await tt(it);nt.push({bitField:et._children.bitField(),children:ot})}return rt(nt)}var bucket=Bucket$2,consumableHash={exports:{}};const START_MASKS=[255,254,252,248,240,224,192,128],STOP_MASKS=[1,3,7,15,31,63,127,255];var consumableBuffer=class{constructor(et){this._value=et,this._currentBytePos=et.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+this._currentBytePos*8}totalBits(){return this._value.length*8}take(et){let tt=et,rt=0;for(;tt&&this._haveBits();){const nt=this._value[this._currentBytePos],it=this._currentBitPos+1,ot=Math.min(it,tt),st=byteBitsToInt(nt,it-ot,ot);rt=(rt<<ot)+st,tt-=ot,this._currentBitPos-=ot,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return rt}untake(et){for(this._currentBitPos+=et;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}};function byteBitsToInt(et,tt,rt){const nt=maskFor(tt,rt);return(et&nt)>>>tt}function maskFor(et,tt){return START_MASKS[et]&STOP_MASKS[Math.min(tt+et-1,7)]}const ConsumableBuffer=consumableBuffer,{concat:uint8ArrayConcat$1}=require$$7$1;function wrapHash$1(et){function tt(rt){return rt instanceof InfiniteHash?rt:new InfiniteHash(rt,et)}return tt}class InfiniteHash{constructor(tt,rt){if(!(tt instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=tt,this._hashFn=rt,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(tt){let rt=tt;for(;this._availableBits<rt;)await this._produceMoreBits();let nt=0;for(;rt>0;){const it=this._buffers[this._currentBufferIndex],ot=Math.min(it.availableBits(),rt),st=it.take(ot);nt=(nt<<ot)+st,rt-=ot,this._availableBits-=ot,it.availableBits()===0&&this._currentBufferIndex++}return nt}untake(tt){let rt=tt;for(;rt>0;){const nt=this._buffers[this._currentBufferIndex],it=Math.min(nt.totalBits()-nt.availableBits(),rt);nt.untake(it),rt-=it,this._availableBits+=it,this._currentBufferIndex>0&&nt.totalBits()===nt.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;const tt=this._depth?uint8ArrayConcat$1([this._value,Uint8Array.from([this._depth])]):this._value,rt=await this._hashFn(tt),nt=new ConsumableBuffer(rt);this._buffers.push(nt),this._availableBits+=nt.availableBits()}}consumableHash.exports=wrapHash$1,consumableHash.exports.InfiniteHash=InfiniteHash;var consumableHashExports=consumableHash.exports;const Bucket$1=bucket,wrapHash=consumableHashExports;function createHAMT$1(et){if(!et||!et.hashFn)throw new Error("please define an options.hashFn");const tt={bits:et.bits||8,hash:wrapHash(et.hashFn)};return new Bucket$1(tt)}var src$4={createHAMT:createHAMT$1,Bucket:Bucket$1};const{bases:bases$2}=require$$8;function createCodec$1(et,tt,rt,nt){return{name:et,prefix:tt,encoder:{name:et,prefix:tt,encode:rt},decoder:{decode:nt}}}const string$1=createCodec$1("utf8","u",et=>"u"+new TextDecoder("utf8").decode(et),et=>new TextEncoder().encode(et.substring(1))),ascii$1=createCodec$1("ascii","a",et=>{let tt="a";for(let rt=0;rt<et.length;rt++)tt+=String.fromCharCode(et[rt]);return tt},et=>{et=et.substring(1);const tt=new Uint8Array(et.length);for(let rt=0;rt<et.length;rt++)tt[rt]=et.charCodeAt(rt);return tt});({hex:bases$2.base16,...bases$2},mergeOptions.bind({ignoreUndefined:!0}));const{bases:bases$1}=require$$8;function createCodec(et,tt,rt,nt){return{name:et,prefix:tt,encoder:{name:et,prefix:tt,encode:rt},decoder:{decode:nt}}}const string=createCodec("utf8","u",et=>"u"+new TextDecoder("utf8").decode(et),et=>new TextEncoder().encode(et.substring(1))),ascii=createCodec("ascii","a",et=>{let tt="a";for(let rt=0;rt<et.length;rt++)tt+=String.fromCharCode(et[rt]);return tt},et=>{et=et.substring(1);const tt=new Uint8Array(et.length);for(let rt=0;rt<et.length;rt++)tt[rt]=et.charCodeAt(rt);return tt}),BASES={utf8:string,"utf-8":string,hex:bases$1.base16,latin1:ascii,ascii,binary:ascii,...bases$1};var bases_1=BASES;const bases=bases_1;function fromString$1(et,tt="utf8"){const rt=bases[tt];if(!rt)throw new Error(`Unsupported encoding "${tt}"`);return rt.decoder.decode(`${rt.prefix}${et}`)}var fromString_1=fromString$1;const{Bucket,createHAMT}=src$4,{decode:decode$5}=require$$5,mur=murmurhash3jsRevisited,uint8ArrayFromString$5=fromString_1,hashFn=async function(et){return uint8ArrayFromString$5(mur.x64.hash128(et),"base16").slice(0,8).reverse()},addLinksToHamtBucket=(et,tt,rt)=>Promise.all(et.map(nt=>{if(nt.Name==null)throw new Error("Unexpected Link without a Name");if(nt.Name.length===2){const it=parseInt(nt.Name,16);return tt._putObjectAt(it,new Bucket({hash:rt._options.hash,bits:rt._options.bits},tt,it))}return rt.put(nt.Name.substring(2),!0)})),toPrefix=et=>et.toString(16).toUpperCase().padStart(2,"0").substring(0,2),toBucketPath=et=>{let tt=et.bucket;const rt=[];for(;tt._parent;)rt.push(tt),tt=tt._parent;return rt.push(tt),rt.reverse()},findShardCid$1=async(et,tt,rt,nt,it)=>{if(!nt){const lt=createHAMT({hashFn});nt={rootBucket:lt,hamtDepth:1,lastBucket:lt}}await addLinksToHamtBucket(et.Links,nt.lastBucket,nt.rootBucket);const ot=await nt.rootBucket._findNewBucketAndPos(tt);let st=toPrefix(ot.pos);const at=toBucketPath(ot);at.length>nt.hamtDepth&&(nt.lastBucket=at[nt.hamtDepth],st=toPrefix(nt.lastBucket._posAtParent));const ct=et.Links.find(lt=>{if(lt.Name==null)return!1;const ht=lt.Name.substring(0,2),ft=lt.Name.substring(2);return!(ht!==st||ft&&ft!==tt)});if(!ct)return null;if(ct.Name!=null&&ct.Name.substring(2)===tt)return ct.Hash;nt.hamtDepth++;const ut=await rt.get(ct.Hash,it);return et=decode$5(ut),findShardCid$1(et,tt,rt,nt,it)};var findCidInShard=findShardCid$1,extractDataFromBlock$3=function et(tt,rt,nt,it){const ot=tt.length,st=rt+ot;return nt>=st||it<rt?new Uint8Array(0):(it>=rt&&it<st&&(tt=tt.slice(0,it-rt)),nt>=rt&&nt<st&&(tt=tt.slice(nt-rt)),tt)};const errCode$6=errCode$i,validateOffsetAndLength$3=(et,tt,rt)=>{if(tt||(tt=0),tt<0)throw errCode$6(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(tt>et)throw errCode$6(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(!rt&&rt!==0&&(rt=et-tt),rt<0)throw errCode$6(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");return tt+rt>et&&(rt=et-tt),{offset:tt,length:rt}};var validateOffsetAndLength_1=validateOffsetAndLength$3;const extractDataFromBlock$2=extractDataFromBlock$3,validateOffsetAndLength$2=validateOffsetAndLength_1,{UnixFS:UnixFS$1}=src$c,errCode$5=errCode$i,dagPb$1=require$$5,dagCbor$2=require$$6,raw$3=require$$9$1;async function*emitBytes(et,tt,rt,nt,it=0,ot){if(tt instanceof Uint8Array){const ct=extractDataFromBlock$2(tt,it,rt,nt);return ct.length&&(yield ct),it+=ct.length,it}if(tt.Data==null)throw errCode$5(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let st;try{st=UnixFS$1.unmarshal(tt.Data)}catch(ct){throw errCode$5(ct,"ERR_NOT_UNIXFS")}if(st.data&&st.data.length){const ct=extractDataFromBlock$2(st.data,it,rt,nt);ct.length&&(yield ct),it+=st.data.length}let at=it;for(let ct=0;ct<tt.Links.length;ct++){const ut=tt.Links[ct],lt=it+st.blockSizes[ct];if(rt>=at&&rt<lt||nt>at&&nt<=lt||rt<at&&nt>lt){const ht=await et.get(ut.Hash,{signal:ot.signal});let ft;switch(ut.Hash.code){case dagPb$1.code:ft=await dagPb$1.decode(ht);break;case raw$3.code:ft=ht;break;case dagCbor$2.code:ft=await dagCbor$2.decode(ht);break;default:throw Error(`Unsupported codec: ${ut.Hash.code}`)}for await(const dt of emitBytes(et,ft,rt,nt,it,ot))it+=dt.length,yield dt}it=lt,at=lt+1}}const fileContent=(et,tt,rt,nt,it,ot,st)=>{function at(ct={}){const ut=rt.fileSize();if(ut===void 0)throw new Error("File was a directory");const{offset:lt,length:ht}=validateOffsetAndLength$2(ut,ct.offset,ct.length),ft=lt,dt=lt+ht;return emitBytes(st,tt,ft,dt,0,ct)}return at};var file=fileContent;const directoryContent=(et,tt,rt,nt,it,ot,st)=>{async function*at(ct={}){const ut=ct.offset||0,lt=ct.length||tt.Links.length,ht=tt.Links.slice(ut,lt);for(const ft of ht){const dt=await it(ft.Hash,ft.Name||"",`${nt}/${ft.Name||""}`,[],ot+1,st,ct);dt.entry&&(yield dt.entry)}}return at};var directory=directoryContent;const{decode:decode$4}=require$$5,hamtShardedDirectoryContent=(et,tt,rt,nt,it,ot,st)=>{function at(ct={}){return listDirectory(tt,nt,it,ot,st,ct)}return at};async function*listDirectory(et,tt,rt,nt,it,ot){const st=et.Links;for(const at of st){const ct=at.Name!=null?at.Name.substring(2):null;if(ct)yield(await rt(at.Hash,ct,`${tt}/${ct}`,[],nt+1,it,ot)).entry;else{const ut=await it.get(at.Hash);et=decode$4(ut);for await(const lt of listDirectory(et,tt,rt,nt,it,ot))yield lt}}}var hamtShardedDirectory=hamtShardedDirectoryContent;const errCode$4=errCode$i,{UnixFS}=src$c,findShardCid=findCidInShard,{decode:decode$3}=require$$5,findLinkCid=(et,tt)=>{const rt=et.Links.find(nt=>nt.Name===tt);return rt&&rt.Hash},contentExporters={raw:file,file,directory,"hamt-sharded-directory":hamtShardedDirectory,metadata:(et,tt,rt,nt,it,ot,st)=>()=>[],symlink:(et,tt,rt,nt,it,ot,st)=>()=>[]},unixFsResolver=async(et,tt,rt,nt,it,ot,st,at)=>{const ct=await st.get(et,at),ut=decode$3(ct);let lt,ht;if(tt||(tt=et.toString()),ut.Data==null)throw errCode$4(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{lt=UnixFS.unmarshal(ut.Data)}catch(ft){throw errCode$4(ft,"ERR_NOT_UNIXFS")}if(rt||(rt=tt),nt.length){let ft;if(lt&&lt.type==="hamt-sharded-directory"?ft=await findShardCid(ut,nt[0],st):ft=findLinkCid(ut,nt[0]),!ft)throw errCode$4(new Error("file does not exist"),"ERR_NOT_FOUND");const dt=nt.shift(),pt=`${rt}/${dt}`;ht={cid:ft,toResolve:nt,name:dt||"",path:pt}}return{entry:{type:lt.isDirectory()?"directory":"file",name:tt,path:rt,cid:et,content:contentExporters[lt.type](et,ut,lt,rt,it,ot,st),unixfs:lt,depth:ot,node:ut,size:lt.fileSize()},next:ht}};var unixfsV1=unixFsResolver;const errCode$3=errCode$i,extractDataFromBlock$1=extractDataFromBlock$3,validateOffsetAndLength$1=validateOffsetAndLength_1,rawContent$1=et=>{async function*tt(rt={}){const{offset:nt,length:it}=validateOffsetAndLength$1(et.length,rt.offset,rt.length);yield extractDataFromBlock$1(et,0,nt,nt+it)}return tt},resolve$2=async(et,tt,rt,nt,it,ot,st,at)=>{if(nt.length)throw errCode$3(new Error(`No link named ${rt} found in raw node ${et}`),"ERR_NOT_FOUND");const ct=await st.get(et,at);return{entry:{type:"raw",name:tt,path:rt,cid:et,content:rawContent$1(ct),depth:ot,size:ct.length,node:ct}}};var raw$2=resolve$2;const{CID}=require$$6$2,errCode$2=errCode$i,dagCbor$1=require$$6,resolve$1=async(et,tt,rt,nt,it,ot,st,at)=>{const ct=await st.get(et),ut=dagCbor$1.decode(ct);let lt=ut,ht=rt;for(;nt.length;){const ft=nt[0];if(ft in lt){nt.shift(),ht=`${ht}/${ft}`;const dt=CID.asCID(lt[ft]);if(dt)return{entry:{type:"object",name:tt,path:rt,cid:et,node:ct,depth:ot,size:ct.length,content:async function*(){yield ut}},next:{cid:dt,name:ft,path:ht,toResolve:nt}};lt=lt[ft]}else throw errCode$2(new Error(`No property named ${ft} found in cbor node ${et}`),"ERR_NO_PROP")}return{entry:{type:"object",name:tt,path:rt,cid:et,node:ct,depth:ot,size:ct.length,content:async function*(){yield ut}}}};var dagCbor_1=resolve$1;const errCode$1=errCode$i,extractDataFromBlock=extractDataFromBlock$3,validateOffsetAndLength=validateOffsetAndLength_1,mh=require$$6$1,rawContent=et=>{async function*tt(rt={}){const{offset:nt,length:it}=validateOffsetAndLength(et.length,rt.offset,rt.length);yield extractDataFromBlock(et,0,nt,nt+it)}return tt},resolve=async(et,tt,rt,nt,it,ot,st,at)=>{if(nt.length)throw errCode$1(new Error(`No link named ${rt} found in raw node ${et}`),"ERR_NOT_FOUND");const ct=await mh.decode(et.multihash.bytes);return{entry:{type:"identity",name:tt,path:rt,cid:et,content:rawContent(ct.digest),depth:ot,size:ct.digest.length,node:ct.digest}}};var identity$2=resolve;const dagPb=require$$5,dagCbor=require$$6,raw$1=require$$9$1,{identity:identity$1}=require$$7;dagPb.code+"",raw$1.code+"",dagCbor.code+"",identity$1.code+"";var config={exports:{}};const set=justSafeSet,getDefaultConfig=configBrowser,withTimeoutOption=withTimeoutOption_1,log$4=browserExports("ipfs:core:config");config.exports=({repo:et})=>{return{getAll:withTimeoutOption(tt),get:withTimeoutOption(rt),set:withTimeoutOption(nt),replace:withTimeoutOption(it),profiles:{apply:withTimeoutOption(ot),list:withTimeoutOption(listProfiles)}};async function tt(st={}){return et.config.getAll(st)}async function rt(st,at){return st?et.config.get(st,at):Promise.reject(new Error("key argument is required"))}async function nt(st,at,ct){return et.config.set(st,at,ct)}async function it(st,at){return et.config.replace(st,at)}async function ot(st,at={dryRun:!1}){const{dryRun:ct}=at,ut=profiles[st];if(!ut)throw new Error(`No profile with name '${st}' exists`);try{const lt=await et.config.getAll(at);let ht=JSON.parse(JSON.stringify(lt));return ht=ut.transform(ht),ct||await et.config.replace(ht,at),delete lt.Identity.PrivKey,delete ht.Identity.PrivKey,{original:lt,updated:ht}}catch(lt){throw log$4(lt),new Error(`Could not apply profile '${st}' to config: ${lt.message}`)}}};async function listProfiles(et){return Object.keys(profiles).map(tt=>({name:tt,description:profiles[tt].description}))}const profiles={server:{description:"Recommended for nodes with public IPv4 address (servers, VPSes, etc.), disables host and content discovery and UPnP in local networks.",transform:et=>(set(et,"Discovery.MDNS.Enabled",!1),set(et,"Discovery.webRTCStar.Enabled",!1),et.Swarm={...et.Swarm||{},DisableNatPortMap:!0},et)},"local-discovery":{description:"Sets default values to fields affected by `server` profile, enables discovery and UPnP in local networks.",transform:et=>(set(et,"Discovery.MDNS.Enabled",!0),set(et,"Discovery.webRTCStar.Enabled",!0),set(et,"Swarm",{...et.Swarm||{},DisableNatPortMap:!1}),et)},test:{description:"Reduces external interference, useful for running ipfs in test environments. Note that with these settings node won't be able to talk to the rest of the network without manual bootstrap.",transform:et=>{const tt=getDefaultConfig();return set(et,"Addresses.API",tt.Addresses.API?"/ip4/127.0.0.1/tcp/0":""),set(et,"Addresses.Gateway",tt.Addresses.Gateway?"/ip4/127.0.0.1/tcp/0":""),set(et,"Addresses.Swarm",tt.Addresses.Swarm.length?["/ip4/127.0.0.1/tcp/0"]:[]),set(et,"Addresses.Delegates",[]),set(et,"Bootstrap",[]),set(et,"Discovery.MDNS.Enabled",!1),set(et,"Discovery.webRTCStar.Enabled",!1),set(et,"Swarm",{...et.Swarm||{},DisableNatPortMap:!0}),et}},"default-networking":{description:"Restores default network settings. Inverse profile of the `test` profile.",transform:et=>{const tt=getDefaultConfig();return set(et,"Addresses.API",tt.Addresses.API),set(et,"Addresses.Gateway",tt.Addresses.Gateway),set(et,"Addresses.Swarm",tt.Addresses.Swarm),set(et,"Addresses.Delegates",tt.Addresses.Delegates),set(et,"Bootstrap",tt.Bootstrap),set(et,"Discovery.MDNS.Enabled",tt.Discovery.MDNS.Enabled),set(et,"Discovery.webRTCStar.Enabled",tt.Discovery.webRTCStar.Enabled),set(et,"Swarm",{...et.Swarm||{},DisableNatPortMap:!1}),et}},lowpower:{description:"Reduces daemon overhead on the system. May affect node functionality,performance of content discovery and data fetching may be degraded. Recommended for low power systems.",transform:et=>{const tt=et.Swarm||{},rt=tt.ConnMgr||{};return rt.LowWater=20,rt.HighWater=40,tt.ConnMgr=rt,et.Swarm=tt,et}},"default-power":{description:'Inverse of "lowpower" profile.',transform:et=>{const tt=getDefaultConfig();return et.Swarm=tt.Swarm,et}}};config.exports.profiles=profiles;const require$$10=getAugmentedNamespace(json$1);browserExports("ipfs:components:dag:import");const raw=require$$9$1,json=require$$10;raw.code,json.code,browserExports("ipfs:components:dag:import");const{default:PQueue}=dist$1,debug$7=browserExports;Object.assign(debug$7("ipfs:preload"),{error:debug$7("ipfs:preload:error")}),new PQueue({concurrency:4});const debug$6=browserExports;Object.assign(debug$6("ipfs:preload"),{error:debug$6("ipfs:preload:error")});const debug$5=browserExports;Object.assign(debug$5("ipfs:mfs-preload"),{error:debug$5("ipfs:mfs-preload:error")}),browserExports("ipfs:mfs:utils:with-mfs-root"),mergeOptions.bind({ignoreUndefined:!0}),browserExports("ipfs:mfs:stat"),browserExports("ipfs:mfs:utils:to-trail"),browserExports("ipfs:mfs:core:utils:hamt-utils"),browserExports("ipfs:mfs:core:utils:add-link"),browserExports("ipfs:mfs:utils:update-tree"),browserExports("ipfs:mfs:utils:update-mfs-root"),browserExports("ipfs:mfs:mkdir"),mergeOptions.bind({ignoreUndefined:!0}),browserExports("ipfs:mfs:cp"),mergeOptions.bind({ignoreUndefined:!0}),browserExports("ipfs:mfs:core:utils:remove-link"),mergeOptions.bind({ignoreUndefined:!0}),mergeOptions.bind({ignoreUndefined:!0}),browserExports("ipfs:mfs:touch"),mergeOptions.bind({ignoreUndefined:!0}),mergeOptions.bind({ignoreUndefined:!0}),mergeOptions.bind({ignoreUndefined:!0}),browserExports("ipfs:mfs:touch"),browserExports("ipfs:mfs:utils:to-async-iterator"),browserExports("ipfs:mfs:write"),mergeOptions.bind({ignoreUndefined:!0}),mergeOptions.bind({ignoreUndefined:!0}),browserExports("ipfs:repo:gc");var topology,hasRequiredTopology;function requireTopology(){if(hasRequiredTopology)return topology;hasRequiredTopology=1;const et=()=>{},tt=Symbol.for("@libp2p/js-interfaces/topology");class rt{constructor({min:it=0,max:ot=1/0,handlers:st={}}){this.min=it,this.max=ot,this._onConnect=st.onConnect||et,this._onDisconnect=st.onDisconnect||et,this.peers=new Set}get[Symbol.toStringTag](){return"Topology"}get[tt](){return!0}static isTopology(it){return!!(it&&it[tt])}set registrar(it){this._registrar=it}disconnect(it){this._onDisconnect(it)}}return topology=rt,topology}const Topology=requireTopology(),multicodecTopologySymbol=Symbol.for("@libp2p/js-interfaces/topology/multicodec-topology");let MulticodecTopology$1=class extends Topology{constructor({min:et,max:tt,multicodecs:rt,handlers:nt}){if(super({min:et,max:tt,handlers:nt}),!rt)throw new Error("one or more multicodec should be provided");if(!nt)throw new Error("the handlers should be provided");if(typeof nt.onConnect!="function")throw new Error("the 'onConnect' handler must be provided");if(typeof nt.onDisconnect!="function")throw new Error("the 'onDisconnect' handler must be provided");this.multicodecs=Array.isArray(rt)?rt:[rt],this._registrar=void 0,this._onProtocolChange=this._onProtocolChange.bind(this),this._onPeerConnect=this._onPeerConnect.bind(this)}get[Symbol.toStringTag](){return"Topology"}get[multicodecTopologySymbol](){return!0}static isMulticodecTopology(et){return!!(et&&et[multicodecTopologySymbol])}set registrar(et){this._registrar=et,this._registrar.peerStore.on("change:protocols",this._onProtocolChange),this._registrar.connectionManager.on("peer:connect",this._onPeerConnect),this._updatePeers(this._registrar.peerStore.peers.values())}_updatePeers(et){for(const{id:tt,protocols:rt}of et)if(this.multicodecs.filter(nt=>rt.includes(nt)).length){this.peers.add(tt.toB58String());const nt=this._registrar.getConnection(tt);nt&&this._onConnect(tt,nt)}else this.peers.delete(tt.toB58String())}_onProtocolChange({peerId:et,protocols:tt}){const rt=this.peers.has(et.toB58String()),nt=tt.filter(it=>this.multicodecs.includes(it));rt&&nt.length===0&&this._onDisconnect(et);for(const it of tt)if(this.multicodecs.includes(it)){const ot=this._registrar.peerStore.get(et);this._updatePeers([ot]);return}}_onPeerConnect(et){const tt=et.remotePeer,rt=this._registrar.peerStore.protoBook.get(tt);rt&&this.multicodecs.find(nt=>rt.includes(nt))&&(this.peers.add(tt.toB58String()),this._onConnect(tt,et))}};var multicodecTopology=MulticodecTopology$1,errors$1={};errors$1.codes={ERR_INVALID_SIGNATURE_POLICY:"ERR_INVALID_SIGNATURE_POLICY",ERR_UNHANDLED_SIGNATURE_POLICY:"ERR_UNHANDLED_SIGNATURE_POLICY",ERR_MISSING_SIGNATURE:"ERR_MISSING_SIGNATURE",ERR_MISSING_SEQNO:"ERR_MISSING_SEQNO",ERR_INVALID_SIGNATURE:"ERR_INVALID_SIGNATURE",ERR_UNEXPECTED_FROM:"ERR_UNEXPECTED_FROM",ERR_UNEXPECTED_SIGNATURE:"ERR_UNEXPECTED_SIGNATURE",ERR_UNEXPECTED_KEY:"ERR_UNEXPECTED_KEY",ERR_UNEXPECTED_SEQNO:"ERR_UNEXPECTED_SEQNO"};var $protobuf$4=minimal,$Reader$4=$protobuf$4.Reader,$Writer$4=$protobuf$4.Writer,$util$4=$protobuf$4.util,$root$4=$protobuf$4.roots["libp2p-pubsub-rpc"]||($protobuf$4.roots["libp2p-pubsub-rpc"]={});$root$4.RPC=function(){function et(tt){if(this.subscriptions=[],this.msgs=[],tt)for(var rt=Object.keys(tt),nt=0;nt<rt.length;++nt)tt[rt[nt]]!=null&&(this[rt[nt]]=tt[rt[nt]])}return et.prototype.subscriptions=$util$4.emptyArray,et.prototype.msgs=$util$4.emptyArray,et.encode=function(tt,rt){if(rt||(rt=$Writer$4.create()),tt.subscriptions!=null&&tt.subscriptions.length)for(var nt=0;nt<tt.subscriptions.length;++nt)$root$4.RPC.SubOpts.encode(tt.subscriptions[nt],rt.uint32(10).fork()).ldelim();if(tt.msgs!=null&&tt.msgs.length)for(var nt=0;nt<tt.msgs.length;++nt)$root$4.RPC.Message.encode(tt.msgs[nt],rt.uint32(18).fork()).ldelim();return rt},et.decode=function(tt,rt){tt instanceof $Reader$4||(tt=$Reader$4.create(tt));for(var nt=rt===void 0?tt.len:tt.pos+rt,it=new $root$4.RPC;tt.pos<nt;){var ot=tt.uint32();switch(ot>>>3){case 1:it.subscriptions&&it.subscriptions.length||(it.subscriptions=[]),it.subscriptions.push($root$4.RPC.SubOpts.decode(tt,tt.uint32()));break;case 2:it.msgs&&it.msgs.length||(it.msgs=[]),it.msgs.push($root$4.RPC.Message.decode(tt,tt.uint32()));break;default:tt.skipType(ot&7);break}}return it},et.fromObject=function(tt){if(tt instanceof $root$4.RPC)return tt;var rt=new $root$4.RPC;if(tt.subscriptions){if(!Array.isArray(tt.subscriptions))throw TypeError(".RPC.subscriptions: array expected");rt.subscriptions=[];for(var nt=0;nt<tt.subscriptions.length;++nt){if(typeof tt.subscriptions[nt]!="object")throw TypeError(".RPC.subscriptions: object expected");rt.subscriptions[nt]=$root$4.RPC.SubOpts.fromObject(tt.subscriptions[nt])}}if(tt.msgs){if(!Array.isArray(tt.msgs))throw TypeError(".RPC.msgs: array expected");rt.msgs=[];for(var nt=0;nt<tt.msgs.length;++nt){if(typeof tt.msgs[nt]!="object")throw TypeError(".RPC.msgs: object expected");rt.msgs[nt]=$root$4.RPC.Message.fromObject(tt.msgs[nt])}}return rt},et.toObject=function(tt,rt){rt||(rt={});var nt={};if((rt.arrays||rt.defaults)&&(nt.subscriptions=[],nt.msgs=[]),tt.subscriptions&&tt.subscriptions.length){nt.subscriptions=[];for(var it=0;it<tt.subscriptions.length;++it)nt.subscriptions[it]=$root$4.RPC.SubOpts.toObject(tt.subscriptions[it],rt)}if(tt.msgs&&tt.msgs.length){nt.msgs=[];for(var it=0;it<tt.msgs.length;++it)nt.msgs[it]=$root$4.RPC.Message.toObject(tt.msgs[it],rt)}return nt},et.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf$4.util.toJSONOptions)},et.SubOpts=function(){function tt(nt){if(nt)for(var it=Object.keys(nt),ot=0;ot<it.length;++ot)nt[it[ot]]!=null&&(this[it[ot]]=nt[it[ot]])}tt.prototype.subscribe=null,tt.prototype.topicID=null;var rt;return Object.defineProperty(tt.prototype,"_subscribe",{get:$util$4.oneOfGetter(rt=["subscribe"]),set:$util$4.oneOfSetter(rt)}),Object.defineProperty(tt.prototype,"_topicID",{get:$util$4.oneOfGetter(rt=["topicID"]),set:$util$4.oneOfSetter(rt)}),tt.encode=function(nt,it){return it||(it=$Writer$4.create()),nt.subscribe!=null&&Object.hasOwnProperty.call(nt,"subscribe")&&it.uint32(8).bool(nt.subscribe),nt.topicID!=null&&Object.hasOwnProperty.call(nt,"topicID")&&it.uint32(18).string(nt.topicID),it},tt.decode=function(nt,it){nt instanceof $Reader$4||(nt=$Reader$4.create(nt));for(var ot=it===void 0?nt.len:nt.pos+it,st=new $root$4.RPC.SubOpts;nt.pos<ot;){var at=nt.uint32();switch(at>>>3){case 1:st.subscribe=nt.bool();break;case 2:st.topicID=nt.string();break;default:nt.skipType(at&7);break}}return st},tt.fromObject=function(nt){if(nt instanceof $root$4.RPC.SubOpts)return nt;var it=new $root$4.RPC.SubOpts;return nt.subscribe!=null&&(it.subscribe=!!nt.subscribe),nt.topicID!=null&&(it.topicID=String(nt.topicID)),it},tt.toObject=function(nt,it){it||(it={});var ot={};return nt.subscribe!=null&&nt.hasOwnProperty("subscribe")&&(ot.subscribe=nt.subscribe,it.oneofs&&(ot._subscribe="subscribe")),nt.topicID!=null&&nt.hasOwnProperty("topicID")&&(ot.topicID=nt.topicID,it.oneofs&&(ot._topicID="topicID")),ot},tt.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf$4.util.toJSONOptions)},tt}(),et.Message=function(){function tt(nt){if(this.topicIDs=[],nt)for(var it=Object.keys(nt),ot=0;ot<it.length;++ot)nt[it[ot]]!=null&&(this[it[ot]]=nt[it[ot]])}tt.prototype.from=null,tt.prototype.data=null,tt.prototype.seqno=null,tt.prototype.topicIDs=$util$4.emptyArray,tt.prototype.signature=null,tt.prototype.key=null;var rt;return Object.defineProperty(tt.prototype,"_from",{get:$util$4.oneOfGetter(rt=["from"]),set:$util$4.oneOfSetter(rt)}),Object.defineProperty(tt.prototype,"_data",{get:$util$4.oneOfGetter(rt=["data"]),set:$util$4.oneOfSetter(rt)}),Object.defineProperty(tt.prototype,"_seqno",{get:$util$4.oneOfGetter(rt=["seqno"]),set:$util$4.oneOfSetter(rt)}),Object.defineProperty(tt.prototype,"_signature",{get:$util$4.oneOfGetter(rt=["signature"]),set:$util$4.oneOfSetter(rt)}),Object.defineProperty(tt.prototype,"_key",{get:$util$4.oneOfGetter(rt=["key"]),set:$util$4.oneOfSetter(rt)}),tt.encode=function(nt,it){if(it||(it=$Writer$4.create()),nt.from!=null&&Object.hasOwnProperty.call(nt,"from")&&it.uint32(10).bytes(nt.from),nt.data!=null&&Object.hasOwnProperty.call(nt,"data")&&it.uint32(18).bytes(nt.data),nt.seqno!=null&&Object.hasOwnProperty.call(nt,"seqno")&&it.uint32(26).bytes(nt.seqno),nt.topicIDs!=null&&nt.topicIDs.length)for(var ot=0;ot<nt.topicIDs.length;++ot)it.uint32(34).string(nt.topicIDs[ot]);return nt.signature!=null&&Object.hasOwnProperty.call(nt,"signature")&&it.uint32(42).bytes(nt.signature),nt.key!=null&&Object.hasOwnProperty.call(nt,"key")&&it.uint32(50).bytes(nt.key),it},tt.decode=function(nt,it){nt instanceof $Reader$4||(nt=$Reader$4.create(nt));for(var ot=it===void 0?nt.len:nt.pos+it,st=new $root$4.RPC.Message;nt.pos<ot;){var at=nt.uint32();switch(at>>>3){case 1:st.from=nt.bytes();break;case 2:st.data=nt.bytes();break;case 3:st.seqno=nt.bytes();break;case 4:st.topicIDs&&st.topicIDs.length||(st.topicIDs=[]),st.topicIDs.push(nt.string());break;case 5:st.signature=nt.bytes();break;case 6:st.key=nt.bytes();break;default:nt.skipType(at&7);break}}return st},tt.fromObject=function(nt){if(nt instanceof $root$4.RPC.Message)return nt;var it=new $root$4.RPC.Message;if(nt.from!=null&&(typeof nt.from=="string"?$util$4.base64.decode(nt.from,it.from=$util$4.newBuffer($util$4.base64.length(nt.from)),0):nt.from.length&&(it.from=nt.from)),nt.data!=null&&(typeof nt.data=="string"?$util$4.base64.decode(nt.data,it.data=$util$4.newBuffer($util$4.base64.length(nt.data)),0):nt.data.length&&(it.data=nt.data)),nt.seqno!=null&&(typeof nt.seqno=="string"?$util$4.base64.decode(nt.seqno,it.seqno=$util$4.newBuffer($util$4.base64.length(nt.seqno)),0):nt.seqno.length&&(it.seqno=nt.seqno)),nt.topicIDs){if(!Array.isArray(nt.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");it.topicIDs=[];for(var ot=0;ot<nt.topicIDs.length;++ot)it.topicIDs[ot]=String(nt.topicIDs[ot])}return nt.signature!=null&&(typeof nt.signature=="string"?$util$4.base64.decode(nt.signature,it.signature=$util$4.newBuffer($util$4.base64.length(nt.signature)),0):nt.signature.length&&(it.signature=nt.signature)),nt.key!=null&&(typeof nt.key=="string"?$util$4.base64.decode(nt.key,it.key=$util$4.newBuffer($util$4.base64.length(nt.key)),0):nt.key.length&&(it.key=nt.key)),it},tt.toObject=function(nt,it){it||(it={});var ot={};if((it.arrays||it.defaults)&&(ot.topicIDs=[]),nt.from!=null&&nt.hasOwnProperty("from")&&(ot.from=it.bytes===String?$util$4.base64.encode(nt.from,0,nt.from.length):it.bytes===Array?Array.prototype.slice.call(nt.from):nt.from,it.oneofs&&(ot._from="from")),nt.data!=null&&nt.hasOwnProperty("data")&&(ot.data=it.bytes===String?$util$4.base64.encode(nt.data,0,nt.data.length):it.bytes===Array?Array.prototype.slice.call(nt.data):nt.data,it.oneofs&&(ot._data="data")),nt.seqno!=null&&nt.hasOwnProperty("seqno")&&(ot.seqno=it.bytes===String?$util$4.base64.encode(nt.seqno,0,nt.seqno.length):it.bytes===Array?Array.prototype.slice.call(nt.seqno):nt.seqno,it.oneofs&&(ot._seqno="seqno")),nt.topicIDs&&nt.topicIDs.length){ot.topicIDs=[];for(var st=0;st<nt.topicIDs.length;++st)ot.topicIDs[st]=nt.topicIDs[st]}return nt.signature!=null&&nt.hasOwnProperty("signature")&&(ot.signature=it.bytes===String?$util$4.base64.encode(nt.signature,0,nt.signature.length):it.bytes===Array?Array.prototype.slice.call(nt.signature):nt.signature,it.oneofs&&(ot._signature="signature")),nt.key!=null&&nt.hasOwnProperty("key")&&(ot.key=it.bytes===String?$util$4.base64.encode(nt.key,0,nt.key.length):it.bytes===Array?Array.prototype.slice.call(nt.key):nt.key,it.oneofs&&(ot._key="key")),ot},tt.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf$4.util.toJSONOptions)},tt}(),et}();var rpc$1=$root$4,src$3={},encode$2={exports:{}};const Varint$1=varint$7,{Buffer:Buffer$5}=requireBuffer(),varintEncode$1=(et,tt,rt)=>{const nt=Varint$1.encode(et,tt,rt);return varintEncode$1.bytes=Varint$1.encode.bytes,tt||Buffer$5.from(nt)};var varintEncode_1=varintEncode$1;const{Buffer:Buffer$4}=requireBuffer(),BufferList$1=requireBufferList(),varintEncode=varintEncode_1,MIN_POOL_SIZE=8,DEFAULT_POOL_SIZE=10*1024;function encode$1(et){et=et||{};const tt=Math.max(et.poolSize||DEFAULT_POOL_SIZE,et.minPoolSize||MIN_POOL_SIZE),rt=et.lengthEncoder||varintEncode;return async function*(nt){let it=Buffer$4.alloc(tt),ot=0;for await(const st of nt){rt(st.length,it,ot);const at=it.slice(ot,ot+rt.bytes);ot+=rt.bytes,it.length-ot<MIN_POOL_SIZE&&(it=Buffer$4.alloc(tt),ot=0),yield new BufferList$1().append(at).append(st)}}}encode$1.single=(et,tt)=>{tt=tt||{};const rt=tt.lengthEncoder||varintEncode;return new BufferList$1([rt(et.length),et.slice()])},encode$2.exports=encode$1,encode$2.exports.MIN_POOL_SIZE=MIN_POOL_SIZE,encode$2.exports.DEFAULT_POOL_SIZE=DEFAULT_POOL_SIZE;var encodeExports=encode$2.exports,decode$2={exports:{}};const Varint=varint$7,{Buffer:Buffer$3}=requireBuffer(),toBufferProxy=et=>new Proxy({},{get:(tt,rt)=>rt[0]==="l"?et[rt]:et.get(parseInt(rt))}),varintDecode$1=et=>{const tt=Varint.decode(Buffer$3.isBuffer(et)?et:toBufferProxy(et));return varintDecode$1.bytes=Varint.decode.bytes,tt};var varintDecode_1=varintDecode$1;const{Buffer:Buffer$2}=requireBuffer(),BufferList=requireBufferList(),varintDecode=varintDecode_1,MAX_LENGTH_LENGTH=8,MAX_DATA_LENGTH=1024*1024*4,Empty=Buffer$2.alloc(0),ReadModes={LENGTH:"readLength",DATA:"readData"},ReadHandlers={[ReadModes.LENGTH]:(et,tt,rt,nt)=>{tt=tt.append(et);let it;try{it=nt.lengthDecoder(tt)}catch(ot){if(tt.length>nt.maxLengthLength)throw Object.assign(ot,{message:"message length too long",code:"ERR_MSG_LENGTH_TOO_LONG"});if(ot instanceof RangeError)return{mode:ReadModes.LENGTH,buffer:tt,chunk:void 0,state:void 0,data:void 0};throw ot}if(it>nt.maxDataLength)throw Object.assign(new Error("message data too long"),{code:"ERR_MSG_DATA_TOO_LONG"});return et=tt.shallowSlice(nt.lengthDecoder.bytes),tt=new BufferList,nt.onLength&&nt.onLength(it),it<=0?(nt.onData&&nt.onData(Empty),{mode:ReadModes.LENGTH,chunk:et,buffer:tt,data:Empty}):{mode:ReadModes.DATA,chunk:et,buffer:tt,state:{dataLength:it},data:void 0}},[ReadModes.DATA]:(et,tt,rt,nt)=>{if(tt=tt.append(et),!rt)throw new Error("state is required");if(tt.length<rt.dataLength)return{mode:ReadModes.DATA,buffer:tt,state:rt,chunk:void 0,data:void 0};const{dataLength:it}=rt,ot=tt.shallowSlice(0,it),st=tt.length>it?tt.shallowSlice(it):void 0;return tt=new BufferList,nt.onData&&nt.onData(ot),{mode:ReadModes.LENGTH,chunk:st,buffer:tt,state:void 0,data:ot}}};function decode$1(et){et=et||{};const tt={lengthDecoder:et.lengthDecoder||varintDecode,maxLengthLength:et.maxLengthLength||MAX_LENGTH_LENGTH,maxDataLength:et.maxDataLength||MAX_DATA_LENGTH,onLength:et.onLength,onData:et.onData};return async function*(rt){let nt=new BufferList,it=ReadModes.LENGTH,ot;for await(const st of rt){let at=st;for(;at;){const ct=ReadHandlers[it](at,nt,ot,tt);it=ct.mode,at=ct.chunk,nt=ct.buffer,ot=ct.state,ct.data&&(yield ct.data)}}if(nt.length)throw Object.assign(new Error("unexpected end of input"),{code:"ERR_UNEXPECTED_EOF"})}}decode$1.fromReader=(et,tt)=>{let rt=1;const nt={[Symbol.asyncIterator](){return this},next:async()=>{try{return await et.next(rt)}catch(it){if(it.code==="ERR_UNDER_READ")return{done:!0,value:null};throw it}finally{rt=1}}};return decode$1({...tt||{},onLength:it=>{rt=it}})(nt)},decode$2.exports=decode$1,decode$2.exports.MAX_LENGTH_LENGTH=MAX_LENGTH_LENGTH,decode$2.exports.MAX_DATA_LENGTH=MAX_DATA_LENGTH;var decodeExports=decode$2.exports;const{Buffer:Buffer$1}=requireBuffer(),int32BEEncode=(et,tt,rt)=>(tt=tt||Buffer$1.allocUnsafe(4),tt.writeInt32BE(et,rt),tt);int32BEEncode.bytes=4;var int32BEEncode_1=int32BEEncode;const int32BEDecode=et=>{if(et.length<4)throw RangeError("Could not decode int32BE");return et.readInt32BE(0)};int32BEDecode.bytes=4;var int32BEDecode_1=int32BEDecode;src$3.encode=encodeExports,src$3.decode=decodeExports,src$3.varintEncode=varintEncode_1,src$3.varintDecode=varintDecode_1,src$3.int32BEEncode=int32BEEncode_1,src$3.int32BEDecode=int32BEDecode_1;var abortableIterator={exports:{}},getIterator,hasRequiredGetIterator;function requireGetIterator(){return hasRequiredGetIterator||(hasRequiredGetIterator=1,getIterator=function(et){if(et){if(typeof et[Symbol.iterator]=="function")return et[Symbol.iterator]();if(typeof et[Symbol.asyncIterator]=="function")return et[Symbol.asyncIterator]();if(typeof et.next=="function")return et}throw new Error("argument is not an iterator or iterable")}),getIterator}var AbortError_1,hasRequiredAbortError;function requireAbortError(){return hasRequiredAbortError||(hasRequiredAbortError=1,AbortError_1=class extends Error{constructor(et,tt){super(et||"The operation was aborted"),this.type="aborted",this.code=tt||"ABORT_ERR"}}),AbortError_1}var hasRequiredAbortableIterator;function requireAbortableIterator(){if(hasRequiredAbortableIterator)return abortableIterator.exports;hasRequiredAbortableIterator=1;const et=requireGetIterator(),tt=requireAbortError(),rt=(ct,ut,lt)=>nt(ct,Array.isArray(ut)?ut:[{signal:ut,options:lt}]),nt=(ct,ut)=>{ct=et(ct),ut=ut.map(({signal:ht,options:ft})=>({signal:ht,options:ft||{}}));async function*lt(){let ht;const ft=()=>{ht&&ht()};for(const{signal:dt}of ut)dt.addEventListener("abort",ft);for(;;){let dt;try{for(const{signal:gt,options:_t}of ut)if(gt.aborted){const{abortMessage:mt,abortCode:At}=_t;throw new tt(mt,At)}const pt=new Promise((gt,_t)=>{ht=()=>{const{options:mt}=ut.find(({signal:Mt})=>Mt.aborted),{abortMessage:At,abortCode:It}=mt;_t(new tt(At,It))}});dt=await Promise.race([pt,ct.next()]),ht=null}catch(pt){for(const{signal:mt}of ut)mt.removeEventListener("abort",ft);const gt=ut.find(({signal:mt})=>mt.aborted),_t=pt.type==="aborted"&&gt;if(_t&&gt.options.onAbort&&await gt.options.onAbort(ct),typeof ct.return=="function")try{const mt=ct.return();mt instanceof Promise&&mt.catch(At=>{gt.options.onReturnError!=null&&gt.options.onReturnError(At)})}catch(mt){gt.options.onReturnError!=null&&gt.options.onReturnError(mt)}if(_t&&gt.options.returnOnAbort)return;throw pt}if(dt.done)break;yield dt.value}for(const{signal:dt}of ut)dt.removeEventListener("abort",ft)}return lt()},it=(ct,ut,lt)=>ot(ct,Array.isArray(ut)?ut:[{signal:ut,options:lt}]),ot=(ct,ut)=>lt=>ct(nt(lt,ut)),st=(ct,ut,lt)=>at(ct,Array.isArray(ut)?ut:[{signal:ut,options:lt}]),at=(ct,ut)=>({sink:ot(ct.sink,ut),source:nt(ct.source,ut)});return abortableIterator.exports=rt,abortableIterator.exports.AbortError=tt,abortableIterator.exports.source=rt,abortableIterator.exports.sink=it,abortableIterator.exports.transform=it,abortableIterator.exports.duplex=st,abortableIterator.exports}const debug$4=browserExports,log$3=Object.assign(debug$4("libp2p-pubsub:peer-streams"),{error:debug$4("libp2p-pubsub:peer-streams:err")}),{EventEmitter:EventEmitter$1}=eventsExports,lp=src$3,pushable=itPushable,{pipe:pipe$1}=itPipeExports,{source:abortable}=requireAbortableIterator(),AbortController=requireBrowser().default;let PeerStreams$1=class extends EventEmitter$1{constructor({id:et,protocol:tt}){super(),this.id=et,this.protocol=tt,this._rawOutboundStream=null,this._rawInboundStream=null,this._inboundAbortController=new AbortController,this.outboundStream=null,this.inboundStream=null}get isReadable(){return!!this.inboundStream}get isWritable(){return!!this.outboundStream}write(et){if(!this.outboundStream){const tt=this.id.toB58String();throw new Error("No writable connection to "+tt)}this.outboundStream.push(et)}attachInboundStream(et){return this._rawInboundStream=et,this.inboundStream=abortable(pipe$1(this._rawInboundStream,lp.decode()),this._inboundAbortController.signal,{returnOnAbort:!0}),this.emit("stream:inbound"),this.inboundStream}async attachOutboundStream(et){const tt=this.outboundStream;this.outboundStream&&await this.outboundStream.end(),this._rawOutboundStream=et,this.outboundStream=pushable({onEnd:rt=>{this._rawOutboundStream&&this._rawOutboundStream.reset&&this._rawOutboundStream.reset(),this._rawOutboundStream=null,this.outboundStream=null,rt&&this.emit("close")}}),pipe$1(this.outboundStream,lp.encode(),this._rawOutboundStream).catch(rt=>{log$3.error(rt)}),tt||this.emit("stream:outbound")}close(){this.outboundStream&&this.outboundStream.end(),this.inboundStream&&this._inboundAbortController.abort(),this._rawOutboundStream=null,this.outboundStream=null,this._rawInboundStream=null,this.inboundStream=null,this.emit("close")}};var peerStreams=PeerStreams$1,signaturePolicy={};const SignaturePolicy$1={StrictSign:"StrictSign",StrictNoSign:"StrictNoSign"};signaturePolicy.SignaturePolicy=SignaturePolicy$1;const randomBytes$3=random_browser,errcode$6=errCode$i;var randomBytes_1$1=function(et){if(isNaN(et)||et<=0)throw errcode$6(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return randomBytes$3(et)};const randomBytes$2=randomBytes_1$1,{toString:uint8ArrayToString$4}=require$$1$2,{fromString:uint8ArrayFromString$4}=require$$9$2,PeerId$3=srcExports$1,{sha256:sha256$4}=require$$1$4,randomSeqno=()=>randomBytes$2(8),msgId=(et,tt)=>{let rt;et instanceof Uint8Array?rt=PeerId$3.createFromBytes(et).id:rt=PeerId$3.parse(et).id;const nt=new Uint8Array(rt.length+tt.length);return nt.set(rt,0),nt.set(tt,rt.length),nt},noSignMsgId=et=>sha256$4.encode(et),anyMatch=(et,tt)=>{let rt;Array.isArray(tt)?rt=nt=>tt.indexOf(nt)>-1:rt=nt=>tt.has(nt);for(const nt of et)if(rt(nt))return!0;return!1},ensureArray=et=>Array.isArray(et)?et:[et],normalizeInRpcMessage=(et,tt)=>{const rt=Object.assign({},et);return et.from instanceof Uint8Array&&(rt.from=uint8ArrayToString$4(et.from,"base58btc")),tt&&(rt.receivedFrom=tt),rt},normalizeOutRpcMessage$1=et=>{const tt=Object.assign({},et);return typeof et.from=="string"&&(tt.from=uint8ArrayFromString$4(et.from,"base58btc")),typeof et.data=="string"&&(tt.data=uint8ArrayFromString$4(et.data)),tt};var utils$3={randomSeqno,msgId,noSignMsgId,anyMatch,ensureArray,normalizeInRpcMessage,normalizeOutRpcMessage:normalizeOutRpcMessage$1};const PeerId$2=srcExports$1,{RPC:RPC$1}=rpc$1,{concat:uint8ArrayConcat}=require$$7$1,{fromString:uint8ArrayFromString$3}=require$$9$2,SignPrefix=uint8ArrayFromString$3("libp2p-pubsub:"),{normalizeOutRpcMessage}=utils$3;async function signMessage$1(et,tt){const rt=uint8ArrayConcat([SignPrefix,RPC$1.Message.encode(normalizeOutRpcMessage(tt)).finish()]),nt=await et.privKey.sign(rt);return{...tt,signature:nt,key:et.pubKey.bytes}}async function verifySignature$1(et){if(!et.signature)throw new Error("Message must contain a signature to be verified");if(!et.from)throw new Error("Message must contain a from property to be verified");const tt=uint8ArrayConcat([SignPrefix,RPC$1.Message.encode({...et,from:PeerId$2.createFromB58String(et.from).toBytes(),signature:void 0,key:void 0}).finish()]);return(await messagePublicKey(et)).verify(tt,et.signature)}async function messagePublicKey(et){if(!et.from)throw new Error("Could not get the public key from the originator id");const tt=PeerId$2.createFromB58String(et.from);if(et.key){const rt=await PeerId$2.createFromPubKey(et.key);if(rt.equals(tt))return rt.pubKey;throw new Error("Public Key does not match the originator")}else{if(tt.pubKey)return tt.pubKey;throw new Error("Could not get the public key from the originator id")}}var sign={messagePublicKey,signMessage:signMessage$1,SignPrefix,verifySignature:verifySignature$1};const debug$3=browserExports,{EventEmitter}=eventsExports,errcode$5=errCode$i,{pipe}=itPipeExports,{default:Queue}=dist$1,MulticodecTopology=multicodecTopology,{codes:codes$1}=errors$1,{RPC}=rpc$1,PeerStreams=peerStreams,{SignaturePolicy}=signaturePolicy,utils$2=utils$3,{signMessage,verifySignature}=sign;class PubsubBaseProtocol extends EventEmitter{constructor({debugName:tt,multicodecs:rt,libp2p:nt,globalSignaturePolicy:it=SignaturePolicy.StrictSign,canRelayMessage:ot=!1,emitSelf:st=!1,messageProcessingConcurrency:at=10}){if(typeof tt!="string")throw new Error("a debugname `string` is required");if(!rt)throw new Error("multicodecs are required");if(!nt)throw new Error("libp2p is required");if(super(),this.log=Object.assign(debug$3(tt),{err:debug$3(`${tt}:error`)}),this.multicodecs=utils$2.ensureArray(rt),this._libp2p=nt,this.registrar=nt.registrar,this.peerId=nt.peerId,this.started=!1,this.topics=new Map,this.subscriptions=new Set,this.peers=new Map,!SignaturePolicy[it])throw errcode$5(new Error("Invalid window signature policy"),codes$1.ERR_INVALID_SIGNATURE_POLICY);this.globalSignaturePolicy=it,this.canRelayMessage=ot,this.emitSelf=st,this.topicValidators=new Map,this.queue=new Queue({concurrency:at}),this._registrarId=void 0,this._onIncomingStream=this._onIncomingStream.bind(this),this._onPeerConnected=this._onPeerConnected.bind(this),this._onPeerDisconnected=this._onPeerDisconnected.bind(this)}start(){if(this.started)return;this.log("starting"),this.registrar.handle(this.multicodecs,this._onIncomingStream);const tt=new MulticodecTopology({multicodecs:this.multicodecs,handlers:{onConnect:this._onPeerConnected,onDisconnect:this._onPeerDisconnected}});this._registrarId=this.registrar.register(tt),this.log("started"),this.started=!0}stop(){this.started&&(this.registrar.unregister(this._registrarId),this.log("stopping"),this.peers.forEach(tt=>tt.close()),this.peers=new Map,this.subscriptions=new Set,this.started=!1,this.log("stopped"))}_onIncomingStream({protocol:tt,stream:rt,connection:nt}){const it=nt.remotePeer,ot=it.toB58String(),st=this._addPeer(it,tt),at=st.attachInboundStream(rt);this._processMessages(ot,at,st)}async _onPeerConnected(tt,rt){const nt=tt.toB58String();this.log("connected",nt);try{const{stream:it,protocol:ot}=await rt.newStream(this.multicodecs);await this._addPeer(tt,ot).attachOutboundStream(it)}catch(it){this.log.err(it)}this._sendSubscriptions(nt,Array.from(this.subscriptions),!0)}_onPeerDisconnected(tt,rt){const nt=tt.toB58String();this.log("connection ended",nt,rt?rt.message:""),this._removePeer(tt)}_addPeer(tt,rt){const nt=tt.toB58String(),it=this.peers.get(nt);if(it)return it;this.log("new peer",nt);const ot=new PeerStreams({id:tt,protocol:rt});return this.peers.set(nt,ot),ot.once("close",()=>this._removePeer(tt)),ot}_removePeer(tt){if(!tt)return;const rt=tt.toB58String(),nt=this.peers.get(rt);if(nt){nt.removeAllListeners(),nt.close(),this.log("delete peer",rt),this.peers.delete(rt);for(const it of this.topics.values())it.delete(rt);return nt}}async _processMessages(tt,rt,nt){try{await pipe(rt,async it=>{for await(const ot of it){const st=ot instanceof Uint8Array?ot:ot.slice(),at=this._decodeRpc(st);(async()=>{try{await this._processRpc(tt,nt,at)}catch(ct){this.log.err(ct)}})()}})}catch(it){this._onPeerDisconnected(nt.id,it)}}async _processRpc(tt,rt,nt){this.log("rpc from",tt);const it=nt.subscriptions,ot=nt.msgs;return it.length&&(it.forEach(st=>{this._processRpcSubOpt(tt,st)}),this.emit("pubsub:subscription-change",rt.id,it)),this._acceptFrom(tt)?(ot.length&&this.queue.addAll(ot.map(st=>async()=>{if(!(this.canRelayMessage||st.topicIDs&&st.topicIDs.some(at=>this.subscriptions.has(at)))){this.log("received message we didn't subscribe to. Dropping.");return}try{const at=utils$2.normalizeInRpcMessage(st,tt);await this._processRpcMessage(at)}catch(at){this.log.err(at)}})),!0):(this.log("received message from unacceptable peer %s",tt),!1)}_processRpcSubOpt(tt,rt){const nt=rt.topicID;if(!nt)return;let it=this.topics.get(nt);it||(it=new Set,this.topics.set(nt,it)),rt.subscribe?it.add(tt):it.delete(tt)}async _processRpcMessage(tt){if(!(this.peerId.toB58String()===tt.from&&!this.emitSelf)){try{await this.validate(tt)}catch(rt){this.log("Message is invalid, dropping it. %O",rt);return}return this._emitMessage(tt),this._publish(utils$2.normalizeOutRpcMessage(tt))}}_emitMessage(tt){tt.topicIDs.forEach(rt=>{this.subscriptions.has(rt)&&this.emit(rt,tt)})}getMsgId(tt){const rt=this.globalSignaturePolicy;switch(rt){case SignaturePolicy.StrictSign:return utils$2.msgId(tt.from,tt.seqno);case SignaturePolicy.StrictNoSign:return utils$2.noSignMsgId(tt.data);default:throw errcode$5(new Error("Cannot get message id: unhandled signature policy: "+rt),codes$1.ERR_UNHANDLED_SIGNATURE_POLICY)}}_acceptFrom(tt){return!0}_decodeRpc(tt){return RPC.decode(tt)}_encodeRpc(tt){return RPC.encode(tt).finish()}_sendRpc(tt,rt){const nt=this.peers.get(tt);if(!nt||!nt.isWritable){const it=`Cannot send RPC to ${tt} as there is no open stream to it available`;this.log.err(it);return}nt.write(this._encodeRpc(rt))}_sendSubscriptions(tt,rt,nt){return this._sendRpc(tt,{subscriptions:rt.map(it=>({topicID:it,subscribe:nt}))})}async validate(tt){const rt=this.globalSignaturePolicy;switch(rt){case SignaturePolicy.StrictNoSign:if(tt.from)throw errcode$5(new Error("StrictNoSigning: from should not be present"),codes$1.ERR_UNEXPECTED_FROM);if(tt.signature)throw errcode$5(new Error("StrictNoSigning: signature should not be present"),codes$1.ERR_UNEXPECTED_SIGNATURE);if(tt.key)throw errcode$5(new Error("StrictNoSigning: key should not be present"),codes$1.ERR_UNEXPECTED_KEY);if(tt.seqno)throw errcode$5(new Error("StrictNoSigning: seqno should not be present"),codes$1.ERR_UNEXPECTED_SEQNO);break;case SignaturePolicy.StrictSign:if(!tt.signature)throw errcode$5(new Error("StrictSigning: Signing required and no signature was present"),codes$1.ERR_MISSING_SIGNATURE);if(!tt.seqno)throw errcode$5(new Error("StrictSigning: Signing required and no seqno was present"),codes$1.ERR_MISSING_SEQNO);if(!await verifySignature(tt))throw errcode$5(new Error("StrictSigning: Invalid message signature"),codes$1.ERR_INVALID_SIGNATURE);break;default:throw errcode$5(new Error("Cannot validate message: unhandled signature policy: "+rt),codes$1.ERR_UNHANDLED_SIGNATURE_POLICY)}for(const nt of tt.topicIDs){const it=this.topicValidators.get(nt);it&&await it(nt,tt)}}_buildMessage(tt){const rt=this.globalSignaturePolicy;switch(rt){case SignaturePolicy.StrictSign:return tt.from=this.peerId.toB58String(),tt.seqno=utils$2.randomSeqno(),signMessage(this.peerId,tt);case SignaturePolicy.StrictNoSign:return Promise.resolve(tt);default:throw errcode$5(new Error("Cannot build message: unhandled signature policy: "+rt),codes$1.ERR_UNHANDLED_SIGNATURE_POLICY)}}getSubscribers(tt){if(!this.started)throw errcode$5(new Error("not started yet"),"ERR_NOT_STARTED_YET");if(!tt||typeof tt!="string")throw errcode$5(new Error("a string topic must be provided"),"ERR_NOT_VALID_TOPIC");const rt=this.topics.get(tt);return rt?Array.from(rt):[]}async publish(tt,rt){if(!this.started)throw new Error("Pubsub has not started");this.log("publish",tt,rt);const nt={receivedFrom:this.peerId.toB58String(),data:rt,topicIDs:[tt]},it=await this._buildMessage(nt),ot=utils$2.normalizeInRpcMessage(it);this.emitSelf&&this._emitMessage(ot),await this._publish(ot)}_publish(tt){throw errcode$5(new Error("publish must be implemented by the subclass"),"ERR_NOT_IMPLEMENTED")}subscribe(tt){if(!this.started)throw new Error("Pubsub has not started");this.subscriptions.has(tt)||(this.subscriptions.add(tt),this.peers.forEach((rt,nt)=>this._sendSubscriptions(nt,[tt],!0)))}unsubscribe(tt){if(!this.started)throw new Error("Pubsub is not started");this.subscriptions.has(tt)&&this.listenerCount(tt)===0&&(this.subscriptions.delete(tt),this.peers.forEach((rt,nt)=>this._sendSubscriptions(nt,[tt],!1)))}getTopics(){if(!this.started)throw new Error("Pubsub is not started");return Array.from(this.subscriptions)}}PubsubBaseProtocol.utils=utils$2,PubsubBaseProtocol.SignaturePolicy=SignaturePolicy;var pubsub=PubsubBaseProtocol,messageCache={},utils$1={},createGossipRpc$1={};Object.defineProperty(createGossipRpc$1,"__esModule",{value:!0}),createGossipRpc$1.createGossipRpc=void 0;function createGossipRpc(et=[],tt={}){return{subscriptions:[],msgs:et,control:Object.assign({ihave:[],iwant:[],graft:[],prune:[]},tt)}}createGossipRpc$1.createGossipRpc=createGossipRpc;var shuffle$1={};Object.defineProperty(shuffle$1,"__esModule",{value:!0}),shuffle$1.shuffle=void 0;function shuffle(et){if(et.length<=1)return et;const tt=()=>Math.floor(Math.random()*Math.floor(et.length));for(let rt=0;rt<et.length;rt++){const nt=tt(),it=et[rt];et[rt]=et[nt],et[nt]=it}return et}shuffle$1.shuffle=shuffle;var hasGossipProtocol$1={},constants$3={};(function(et){Object.defineProperty(et,"__esModule",{value:!0}),et.ERR_TOPIC_VALIDATOR_IGNORE=et.ERR_TOPIC_VALIDATOR_REJECT=et.TimeCacheDuration=et.GossipsubSeenTTL=et.GossipsubIWantFollowupTime=et.GossipsubMaxIHaveMessages=et.GossipsubMaxIHaveLength=et.GossipsubGraftFloodThreshold=et.GossipsubOpportunisticGraftPeers=et.GossipsubOpportunisticGraftTicks=et.GossipsubDirectConnectInitialDelay=et.GossipsubDirectConnectTicks=et.GossipsubConnectionTimeout=et.GossipsubMaxPendingConnections=et.GossipsubConnectors=et.GossipsubPruneBackoffTicks=et.GossipsubPruneBackoff=et.GossipsubPrunePeers=et.GossipsubFanoutTTL=et.GossipsubHeartbeatInterval=et.GossipsubHeartbeatInitialDelay=et.GossipsubGossipRetransmission=et.GossipsubGossipFactor=et.GossipsubDlazy=et.GossipsubHistoryGossip=et.GossipsubHistoryLength=et.GossipsubDout=et.GossipsubDscore=et.GossipsubDhi=et.GossipsubDlo=et.GossipsubD=et.GossipsubIDv11=et.GossipsubIDv10=et.FloodsubID=et.minute=et.second=void 0,et.second=1e3,et.minute=60*et.second,et.FloodsubID="/floodsub/1.0.0",et.GossipsubIDv10="/meshsub/1.0.0",et.GossipsubIDv11="/meshsub/1.1.0",et.GossipsubD=6,et.GossipsubDlo=4,et.GossipsubDhi=12,et.GossipsubDscore=4,et.GossipsubDout=2,et.GossipsubHistoryLength=5,et.GossipsubHistoryGossip=3,et.GossipsubDlazy=6,et.GossipsubGossipFactor=.25,et.GossipsubGossipRetransmission=3,et.GossipsubHeartbeatInitialDelay=100,et.GossipsubHeartbeatInterval=et.second,et.GossipsubFanoutTTL=et.minute,et.GossipsubPrunePeers=16,et.GossipsubPruneBackoff=et.minute,et.GossipsubPruneBackoffTicks=15,et.GossipsubConnectors=8,et.GossipsubMaxPendingConnections=128,et.GossipsubConnectionTimeout=30*et.second,et.GossipsubDirectConnectTicks=300,et.GossipsubDirectConnectInitialDelay=et.second,et.GossipsubOpportunisticGraftTicks=60,et.GossipsubOpportunisticGraftPeers=2,et.GossipsubGraftFloodThreshold=10*et.second,et.GossipsubMaxIHaveLength=5e3,et.GossipsubMaxIHaveMessages=10,et.GossipsubIWantFollowupTime=3*et.second,et.GossipsubSeenTTL=30*et.second,et.TimeCacheDuration=120*1e3,et.ERR_TOPIC_VALIDATOR_REJECT="ERR_TOPIC_VALIDATOR_REJECT",et.ERR_TOPIC_VALIDATOR_IGNORE="ERR_TOPIC_VALIDATOR_IGNORE"})(constants$3),Object.defineProperty(hasGossipProtocol$1,"__esModule",{value:!0}),hasGossipProtocol$1.hasGossipProtocol=void 0;const constants_1$2=constants$3;function hasGossipProtocol(et){return et===constants_1$2.GossipsubIDv10||et===constants_1$2.GossipsubIDv11}hasGossipProtocol$1.hasGossipProtocol=hasGossipProtocol;var messageIdToString$1={};Object.defineProperty(messageIdToString$1,"__esModule",{value:!0}),messageIdToString$1.messageIdToString=void 0;const to_string_1=require$$1$2;function messageIdToString(et){return to_string_1.toString(et,"base64")}messageIdToString$1.messageIdToString=messageIdToString,function(et){var tt=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(nt,it,ot,st){st===void 0&&(st=ot),Object.defineProperty(nt,st,{enumerable:!0,get:function(){return it[ot]}})}:function(nt,it,ot,st){st===void 0&&(st=ot),nt[st]=it[ot]}),rt=commonjsGlobal&&commonjsGlobal.__exportStar||function(nt,it){for(var ot in nt)ot!=="default"&&!Object.prototype.hasOwnProperty.call(it,ot)&&tt(it,nt,ot)};Object.defineProperty(et,"__esModule",{value:!0}),rt(createGossipRpc$1,et),rt(shuffle$1,et),rt(hasGossipProtocol$1,et),rt(messageIdToString$1,et)}(utils$1);var __awaiter$3=commonjsGlobal&&commonjsGlobal.__awaiter||function(et,tt,rt,nt){function it(ot){return ot instanceof rt?ot:new rt(function(st){st(ot)})}return new(rt||(rt=Promise))(function(ot,st){function at(lt){try{ut(nt.next(lt))}catch(ht){st(ht)}}function ct(lt){try{ut(nt.throw(lt))}catch(ht){st(ht)}}function ut(lt){lt.done?ot(lt.value):it(lt.value).then(at,ct)}ut((nt=nt.apply(et,tt||[])).next())})};Object.defineProperty(messageCache,"__esModule",{value:!0}),messageCache.MessageCache=void 0;const utils_1$4=utils$1;class MessageCache{constructor(tt,rt,nt){this.msgs=new Map,this.peertx=new Map,this.history=[];for(let it=0;it<rt;it++)this.history[it]=[];this.gossip=tt,this.msgIdFn=nt}put(tt){return __awaiter$3(this,void 0,void 0,function*(){const rt=yield this.getMsgId(tt),nt=utils_1$4.messageIdToString(rt);this.msgs.set(nt,tt),this.history[0].push({msgID:rt,topics:tt.topicIDs})})}getMsgId(tt){return this.msgIdFn(tt)}get(tt){return this.msgs.get(utils_1$4.messageIdToString(tt))}getForPeer(tt,rt){const nt=utils_1$4.messageIdToString(tt),it=this.msgs.get(nt);if(!it)return[void 0,0];let ot=this.peertx.get(nt);ot||(ot=new Map,this.peertx.set(nt,ot));const st=(ot.get(rt)||0)+1;return ot.set(rt,st),[it,st]}getGossipIDs(tt){const rt=[];for(let nt=0;nt<this.gossip;nt++)this.history[nt].forEach(it=>{for(const ot of it.topics)if(ot===tt){rt.push(it.msgID);break}});return rt}shift(){this.history[this.history.length-1].forEach(tt=>{const rt=utils_1$4.messageIdToString(tt.msgID);this.msgs.delete(rt),this.peertx.delete(rt)}),this.history.pop(),this.history.unshift([])}}messageCache.MessageCache=MessageCache;var rpc={exports:{}};(function(et){(function(tt,rt){typeof commonjsRequire=="function"&&et&&et.exports&&(et.exports=rt(minimal))})(commonjsGlobal,function(tt){var rt=tt.Reader,nt=tt.Writer,it=tt.util,ot=tt.roots.default||(tt.roots.default={});return ot.RPC=function(){function st(ct){if(this.subscriptions=[],this.msgs=[],ct)for(var ut=Object.keys(ct),lt=0;lt<ut.length;++lt)ct[ut[lt]]!=null&&(this[ut[lt]]=ct[ut[lt]])}st.prototype.subscriptions=it.emptyArray,st.prototype.msgs=it.emptyArray,st.prototype.control=null;var at;return Object.defineProperty(st.prototype,"_control",{get:it.oneOfGetter(at=["control"]),set:it.oneOfSetter(at)}),st.encode=function(ct,ut){if(ut||(ut=nt.create()),ct.subscriptions!=null&&ct.subscriptions.length)for(var lt=0;lt<ct.subscriptions.length;++lt)ot.RPC.SubOpts.encode(ct.subscriptions[lt],ut.uint32(10).fork()).ldelim();if(ct.msgs!=null&&ct.msgs.length)for(var lt=0;lt<ct.msgs.length;++lt)ot.RPC.Message.encode(ct.msgs[lt],ut.uint32(18).fork()).ldelim();return ct.control!=null&&Object.hasOwnProperty.call(ct,"control")&&ot.RPC.ControlMessage.encode(ct.control,ut.uint32(26).fork()).ldelim(),ut},st.decode=function(ct,ut){ct instanceof rt||(ct=rt.create(ct));for(var lt=ut===void 0?ct.len:ct.pos+ut,ht=new ot.RPC;ct.pos<lt;){var ft=ct.uint32();switch(ft>>>3){case 1:ht.subscriptions&&ht.subscriptions.length||(ht.subscriptions=[]),ht.subscriptions.push(ot.RPC.SubOpts.decode(ct,ct.uint32()));break;case 2:ht.msgs&&ht.msgs.length||(ht.msgs=[]),ht.msgs.push(ot.RPC.Message.decode(ct,ct.uint32()));break;case 3:ht.control=ot.RPC.ControlMessage.decode(ct,ct.uint32());break;default:ct.skipType(ft&7);break}}return ht},st.fromObject=function(ct){if(ct instanceof ot.RPC)return ct;var ut=new ot.RPC;if(ct.subscriptions){if(!Array.isArray(ct.subscriptions))throw TypeError(".RPC.subscriptions: array expected");ut.subscriptions=[];for(var lt=0;lt<ct.subscriptions.length;++lt){if(typeof ct.subscriptions[lt]!="object")throw TypeError(".RPC.subscriptions: object expected");ut.subscriptions[lt]=ot.RPC.SubOpts.fromObject(ct.subscriptions[lt])}}if(ct.msgs){if(!Array.isArray(ct.msgs))throw TypeError(".RPC.msgs: array expected");ut.msgs=[];for(var lt=0;lt<ct.msgs.length;++lt){if(typeof ct.msgs[lt]!="object")throw TypeError(".RPC.msgs: object expected");ut.msgs[lt]=ot.RPC.Message.fromObject(ct.msgs[lt])}}if(ct.control!=null){if(typeof ct.control!="object")throw TypeError(".RPC.control: object expected");ut.control=ot.RPC.ControlMessage.fromObject(ct.control)}return ut},st.toObject=function(ct,ut){ut||(ut={});var lt={};if((ut.arrays||ut.defaults)&&(lt.subscriptions=[],lt.msgs=[]),ct.subscriptions&&ct.subscriptions.length){lt.subscriptions=[];for(var ht=0;ht<ct.subscriptions.length;++ht)lt.subscriptions[ht]=ot.RPC.SubOpts.toObject(ct.subscriptions[ht],ut)}if(ct.msgs&&ct.msgs.length){lt.msgs=[];for(var ht=0;ht<ct.msgs.length;++ht)lt.msgs[ht]=ot.RPC.Message.toObject(ct.msgs[ht],ut)}return ct.control!=null&&ct.hasOwnProperty("control")&&(lt.control=ot.RPC.ControlMessage.toObject(ct.control,ut),ut.oneofs&&(lt._control="control")),lt},st.prototype.toJSON=function(){return this.constructor.toObject(this,tt.util.toJSONOptions)},st.SubOpts=function(){function ct(lt){if(lt)for(var ht=Object.keys(lt),ft=0;ft<ht.length;++ft)lt[ht[ft]]!=null&&(this[ht[ft]]=lt[ht[ft]])}ct.prototype.subscribe=null,ct.prototype.topicID=null;var ut;return Object.defineProperty(ct.prototype,"_subscribe",{get:it.oneOfGetter(ut=["subscribe"]),set:it.oneOfSetter(ut)}),Object.defineProperty(ct.prototype,"_topicID",{get:it.oneOfGetter(ut=["topicID"]),set:it.oneOfSetter(ut)}),ct.encode=function(lt,ht){return ht||(ht=nt.create()),lt.subscribe!=null&&Object.hasOwnProperty.call(lt,"subscribe")&&ht.uint32(8).bool(lt.subscribe),lt.topicID!=null&&Object.hasOwnProperty.call(lt,"topicID")&&ht.uint32(18).string(lt.topicID),ht},ct.decode=function(lt,ht){lt instanceof rt||(lt=rt.create(lt));for(var ft=ht===void 0?lt.len:lt.pos+ht,dt=new ot.RPC.SubOpts;lt.pos<ft;){var pt=lt.uint32();switch(pt>>>3){case 1:dt.subscribe=lt.bool();break;case 2:dt.topicID=lt.string();break;default:lt.skipType(pt&7);break}}return dt},ct.fromObject=function(lt){if(lt instanceof ot.RPC.SubOpts)return lt;var ht=new ot.RPC.SubOpts;return lt.subscribe!=null&&(ht.subscribe=!!lt.subscribe),lt.topicID!=null&&(ht.topicID=String(lt.topicID)),ht},ct.toObject=function(lt,ht){ht||(ht={});var ft={};return lt.subscribe!=null&&lt.hasOwnProperty("subscribe")&&(ft.subscribe=lt.subscribe,ht.oneofs&&(ft._subscribe="subscribe")),lt.topicID!=null&&lt.hasOwnProperty("topicID")&&(ft.topicID=lt.topicID,ht.oneofs&&(ft._topicID="topicID")),ft},ct.prototype.toJSON=function(){return this.constructor.toObject(this,tt.util.toJSONOptions)},ct}(),st.Message=function(){function ct(lt){if(this.topicIDs=[],lt)for(var ht=Object.keys(lt),ft=0;ft<ht.length;++ft)lt[ht[ft]]!=null&&(this[ht[ft]]=lt[ht[ft]])}ct.prototype.from=null,ct.prototype.data=null,ct.prototype.seqno=null,ct.prototype.topicIDs=it.emptyArray,ct.prototype.signature=null,ct.prototype.key=null;var ut;return Object.defineProperty(ct.prototype,"_from",{get:it.oneOfGetter(ut=["from"]),set:it.oneOfSetter(ut)}),Object.defineProperty(ct.prototype,"_data",{get:it.oneOfGetter(ut=["data"]),set:it.oneOfSetter(ut)}),Object.defineProperty(ct.prototype,"_seqno",{get:it.oneOfGetter(ut=["seqno"]),set:it.oneOfSetter(ut)}),Object.defineProperty(ct.prototype,"_signature",{get:it.oneOfGetter(ut=["signature"]),set:it.oneOfSetter(ut)}),Object.defineProperty(ct.prototype,"_key",{get:it.oneOfGetter(ut=["key"]),set:it.oneOfSetter(ut)}),ct.encode=function(lt,ht){if(ht||(ht=nt.create()),lt.from!=null&&Object.hasOwnProperty.call(lt,"from")&&ht.uint32(10).bytes(lt.from),lt.data!=null&&Object.hasOwnProperty.call(lt,"data")&&ht.uint32(18).bytes(lt.data),lt.seqno!=null&&Object.hasOwnProperty.call(lt,"seqno")&&ht.uint32(26).bytes(lt.seqno),lt.topicIDs!=null&&lt.topicIDs.length)for(var ft=0;ft<lt.topicIDs.length;++ft)ht.uint32(34).string(lt.topicIDs[ft]);return lt.signature!=null&&Object.hasOwnProperty.call(lt,"signature")&&ht.uint32(42).bytes(lt.signature),lt.key!=null&&Object.hasOwnProperty.call(lt,"key")&&ht.uint32(50).bytes(lt.key),ht},ct.decode=function(lt,ht){lt instanceof rt||(lt=rt.create(lt));for(var ft=ht===void 0?lt.len:lt.pos+ht,dt=new ot.RPC.Message;lt.pos<ft;){var pt=lt.uint32();switch(pt>>>3){case 1:dt.from=lt.bytes();break;case 2:dt.data=lt.bytes();break;case 3:dt.seqno=lt.bytes();break;case 4:dt.topicIDs&&dt.topicIDs.length||(dt.topicIDs=[]),dt.topicIDs.push(lt.string());break;case 5:dt.signature=lt.bytes();break;case 6:dt.key=lt.bytes();break;default:lt.skipType(pt&7);break}}return dt},ct.fromObject=function(lt){if(lt instanceof ot.RPC.Message)return lt;var ht=new ot.RPC.Message;if(lt.from!=null&&(typeof lt.from=="string"?it.base64.decode(lt.from,ht.from=it.newBuffer(it.base64.length(lt.from)),0):lt.from.length&&(ht.from=lt.from)),lt.data!=null&&(typeof lt.data=="string"?it.base64.decode(lt.data,ht.data=it.newBuffer(it.base64.length(lt.data)),0):lt.data.length&&(ht.data=lt.data)),lt.seqno!=null&&(typeof lt.seqno=="string"?it.base64.decode(lt.seqno,ht.seqno=it.newBuffer(it.base64.length(lt.seqno)),0):lt.seqno.length&&(ht.seqno=lt.seqno)),lt.topicIDs){if(!Array.isArray(lt.topicIDs))throw TypeError(".RPC.Message.topicIDs: array expected");ht.topicIDs=[];for(var ft=0;ft<lt.topicIDs.length;++ft)ht.topicIDs[ft]=String(lt.topicIDs[ft])}return lt.signature!=null&&(typeof lt.signature=="string"?it.base64.decode(lt.signature,ht.signature=it.newBuffer(it.base64.length(lt.signature)),0):lt.signature.length&&(ht.signature=lt.signature)),lt.key!=null&&(typeof lt.key=="string"?it.base64.decode(lt.key,ht.key=it.newBuffer(it.base64.length(lt.key)),0):lt.key.length&&(ht.key=lt.key)),ht},ct.toObject=function(lt,ht){ht||(ht={});var ft={};if((ht.arrays||ht.defaults)&&(ft.topicIDs=[]),lt.from!=null&&lt.hasOwnProperty("from")&&(ft.from=ht.bytes===String?it.base64.encode(lt.from,0,lt.from.length):ht.bytes===Array?Array.prototype.slice.call(lt.from):lt.from,ht.oneofs&&(ft._from="from")),lt.data!=null&&lt.hasOwnProperty("data")&&(ft.data=ht.bytes===String?it.base64.encode(lt.data,0,lt.data.length):ht.bytes===Array?Array.prototype.slice.call(lt.data):lt.data,ht.oneofs&&(ft._data="data")),lt.seqno!=null&&lt.hasOwnProperty("seqno")&&(ft.seqno=ht.bytes===String?it.base64.encode(lt.seqno,0,lt.seqno.length):ht.bytes===Array?Array.prototype.slice.call(lt.seqno):lt.seqno,ht.oneofs&&(ft._seqno="seqno")),lt.topicIDs&&lt.topicIDs.length){ft.topicIDs=[];for(var dt=0;dt<lt.topicIDs.length;++dt)ft.topicIDs[dt]=lt.topicIDs[dt]}return lt.signature!=null&&lt.hasOwnProperty("signature")&&(ft.signature=ht.bytes===String?it.base64.encode(lt.signature,0,lt.signature.length):ht.bytes===Array?Array.prototype.slice.call(lt.signature):lt.signature,ht.oneofs&&(ft._signature="signature")),lt.key!=null&&lt.hasOwnProperty("key")&&(ft.key=ht.bytes===String?it.base64.encode(lt.key,0,lt.key.length):ht.bytes===Array?Array.prototype.slice.call(lt.key):lt.key,ht.oneofs&&(ft._key="key")),ft},ct.prototype.toJSON=function(){return this.constructor.toObject(this,tt.util.toJSONOptions)},ct}(),st.ControlMessage=function(){function ct(ut){if(this.ihave=[],this.iwant=[],this.graft=[],this.prune=[],ut)for(var lt=Object.keys(ut),ht=0;ht<lt.length;++ht)ut[lt[ht]]!=null&&(this[lt[ht]]=ut[lt[ht]])}return ct.prototype.ihave=it.emptyArray,ct.prototype.iwant=it.emptyArray,ct.prototype.graft=it.emptyArray,ct.prototype.prune=it.emptyArray,ct.encode=function(ut,lt){if(lt||(lt=nt.create()),ut.ihave!=null&&ut.ihave.length)for(var ht=0;ht<ut.ihave.length;++ht)ot.RPC.ControlIHave.encode(ut.ihave[ht],lt.uint32(10).fork()).ldelim();if(ut.iwant!=null&&ut.iwant.length)for(var ht=0;ht<ut.iwant.length;++ht)ot.RPC.ControlIWant.encode(ut.iwant[ht],lt.uint32(18).fork()).ldelim();if(ut.graft!=null&&ut.graft.length)for(var ht=0;ht<ut.graft.length;++ht)ot.RPC.ControlGraft.encode(ut.graft[ht],lt.uint32(26).fork()).ldelim();if(ut.prune!=null&&ut.prune.length)for(var ht=0;ht<ut.prune.length;++ht)ot.RPC.ControlPrune.encode(ut.prune[ht],lt.uint32(34).fork()).ldelim();return lt},ct.decode=function(ut,lt){ut instanceof rt||(ut=rt.create(ut));for(var ht=lt===void 0?ut.len:ut.pos+lt,ft=new ot.RPC.ControlMessage;ut.pos<ht;){var dt=ut.uint32();switch(dt>>>3){case 1:ft.ihave&&ft.ihave.length||(ft.ihave=[]),ft.ihave.push(ot.RPC.ControlIHave.decode(ut,ut.uint32()));break;case 2:ft.iwant&&ft.iwant.length||(ft.iwant=[]),ft.iwant.push(ot.RPC.ControlIWant.decode(ut,ut.uint32()));break;case 3:ft.graft&&ft.graft.length||(ft.graft=[]),ft.graft.push(ot.RPC.ControlGraft.decode(ut,ut.uint32()));break;case 4:ft.prune&&ft.prune.length||(ft.prune=[]),ft.prune.push(ot.RPC.ControlPrune.decode(ut,ut.uint32()));break;default:ut.skipType(dt&7);break}}return ft},ct.fromObject=function(ut){if(ut instanceof ot.RPC.ControlMessage)return ut;var lt=new ot.RPC.ControlMessage;if(ut.ihave){if(!Array.isArray(ut.ihave))throw TypeError(".RPC.ControlMessage.ihave: array expected");lt.ihave=[];for(var ht=0;ht<ut.ihave.length;++ht){if(typeof ut.ihave[ht]!="object")throw TypeError(".RPC.ControlMessage.ihave: object expected");lt.ihave[ht]=ot.RPC.ControlIHave.fromObject(ut.ihave[ht])}}if(ut.iwant){if(!Array.isArray(ut.iwant))throw TypeError(".RPC.ControlMessage.iwant: array expected");lt.iwant=[];for(var ht=0;ht<ut.iwant.length;++ht){if(typeof ut.iwant[ht]!="object")throw TypeError(".RPC.ControlMessage.iwant: object expected");lt.iwant[ht]=ot.RPC.ControlIWant.fromObject(ut.iwant[ht])}}if(ut.graft){if(!Array.isArray(ut.graft))throw TypeError(".RPC.ControlMessage.graft: array expected");lt.graft=[];for(var ht=0;ht<ut.graft.length;++ht){if(typeof ut.graft[ht]!="object")throw TypeError(".RPC.ControlMessage.graft: object expected");lt.graft[ht]=ot.RPC.ControlGraft.fromObject(ut.graft[ht])}}if(ut.prune){if(!Array.isArray(ut.prune))throw TypeError(".RPC.ControlMessage.prune: array expected");lt.prune=[];for(var ht=0;ht<ut.prune.length;++ht){if(typeof ut.prune[ht]!="object")throw TypeError(".RPC.ControlMessage.prune: object expected");lt.prune[ht]=ot.RPC.ControlPrune.fromObject(ut.prune[ht])}}return lt},ct.toObject=function(ut,lt){lt||(lt={});var ht={};if((lt.arrays||lt.defaults)&&(ht.ihave=[],ht.iwant=[],ht.graft=[],ht.prune=[]),ut.ihave&&ut.ihave.length){ht.ihave=[];for(var ft=0;ft<ut.ihave.length;++ft)ht.ihave[ft]=ot.RPC.ControlIHave.toObject(ut.ihave[ft],lt)}if(ut.iwant&&ut.iwant.length){ht.iwant=[];for(var ft=0;ft<ut.iwant.length;++ft)ht.iwant[ft]=ot.RPC.ControlIWant.toObject(ut.iwant[ft],lt)}if(ut.graft&&ut.graft.length){ht.graft=[];for(var ft=0;ft<ut.graft.length;++ft)ht.graft[ft]=ot.RPC.ControlGraft.toObject(ut.graft[ft],lt)}if(ut.prune&&ut.prune.length){ht.prune=[];for(var ft=0;ft<ut.prune.length;++ft)ht.prune[ft]=ot.RPC.ControlPrune.toObject(ut.prune[ft],lt)}return ht},ct.prototype.toJSON=function(){return this.constructor.toObject(this,tt.util.toJSONOptions)},ct}(),st.ControlIHave=function(){function ct(lt){if(this.messageIDs=[],lt)for(var ht=Object.keys(lt),ft=0;ft<ht.length;++ft)lt[ht[ft]]!=null&&(this[ht[ft]]=lt[ht[ft]])}ct.prototype.topicID=null,ct.prototype.messageIDs=it.emptyArray;var ut;return Object.defineProperty(ct.prototype,"_topicID",{get:it.oneOfGetter(ut=["topicID"]),set:it.oneOfSetter(ut)}),ct.encode=function(lt,ht){if(ht||(ht=nt.create()),lt.topicID!=null&&Object.hasOwnProperty.call(lt,"topicID")&&ht.uint32(10).string(lt.topicID),lt.messageIDs!=null&&lt.messageIDs.length)for(var ft=0;ft<lt.messageIDs.length;++ft)ht.uint32(18).bytes(lt.messageIDs[ft]);return ht},ct.decode=function(lt,ht){lt instanceof rt||(lt=rt.create(lt));for(var ft=ht===void 0?lt.len:lt.pos+ht,dt=new ot.RPC.ControlIHave;lt.pos<ft;){var pt=lt.uint32();switch(pt>>>3){case 1:dt.topicID=lt.string();break;case 2:dt.messageIDs&&dt.messageIDs.length||(dt.messageIDs=[]),dt.messageIDs.push(lt.bytes());break;default:lt.skipType(pt&7);break}}return dt},ct.fromObject=function(lt){if(lt instanceof ot.RPC.ControlIHave)return lt;var ht=new ot.RPC.ControlIHave;if(lt.topicID!=null&&(ht.topicID=String(lt.topicID)),lt.messageIDs){if(!Array.isArray(lt.messageIDs))throw TypeError(".RPC.ControlIHave.messageIDs: array expected");ht.messageIDs=[];for(var ft=0;ft<lt.messageIDs.length;++ft)typeof lt.messageIDs[ft]=="string"?it.base64.decode(lt.messageIDs[ft],ht.messageIDs[ft]=it.newBuffer(it.base64.length(lt.messageIDs[ft])),0):lt.messageIDs[ft].length&&(ht.messageIDs[ft]=lt.messageIDs[ft])}return ht},ct.toObject=function(lt,ht){ht||(ht={});var ft={};if((ht.arrays||ht.defaults)&&(ft.messageIDs=[]),lt.topicID!=null&&lt.hasOwnProperty("topicID")&&(ft.topicID=lt.topicID,ht.oneofs&&(ft._topicID="topicID")),lt.messageIDs&&lt.messageIDs.length){ft.messageIDs=[];for(var dt=0;dt<lt.messageIDs.length;++dt)ft.messageIDs[dt]=ht.bytes===String?it.base64.encode(lt.messageIDs[dt],0,lt.messageIDs[dt].length):ht.bytes===Array?Array.prototype.slice.call(lt.messageIDs[dt]):lt.messageIDs[dt]}return ft},ct.prototype.toJSON=function(){return this.constructor.toObject(this,tt.util.toJSONOptions)},ct}(),st.ControlIWant=function(){function ct(ut){if(this.messageIDs=[],ut)for(var lt=Object.keys(ut),ht=0;ht<lt.length;++ht)ut[lt[ht]]!=null&&(this[lt[ht]]=ut[lt[ht]])}return ct.prototype.messageIDs=it.emptyArray,ct.encode=function(ut,lt){if(lt||(lt=nt.create()),ut.messageIDs!=null&&ut.messageIDs.length)for(var ht=0;ht<ut.messageIDs.length;++ht)lt.uint32(10).bytes(ut.messageIDs[ht]);return lt},ct.decode=function(ut,lt){ut instanceof rt||(ut=rt.create(ut));for(var ht=lt===void 0?ut.len:ut.pos+lt,ft=new ot.RPC.ControlIWant;ut.pos<ht;){var dt=ut.uint32();switch(dt>>>3){case 1:ft.messageIDs&&ft.messageIDs.length||(ft.messageIDs=[]),ft.messageIDs.push(ut.bytes());break;default:ut.skipType(dt&7);break}}return ft},ct.fromObject=function(ut){if(ut instanceof ot.RPC.ControlIWant)return ut;var lt=new ot.RPC.ControlIWant;if(ut.messageIDs){if(!Array.isArray(ut.messageIDs))throw TypeError(".RPC.ControlIWant.messageIDs: array expected");lt.messageIDs=[];for(var ht=0;ht<ut.messageIDs.length;++ht)typeof ut.messageIDs[ht]=="string"?it.base64.decode(ut.messageIDs[ht],lt.messageIDs[ht]=it.newBuffer(it.base64.length(ut.messageIDs[ht])),0):ut.messageIDs[ht].length&&(lt.messageIDs[ht]=ut.messageIDs[ht])}return lt},ct.toObject=function(ut,lt){lt||(lt={});var ht={};if((lt.arrays||lt.defaults)&&(ht.messageIDs=[]),ut.messageIDs&&ut.messageIDs.length){ht.messageIDs=[];for(var ft=0;ft<ut.messageIDs.length;++ft)ht.messageIDs[ft]=lt.bytes===String?it.base64.encode(ut.messageIDs[ft],0,ut.messageIDs[ft].length):lt.bytes===Array?Array.prototype.slice.call(ut.messageIDs[ft]):ut.messageIDs[ft]}return ht},ct.prototype.toJSON=function(){return this.constructor.toObject(this,tt.util.toJSONOptions)},ct}(),st.ControlGraft=function(){function ct(lt){if(lt)for(var ht=Object.keys(lt),ft=0;ft<ht.length;++ft)lt[ht[ft]]!=null&&(this[ht[ft]]=lt[ht[ft]])}ct.prototype.topicID=null;var ut;return Object.defineProperty(ct.prototype,"_topicID",{get:it.oneOfGetter(ut=["topicID"]),set:it.oneOfSetter(ut)}),ct.encode=function(lt,ht){return ht||(ht=nt.create()),lt.topicID!=null&&Object.hasOwnProperty.call(lt,"topicID")&&ht.uint32(10).string(lt.topicID),ht},ct.decode=function(lt,ht){lt instanceof rt||(lt=rt.create(lt));for(var ft=ht===void 0?lt.len:lt.pos+ht,dt=new ot.RPC.ControlGraft;lt.pos<ft;){var pt=lt.uint32();switch(pt>>>3){case 1:dt.topicID=lt.string();break;default:lt.skipType(pt&7);break}}return dt},ct.fromObject=function(lt){if(lt instanceof ot.RPC.ControlGraft)return lt;var ht=new ot.RPC.ControlGraft;return lt.topicID!=null&&(ht.topicID=String(lt.topicID)),ht},ct.toObject=function(lt,ht){ht||(ht={});var ft={};return lt.topicID!=null&&lt.hasOwnProperty("topicID")&&(ft.topicID=lt.topicID,ht.oneofs&&(ft._topicID="topicID")),ft},ct.prototype.toJSON=function(){return this.constructor.toObject(this,tt.util.toJSONOptions)},ct}(),st.ControlPrune=function(){function ct(lt){if(this.peers=[],lt)for(var ht=Object.keys(lt),ft=0;ft<ht.length;++ft)lt[ht[ft]]!=null&&(this[ht[ft]]=lt[ht[ft]])}ct.prototype.topicID=null,ct.prototype.peers=it.emptyArray,ct.prototype.backoff=null;var ut;return Object.defineProperty(ct.prototype,"_topicID",{get:it.oneOfGetter(ut=["topicID"]),set:it.oneOfSetter(ut)}),Object.defineProperty(ct.prototype,"_backoff",{get:it.oneOfGetter(ut=["backoff"]),set:it.oneOfSetter(ut)}),ct.encode=function(lt,ht){if(ht||(ht=nt.create()),lt.topicID!=null&&Object.hasOwnProperty.call(lt,"topicID")&&ht.uint32(10).string(lt.topicID),lt.peers!=null&&lt.peers.length)for(var ft=0;ft<lt.peers.length;++ft)ot.RPC.PeerInfo.encode(lt.peers[ft],ht.uint32(18).fork()).ldelim();return lt.backoff!=null&&Object.hasOwnProperty.call(lt,"backoff")&&ht.uint32(24).uint64(lt.backoff),ht},ct.decode=function(lt,ht){lt instanceof rt||(lt=rt.create(lt));for(var ft=ht===void 0?lt.len:lt.pos+ht,dt=new ot.RPC.ControlPrune;lt.pos<ft;){var pt=lt.uint32();switch(pt>>>3){case 1:dt.topicID=lt.string();break;case 2:dt.peers&&dt.peers.length||(dt.peers=[]),dt.peers.push(ot.RPC.PeerInfo.decode(lt,lt.uint32()));break;case 3:dt.backoff=lt.uint64();break;default:lt.skipType(pt&7);break}}return dt},ct.fromObject=function(lt){if(lt instanceof ot.RPC.ControlPrune)return lt;var ht=new ot.RPC.ControlPrune;if(lt.topicID!=null&&(ht.topicID=String(lt.topicID)),lt.peers){if(!Array.isArray(lt.peers))throw TypeError(".RPC.ControlPrune.peers: array expected");ht.peers=[];for(var ft=0;ft<lt.peers.length;++ft){if(typeof lt.peers[ft]!="object")throw TypeError(".RPC.ControlPrune.peers: object expected");ht.peers[ft]=ot.RPC.PeerInfo.fromObject(lt.peers[ft])}}return lt.backoff!=null&&(it.Long?(ht.backoff=it.Long.fromValue(lt.backoff)).unsigned=!0:typeof lt.backoff=="string"?ht.backoff=parseInt(lt.backoff,10):typeof lt.backoff=="number"?ht.backoff=lt.backoff:typeof lt.backoff=="object"&&(ht.backoff=new it.LongBits(lt.backoff.low>>>0,lt.backoff.high>>>0).toNumber(!0))),ht},ct.toObject=function(lt,ht){ht||(ht={});var ft={};if((ht.arrays||ht.defaults)&&(ft.peers=[]),lt.topicID!=null&&lt.hasOwnProperty("topicID")&&(ft.topicID=lt.topicID,ht.oneofs&&(ft._topicID="topicID")),lt.peers&&lt.peers.length){ft.peers=[];for(var dt=0;dt<lt.peers.length;++dt)ft.peers[dt]=ot.RPC.PeerInfo.toObject(lt.peers[dt],ht)}return lt.backoff!=null&&lt.hasOwnProperty("backoff")&&(typeof lt.backoff=="number"?ft.backoff=ht.longs===String?String(lt.backoff):lt.backoff:ft.backoff=ht.longs===String?it.Long.prototype.toString.call(lt.backoff):ht.longs===Number?new it.LongBits(lt.backoff.low>>>0,lt.backoff.high>>>0).toNumber(!0):lt.backoff,ht.oneofs&&(ft._backoff="backoff")),ft},ct.prototype.toJSON=function(){return this.constructor.toObject(this,tt.util.toJSONOptions)},ct}(),st.PeerInfo=function(){function ct(lt){if(lt)for(var ht=Object.keys(lt),ft=0;ft<ht.length;++ft)lt[ht[ft]]!=null&&(this[ht[ft]]=lt[ht[ft]])}ct.prototype.peerID=null,ct.prototype.signedPeerRecord=null;var ut;return Object.defineProperty(ct.prototype,"_peerID",{get:it.oneOfGetter(ut=["peerID"]),set:it.oneOfSetter(ut)}),Object.defineProperty(ct.prototype,"_signedPeerRecord",{get:it.oneOfGetter(ut=["signedPeerRecord"]),set:it.oneOfSetter(ut)}),ct.encode=function(lt,ht){return ht||(ht=nt.create()),lt.peerID!=null&&Object.hasOwnProperty.call(lt,"peerID")&&ht.uint32(10).bytes(lt.peerID),lt.signedPeerRecord!=null&&Object.hasOwnProperty.call(lt,"signedPeerRecord")&&ht.uint32(18).bytes(lt.signedPeerRecord),ht},ct.decode=function(lt,ht){lt instanceof rt||(lt=rt.create(lt));for(var ft=ht===void 0?lt.len:lt.pos+ht,dt=new ot.RPC.PeerInfo;lt.pos<ft;){var pt=lt.uint32();switch(pt>>>3){case 1:dt.peerID=lt.bytes();break;case 2:dt.signedPeerRecord=lt.bytes();break;default:lt.skipType(pt&7);break}}return dt},ct.fromObject=function(lt){if(lt instanceof ot.RPC.PeerInfo)return lt;var ht=new ot.RPC.PeerInfo;return lt.peerID!=null&&(typeof lt.peerID=="string"?it.base64.decode(lt.peerID,ht.peerID=it.newBuffer(it.base64.length(lt.peerID)),0):lt.peerID.length&&(ht.peerID=lt.peerID)),lt.signedPeerRecord!=null&&(typeof lt.signedPeerRecord=="string"?it.base64.decode(lt.signedPeerRecord,ht.signedPeerRecord=it.newBuffer(it.base64.length(lt.signedPeerRecord)),0):lt.signedPeerRecord.length&&(ht.signedPeerRecord=lt.signedPeerRecord)),ht},ct.toObject=function(lt,ht){ht||(ht={});var ft={};return lt.peerID!=null&&lt.hasOwnProperty("peerID")&&(ft.peerID=ht.bytes===String?it.base64.encode(lt.peerID,0,lt.peerID.length):ht.bytes===Array?Array.prototype.slice.call(lt.peerID):lt.peerID,ht.oneofs&&(ft._peerID="peerID")),lt.signedPeerRecord!=null&&lt.hasOwnProperty("signedPeerRecord")&&(ft.signedPeerRecord=ht.bytes===String?it.base64.encode(lt.signedPeerRecord,0,lt.signedPeerRecord.length):ht.bytes===Array?Array.prototype.slice.call(lt.signedPeerRecord):lt.signedPeerRecord,ht.oneofs&&(ft._signedPeerRecord="signedPeerRecord")),ft},ct.prototype.toJSON=function(){return this.constructor.toObject(this,tt.util.toJSONOptions)},ct}(),st}(),ot})})(rpc);var rpcExports=rpc.exports,heartbeat={},getGossipPeers$1={};Object.defineProperty(getGossipPeers$1,"__esModule",{value:!0}),getGossipPeers$1.getGossipPeers=void 0;const utils_1$3=utils$1;function getGossipPeers(et,tt,rt,nt=()=>!0){const it=et.topics.get(tt);if(!it)return new Set;let ot=[];return it.forEach(st=>{const at=et.peers.get(st);at&&utils_1$3.hasGossipProtocol(at.protocol)&&nt(st)&&ot.push(st)}),ot=utils_1$3.shuffle(ot),rt>0&&ot.length>rt&&(ot=ot.slice(0,rt)),new Set(ot)}getGossipPeers$1.getGossipPeers=getGossipPeers;var __createBinding$1=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(et,tt,rt,nt){nt===void 0&&(nt=rt),Object.defineProperty(et,nt,{enumerable:!0,get:function(){return tt[rt]}})}:function(et,tt,rt,nt){nt===void 0&&(nt=rt),et[nt]=tt[rt]}),__setModuleDefault$1=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(et,tt){Object.defineProperty(et,"default",{enumerable:!0,value:tt})}:function(et,tt){et.default=tt}),__importStar$1=commonjsGlobal&&commonjsGlobal.__importStar||function(et){if(et&&et.__esModule)return et;var tt={};if(et!=null)for(var rt in et)rt!=="default"&&Object.prototype.hasOwnProperty.call(et,rt)&&__createBinding$1(tt,et,rt);return __setModuleDefault$1(tt,et),tt};Object.defineProperty(heartbeat,"__esModule",{value:!0}),heartbeat.Heartbeat=void 0;const constants$2=__importStar$1(constants$3),get_gossip_peers_1$1=getGossipPeers$1,utils_1$2=utils$1;class Heartbeat{constructor(tt){this.gossipsub=tt}start(){if(this._heartbeatTimer)return;const tt=this._heartbeat.bind(this),rt=setTimeout(()=>{tt(),this._heartbeatTimer.runPeriodically(tt,this.gossipsub._options.heartbeatInterval)},constants$2.GossipsubHeartbeatInitialDelay);this._heartbeatTimer={_intervalId:void 0,runPeriodically:(nt,it)=>{this._heartbeatTimer._intervalId=setInterval(nt,it)},cancel:()=>{clearTimeout(rt),clearInterval(this._heartbeatTimer._intervalId)}}}stop(){this._heartbeatTimer&&(this._heartbeatTimer.cancel(),this._heartbeatTimer=null)}_heartbeat(){const{D:tt,Dlo:rt,Dhi:nt,Dscore:it,Dout:ot,fanoutTTL:st}=this.gossipsub._options;this.gossipsub.heartbeatTicks++;const at=new Map,ct=dt=>{let pt=at.get(dt);return pt===void 0&&(pt=this.gossipsub.score.score(dt),at.set(dt,pt)),pt},ut=new Map,lt=new Map,ht=new Map;this.gossipsub._clearBackoff(),this.gossipsub.peerhave.clear(),this.gossipsub.iasked.clear(),this.gossipsub._applyIwantPenalties(),this.gossipsub._directConnect(),this.gossipsub.mesh.forEach((dt,pt)=>{const gt=mt=>{this.gossipsub.log("HEARTBEAT: Remove mesh link to %s in %s",mt,pt),this.gossipsub.score.prune(mt,pt),this.gossipsub._addBackoff(mt,pt),dt.delete(mt);const At=lt.get(mt);At?At.push(pt):lt.set(mt,[pt])},_t=mt=>{this.gossipsub.log("HEARTBEAT: Add mesh link to %s in %s",mt,pt),this.gossipsub.score.graft(mt,pt),dt.add(mt);const At=ut.get(mt);At?At.push(pt):ut.set(mt,[pt])};if(dt.forEach(mt=>{const At=ct(mt);At<0&&(this.gossipsub.log("HEARTBEAT: Prune peer %s with negative score: score=%d, topic=%s",mt,At,pt),gt(mt),ht.set(mt,!0))}),dt.size<rt){const mt=this.gossipsub.backoff.get(pt),At=tt-dt.size;get_gossip_peers_1$1.getGossipPeers(this.gossipsub,pt,At,It=>!dt.has(It)&&!this.gossipsub.direct.has(It)&&(!mt||!mt.has(It))&&ct(It)>=0).forEach(_t)}if(dt.size>nt){let mt=Array.from(dt);mt.sort((It,Mt)=>ct(Mt)-ct(It)),mt=mt.slice(0,it).concat(utils_1$2.shuffle(mt.slice(it)));let At=0;if(mt.slice(0,tt).forEach(It=>{this.gossipsub.outbound.get(It)&&At++}),At<ot){const It=kt=>{const Ct=mt[kt];for(let Ut=kt;Ut>0;Ut--)mt[Ut]=mt[Ut-1];mt[0]=Ct};if(At>0){let kt=At;for(let Ct=1;Ct<tt&&kt>0;Ct++)this.gossipsub.outbound.get(mt[Ct])&&(It(Ct),kt--)}let Mt=tt-At;for(let kt=tt;kt<mt.length&&Mt>0;kt++)this.gossipsub.outbound.get(mt[kt])&&(It(kt),Mt--)}mt.slice(tt).forEach(gt)}if(dt.size>=rt){let mt=0;if(dt.forEach(At=>{this.gossipsub.outbound.get(At)&&mt++}),mt<ot){const At=ot-mt,It=this.gossipsub.backoff.get(pt);get_gossip_peers_1$1.getGossipPeers(this.gossipsub,pt,At,Mt=>!dt.has(Mt)&&!this.gossipsub.direct.has(Mt)&&(!It||!It.has(Mt))&&ct(Mt)>=0).forEach(_t)}}if(this.gossipsub.heartbeatTicks%constants$2.GossipsubOpportunisticGraftTicks===0&&dt.size>1){const mt=Array.from(dt).sort((Mt,kt)=>ct(Mt)-ct(kt)),At=Math.floor(dt.size/2),It=ct(mt[At]);if(It<this.gossipsub._options.scoreThresholds.opportunisticGraftThreshold){const Mt=this.gossipsub.backoff.get(pt);get_gossip_peers_1$1.getGossipPeers(this.gossipsub,pt,constants$2.GossipsubOpportunisticGraftPeers,kt=>dt.has(kt)&&!this.gossipsub.direct.has(kt)&&(!Mt||!Mt.has(kt))&&ct(kt)>It).forEach(kt=>{this.gossipsub.log("HEARTBEAT: Opportunistically graft peer %s on topic %s",kt,pt),_t(kt)})}}this.gossipsub._emitGossip(pt,dt)});const ft=this.gossipsub._now();this.gossipsub.lastpub.forEach((dt,pt)=>{dt+st<ft&&(this.gossipsub.fanout.delete(pt),this.gossipsub.lastpub.delete(pt))}),this.gossipsub.fanout.forEach((dt,pt)=>{const gt=this.gossipsub.topics.get(pt);if(dt.forEach(_t=>{(!gt.has(_t)||ct(_t)<this.gossipsub._options.scoreThresholds.publishThreshold)&&dt.delete(_t)}),dt.size<tt){const _t=tt-dt.size;get_gossip_peers_1$1.getGossipPeers(this.gossipsub,pt,_t,mt=>!dt.has(mt)&&!this.gossipsub.direct.has(mt)&&ct(mt)>=this.gossipsub._options.scoreThresholds.publishThreshold).forEach(mt=>{dt.add(mt)})}this.gossipsub._emitGossip(pt,dt)}),this.gossipsub._sendGraftPrune(ut,lt,ht),this.gossipsub._flush(),this.gossipsub.messageCache.shift(),this.gossipsub.emit("gossipsub:heartbeat")}}heartbeat.Heartbeat=Heartbeat;var score={},peerScoreParams={},constants$1={};Object.defineProperty(constants$1,"__esModule",{value:!0}),constants$1.ERR_INVALID_PEER_SCORE_THRESHOLDS=constants$1.ERR_INVALID_PEER_SCORE_PARAMS=void 0,constants$1.ERR_INVALID_PEER_SCORE_PARAMS="ERR_INVALID_PEER_SCORE_PARAMS",constants$1.ERR_INVALID_PEER_SCORE_THRESHOLDS="ERR_INVALID_PEER_SCORE_THRESHOLDS",function(et){Object.defineProperty(et,"__esModule",{value:!0}),et.validateTopicScoreParams=et.validatePeerScoreParams=et.createTopicScoreParams=et.createPeerScoreParams=et.defaultTopicScoreParams=et.defaultPeerScoreParams=void 0;const tt=constants$1,rt=errCode$i;et.defaultPeerScoreParams={topics:{},topicScoreCap:10,appSpecificScore:()=>0,appSpecificWeight:10,IPColocationFactorWeight:-5,IPColocationFactorThreshold:10,IPColocationFactorWhitelist:new Set,behaviourPenaltyWeight:-10,behaviourPenaltyDecay:.2,decayInterval:1e3,decayToZero:.1,retainScore:3600*1e3},et.defaultTopicScoreParams={topicWeight:.5,timeInMeshWeight:1,timeInMeshQuantum:1,timeInMeshCap:3600,firstMessageDeliveriesWeight:1,firstMessageDeliveriesDecay:.5,firstMessageDeliveriesCap:2e3,meshMessageDeliveriesWeight:-1,meshMessageDeliveriesDecay:.5,meshMessageDeliveriesCap:100,meshMessageDeliveriesThreshold:20,meshMessageDeliveriesWindow:10,meshMessageDeliveriesActivation:5e3,meshFailurePenaltyWeight:-1,meshFailurePenaltyDecay:.5,invalidMessageDeliveriesWeight:-1,invalidMessageDeliveriesDecay:.3};function nt(at={}){return Object.assign(Object.assign(Object.assign({},et.defaultPeerScoreParams),at),{topics:at.topics?Object.entries(at.topics).reduce((ct,[ut,lt])=>(ct[ut]=it(lt),ct),{}):{}})}et.createPeerScoreParams=nt;function it(at={}){return Object.assign(Object.assign({},et.defaultTopicScoreParams),at)}et.createTopicScoreParams=it;function ot(at){for(const[ct,ut]of Object.entries(at.topics))try{st(ut)}catch(lt){throw rt(new Error(`invalid score parameters for topic ${ct}: ${lt.message}`),tt.ERR_INVALID_PEER_SCORE_PARAMS)}if(at.topicScoreCap<0)throw rt(new Error("invalid topic score cap; must be positive (or 0 for no cap)"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.appSpecificScore===null||at.appSpecificScore===void 0)throw rt(new Error("missing application specific score function"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.IPColocationFactorWeight>0)throw rt(new Error("invalid IPColocationFactorWeight; must be negative (or 0 to disable)"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.IPColocationFactorWeight!==0&&at.IPColocationFactorThreshold<1)throw rt(new Error("invalid IPColocationFactorThreshold; must be at least 1"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.behaviourPenaltyWeight>0)throw rt(new Error("invalid BehaviourPenaltyWeight; must be negative (or 0 to disable)"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.behaviourPenaltyWeight!==0&&(at.behaviourPenaltyDecay<=0||at.behaviourPenaltyDecay>=1))throw rt(new Error("invalid BehaviourPenaltyDecay; must be between 0 and 1"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.decayInterval<1e3)throw rt(new Error("invalid DecayInterval; must be at least 1s"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.decayToZero<=0||at.decayToZero>=1)throw rt(new Error("invalid DecayToZero; must be between 0 and 1"),tt.ERR_INVALID_PEER_SCORE_PARAMS)}et.validatePeerScoreParams=ot;function st(at){if(at.topicWeight<0)throw rt(new Error("invalid topic weight; must be >= 0"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.timeInMeshQuantum===0)throw rt(new Error("invalid TimeInMeshQuantum; must be non zero"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.timeInMeshWeight<0)throw rt(new Error("invalid TimeInMeshWeight; must be positive (or 0 to disable)"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.timeInMeshWeight!==0&&at.timeInMeshQuantum<=0)throw rt(new Error("invalid TimeInMeshQuantum; must be positive"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.timeInMeshWeight!==0&&at.timeInMeshCap<=0)throw rt(new Error("invalid TimeInMeshCap; must be positive"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.firstMessageDeliveriesWeight<0)throw rt(new Error("invallid FirstMessageDeliveriesWeight; must be positive (or 0 to disable)"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.firstMessageDeliveriesWeight!==0&&(at.firstMessageDeliveriesDecay<=0||at.firstMessageDeliveriesDecay>=1))throw rt(new Error("invalid FirstMessageDeliveriesDecay; must be between 0 and 1"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.firstMessageDeliveriesWeight!==0&&at.firstMessageDeliveriesCap<=0)throw rt(new Error("invalid FirstMessageDeliveriesCap; must be positive"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.meshMessageDeliveriesWeight>0)throw rt(new Error("invalid MeshMessageDeliveriesWeight; must be negative (or 0 to disable)"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.meshMessageDeliveriesWeight!==0&&(at.meshMessageDeliveriesDecay<=0||at.meshMessageDeliveriesDecay>=1))throw rt(new Error("invalid MeshMessageDeliveriesDecay; must be between 0 and 1"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.meshMessageDeliveriesWeight!==0&&at.meshMessageDeliveriesCap<=0)throw rt(new Error("invalid MeshMessageDeliveriesCap; must be positive"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.meshMessageDeliveriesWeight!==0&&at.meshMessageDeliveriesThreshold<=0)throw rt(new Error("invalid MeshMessageDeliveriesThreshold; must be positive"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.meshMessageDeliveriesWindow<0)throw rt(new Error("invalid MeshMessageDeliveriesWindow; must be non-negative"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.meshMessageDeliveriesWeight!==0&&at.meshMessageDeliveriesActivation<1e3)throw rt(new Error("invalid MeshMessageDeliveriesActivation; must be at least 1s"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.meshFailurePenaltyWeight>0)throw rt(new Error("invalid MeshFailurePenaltyWeight; must be negative (or 0 to disable)"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.meshFailurePenaltyWeight!==0&&(at.meshFailurePenaltyDecay<=0||at.meshFailurePenaltyDecay>=1))throw rt(new Error("invalid MeshFailurePenaltyDecay; must be between 0 and 1"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.invalidMessageDeliveriesWeight>0)throw rt(new Error("invalid InvalidMessageDeliveriesWeight; must be negative (or 0 to disable)"),tt.ERR_INVALID_PEER_SCORE_PARAMS);if(at.invalidMessageDeliveriesDecay<=0||at.invalidMessageDeliveriesDecay>=1)throw rt(new Error("invalid InvalidMessageDeliveriesDecay; must be between 0 and 1"),tt.ERR_INVALID_PEER_SCORE_PARAMS)}et.validateTopicScoreParams=st}(peerScoreParams);var peerScoreThresholds={};(function(et){Object.defineProperty(et,"__esModule",{value:!0}),et.validatePeerScoreThresholds=et.createPeerScoreThresholds=et.defaultPeerScoreThresholds=void 0;const tt=constants$1,rt=errCode$i;et.defaultPeerScoreThresholds={gossipThreshold:-10,publishThreshold:-50,graylistThreshold:-80,acceptPXThreshold:10,opportunisticGraftThreshold:20};function nt(ot={}){return Object.assign(Object.assign({},et.defaultPeerScoreThresholds),ot)}et.createPeerScoreThresholds=nt;function it(ot){if(ot.gossipThreshold>0)throw rt(new Error("invalid gossip threshold; it must be <= 0"),tt.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(ot.publishThreshold>0||ot.publishThreshold>ot.gossipThreshold)throw rt(new Error("invalid publish threshold; it must be <= 0 and <= gossip threshold"),tt.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(ot.graylistThreshold>0||ot.graylistThreshold>ot.publishThreshold)throw rt(new Error("invalid graylist threshold; it must be <= 0 and <= publish threshold"),tt.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(ot.acceptPXThreshold<0)throw rt(new Error("invalid accept PX threshold; it must be >= 0"),tt.ERR_INVALID_PEER_SCORE_THRESHOLDS);if(ot.opportunisticGraftThreshold<0)throw rt(new Error("invalid opportunistic grafting threshold; it must be >= 0"),tt.ERR_INVALID_PEER_SCORE_THRESHOLDS)}et.validatePeerScoreThresholds=it})(peerScoreThresholds);var peerScore={},peerStats={};Object.defineProperty(peerStats,"__esModule",{value:!0}),peerStats.ensureTopicStats=peerStats.createTopicStats=peerStats.createPeerStats=void 0;function createPeerStats(et={}){return Object.assign(Object.assign({connected:!1,expire:0,ips:[],behaviourPenalty:0},et),{topics:et.topics?Object.entries(et.topics).reduce((tt,[rt,nt])=>(tt[rt]=createTopicStats(nt),tt),{}):{}})}peerStats.createPeerStats=createPeerStats;function createTopicStats(et={}){return Object.assign({inMesh:!1,graftTime:0,meshTime:0,firstMessageDeliveries:0,meshMessageDeliveries:0,meshMessageDeliveriesActive:!1,meshFailurePenalty:0,invalidMessageDeliveries:0},et)}peerStats.createTopicStats=createTopicStats;function ensureTopicStats(et,tt,rt){let nt=tt.topics[et];if(nt)return nt;if(rt.topics[et])return tt.topics[et]=nt=createTopicStats(),nt}peerStats.ensureTopicStats=ensureTopicStats;var computeScore$1={};Object.defineProperty(computeScore$1,"__esModule",{value:!0}),computeScore$1.computeScore=void 0;function computeScore(et,tt,rt,nt){let it=0;Object.entries(tt.topics).forEach(([at,ct])=>{const ut=rt.topics[at];if(!ut)return;let lt=0;if(ct.inMesh){let pt=ct.meshTime/ut.timeInMeshQuantum;pt>ut.timeInMeshCap&&(pt=ut.timeInMeshCap),lt+=pt*ut.timeInMeshWeight}const ht=ct.firstMessageDeliveries;if(lt+=ht*ut.firstMessageDeliveriesWeight,ct.meshMessageDeliveriesActive&&ct.meshMessageDeliveries<ut.meshMessageDeliveriesThreshold){const pt=ut.meshMessageDeliveriesThreshold-ct.meshMessageDeliveries,gt=pt*pt;lt+=gt*ut.meshMessageDeliveriesWeight}const ft=ct.meshFailurePenalty;lt+=ft*ut.meshFailurePenaltyWeight;const dt=ct.invalidMessageDeliveries*ct.invalidMessageDeliveries;lt+=dt*ut.invalidMessageDeliveriesWeight,it+=lt*ut.topicWeight}),rt.topicScoreCap>0&&it>rt.topicScoreCap&&(it=rt.topicScoreCap);const ot=rt.appSpecificScore(et);it+=ot*rt.appSpecificWeight,tt.ips.forEach(at=>{if(rt.IPColocationFactorWhitelist.has(at))return;const ct=nt.get(at),ut=ct?ct.size:0;if(ut>rt.IPColocationFactorThreshold){const lt=ut-rt.IPColocationFactorThreshold,ht=lt*lt;it+=ht*rt.IPColocationFactorWeight}});const st=tt.behaviourPenalty*tt.behaviourPenalty;return it+=st*rt.behaviourPenaltyWeight,it}computeScore$1.computeScore=computeScore;var messageDeliveries={};function Denque(et,rt){var rt=rt||{};this._head=0,this._tail=0,this._capacity=rt.capacity,this._capacityMask=3,this._list=new Array(4),Array.isArray(et)&&this._fromArray(et)}Denque.prototype.peekAt=function et(tt){var rt=tt;if(rt===(rt|0)){var nt=this.size();if(!(rt>=nt||rt<-nt))return rt<0&&(rt+=nt),rt=this._head+rt&this._capacityMask,this._list[rt]}},Denque.prototype.get=function et(tt){return this.peekAt(tt)},Denque.prototype.peek=function et(){if(this._head!==this._tail)return this._list[this._head]},Denque.prototype.peekFront=function et(){return this.peek()},Denque.prototype.peekBack=function et(){return this.peekAt(-1)},Object.defineProperty(Denque.prototype,"length",{get:function et(){return this.size()}}),Denque.prototype.size=function et(){return this._head===this._tail?0:this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},Denque.prototype.unshift=function et(tt){if(tt===void 0)return this.size();var rt=this._list.length;return this._head=this._head-1+rt&this._capacityMask,this._list[this._head]=tt,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.pop(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},Denque.prototype.shift=function et(){var tt=this._head;if(tt!==this._tail){var rt=this._list[tt];return this._list[tt]=void 0,this._head=tt+1&this._capacityMask,tt<2&&this._tail>1e4&&this._tail<=this._list.length>>>2&&this._shrinkArray(),rt}},Denque.prototype.push=function et(tt){if(tt===void 0)return this.size();var rt=this._tail;return this._list[rt]=tt,this._tail=rt+1&this._capacityMask,this._tail===this._head&&this._growArray(),this._capacity&&this.size()>this._capacity&&this.shift(),this._head<this._tail?this._tail-this._head:this._capacityMask+1-(this._head-this._tail)},Denque.prototype.pop=function et(){var tt=this._tail;if(tt!==this._head){var rt=this._list.length;this._tail=tt-1+rt&this._capacityMask;var nt=this._list[this._tail];return this._list[this._tail]=void 0,this._head<2&&tt>1e4&&tt<=rt>>>2&&this._shrinkArray(),nt}},Denque.prototype.removeOne=function et(tt){var rt=tt;if(rt===(rt|0)&&this._head!==this._tail){var nt=this.size(),it=this._list.length;if(!(rt>=nt||rt<-nt)){rt<0&&(rt+=nt),rt=this._head+rt&this._capacityMask;var ot=this._list[rt],st;if(tt<nt/2){for(st=tt;st>0;st--)this._list[rt]=this._list[rt=rt-1+it&this._capacityMask];this._list[rt]=void 0,this._head=this._head+1+it&this._capacityMask}else{for(st=nt-1-tt;st>0;st--)this._list[rt]=this._list[rt=rt+1+it&this._capacityMask];this._list[rt]=void 0,this._tail=this._tail-1+it&this._capacityMask}return ot}}},Denque.prototype.remove=function et(tt,rt){var nt=tt,it,ot=rt;if(nt===(nt|0)&&this._head!==this._tail){var st=this.size(),at=this._list.length;if(!(nt>=st||nt<-st||rt<1)){if(nt<0&&(nt+=st),rt===1||!rt)return it=new Array(1),it[0]=this.removeOne(nt),it;if(nt===0&&nt+rt>=st)return it=this.toArray(),this.clear(),it;nt+rt>st&&(rt=st-nt);var ct;for(it=new Array(rt),ct=0;ct<rt;ct++)it[ct]=this._list[this._head+nt+ct&this._capacityMask];if(nt=this._head+nt&this._capacityMask,tt+rt===st){for(this._tail=this._tail-rt+at&this._capacityMask,ct=rt;ct>0;ct--)this._list[nt=nt+1+at&this._capacityMask]=void 0;return it}if(tt===0){for(this._head=this._head+rt+at&this._capacityMask,ct=rt-1;ct>0;ct--)this._list[nt=nt+1+at&this._capacityMask]=void 0;return it}if(nt<st/2){for(this._head=this._head+tt+rt+at&this._capacityMask,ct=tt;ct>0;ct--)this.unshift(this._list[nt=nt-1+at&this._capacityMask]);for(nt=this._head-1+at&this._capacityMask;ot>0;)this._list[nt=nt-1+at&this._capacityMask]=void 0,ot--;tt<0&&(this._tail=nt)}else{for(this._tail=nt,nt=nt+rt+at&this._capacityMask,ct=st-(rt+tt);ct>0;ct--)this.push(this._list[nt++]);for(nt=this._tail;ot>0;)this._list[nt=nt+1+at&this._capacityMask]=void 0,ot--}return this._head<2&&this._tail>1e4&&this._tail<=at>>>2&&this._shrinkArray(),it}}},Denque.prototype.splice=function et(tt,rt){var nt=tt;if(nt===(nt|0)){var it=this.size();if(nt<0&&(nt+=it),!(nt>it))if(arguments.length>2){var ot,st,at,ct=arguments.length,ut=this._list.length,lt=2;if(!it||nt<it/2){for(st=new Array(nt),ot=0;ot<nt;ot++)st[ot]=this._list[this._head+ot&this._capacityMask];for(rt===0?(at=[],nt>0&&(this._head=this._head+nt+ut&this._capacityMask)):(at=this.remove(nt,rt),this._head=this._head+nt+ut&this._capacityMask);ct>lt;)this.unshift(arguments[--ct]);for(ot=nt;ot>0;ot--)this.unshift(st[ot-1])}else{st=new Array(it-(nt+rt));var ht=st.length;for(ot=0;ot<ht;ot++)st[ot]=this._list[this._head+nt+rt+ot&this._capacityMask];for(rt===0?(at=[],nt!=it&&(this._tail=this._head+nt+ut&this._capacityMask)):(at=this.remove(nt,rt),this._tail=this._tail-ht+ut&this._capacityMask);lt<ct;)this.push(arguments[lt++]);for(ot=0;ot<ht;ot++)this.push(st[ot])}return at}else return this.remove(nt,rt)}},Denque.prototype.clear=function et(){this._head=0,this._tail=0},Denque.prototype.isEmpty=function et(){return this._head===this._tail},Denque.prototype.toArray=function et(){return this._copyArray(!1)},Denque.prototype._fromArray=function et(tt){for(var rt=0;rt<tt.length;rt++)this.push(tt[rt])},Denque.prototype._copyArray=function et(tt){var rt=[],nt=this._list,it=nt.length,ot;if(tt||this._head>this._tail){for(ot=this._head;ot<it;ot++)rt.push(nt[ot]);for(ot=0;ot<this._tail;ot++)rt.push(nt[ot])}else for(ot=this._head;ot<this._tail;ot++)rt.push(nt[ot]);return rt},Denque.prototype._growArray=function et(){this._head&&(this._list=this._copyArray(!0),this._head=0),this._tail=this._list.length,this._list.length<<=1,this._capacityMask=this._capacityMask<<1|1},Denque.prototype._shrinkArray=function et(){this._list.length>>>=1,this._capacityMask>>>=1};var denque=Denque;(function(et){var tt=commonjsGlobal&&commonjsGlobal.__importDefault||function(at){return at&&at.__esModule?at:{default:at}};Object.defineProperty(et,"__esModule",{value:!0}),et.MessageDeliveries=et.DeliveryRecordStatus=void 0;const rt=constants$3,nt=tt(denque),it=utils$1;var ot;(function(at){at[at.unknown=0]="unknown",at[at.valid=1]="valid",at[at.invalid=2]="invalid",at[at.ignored=3]="ignored"})(ot=et.DeliveryRecordStatus||(et.DeliveryRecordStatus={}));class st{constructor(){this.records=new Map,this.queue=new nt.default}ensureRecord(ct){const ut=it.messageIdToString(ct);let lt=this.records.get(ut);if(lt)return lt;lt={status:ot.unknown,firstSeen:Date.now(),validated:0,peers:new Set},this.records.set(ut,lt);const ht={msgId:ut,expire:Date.now()+rt.TimeCacheDuration};return this.queue.push(ht),lt}gc(){const ct=Date.now();let ut=this.queue.peekFront();for(;ut&&ut.expire<ct;)this.records.delete(ut.msgId),this.queue.shift(),ut=this.queue.peekFront()}clear(){this.records.clear(),this.queue.clear()}}et.MessageDeliveries=st})(messageDeliveries);var __awaiter$2=commonjsGlobal&&commonjsGlobal.__awaiter||function(et,tt,rt,nt){function it(ot){return ot instanceof rt?ot:new rt(function(st){st(ot)})}return new(rt||(rt=Promise))(function(ot,st){function at(lt){try{ut(nt.next(lt))}catch(ht){st(ht)}}function ct(lt){try{ut(nt.throw(lt))}catch(ht){st(ht)}}function ut(lt){lt.done?ot(lt.value):it(lt.value).then(at,ct)}ut((nt=nt.apply(et,tt||[])).next())})},__importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(et){return et&&et.__esModule?et:{default:et}};Object.defineProperty(peerScore,"__esModule",{value:!0}),peerScore.PeerScore=void 0;const peer_score_params_1=peerScoreParams,peer_stats_1=peerStats,compute_score_1=computeScore$1,message_deliveries_1=messageDeliveries,constants_1$1=constants$3,peer_id_1=__importDefault(srcExports$1),debug$2=browserExports,pubsubErrors$1=errors$1,{ERR_INVALID_SIGNATURE:ERR_INVALID_SIGNATURE$1,ERR_MISSING_SIGNATURE:ERR_MISSING_SIGNATURE$1}=pubsubErrors$1.codes,log$2=debug$2("libp2p:gossipsub:score");class PeerScore{constructor(tt,rt,nt){peer_score_params_1.validatePeerScoreParams(tt),this.params=tt,this._connectionManager=rt,this.peerStats=new Map,this.peerIPs=new Map,this.deliveryRecords=new message_deliveries_1.MessageDeliveries,this.msgId=nt}start(){if(this._backgroundInterval){log$2("Peer score already running");return}this._backgroundInterval=setInterval(()=>this.background(),this.params.decayInterval),log$2("started")}stop(){if(!this._backgroundInterval){log$2("Peer score already stopped");return}clearInterval(this._backgroundInterval),delete this._backgroundInterval,this.peerIPs.clear(),this.peerStats.clear(),this.deliveryRecords.clear(),log$2("stopped")}background(){this._refreshScores(),this._updateIPs(),this.deliveryRecords.gc()}_refreshScores(){const tt=Date.now(),rt=this.params.decayToZero;this.peerStats.forEach((nt,it)=>{if(!nt.connected){tt>nt.expire&&(this._removeIPs(it,nt.ips),this.peerStats.delete(it));return}Object.entries(nt.topics).forEach(([ot,st])=>{const at=this.params.topics[ot];at&&(st.firstMessageDeliveries*=at.firstMessageDeliveriesDecay,st.firstMessageDeliveries<rt&&(st.firstMessageDeliveries=0),st.meshMessageDeliveries*=at.meshMessageDeliveriesDecay,st.meshMessageDeliveries<rt&&(st.meshMessageDeliveries=0),st.meshFailurePenalty*=at.meshFailurePenaltyDecay,st.meshFailurePenalty<rt&&(st.meshFailurePenalty=0),st.invalidMessageDeliveries*=at.invalidMessageDeliveriesDecay,st.invalidMessageDeliveries<rt&&(st.invalidMessageDeliveries=0),st.inMesh&&(st.meshTime=tt-st.graftTime,st.meshTime>at.meshMessageDeliveriesActivation&&(st.meshMessageDeliveriesActive=!0)))}),nt.behaviourPenalty*=this.params.behaviourPenaltyDecay,nt.behaviourPenalty<rt&&(nt.behaviourPenalty=0)})}score(tt){const rt=this.peerStats.get(tt);return rt?compute_score_1.computeScore(tt,rt,this.params,this.peerIPs):0}addPenalty(tt,rt){const nt=this.peerStats.get(tt);nt&&(nt.behaviourPenalty+=rt)}addPeer(tt){const rt=peer_stats_1.createPeerStats({connected:!0});this.peerStats.set(tt,rt);const nt=this._getIPs(tt);this._setIPs(tt,nt,rt.ips),rt.ips=nt}removePeer(tt){const rt=this.peerStats.get(tt);if(rt){if(this.score(tt)>0){this._removeIPs(tt,rt.ips),this.peerStats.delete(tt);return}Object.entries(rt.topics).forEach(([nt,it])=>{it.firstMessageDeliveries=0;const ot=this.params.topics[nt].meshMessageDeliveriesThreshold;if(it.inMesh&&it.meshMessageDeliveriesActive&&it.meshMessageDeliveries<ot){const st=ot-it.meshMessageDeliveries;it.meshFailurePenalty+=st*st}it.inMesh=!1,it.meshMessageDeliveriesActive=!1}),rt.connected=!1,rt.expire=Date.now()+this.params.retainScore}}graft(tt,rt){const nt=this.peerStats.get(tt);if(!nt)return;const it=peer_stats_1.ensureTopicStats(rt,nt,this.params);it&&(it.inMesh=!0,it.graftTime=Date.now(),it.meshTime=0,it.meshMessageDeliveriesActive=!1)}prune(tt,rt){const nt=this.peerStats.get(tt);if(!nt)return;const it=peer_stats_1.ensureTopicStats(rt,nt,this.params);if(!it)return;const ot=this.params.topics[rt].meshMessageDeliveriesThreshold;if(it.meshMessageDeliveriesActive&&it.meshMessageDeliveries<ot){const st=ot-it.meshMessageDeliveries;it.meshFailurePenalty+=st*st}it.inMesh=!1,it.meshMessageDeliveriesActive=!1}validateMessage(tt){return __awaiter$2(this,void 0,void 0,function*(){this.deliveryRecords.ensureRecord(yield this.msgId(tt))})}deliverMessage(tt){return __awaiter$2(this,void 0,void 0,function*(){const rt=tt.receivedFrom;this._markFirstMessageDelivery(rt,tt);const nt=this.deliveryRecords.ensureRecord(yield this.msgId(tt)),it=Date.now();if(nt.status!==message_deliveries_1.DeliveryRecordStatus.unknown){log$2("unexpected delivery: message from %s was first seen %s ago and has delivery status %d",rt,it-nt.firstSeen,message_deliveries_1.DeliveryRecordStatus[nt.status]);return}nt.status=message_deliveries_1.DeliveryRecordStatus.valid,nt.validated=it,nt.peers.forEach(ot=>{ot!==rt&&this._markDuplicateMessageDelivery(ot,tt)})})}rejectMessage(tt,rt){return __awaiter$2(this,void 0,void 0,function*(){const nt=tt.receivedFrom;switch(rt){case ERR_MISSING_SIGNATURE$1:case ERR_INVALID_SIGNATURE$1:this._markInvalidMessageDelivery(nt,tt);return}const it=this.deliveryRecords.ensureRecord(yield this.msgId(tt));if(it.status!==message_deliveries_1.DeliveryRecordStatus.unknown){log$2("unexpected rejection: message from %s was first seen %s ago and has delivery status %d",nt,Date.now()-it.firstSeen,message_deliveries_1.DeliveryRecordStatus[it.status]);return}switch(rt){case constants_1$1.ERR_TOPIC_VALIDATOR_IGNORE:it.status=message_deliveries_1.DeliveryRecordStatus.ignored;return}it.status=message_deliveries_1.DeliveryRecordStatus.invalid,this._markInvalidMessageDelivery(nt,tt),it.peers.forEach(ot=>{this._markInvalidMessageDelivery(ot,tt)})})}duplicateMessage(tt){return __awaiter$2(this,void 0,void 0,function*(){const rt=tt.receivedFrom,nt=this.deliveryRecords.ensureRecord(yield this.msgId(tt));if(!nt.peers.has(rt))switch(nt.status){case message_deliveries_1.DeliveryRecordStatus.unknown:nt.peers.add(rt);break;case message_deliveries_1.DeliveryRecordStatus.valid:nt.peers.add(rt),this._markDuplicateMessageDelivery(rt,tt,nt.validated);break;case message_deliveries_1.DeliveryRecordStatus.invalid:this._markInvalidMessageDelivery(rt,tt);break}})}_markInvalidMessageDelivery(tt,rt){const nt=this.peerStats.get(tt);nt&&rt.topicIDs.forEach(it=>{const ot=peer_stats_1.ensureTopicStats(it,nt,this.params);ot&&(ot.invalidMessageDeliveries+=1)})}_markFirstMessageDelivery(tt,rt){const nt=this.peerStats.get(tt);nt&&rt.topicIDs.forEach(it=>{const ot=peer_stats_1.ensureTopicStats(it,nt,this.params);if(!ot)return;let st=this.params.topics[it].firstMessageDeliveriesCap;ot.firstMessageDeliveries+=1,ot.firstMessageDeliveries>st&&(ot.firstMessageDeliveries=st),ot.inMesh&&(st=this.params.topics[it].meshMessageDeliveriesCap,ot.meshMessageDeliveries+=1,ot.meshMessageDeliveries>st&&(ot.meshMessageDeliveries=st))})}_markDuplicateMessageDelivery(tt,rt,nt=0){const it=this.peerStats.get(tt);if(!it)return;const ot=nt?Date.now():0;rt.topicIDs.forEach(st=>{const at=peer_stats_1.ensureTopicStats(st,it,this.params);if(!at||!at.inMesh)return;const ct=this.params.topics[st];if(nt&&ot>nt+ct.meshMessageDeliveriesWindow)return;const ut=ct.meshMessageDeliveriesCap;at.meshMessageDeliveries+=1,at.meshMessageDeliveries>ut&&(at.meshMessageDeliveries=ut)})}_getIPs(tt){return this._connectionManager.getAll(peer_id_1.default.createFromB58String(tt)).map(rt=>rt.remoteAddr.toOptions().host)}_setIPs(tt,rt,nt){t:for(const it of rt){for(const st of nt)if(it===st)continue t;let ot=this.peerIPs.get(it);ot||(ot=new Set,this.peerIPs.set(it,ot)),ot.add(tt)}t:for(const it of nt){for(const st of rt)if(it===st)continue t;const ot=this.peerIPs.get(it);ot&&(ot.delete(tt),ot.size||this.peerIPs.delete(it))}}_removeIPs(tt,rt){rt.forEach(nt=>{const it=this.peerIPs.get(nt);it&&(it.delete(tt),it.size||this.peerIPs.delete(nt))})}_updateIPs(){this.peerStats.forEach((tt,rt)=>{const nt=this._getIPs(rt);this._setIPs(rt,nt,tt.ips),tt.ips=nt})}}peerScore.PeerScore=PeerScore,function(et){var tt=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(nt,it,ot,st){st===void 0&&(st=ot),Object.defineProperty(nt,st,{enumerable:!0,get:function(){return it[ot]}})}:function(nt,it,ot,st){st===void 0&&(st=ot),nt[st]=it[ot]}),rt=commonjsGlobal&&commonjsGlobal.__exportStar||function(nt,it){for(var ot in nt)ot!=="default"&&!Object.prototype.hasOwnProperty.call(it,ot)&&tt(it,nt,ot)};Object.defineProperty(et,"__esModule",{value:!0}),rt(peerScoreParams,et),rt(peerScoreThresholds,et),rt(peerScore,et)}(score);var tracer={},__awaiter$1=commonjsGlobal&&commonjsGlobal.__awaiter||function(et,tt,rt,nt){function it(ot){return ot instanceof rt?ot:new rt(function(st){st(ot)})}return new(rt||(rt=Promise))(function(ot,st){function at(lt){try{ut(nt.next(lt))}catch(ht){st(ht)}}function ct(lt){try{ut(nt.throw(lt))}catch(ht){st(ht)}}function ut(lt){lt.done?ot(lt.value):it(lt.value).then(at,ct)}ut((nt=nt.apply(et,tt||[])).next())})};Object.defineProperty(tracer,"__esModule",{value:!0}),tracer.IWantTracer=void 0;const constants_1=constants$3,utils_1$1=utils$1,pubsubErrors=errors$1,{ERR_INVALID_SIGNATURE,ERR_MISSING_SIGNATURE}=pubsubErrors.codes;class IWantTracer{constructor(tt){this.getMsgId=tt,this.promises=new Map}addPromise(tt,rt){const nt=Math.floor(Math.random()*rt.length),it=rt[nt],ot=utils_1$1.messageIdToString(it);let st=this.promises.get(ot);st||(st=new Map,this.promises.set(ot,st)),st.has(tt)||st.set(tt,Date.now()+constants_1.GossipsubIWantFollowupTime)}getBrokenPromises(){const tt=Date.now(),rt=new Map;return this.promises.forEach((nt,it)=>{nt.forEach((ot,st)=>{ot<tt&&(rt.set(st,(rt.get(st)||0)+1),nt.delete(st))}),nt.size||this.promises.delete(it)}),rt}deliverMessage(tt){return __awaiter$1(this,void 0,void 0,function*(){const rt=yield this.getMsgId(tt),nt=utils_1$1.messageIdToString(rt);this.promises.delete(nt)})}rejectMessage(tt,rt){return __awaiter$1(this,void 0,void 0,function*(){switch(rt){case ERR_INVALID_SIGNATURE:case ERR_MISSING_SIGNATURE:return}const nt=yield this.getMsgId(tt),it=utils_1$1.messageIdToString(nt);this.promises.delete(it)})}clear(){this.promises.clear()}}tracer.IWantTracer=IWantTracer;var src$2={exports:{}},FUNC_ERROR_TEXT="Expected a function",NAN=0/0,symbolTag="[object Symbol]",reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt,freeGlobal=typeof window=="object"&&window&&window.Object===Object&&window,freeSelf=typeof self=="object"&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),objectProto=Object.prototype,objectToString=objectProto.toString,nativeMax=Math.max,nativeMin=Math.min,now=function(){return root.Date.now()};function debounce(et,tt,rt){var nt,it,ot,st,at,ct,ut=0,lt=!1,ht=!1,ft=!0;if(typeof et!="function")throw new TypeError(FUNC_ERROR_TEXT);tt=toNumber(tt)||0,isObject(rt)&&(lt=!!rt.leading,ht="maxWait"in rt,ot=ht?nativeMax(toNumber(rt.maxWait)||0,tt):ot,ft="trailing"in rt?!!rt.trailing:ft);function dt(Ct){var Ut=nt,Wt=it;return nt=it=void 0,ut=Ct,st=et.apply(Wt,Ut),st}function pt(Ct){return ut=Ct,at=setTimeout(mt,tt),lt?dt(Ct):st}function gt(Ct){var Ut=Ct-ct,Wt=Ct-ut,Ft=tt-Ut;return ht?nativeMin(Ft,ot-Wt):Ft}function _t(Ct){var Ut=Ct-ct,Wt=Ct-ut;return ct===void 0||Ut>=tt||Ut<0||ht&&Wt>=ot}function mt(){var Ct=now();if(_t(Ct))return At(Ct);at=setTimeout(mt,gt(Ct))}function At(Ct){return at=void 0,ft&&nt?dt(Ct):(nt=it=void 0,st)}function It(){at!==void 0&&clearTimeout(at),ut=0,nt=ct=it=at=void 0}function Mt(){return at===void 0?st:At(now())}function kt(){var Ct=now(),Ut=_t(Ct);if(nt=arguments,it=this,ct=Ct,Ut){if(at===void 0)return pt(ct);if(ht)return at=setTimeout(mt,tt),dt(ct)}return at===void 0&&(at=setTimeout(mt,tt)),st}return kt.cancel=It,kt.flush=Mt,kt}function throttle(et,tt,rt){var nt=!0,it=!0;if(typeof et!="function")throw new TypeError(FUNC_ERROR_TEXT);return isObject(rt)&&(nt="leading"in rt?!!rt.leading:nt,it="trailing"in rt?!!rt.trailing:it),debounce(et,tt,{leading:nt,maxWait:tt,trailing:it})}function isObject(et){var tt=typeof et;return!!et&&(tt=="object"||tt=="function")}function isObjectLike(et){return!!et&&typeof et=="object"}function isSymbol(et){return typeof et=="symbol"||isObjectLike(et)&&objectToString.call(et)==symbolTag}function toNumber(et){if(typeof et=="number")return et;if(isSymbol(et))return NAN;if(isObject(et)){var tt=typeof et.valueOf=="function"?et.valueOf():et;et=isObject(tt)?tt+"":tt}if(typeof et!="string")return et===0?et:+et;et=et.replace(reTrim,"");var rt=reIsBinary.test(et);return rt||reIsOctal.test(et)?freeParseInt(et.slice(2),rt?2:8):reIsBadHex.test(et)?NAN:+et}var lodash_throttle=throttle;(function(et,tt){const rt=lodash_throttle;et.exports=nt;function nt(ot){if(!(this instanceof nt))return new nt(ot);ot=ot||{};const st=ot.validity||30,at=new Map,ct=rt(()=>{at.forEach((ut,lt)=>{const ht=ut.validity||st;it(ut.timestamp)>ht&&at.delete(lt)})},200);this.put=(ut,lt,ht)=>{this.has(ut)||at.set(ut,{value:lt,timestamp:new Date,validity:ht}),ct()},this.get=ut=>{if(at.has(ut))return at.get(ut).value;throw new Error("key does not exist")},this.has=ut=>at.has(ut)}function it(ot){const st=new Date().getTime()-ot.getTime();return Math.floor(st/1e3)}})(src$2);var srcExports=src$2.exports,errors={},hasRequiredErrors;function requireErrors(){return hasRequiredErrors||(hasRequiredErrors=1,errors.messages={NOT_STARTED_YET:"The libp2p node is not started yet",DHT_DISABLED:"DHT is not available",CONN_ENCRYPTION_REQUIRED:"At least one connection encryption module is required"},errors.codes={DHT_DISABLED:"ERR_DHT_DISABLED",PUBSUB_NOT_STARTED:"ERR_PUBSUB_NOT_STARTED",DHT_NOT_STARTED:"ERR_DHT_NOT_STARTED",CONN_ENCRYPTION_REQUIRED:"ERR_CONN_ENCRYPTION_REQUIRED",ERR_INVALID_PROTOCOLS_FOR_STREAM:"ERR_INVALID_PROTOCOLS_FOR_STREAM",ERR_CONNECTION_ENDED:"ERR_CONNECTION_ENDED",ERR_CONNECTION_FAILED:"ERR_CONNECTION_FAILED",ERR_NODE_NOT_STARTED:"ERR_NODE_NOT_STARTED",ERR_ALREADY_ABORTED:"ERR_ALREADY_ABORTED",ERR_TOO_MANY_ADDRESSES:"ERR_TOO_MANY_ADDRESSES",ERR_NO_VALID_ADDRESSES:"ERR_NO_VALID_ADDRESSES",ERR_RELAYED_DIAL:"ERR_RELAYED_DIAL",ERR_DIALED_SELF:"ERR_DIALED_SELF",ERR_DISCOVERED_SELF:"ERR_DISCOVERED_SELF",ERR_DUPLICATE_TRANSPORT:"ERR_DUPLICATE_TRANSPORT",ERR_ENCRYPTION_FAILED:"ERR_ENCRYPTION_FAILED",ERR_HOP_REQUEST_FAILED:"ERR_HOP_REQUEST_FAILED",ERR_INVALID_KEY:"ERR_INVALID_KEY",ERR_INVALID_MESSAGE:"ERR_INVALID_MESSAGE",ERR_INVALID_PARAMETERS:"ERR_INVALID_PARAMETERS",ERR_INVALID_PEER:"ERR_INVALID_PEER",ERR_MUXER_UNAVAILABLE:"ERR_MUXER_UNAVAILABLE",ERR_TIMEOUT:"ERR_TIMEOUT",ERR_TRANSPORT_UNAVAILABLE:"ERR_TRANSPORT_UNAVAILABLE",ERR_TRANSPORT_DIAL_FAILED:"ERR_TRANSPORT_DIAL_FAILED",ERR_UNSUPPORTED_PROTOCOL:"ERR_UNSUPPORTED_PROTOCOL",ERR_INVALID_MULTIADDR:"ERR_INVALID_MULTIADDR",ERR_SIGNATURE_NOT_VALID:"ERR_SIGNATURE_NOT_VALID"}),errors}var $protobuf$3=minimal,$Reader$3=$protobuf$3.Reader,$Writer$3=$protobuf$3.Writer,$util$3=$protobuf$3.util,$root$3=$protobuf$3.roots["libp2p-envelope"]||($protobuf$3.roots["libp2p-envelope"]={});$root$3.Envelope=function(){function et(tt){if(tt)for(var rt=Object.keys(tt),nt=0;nt<rt.length;++nt)tt[rt[nt]]!=null&&(this[rt[nt]]=tt[rt[nt]])}return et.prototype.publicKey=$util$3.newBuffer([]),et.prototype.payloadType=$util$3.newBuffer([]),et.prototype.payload=$util$3.newBuffer([]),et.prototype.signature=$util$3.newBuffer([]),et.encode=function(tt,rt){return rt||(rt=$Writer$3.create()),tt.publicKey!=null&&Object.hasOwnProperty.call(tt,"publicKey")&&rt.uint32(10).bytes(tt.publicKey),tt.payloadType!=null&&Object.hasOwnProperty.call(tt,"payloadType")&&rt.uint32(18).bytes(tt.payloadType),tt.payload!=null&&Object.hasOwnProperty.call(tt,"payload")&&rt.uint32(26).bytes(tt.payload),tt.signature!=null&&Object.hasOwnProperty.call(tt,"signature")&&rt.uint32(42).bytes(tt.signature),rt},et.decode=function(tt,rt){tt instanceof $Reader$3||(tt=$Reader$3.create(tt));for(var nt=rt===void 0?tt.len:tt.pos+rt,it=new $root$3.Envelope;tt.pos<nt;){var ot=tt.uint32();switch(ot>>>3){case 1:it.publicKey=tt.bytes();break;case 2:it.payloadType=tt.bytes();break;case 3:it.payload=tt.bytes();break;case 5:it.signature=tt.bytes();break;default:tt.skipType(ot&7);break}}return it},et.fromObject=function(tt){if(tt instanceof $root$3.Envelope)return tt;var rt=new $root$3.Envelope;return tt.publicKey!=null&&(typeof tt.publicKey=="string"?$util$3.base64.decode(tt.publicKey,rt.publicKey=$util$3.newBuffer($util$3.base64.length(tt.publicKey)),0):tt.publicKey.length&&(rt.publicKey=tt.publicKey)),tt.payloadType!=null&&(typeof tt.payloadType=="string"?$util$3.base64.decode(tt.payloadType,rt.payloadType=$util$3.newBuffer($util$3.base64.length(tt.payloadType)),0):tt.payloadType.length&&(rt.payloadType=tt.payloadType)),tt.payload!=null&&(typeof tt.payload=="string"?$util$3.base64.decode(tt.payload,rt.payload=$util$3.newBuffer($util$3.base64.length(tt.payload)),0):tt.payload.length&&(rt.payload=tt.payload)),tt.signature!=null&&(typeof tt.signature=="string"?$util$3.base64.decode(tt.signature,rt.signature=$util$3.newBuffer($util$3.base64.length(tt.signature)),0):tt.signature.length&&(rt.signature=tt.signature)),rt},et.toObject=function(tt,rt){rt||(rt={});var nt={};return rt.defaults&&(rt.bytes===String?nt.publicKey="":(nt.publicKey=[],rt.bytes!==Array&&(nt.publicKey=$util$3.newBuffer(nt.publicKey))),rt.bytes===String?nt.payloadType="":(nt.payloadType=[],rt.bytes!==Array&&(nt.payloadType=$util$3.newBuffer(nt.payloadType))),rt.bytes===String?nt.payload="":(nt.payload=[],rt.bytes!==Array&&(nt.payload=$util$3.newBuffer(nt.payload))),rt.bytes===String?nt.signature="":(nt.signature=[],rt.bytes!==Array&&(nt.signature=$util$3.newBuffer(nt.signature)))),tt.publicKey!=null&&tt.hasOwnProperty("publicKey")&&(nt.publicKey=rt.bytes===String?$util$3.base64.encode(tt.publicKey,0,tt.publicKey.length):rt.bytes===Array?Array.prototype.slice.call(tt.publicKey):tt.publicKey),tt.payloadType!=null&&tt.hasOwnProperty("payloadType")&&(nt.payloadType=rt.bytes===String?$util$3.base64.encode(tt.payloadType,0,tt.payloadType.length):rt.bytes===Array?Array.prototype.slice.call(tt.payloadType):tt.payloadType),tt.payload!=null&&tt.hasOwnProperty("payload")&&(nt.payload=rt.bytes===String?$util$3.base64.encode(tt.payload,0,tt.payload.length):rt.bytes===Array?Array.prototype.slice.call(tt.payload):tt.payload),tt.signature!=null&&tt.hasOwnProperty("signature")&&(nt.signature=rt.bytes===String?$util$3.base64.encode(tt.signature,0,tt.signature.length):rt.bytes===Array?Array.prototype.slice.call(tt.signature):tt.signature),nt},et.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf$3.util.toJSONOptions)},et}();var envelope$1=$root$3;const errCode=errCode$i,{concat:uint8arraysConcat}=require$$7$1,{fromString:uint8arraysFromString}=require$$9$2,cryptoKeys=keys$3,PeerId$1=srcExports$1,varint$2=varint$7,{equals:uint8arraysEquals}=require$$1$3,{codes}=requireErrors(),{Envelope:Protobuf}=envelope$1;let Envelope$1=class{constructor({peerId:et,payloadType:tt,payload:rt,signature:nt}){this.peerId=et,this.payloadType=tt,this.payload=rt,this.signature=nt,this._marshal=void 0}marshal(){if(this._marshal)return this._marshal;const et=cryptoKeys.marshalPublicKey(this.peerId.pubKey);return this._marshal=Protobuf.encode({publicKey:et,payloadType:this.payloadType,payload:this.payload,signature:this.signature}).finish(),this._marshal}equals(et){return uint8arraysEquals(this.peerId.pubKey.bytes,et.peerId.pubKey.bytes)&&uint8arraysEquals(this.payloadType,et.payloadType)&&uint8arraysEquals(this.payload,et.payload)&&uint8arraysEquals(this.signature,et.signature)}validate(et){const tt=formatSignaturePayload(et,this.payloadType,this.payload);return this.peerId.pubKey.verify(tt,this.signature)}};const formatSignaturePayload=(et,tt,rt)=>{const nt=uint8arraysFromString(et),it=varint$2.encode(nt.byteLength),ot=varint$2.encode(tt.length),st=varint$2.encode(rt.length);return uint8arraysConcat([new Uint8Array(it),nt,new Uint8Array(ot),tt,new Uint8Array(st),rt])};Envelope$1.createFromProtobuf=async et=>{const tt=Protobuf.decode(et),rt=await PeerId$1.createFromPubKey(tt.publicKey);return new Envelope$1({peerId:rt,payloadType:tt.payloadType,payload:tt.payload,signature:tt.signature})},Envelope$1.seal=async(et,tt)=>{const rt=et.domain,nt=et.codec,it=et.marshal(),ot=formatSignaturePayload(rt,nt,it),st=await tt.privKey.sign(ot);return new Envelope$1({peerId:tt,payloadType:nt,payload:it,signature:st})},Envelope$1.openAndCertify=async(et,tt)=>{const rt=await Envelope$1.createFromProtobuf(et);if(!await rt.validate(tt))throw errCode(new Error("envelope signature is not valid for the given domain"),codes.ERR_SIGNATURE_NOT_VALID);return rt};var envelope=Envelope$1,__createBinding=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(et,tt,rt,nt){nt===void 0&&(nt=rt),Object.defineProperty(et,nt,{enumerable:!0,get:function(){return tt[rt]}})}:function(et,tt,rt,nt){nt===void 0&&(nt=rt),et[nt]=tt[rt]}),__setModuleDefault=commonjsGlobal&&commonjsGlobal.__setModuleDefault||(Object.create?function(et,tt){Object.defineProperty(et,"default",{enumerable:!0,value:tt})}:function(et,tt){et.default=tt}),__importStar=commonjsGlobal&&commonjsGlobal.__importStar||function(et){if(et&&et.__esModule)return et;var tt={};if(et!=null)for(var rt in et)rt!=="default"&&Object.prototype.hasOwnProperty.call(et,rt)&&__createBinding(tt,et,rt);return __setModuleDefault(tt,et),tt},__awaiter=commonjsGlobal&&commonjsGlobal.__awaiter||function(et,tt,rt,nt){function it(ot){return ot instanceof rt?ot:new rt(function(st){st(ot)})}return new(rt||(rt=Promise))(function(ot,st){function at(lt){try{ut(nt.next(lt))}catch(ht){st(ht)}}function ct(lt){try{ut(nt.throw(lt))}catch(ht){st(ht)}}function ut(lt){lt.done?ot(lt.value):it(lt.value).then(at,ct)}ut((nt=nt.apply(et,tt||[])).next())})};const pubsub_1=__importStar(pubsub),message_cache_1=messageCache,rpc_1=rpcExports,constants=__importStar(constants$3),heartbeat_1=heartbeat,get_gossip_peers_1=getGossipPeers$1,utils_1=utils$1,score_1=score,tracer_1=tracer,TimeCache=srcExports,PeerId=srcExports$1,Envelope=envelope;class Gossipsub extends pubsub_1.default{constructor(tt,rt={}){const nt=[constants.GossipsubIDv11,constants.GossipsubIDv10],it=Object.assign(Object.assign({gossipIncoming:!0,fallbackToFloodsub:!0,floodPublish:!0,doPX:!1,directPeers:[],D:constants.GossipsubD,Dlo:constants.GossipsubDlo,Dhi:constants.GossipsubDhi,Dscore:constants.GossipsubDscore,Dout:constants.GossipsubDout,Dlazy:constants.GossipsubDlazy,heartbeatInterval:constants.GossipsubHeartbeatInterval,fanoutTTL:constants.GossipsubFanoutTTL,mcacheLength:constants.GossipsubHistoryLength,mcacheGossip:constants.GossipsubHistoryGossip,seenTTL:constants.GossipsubSeenTTL},rt),{scoreParams:score_1.createPeerScoreParams(rt.scoreParams),scoreThresholds:score_1.createPeerScoreThresholds(rt.scoreThresholds)});it.fallbackToFloodsub&&nt.push(constants.FloodsubID),super(Object.assign({debugName:"libp2p:gossipsub",multicodecs:nt,libp2p:tt},it)),this._options=it,this.direct=new Set(it.directPeers.map(ot=>ot.id.toB58String())),it.directPeers.forEach(ot=>{tt.peerStore.addressBook.add(ot.id,ot.addrs)}),this.seenCache=new TimeCache({validity:it.seenTTL/1e3}),this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.messageCache=rt.messageCache||new message_cache_1.MessageCache(it.mcacheGossip,it.mcacheLength,this.getMsgId.bind(this)),this.heartbeat=new heartbeat_1.Heartbeat(this),this.heartbeatTicks=0,this.gossipTracer=new tracer_1.IWantTracer(this.getMsgId.bind(this)),this._libp2p=tt,this.score=new score_1.PeerScore(this._options.scoreParams,tt.connectionManager,this.getMsgId.bind(this))}_decodeRpc(tt){return rpc_1.RPC.decode(tt)}_encodeRpc(tt){return rpc_1.RPC.encode(tt).finish()}_addPeer(tt,rt){const nt=super._addPeer(tt,rt);this.score.addPeer(tt.toB58String());let it=!1;for(const ot of this._libp2p.connectionManager.getAll(tt))if(ot.stat.direction==="outbound"&&Array.from(ot.registry.values()).some(st=>rt===st.protocol)){it=!0;break}return this.outbound.set(nt.id.toB58String(),it),nt}_removePeer(tt){const rt=super._removePeer(tt),nt=tt.toB58String();for(const it of this.mesh.values())it.delete(nt);for(const it of this.fanout.values())it.delete(nt);return this.gossip.delete(nt),this.control.delete(nt),this.outbound.delete(nt),this.score.removePeer(nt),rt}_processRpc(tt,rt,nt){const it=Object.create(null,{_processRpc:{get:()=>super._processRpc}});return __awaiter(this,void 0,void 0,function*(){return(yield it._processRpc.call(this,tt,rt,nt))?(nt.control&&this._processRpcControlMessage(tt,nt.control),!0):!1})}_processRpcControlMessage(tt,rt){if(!rt)return;const nt=rt.ihave?this._handleIHave(tt,rt.ihave):[],it=rt.iwant?this._handleIWant(tt,rt.iwant):[],ot=rt.graft?this._handleGraft(tt,rt.graft):[];if(rt.prune&&this._handlePrune(tt,rt.prune),!nt.length&&!it.length&&!ot.length)return;const st=utils_1.createGossipRpc(it,{iwant:nt,prune:ot});this._sendRpc(tt,st)}_processRpcMessage(tt){const rt=Object.create(null,{_processRpcMessage:{get:()=>super._processRpcMessage}});return __awaiter(this,void 0,void 0,function*(){const nt=yield this.getMsgId(tt),it=utils_1.messageIdToString(nt);if(this.seenCache.has(it)){this.score.duplicateMessage(tt);return}this.seenCache.put(it),yield this.score.validateMessage(tt),yield rt._processRpcMessage.call(this,tt)})}_acceptFrom(tt){return this.direct.has(tt)||this.score.score(tt)>=this._options.scoreThresholds.graylistThreshold}validate(tt){const rt=Object.create(null,{validate:{get:()=>super.validate}});return __awaiter(this,void 0,void 0,function*(){try{yield rt.validate.call(this,tt)}catch(nt){throw this.score.rejectMessage(tt,nt.code),this.gossipTracer.rejectMessage(tt,nt.code),nt}})}_handleIHave(tt,rt){if(!rt.length)return[];const nt=this.score.score(tt);if(nt<this._options.scoreThresholds.gossipThreshold)return this.log("IHAVE: ignoring peer %s with score below threshold [ score = %d ]",tt,nt),[];const it=(this.peerhave.get(tt)||0)+1;if(this.peerhave.set(tt,it),it>constants.GossipsubMaxIHaveMessages)return this.log("IHAVE: peer %s has advertised too many times (%d) within this heartbeat interval; ignoring",tt,it),[];const ot=this.iasked.get(tt)||0;if(ot>=constants.GossipsubMaxIHaveLength)return this.log("IHAVE: peer %s has already advertised too many messages (%d); ignoring",tt,ot),[];const st=new Map;if(rt.forEach(({topicID:ut,messageIDs:lt})=>{!ut||!lt||!this.mesh.has(ut)||lt.forEach(ht=>{const ft=utils_1.messageIdToString(ht);this.seenCache.has(ft)||st.set(ft,ht)})}),!st.size)return[];let at=st.size;at+ot>constants.GossipsubMaxIHaveLength&&(at=constants.GossipsubMaxIHaveLength-ot),this.log("IHAVE: Asking for %d out of %d messages from %s",at,st.size,tt);let ct=Array.from(st.values());return utils_1.shuffle(ct),ct=ct.slice(0,at),this.iasked.set(tt,ot+at),this.gossipTracer.addPromise(tt,ct),[{messageIDs:ct}]}_handleIWant(tt,rt){if(!rt.length)return[];const nt=this.score.score(tt);if(nt<this._options.scoreThresholds.gossipThreshold)return this.log("IWANT: ignoring peer %s with score below threshold [score = %d]",tt,nt),[];const it=new Map;return rt.forEach(({messageIDs:ot})=>{ot&&ot.forEach(st=>{const[at,ct]=this.messageCache.getForPeer(st,tt);if(at){if(ct>constants.GossipsubGossipRetransmission){this.log("IWANT: Peer %s has asked for message %s too many times: ignoring request",tt,st);return}it.set(utils_1.messageIdToString(st),at)}})}),it.size?(this.log("IWANT: Sending %d messages to %s",it.size,tt),Array.from(it.values()).map(pubsub_1.utils.normalizeOutRpcMessage)):[]}_handleGraft(tt,rt){const nt=[],it=this.score.score(tt),ot=this._now();let st=this._options.doPX;return rt.forEach(({topicID:at})=>{var ct;if(!at)return;const ut=this.mesh.get(at);if(!ut){st=!1;return}if(ut.has(tt))return;if(this.direct.has(tt)){this.log("GRAFT: ignoring request from direct peer %s",tt),nt.push(at),st=!1;return}const lt=(ct=this.backoff.get(at))===null||ct===void 0?void 0:ct.get(tt);if(typeof lt=="number"&&ot<lt){this.log("GRAFT: ignoring backed off peer %s",tt),this.score.addPenalty(tt,1),st=!1;const ht=lt+constants.GossipsubGraftFloodThreshold-constants.GossipsubPruneBackoff;ot<ht&&this.score.addPenalty(tt,1),this._addBackoff(tt,at),nt.push(at);return}if(it<0){this.log("GRAFT: ignoring peer %s with negative score: score=%d, topic=%s",tt,it,at),nt.push(at),st=!1,this._addBackoff(tt,at);return}if(ut.size>=this._options.Dhi&&!this.outbound.get(tt)){nt.push(at),this._addBackoff(tt,at);return}this.log("GRAFT: Add mesh link from %s in %s",tt,at),this.score.graft(tt,at),ut.add(tt)}),nt.length?nt.map(at=>this._makePrune(tt,at,st)):[]}_handlePrune(tt,rt){const nt=this.score.score(tt);rt.forEach(({topicID:it,backoff:ot,peers:st})=>{if(!it)return;const at=this.mesh.get(it);if(at&&(this.log("PRUNE: Remove mesh link to %s in %s",tt,it),this.score.prune(tt,it),at.delete(tt),typeof ot=="number"&&ot>0?this._doAddBackoff(tt,it,ot*1e3):this._addBackoff(tt,it),st&&st.length)){if(nt<this._options.scoreThresholds.acceptPXThreshold){this.log("PRUNE: ignoring PX from peer %s with insufficient score [score = %d, topic = %s]",tt,nt,it);return}this._pxConnect(st)}})}_addBackoff(tt,rt){this._doAddBackoff(tt,rt,constants.GossipsubPruneBackoff)}_doAddBackoff(tt,rt,nt){let it=this.backoff.get(rt);it||(it=new Map,this.backoff.set(rt,it));const ot=this._now()+nt;(it.get(tt)||0)<ot&&it.set(tt,ot)}_applyIwantPenalties(){this.gossipTracer.getBrokenPromises().forEach((tt,rt)=>{this.log("peer %s didn't follow up in %d IWANT requests; adding penalty",rt,tt),this.score.addPenalty(rt,tt)})}_clearBackoff(){if(this.heartbeatTicks%constants.GossipsubPruneBackoffTicks!==0)return;const tt=this._now();this.backoff.forEach((rt,nt)=>{rt.forEach((it,ot)=>{it<tt&&rt.delete(ot)}),rt.size===0&&this.backoff.delete(nt)})}_directConnect(){if(this.heartbeatTicks%constants.GossipsubDirectConnectTicks!==0)return;const tt=[];this.direct.forEach(rt=>{const nt=this.peers.get(rt);(!nt||!nt.isWritable)&&tt.push(rt)}),tt.length&&tt.forEach(rt=>{this._connect(rt)})}_pxConnect(tt){return __awaiter(this,void 0,void 0,function*(){tt.length>constants.GossipsubPrunePeers&&(utils_1.shuffle(tt),tt=tt.slice(0,constants.GossipsubPrunePeers));const rt=[];yield Promise.all(tt.map(nt=>__awaiter(this,void 0,void 0,function*(){if(!nt.peerID)return;const it=PeerId.createFromBytes(nt.peerID).toB58String();if(!this.peers.has(it)){if(!nt.signedPeerRecord){rt.push(it);return}try{const ot=yield Envelope.openAndCertify(nt.signedPeerRecord,"libp2p-peer-record"),st=ot.peerId.toB58String();if(it!==st){this.log("bogus peer record obtained through px: peer ID %s doesn't match expected peer %s",st,it);return}if(!this._libp2p.peerStore.addressBook.consumePeerRecord(ot)){this.log("bogus peer record obtained through px: could not add peer record to address book");return}rt.push(it)}catch{this.log("bogus peer record obtained through px: invalid signature or not a peer record")}}}))),rt.length&&rt.forEach(nt=>this._connect(nt))})}start(){super.start(),this.heartbeat.start(),this.score.start(),this._directPeerInitial=setTimeout(()=>{this.direct.forEach(tt=>{this._connect(tt)})},constants.GossipsubDirectConnectInitialDelay)}stop(){super.stop(),this.heartbeat.stop(),this.score.stop(),this.mesh=new Map,this.fanout=new Map,this.lastpub=new Map,this.gossip=new Map,this.control=new Map,this.peerhave=new Map,this.iasked=new Map,this.backoff=new Map,this.outbound=new Map,this.gossipTracer.clear(),clearTimeout(this._directPeerInitial)}_connect(tt){this.log("Initiating connection with %s",tt),this._libp2p.dialProtocol(PeerId.createFromB58String(tt),this.multicodecs)}subscribe(tt){super.subscribe(tt),this.join(tt)}unsubscribe(tt){super.unsubscribe(tt),this.leave(tt)}join(tt){if(!this.started)throw new Error("Gossipsub has not started");this.log("JOIN %s",tt);const rt=this.fanout.get(tt);if(rt)rt.forEach(nt=>{this.score.score(nt)<0&&rt.delete(nt)}),rt.size<this._options.D&&get_gossip_peers_1.getGossipPeers(this,tt,this._options.D-rt.size,nt=>!rt.has(nt)&&!this.direct.has(nt)&&this.score.score(nt)>=0).forEach(nt=>rt.add(nt)),this.mesh.set(tt,rt),this.fanout.delete(tt),this.lastpub.delete(tt);else{const nt=get_gossip_peers_1.getGossipPeers(this,tt,this._options.D,it=>!this.direct.has(it)&&this.score.score(it)>=0);this.mesh.set(tt,nt)}this.mesh.get(tt).forEach(nt=>{this.log("JOIN: Add mesh link to %s in %s",nt,tt),this._sendGraft(nt,tt)})}leave(tt){if(!this.started)throw new Error("Gossipsub has not started");this.log("LEAVE %s",tt);const rt=this.mesh.get(tt);rt&&(rt.forEach(nt=>{this.log("LEAVE: Remove mesh link to %s in %s",nt,tt),this._sendPrune(nt,tt)}),this.mesh.delete(tt))}_publish(tt){return __awaiter(this,void 0,void 0,function*(){tt.receivedFrom!==this.peerId.toB58String()&&(this.score.deliverMessage(tt),this.gossipTracer.deliverMessage(tt));const rt=yield this.getMsgId(tt),nt=utils_1.messageIdToString(rt);this.seenCache.put(nt),this.messageCache.put(tt);const it=new Set;tt.topicIDs.forEach(st=>{const at=this.topics.get(st);if(at)if(this._options.floodPublish&&tt.receivedFrom===this.peerId.toB58String())at.forEach(ct=>{(this.direct.has(ct)||this.score.score(ct)>=this._options.scoreThresholds.publishThreshold)&&it.add(ct)});else{this.direct.forEach(ut=>{it.add(ut)}),at.forEach(ut=>{const lt=this.score.score(ut),ht=this.peers.get(ut);ht&&ht.protocol===constants.FloodsubID&&lt>=this._options.scoreThresholds.publishThreshold&&it.add(ut)});let ct=this.mesh.get(st);if(!ct||!ct.size){if(ct=this.fanout.get(st),!ct){const ut=get_gossip_peers_1.getGossipPeers(this,st,this._options.D,lt=>this.score.score(lt)>=this._options.scoreThresholds.publishThreshold);ut.size>0?(ct=ut,this.fanout.set(st,ut)):ct=new Set}this.lastpub.set(st,this._now())}ct.forEach(ut=>{it.add(ut)})}});const ot=utils_1.createGossipRpc([pubsub_1.utils.normalizeOutRpcMessage(tt)]);it.forEach(st=>{st===tt.receivedFrom||st===tt.from||this._sendRpc(st,ot)})})}_sendGraft(tt,rt){const nt=[{topicID:rt}],it=utils_1.createGossipRpc([],{graft:nt});this._sendRpc(tt,it)}_sendPrune(tt,rt){const nt=[this._makePrune(tt,rt,this._options.doPX)],it=utils_1.createGossipRpc([],{prune:nt});this._sendRpc(tt,it)}_sendRpc(tt,rt){const nt=this.peers.get(tt);if(!nt||!nt.isWritable)return;const it=this.control.get(tt);it&&(this._piggybackControl(tt,rt,it),this.control.delete(tt));const ot=this.gossip.get(tt);ot&&(this._piggybackGossip(tt,rt,ot),this.gossip.delete(tt)),nt.write(rpc_1.RPC.encode(rt).finish())}_piggybackControl(tt,rt,nt){const it=(nt.graft||[]).filter(({topicID:st})=>(st&&this.mesh.get(st)||new Set).has(tt)),ot=(nt.prune||[]).filter(({topicID:st})=>!(st&&this.mesh.get(st)||new Set).has(tt));!it.length&&!ot.length||(rt.control?(rt.control.graft=rt.control.graft&&rt.control.graft.concat(it),rt.control.prune=rt.control.prune&&rt.control.prune.concat(ot)):rt.control={ihave:[],iwant:[],graft:it,prune:ot})}_piggybackGossip(tt,rt,nt){rt.control||(rt.control={ihave:[],iwant:[],graft:[],prune:[]}),rt.control.ihave=nt}_sendGraftPrune(tt,rt,nt){const it=this._options.doPX;for(const[ot,st]of tt){const at=st.map(ht=>({topicID:ht}));let ct=[];const ut=rt.get(ot);ut&&(ct=ut.map(ht=>this._makePrune(ot,ht,it&&!nt.get(ot))),rt.delete(ot));const lt=utils_1.createGossipRpc([],{graft:at,prune:ct});this._sendRpc(ot,lt)}for(const[ot,st]of rt){const at=st.map(ut=>this._makePrune(ot,ut,it&&!nt.get(ot))),ct=utils_1.createGossipRpc([],{prune:at});this._sendRpc(ot,ct)}}_emitGossip(tt,rt){const nt=this.messageCache.getGossipIDs(tt);if(!nt.length)return;utils_1.shuffle(nt),nt.length>constants.GossipsubMaxIHaveLength&&this.log("too many messages for gossip; will truncate IHAVE list (%d messages)",nt.length);const it=[],ot=this.topics.get(tt);if(!ot)return;ot.forEach(ct=>{const ut=this.peers.get(ct);ut&&!rt.has(ct)&&!this.direct.has(ct)&&utils_1.hasGossipProtocol(ut.protocol)&&this.score.score(ct)>=this._options.scoreThresholds.gossipThreshold&&it.push(ct)});let st=this._options.Dlazy;const at=constants.GossipsubGossipFactor*it.length;at>st&&(st=at),st>it.length?st=it.length:utils_1.shuffle(it),it.slice(0,st).forEach(ct=>{let ut=nt;nt.length>constants.GossipsubMaxIHaveLength&&(ut=utils_1.shuffle(ut.slice()).slice(0,constants.GossipsubMaxIHaveLength)),this._pushGossip(ct,{topicID:tt,messageIDs:ut})})}_flush(){for(const[tt,rt]of this.gossip.entries()){this.gossip.delete(tt);const nt=utils_1.createGossipRpc([],{ihave:rt});this._sendRpc(tt,nt)}for(const[tt,rt]of this.control.entries()){this.control.delete(tt);const nt=utils_1.createGossipRpc([],{graft:rt.graft,prune:rt.prune});this._sendRpc(tt,nt)}}_pushGossip(tt,rt){this.log("Add gossip to %s",tt);const nt=this.gossip.get(tt)||[];this.gossip.set(tt,nt.concat(rt))}_now(){return Date.now()}_makePrune(tt,rt,nt){if(this.peers.get(tt).protocol===constants.GossipsubIDv10)return{topicID:rt,peers:[]};const it=constants.GossipsubPruneBackoff/1e3,ot=[];return nt&&get_gossip_peers_1.getGossipPeers(this,rt,constants.GossipsubPrunePeers,st=>st!==tt&&this.score.score(st)>=0).forEach(st=>{const at=PeerId.createFromB58String(st);ot.push({peerID:at.toBytes(),signedPeerRecord:this._libp2p.peerStore.addressBook.getRawEnvelope(at)})}),{topicID:rt,peers:ot,backoff:it}}}Gossipsub.multicodec=constants.GossipsubIDv11;const debug$1=browserExports,log$1=debug$1("libp2p-delegated-peer-routing");log$1.error=debug$1("libp2p-delegated-peer-routing:error");var src$1={exports:{}},$protobuf$2=minimal,$Reader$2=$protobuf$2.Reader,$Writer$2=$protobuf$2.Writer,$util$2=$protobuf$2.util,$root$2=$protobuf$2.roots["libp2p-crypto-keys"]||($protobuf$2.roots["libp2p-crypto-keys"]={});$root$2.KeyType=function(){var et={},tt=Object.create(et);return tt[et[0]="RSA"]=0,tt[et[1]="Ed25519"]=1,tt[et[2]="Secp256k1"]=2,tt}(),$root$2.PublicKey=function(){function et(tt){if(tt)for(var rt=Object.keys(tt),nt=0;nt<rt.length;++nt)tt[rt[nt]]!=null&&(this[rt[nt]]=tt[rt[nt]])}return et.prototype.Type=0,et.prototype.Data=$util$2.newBuffer([]),et.encode=function(tt,rt){return rt||(rt=$Writer$2.create()),rt.uint32(8).int32(tt.Type),rt.uint32(18).bytes(tt.Data),rt},et.decode=function(tt,rt){tt instanceof $Reader$2||(tt=$Reader$2.create(tt));for(var nt=rt===void 0?tt.len:tt.pos+rt,it=new $root$2.PublicKey;tt.pos<nt;){var ot=tt.uint32();switch(ot>>>3){case 1:it.Type=tt.int32();break;case 2:it.Data=tt.bytes();break;default:tt.skipType(ot&7);break}}if(!it.hasOwnProperty("Type"))throw $util$2.ProtocolError("missing required 'Type'",{instance:it});if(!it.hasOwnProperty("Data"))throw $util$2.ProtocolError("missing required 'Data'",{instance:it});return it},et.fromObject=function(tt){if(tt instanceof $root$2.PublicKey)return tt;var rt=new $root$2.PublicKey;switch(tt.Type){case"RSA":case 0:rt.Type=0;break;case"Ed25519":case 1:rt.Type=1;break;case"Secp256k1":case 2:rt.Type=2;break}return tt.Data!=null&&(typeof tt.Data=="string"?$util$2.base64.decode(tt.Data,rt.Data=$util$2.newBuffer($util$2.base64.length(tt.Data)),0):tt.Data.length&&(rt.Data=tt.Data)),rt},et.toObject=function(tt,rt){rt||(rt={});var nt={};return rt.defaults&&(nt.Type=rt.enums===String?"RSA":0,rt.bytes===String?nt.Data="":(nt.Data=[],rt.bytes!==Array&&(nt.Data=$util$2.newBuffer(nt.Data)))),tt.Type!=null&&tt.hasOwnProperty("Type")&&(nt.Type=rt.enums===String?$root$2.KeyType[tt.Type]:tt.Type),tt.Data!=null&&tt.hasOwnProperty("Data")&&(nt.Data=rt.bytes===String?$util$2.base64.encode(tt.Data,0,tt.Data.length):rt.bytes===Array?Array.prototype.slice.call(tt.Data):tt.Data),nt},et.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf$2.util.toJSONOptions)},et}(),$root$2.PrivateKey=function(){function et(tt){if(tt)for(var rt=Object.keys(tt),nt=0;nt<rt.length;++nt)tt[rt[nt]]!=null&&(this[rt[nt]]=tt[rt[nt]])}return et.prototype.Type=0,et.prototype.Data=$util$2.newBuffer([]),et.encode=function(tt,rt){return rt||(rt=$Writer$2.create()),rt.uint32(8).int32(tt.Type),rt.uint32(18).bytes(tt.Data),rt},et.decode=function(tt,rt){tt instanceof $Reader$2||(tt=$Reader$2.create(tt));for(var nt=rt===void 0?tt.len:tt.pos+rt,it=new $root$2.PrivateKey;tt.pos<nt;){var ot=tt.uint32();switch(ot>>>3){case 1:it.Type=tt.int32();break;case 2:it.Data=tt.bytes();break;default:tt.skipType(ot&7);break}}if(!it.hasOwnProperty("Type"))throw $util$2.ProtocolError("missing required 'Type'",{instance:it});if(!it.hasOwnProperty("Data"))throw $util$2.ProtocolError("missing required 'Data'",{instance:it});return it},et.fromObject=function(tt){if(tt instanceof $root$2.PrivateKey)return tt;var rt=new $root$2.PrivateKey;switch(tt.Type){case"RSA":case 0:rt.Type=0;break;case"Ed25519":case 1:rt.Type=1;break;case"Secp256k1":case 2:rt.Type=2;break}return tt.Data!=null&&(typeof tt.Data=="string"?$util$2.base64.decode(tt.Data,rt.Data=$util$2.newBuffer($util$2.base64.length(tt.Data)),0):tt.Data.length&&(rt.Data=tt.Data)),rt},et.toObject=function(tt,rt){rt||(rt={});var nt={};return rt.defaults&&(nt.Type=rt.enums===String?"RSA":0,rt.bytes===String?nt.Data="":(nt.Data=[],rt.bytes!==Array&&(nt.Data=$util$2.newBuffer(nt.Data)))),tt.Type!=null&&tt.hasOwnProperty("Type")&&(nt.Type=rt.enums===String?$root$2.KeyType[tt.Type]:tt.Type),tt.Data!=null&&tt.hasOwnProperty("Data")&&(nt.Data=rt.bytes===String?$util$2.base64.encode(tt.Data,0,tt.Data.length):rt.bytes===Array?Array.prototype.slice.call(tt.Data):tt.Data),nt},et.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf$2.util.toJSONOptions)},et}();var keys$1=$root$2,forge$p={options:{usePureJavaScript:!1}},api={},baseN$1=api,_reverseAlphabets={};api.encode=function(et,tt,rt){if(typeof tt!="string")throw new TypeError('"alphabet" must be a string.');if(rt!==void 0&&typeof rt!="number")throw new TypeError('"maxline" must be a number.');var nt="";if(!(et instanceof Uint8Array))nt=_encodeWithByteBuffer(et,tt);else{var it=0,ot=tt.length,st=tt.charAt(0),at=[0];for(it=0;it<et.length;++it){for(var ct=0,ut=et[it];ct<at.length;++ct)ut+=at[ct]<<8,at[ct]=ut%ot,ut=ut/ot|0;for(;ut>0;)at.push(ut%ot),ut=ut/ot|0}for(it=0;et[it]===0&&it<et.length-1;++it)nt+=st;for(it=at.length-1;it>=0;--it)nt+=tt[at[it]]}if(rt){var lt=new RegExp(".{1,"+rt+"}","g");nt=nt.match(lt).join(`\r
`)}return nt},api.decode=function(et,tt){if(typeof et!="string")throw new TypeError('"input" must be a string.');if(typeof tt!="string")throw new TypeError('"alphabet" must be a string.');var rt=_reverseAlphabets[tt];if(!rt){rt=_reverseAlphabets[tt]=[];for(var nt=0;nt<tt.length;++nt)rt[tt.charCodeAt(nt)]=nt}et=et.replace(/\s/g,"");for(var it=tt.length,ot=tt.charAt(0),st=[0],nt=0;nt<et.length;nt++){var at=rt[et.charCodeAt(nt)];if(at===void 0)return;for(var ct=0,ut=at;ct<st.length;++ct)ut+=st[ct]*it,st[ct]=ut&255,ut>>=8;for(;ut>0;)st.push(ut&255),ut>>=8}for(var lt=0;et[lt]===ot&&lt<et.length-1;++lt)st.push(0);return typeof Buffer<"u"?Buffer.from(st.reverse()):new Uint8Array(st.reverse())};function _encodeWithByteBuffer(et,tt){var rt=0,nt=tt.length,it=tt.charAt(0),ot=[0];for(rt=0;rt<et.length();++rt){for(var st=0,at=et.at(rt);st<ot.length;++st)at+=ot[st]<<8,ot[st]=at%nt,at=at/nt|0;for(;at>0;)ot.push(at%nt),at=at/nt|0}var ct="";for(rt=0;et.at(rt)===0&&rt<et.length()-1;++rt)ct+=it;for(rt=ot.length-1;rt>=0;--rt)ct+=tt[ot[rt]];return ct}var forge$o=forge$p,baseN=baseN$1,util$2=forge$o.util=forge$o.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){util$2.nextTick=process.nextTick,typeof setImmediate=="function"?util$2.setImmediate=setImmediate:util$2.setImmediate=util$2.nextTick;return}if(typeof setImmediate=="function"){util$2.setImmediate=function(){return setImmediate.apply(void 0,arguments)},util$2.nextTick=function(st){return setImmediate(st)};return}if(util$2.setImmediate=function(st){setTimeout(st,0)},typeof window<"u"&&typeof window.postMessage=="function"){let st=function(at){if(at.source===window&&at.data===et){at.stopPropagation();var ct=tt.slice();tt.length=0,ct.forEach(function(ut){ut()})}};var et="forge.setImmediate",tt=[];util$2.setImmediate=function(at){tt.push(at),tt.length===1&&window.postMessage(et,"*")},window.addEventListener("message",st,!0)}if(typeof MutationObserver<"u"){var rt=Date.now(),nt=!0,it=document.createElement("div"),tt=[];new MutationObserver(function(){var at=tt.slice();tt.length=0,at.forEach(function(ct){ct()})}).observe(it,{attributes:!0});var ot=util$2.setImmediate;util$2.setImmediate=function(at){Date.now()-rt>15?(rt=Date.now(),ot(at)):(tt.push(at),tt.length===1&&it.setAttribute("a",nt=!nt))}}util$2.nextTick=util$2.setImmediate})(),util$2.isNodejs=typeof process<"u"&&process.versions&&process.versions.node,util$2.globalScope=function(){return util$2.isNodejs||typeof self>"u"?window:self}(),util$2.isArray=Array.isArray||function(et){return Object.prototype.toString.call(et)==="[object Array]"},util$2.isArrayBuffer=function(et){return typeof ArrayBuffer<"u"&&et instanceof ArrayBuffer},util$2.isArrayBufferView=function(et){return et&&util$2.isArrayBuffer(et.buffer)&&et.byteLength!==void 0};function _checkBitsParam(et){if(!(et===8||et===16||et===24||et===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+et)}util$2.ByteBuffer=ByteStringBuffer;function ByteStringBuffer(et){if(this.data="",this.read=0,typeof et=="string")this.data=et;else if(util$2.isArrayBuffer(et)||util$2.isArrayBufferView(et))if(typeof Buffer<"u"&&et instanceof Buffer)this.data=et.toString("binary");else{var tt=new Uint8Array(et);try{this.data=String.fromCharCode.apply(null,tt)}catch{for(var rt=0;rt<tt.length;++rt)this.putByte(tt[rt])}}else(et instanceof ByteStringBuffer||typeof et=="object"&&typeof et.data=="string"&&typeof et.read=="number")&&(this.data=et.data,this.read=et.read);this._constructedStringLength=0}util$2.ByteStringBuffer=ByteStringBuffer;var _MAX_CONSTRUCTED_STRING_LENGTH=4096;util$2.ByteStringBuffer.prototype._optimizeConstructedString=function(et){this._constructedStringLength+=et,this._constructedStringLength>_MAX_CONSTRUCTED_STRING_LENGTH&&(this.data.substr(0,1),this._constructedStringLength=0)},util$2.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},util$2.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},util$2.ByteStringBuffer.prototype.putByte=function(et){return this.putBytes(String.fromCharCode(et))},util$2.ByteStringBuffer.prototype.fillWithByte=function(et,tt){et=String.fromCharCode(et);for(var rt=this.data;tt>0;)tt&1&&(rt+=et),tt>>>=1,tt>0&&(et+=et);return this.data=rt,this._optimizeConstructedString(tt),this},util$2.ByteStringBuffer.prototype.putBytes=function(et){return this.data+=et,this._optimizeConstructedString(et.length),this},util$2.ByteStringBuffer.prototype.putString=function(et){return this.putBytes(util$2.encodeUtf8(et))},util$2.ByteStringBuffer.prototype.putInt16=function(et){return this.putBytes(String.fromCharCode(et>>8&255)+String.fromCharCode(et&255))},util$2.ByteStringBuffer.prototype.putInt24=function(et){return this.putBytes(String.fromCharCode(et>>16&255)+String.fromCharCode(et>>8&255)+String.fromCharCode(et&255))},util$2.ByteStringBuffer.prototype.putInt32=function(et){return this.putBytes(String.fromCharCode(et>>24&255)+String.fromCharCode(et>>16&255)+String.fromCharCode(et>>8&255)+String.fromCharCode(et&255))},util$2.ByteStringBuffer.prototype.putInt16Le=function(et){return this.putBytes(String.fromCharCode(et&255)+String.fromCharCode(et>>8&255))},util$2.ByteStringBuffer.prototype.putInt24Le=function(et){return this.putBytes(String.fromCharCode(et&255)+String.fromCharCode(et>>8&255)+String.fromCharCode(et>>16&255))},util$2.ByteStringBuffer.prototype.putInt32Le=function(et){return this.putBytes(String.fromCharCode(et&255)+String.fromCharCode(et>>8&255)+String.fromCharCode(et>>16&255)+String.fromCharCode(et>>24&255))},util$2.ByteStringBuffer.prototype.putInt=function(et,tt){_checkBitsParam(tt);var rt="";do tt-=8,rt+=String.fromCharCode(et>>tt&255);while(tt>0);return this.putBytes(rt)},util$2.ByteStringBuffer.prototype.putSignedInt=function(et,tt){return et<0&&(et+=2<<tt-1),this.putInt(et,tt)},util$2.ByteStringBuffer.prototype.putBuffer=function(et){return this.putBytes(et.getBytes())},util$2.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},util$2.ByteStringBuffer.prototype.getInt16=function(){var et=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,et},util$2.ByteStringBuffer.prototype.getInt24=function(){var et=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,et},util$2.ByteStringBuffer.prototype.getInt32=function(){var et=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,et},util$2.ByteStringBuffer.prototype.getInt16Le=function(){var et=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,et},util$2.ByteStringBuffer.prototype.getInt24Le=function(){var et=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,et},util$2.ByteStringBuffer.prototype.getInt32Le=function(){var et=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,et},util$2.ByteStringBuffer.prototype.getInt=function(et){_checkBitsParam(et);var tt=0;do tt=(tt<<8)+this.data.charCodeAt(this.read++),et-=8;while(et>0);return tt},util$2.ByteStringBuffer.prototype.getSignedInt=function(et){var tt=this.getInt(et),rt=2<<et-2;return tt>=rt&&(tt-=rt<<1),tt},util$2.ByteStringBuffer.prototype.getBytes=function(et){var tt;return et?(et=Math.min(this.length(),et),tt=this.data.slice(this.read,this.read+et),this.read+=et):et===0?tt="":(tt=this.read===0?this.data:this.data.slice(this.read),this.clear()),tt},util$2.ByteStringBuffer.prototype.bytes=function(et){return typeof et>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+et)},util$2.ByteStringBuffer.prototype.at=function(et){return this.data.charCodeAt(this.read+et)},util$2.ByteStringBuffer.prototype.setAt=function(et,tt){return this.data=this.data.substr(0,this.read+et)+String.fromCharCode(tt)+this.data.substr(this.read+et+1),this},util$2.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},util$2.ByteStringBuffer.prototype.copy=function(){var et=util$2.createBuffer(this.data);return et.read=this.read,et},util$2.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},util$2.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},util$2.ByteStringBuffer.prototype.truncate=function(et){var tt=Math.max(0,this.length()-et);return this.data=this.data.substr(this.read,tt),this.read=0,this},util$2.ByteStringBuffer.prototype.toHex=function(){for(var et="",tt=this.read;tt<this.data.length;++tt){var rt=this.data.charCodeAt(tt);rt<16&&(et+="0"),et+=rt.toString(16)}return et},util$2.ByteStringBuffer.prototype.toString=function(){return util$2.decodeUtf8(this.bytes())};function DataBuffer(et,tt){tt=tt||{},this.read=tt.readOffset||0,this.growSize=tt.growSize||1024;var rt=util$2.isArrayBuffer(et),nt=util$2.isArrayBufferView(et);if(rt||nt){rt?this.data=new DataView(et):this.data=new DataView(et.buffer,et.byteOffset,et.byteLength),this.write="writeOffset"in tt?tt.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,et!=null&&this.putBytes(et),"writeOffset"in tt&&(this.write=tt.writeOffset)}util$2.DataBuffer=DataBuffer,util$2.DataBuffer.prototype.length=function(){return this.write-this.read},util$2.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},util$2.DataBuffer.prototype.accommodate=function(et,tt){if(this.length()>=et)return this;tt=Math.max(tt||this.growSize,et);var rt=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),nt=new Uint8Array(this.length()+tt);return nt.set(rt),this.data=new DataView(nt.buffer),this},util$2.DataBuffer.prototype.putByte=function(et){return this.accommodate(1),this.data.setUint8(this.write++,et),this},util$2.DataBuffer.prototype.fillWithByte=function(et,tt){this.accommodate(tt);for(var rt=0;rt<tt;++rt)this.data.setUint8(et);return this},util$2.DataBuffer.prototype.putBytes=function(et,tt){if(util$2.isArrayBufferView(et)){var rt=new Uint8Array(et.buffer,et.byteOffset,et.byteLength),nt=rt.byteLength-rt.byteOffset;this.accommodate(nt);var it=new Uint8Array(this.data.buffer,this.write);return it.set(rt),this.write+=nt,this}if(util$2.isArrayBuffer(et)){var rt=new Uint8Array(et);this.accommodate(rt.byteLength);var it=new Uint8Array(this.data.buffer);return it.set(rt,this.write),this.write+=rt.byteLength,this}if(et instanceof util$2.DataBuffer||typeof et=="object"&&typeof et.read=="number"&&typeof et.write=="number"&&util$2.isArrayBufferView(et.data)){var rt=new Uint8Array(et.data.byteLength,et.read,et.length());this.accommodate(rt.byteLength);var it=new Uint8Array(et.data.byteLength,this.write);return it.set(rt),this.write+=rt.byteLength,this}if(et instanceof util$2.ByteStringBuffer&&(et=et.data,tt="binary"),tt=tt||"binary",typeof et=="string"){var ot;if(tt==="hex")return this.accommodate(Math.ceil(et.length/2)),ot=new Uint8Array(this.data.buffer,this.write),this.write+=util$2.binary.hex.decode(et,ot,this.write),this;if(tt==="base64")return this.accommodate(Math.ceil(et.length/4)*3),ot=new Uint8Array(this.data.buffer,this.write),this.write+=util$2.binary.base64.decode(et,ot,this.write),this;if(tt==="utf8"&&(et=util$2.encodeUtf8(et),tt="binary"),tt==="binary"||tt==="raw")return this.accommodate(et.length),ot=new Uint8Array(this.data.buffer,this.write),this.write+=util$2.binary.raw.decode(ot),this;if(tt==="utf16")return this.accommodate(et.length*2),ot=new Uint16Array(this.data.buffer,this.write),this.write+=util$2.text.utf16.encode(ot),this;throw new Error("Invalid encoding: "+tt)}throw Error("Invalid parameter: "+et)},util$2.DataBuffer.prototype.putBuffer=function(et){return this.putBytes(et),et.clear(),this},util$2.DataBuffer.prototype.putString=function(et){return this.putBytes(et,"utf16")},util$2.DataBuffer.prototype.putInt16=function(et){return this.accommodate(2),this.data.setInt16(this.write,et),this.write+=2,this},util$2.DataBuffer.prototype.putInt24=function(et){return this.accommodate(3),this.data.setInt16(this.write,et>>8&65535),this.data.setInt8(this.write,et>>16&255),this.write+=3,this},util$2.DataBuffer.prototype.putInt32=function(et){return this.accommodate(4),this.data.setInt32(this.write,et),this.write+=4,this},util$2.DataBuffer.prototype.putInt16Le=function(et){return this.accommodate(2),this.data.setInt16(this.write,et,!0),this.write+=2,this},util$2.DataBuffer.prototype.putInt24Le=function(et){return this.accommodate(3),this.data.setInt8(this.write,et>>16&255),this.data.setInt16(this.write,et>>8&65535,!0),this.write+=3,this},util$2.DataBuffer.prototype.putInt32Le=function(et){return this.accommodate(4),this.data.setInt32(this.write,et,!0),this.write+=4,this},util$2.DataBuffer.prototype.putInt=function(et,tt){_checkBitsParam(tt),this.accommodate(tt/8);do tt-=8,this.data.setInt8(this.write++,et>>tt&255);while(tt>0);return this},util$2.DataBuffer.prototype.putSignedInt=function(et,tt){return _checkBitsParam(tt),this.accommodate(tt/8),et<0&&(et+=2<<tt-1),this.putInt(et,tt)},util$2.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},util$2.DataBuffer.prototype.getInt16=function(){var et=this.data.getInt16(this.read);return this.read+=2,et},util$2.DataBuffer.prototype.getInt24=function(){var et=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,et},util$2.DataBuffer.prototype.getInt32=function(){var et=this.data.getInt32(this.read);return this.read+=4,et},util$2.DataBuffer.prototype.getInt16Le=function(){var et=this.data.getInt16(this.read,!0);return this.read+=2,et},util$2.DataBuffer.prototype.getInt24Le=function(){var et=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,et},util$2.DataBuffer.prototype.getInt32Le=function(){var et=this.data.getInt32(this.read,!0);return this.read+=4,et},util$2.DataBuffer.prototype.getInt=function(et){_checkBitsParam(et);var tt=0;do tt=(tt<<8)+this.data.getInt8(this.read++),et-=8;while(et>0);return tt},util$2.DataBuffer.prototype.getSignedInt=function(et){var tt=this.getInt(et),rt=2<<et-2;return tt>=rt&&(tt-=rt<<1),tt},util$2.DataBuffer.prototype.getBytes=function(et){var tt;return et?(et=Math.min(this.length(),et),tt=this.data.slice(this.read,this.read+et),this.read+=et):et===0?tt="":(tt=this.read===0?this.data:this.data.slice(this.read),this.clear()),tt},util$2.DataBuffer.prototype.bytes=function(et){return typeof et>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+et)},util$2.DataBuffer.prototype.at=function(et){return this.data.getUint8(this.read+et)},util$2.DataBuffer.prototype.setAt=function(et,tt){return this.data.setUint8(et,tt),this},util$2.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},util$2.DataBuffer.prototype.copy=function(){return new util$2.DataBuffer(this)},util$2.DataBuffer.prototype.compact=function(){if(this.read>0){var et=new Uint8Array(this.data.buffer,this.read),tt=new Uint8Array(et.byteLength);tt.set(et),this.data=new DataView(tt),this.write-=this.read,this.read=0}return this},util$2.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},util$2.DataBuffer.prototype.truncate=function(et){return this.write=Math.max(0,this.length()-et),this.read=Math.min(this.read,this.write),this},util$2.DataBuffer.prototype.toHex=function(){for(var et="",tt=this.read;tt<this.data.byteLength;++tt){var rt=this.data.getUint8(tt);rt<16&&(et+="0"),et+=rt.toString(16)}return et},util$2.DataBuffer.prototype.toString=function(et){var tt=new Uint8Array(this.data,this.read,this.length());if(et=et||"utf8",et==="binary"||et==="raw")return util$2.binary.raw.encode(tt);if(et==="hex")return util$2.binary.hex.encode(tt);if(et==="base64")return util$2.binary.base64.encode(tt);if(et==="utf8")return util$2.text.utf8.decode(tt);if(et==="utf16")return util$2.text.utf16.decode(tt);throw new Error("Invalid encoding: "+et)},util$2.createBuffer=function(et,tt){return tt=tt||"raw",et!==void 0&&tt==="utf8"&&(et=util$2.encodeUtf8(et)),new util$2.ByteBuffer(et)},util$2.fillString=function(et,tt){for(var rt="";tt>0;)tt&1&&(rt+=et),tt>>>=1,tt>0&&(et+=et);return rt},util$2.xorBytes=function(et,tt,rt){for(var nt="",it="",ot="",st=0,at=0;rt>0;--rt,++st)it=et.charCodeAt(st)^tt.charCodeAt(st),at>=10&&(nt+=ot,ot="",at=0),ot+=String.fromCharCode(it),++at;return nt+=ot,nt},util$2.hexToBytes=function(et){var tt="",rt=0;for(et.length&!0&&(rt=1,tt+=String.fromCharCode(parseInt(et[0],16)));rt<et.length;rt+=2)tt+=String.fromCharCode(parseInt(et.substr(rt,2),16));return tt},util$2.bytesToHex=function(et){return util$2.createBuffer(et).toHex()},util$2.int32ToBytes=function(et){return String.fromCharCode(et>>24&255)+String.fromCharCode(et>>16&255)+String.fromCharCode(et>>8&255)+String.fromCharCode(et&255)};var _base64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_base64Idx=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],_base58="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";util$2.encode64=function(et,tt){for(var rt="",nt="",it,ot,st,at=0;at<et.length;)it=et.charCodeAt(at++),ot=et.charCodeAt(at++),st=et.charCodeAt(at++),rt+=_base64.charAt(it>>2),rt+=_base64.charAt((it&3)<<4|ot>>4),isNaN(ot)?rt+="==":(rt+=_base64.charAt((ot&15)<<2|st>>6),rt+=isNaN(st)?"=":_base64.charAt(st&63)),tt&&rt.length>tt&&(nt+=rt.substr(0,tt)+`\r
`,rt=rt.substr(tt));return nt+=rt,nt},util$2.decode64=function(et){et=et.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var tt="",rt,nt,it,ot,st=0;st<et.length;)rt=_base64Idx[et.charCodeAt(st++)-43],nt=_base64Idx[et.charCodeAt(st++)-43],it=_base64Idx[et.charCodeAt(st++)-43],ot=_base64Idx[et.charCodeAt(st++)-43],tt+=String.fromCharCode(rt<<2|nt>>4),it!==64&&(tt+=String.fromCharCode((nt&15)<<4|it>>2),ot!==64&&(tt+=String.fromCharCode((it&3)<<6|ot)));return tt},util$2.encodeUtf8=function(et){return unescape(encodeURIComponent(et))},util$2.decodeUtf8=function(et){return decodeURIComponent(escape(et))},util$2.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:baseN.encode,decode:baseN.decode}},util$2.binary.raw.encode=function(et){return String.fromCharCode.apply(null,et)},util$2.binary.raw.decode=function(et,tt,rt){var nt=tt;nt||(nt=new Uint8Array(et.length)),rt=rt||0;for(var it=rt,ot=0;ot<et.length;++ot)nt[it++]=et.charCodeAt(ot);return tt?it-rt:nt},util$2.binary.hex.encode=util$2.bytesToHex,util$2.binary.hex.decode=function(et,tt,rt){var nt=tt;nt||(nt=new Uint8Array(Math.ceil(et.length/2))),rt=rt||0;var it=0,ot=rt;for(et.length&1&&(it=1,nt[ot++]=parseInt(et[0],16));it<et.length;it+=2)nt[ot++]=parseInt(et.substr(it,2),16);return tt?ot-rt:nt},util$2.binary.base64.encode=function(et,tt){for(var rt="",nt="",it,ot,st,at=0;at<et.byteLength;)it=et[at++],ot=et[at++],st=et[at++],rt+=_base64.charAt(it>>2),rt+=_base64.charAt((it&3)<<4|ot>>4),isNaN(ot)?rt+="==":(rt+=_base64.charAt((ot&15)<<2|st>>6),rt+=isNaN(st)?"=":_base64.charAt(st&63)),tt&&rt.length>tt&&(nt+=rt.substr(0,tt)+`\r
`,rt=rt.substr(tt));return nt+=rt,nt},util$2.binary.base64.decode=function(et,tt,rt){var nt=tt;nt||(nt=new Uint8Array(Math.ceil(et.length/4)*3)),et=et.replace(/[^A-Za-z0-9\+\/\=]/g,""),rt=rt||0;for(var it,ot,st,at,ct=0,ut=rt;ct<et.length;)it=_base64Idx[et.charCodeAt(ct++)-43],ot=_base64Idx[et.charCodeAt(ct++)-43],st=_base64Idx[et.charCodeAt(ct++)-43],at=_base64Idx[et.charCodeAt(ct++)-43],nt[ut++]=it<<2|ot>>4,st!==64&&(nt[ut++]=(ot&15)<<4|st>>2,at!==64&&(nt[ut++]=(st&3)<<6|at));return tt?ut-rt:nt.subarray(0,ut)},util$2.binary.base58.encode=function(et,tt){return util$2.binary.baseN.encode(et,_base58,tt)},util$2.binary.base58.decode=function(et,tt){return util$2.binary.baseN.decode(et,_base58,tt)},util$2.text={utf8:{},utf16:{}},util$2.text.utf8.encode=function(et,tt,rt){et=util$2.encodeUtf8(et);var nt=tt;nt||(nt=new Uint8Array(et.length)),rt=rt||0;for(var it=rt,ot=0;ot<et.length;++ot)nt[it++]=et.charCodeAt(ot);return tt?it-rt:nt},util$2.text.utf8.decode=function(et){return util$2.decodeUtf8(String.fromCharCode.apply(null,et))},util$2.text.utf16.encode=function(et,tt,rt){var nt=tt;nt||(nt=new Uint8Array(et.length*2));var it=new Uint16Array(nt.buffer);rt=rt||0;for(var ot=rt,st=rt,at=0;at<et.length;++at)it[st++]=et.charCodeAt(at),ot+=2;return tt?ot-rt:nt},util$2.text.utf16.decode=function(et){return String.fromCharCode.apply(null,new Uint16Array(et.buffer))},util$2.deflate=function(et,tt,rt){if(tt=util$2.decode64(et.deflate(util$2.encode64(tt)).rval),rt){var nt=2,it=tt.charCodeAt(1);it&32&&(nt=6),tt=tt.substring(nt,tt.length-4)}return tt},util$2.inflate=function(et,tt,rt){var nt=et.inflate(util$2.encode64(tt)).rval;return nt===null?null:util$2.decode64(nt)};var _setStorageObject=function(et,tt,rt){if(!et)throw new Error("WebStorage not available.");var nt;if(rt===null?nt=et.removeItem(tt):(rt=util$2.encode64(JSON.stringify(rt)),nt=et.setItem(tt,rt)),typeof nt<"u"&&nt.rval!==!0){var it=new Error(nt.error.message);throw it.id=nt.error.id,it.name=nt.error.name,it}},_getStorageObject=function(et,tt){if(!et)throw new Error("WebStorage not available.");var rt=et.getItem(tt);if(et.init)if(rt.rval===null){if(rt.error){var nt=new Error(rt.error.message);throw nt.id=rt.error.id,nt.name=rt.error.name,nt}rt=null}else rt=rt.rval;return rt!==null&&(rt=JSON.parse(util$2.decode64(rt))),rt},_setItem=function(et,tt,rt,nt){var it=_getStorageObject(et,tt);it===null&&(it={}),it[rt]=nt,_setStorageObject(et,tt,it)},_getItem=function(et,tt,rt){var nt=_getStorageObject(et,tt);return nt!==null&&(nt=rt in nt?nt[rt]:null),nt},_removeItem=function(et,tt,rt){var nt=_getStorageObject(et,tt);if(nt!==null&&rt in nt){delete nt[rt];var it=!0;for(var ot in nt){it=!1;break}it&&(nt=null),_setStorageObject(et,tt,nt)}},_clearItems=function(et,tt){_setStorageObject(et,tt,null)},_callStorageFunction=function(et,tt,rt){var nt=null;typeof rt>"u"&&(rt=["web","flash"]);var it,ot=!1,st=null;for(var at in rt){it=rt[at];try{if(it==="flash"||it==="both"){if(tt[0]===null)throw new Error("Flash local storage not available.");nt=et.apply(this,tt),ot=it==="flash"}(it==="web"||it==="both")&&(tt[0]=localStorage,nt=et.apply(this,tt),ot=!0)}catch(ct){st=ct}if(ot)break}if(!ot)throw st;return nt};util$2.setItem=function(et,tt,rt,nt,it){_callStorageFunction(_setItem,arguments,it)},util$2.getItem=function(et,tt,rt,nt){return _callStorageFunction(_getItem,arguments,nt)},util$2.removeItem=function(et,tt,rt,nt){_callStorageFunction(_removeItem,arguments,nt)},util$2.clearItems=function(et,tt,rt){_callStorageFunction(_clearItems,arguments,rt)},util$2.isEmpty=function(et){for(var tt in et)if(et.hasOwnProperty(tt))return!1;return!0},util$2.format=function(et){for(var tt=/%./g,rt,nt,it=0,ot=[],st=0;rt=tt.exec(et);){nt=et.substring(st,tt.lastIndex-2),nt.length>0&&ot.push(nt),st=tt.lastIndex;var at=rt[0][1];switch(at){case"s":case"o":it<arguments.length?ot.push(arguments[it+++1]):ot.push("<?>");break;case"%":ot.push("%");break;default:ot.push("<%"+at+"?>")}}return ot.push(et.substring(st)),ot.join("")},util$2.formatNumber=function(et,tt,rt,nt){var it=et,ot=isNaN(tt=Math.abs(tt))?2:tt,st=rt===void 0?",":rt,at=nt===void 0?".":nt,ct=it<0?"-":"",ut=parseInt(it=Math.abs(+it||0).toFixed(ot),10)+"",lt=ut.length>3?ut.length%3:0;return ct+(lt?ut.substr(0,lt)+at:"")+ut.substr(lt).replace(/(\d{3})(?=\d)/g,"$1"+at)+(ot?st+Math.abs(it-ut).toFixed(ot).slice(2):"")},util$2.formatSize=function(et){return et>=1073741824?et=util$2.formatNumber(et/1073741824,2,".","")+" GiB":et>=1048576?et=util$2.formatNumber(et/1048576,2,".","")+" MiB":et>=1024?et=util$2.formatNumber(et/1024,0)+" KiB":et=util$2.formatNumber(et,0)+" bytes",et},util$2.bytesFromIP=function(et){return et.indexOf(".")!==-1?util$2.bytesFromIPv4(et):et.indexOf(":")!==-1?util$2.bytesFromIPv6(et):null},util$2.bytesFromIPv4=function(et){if(et=et.split("."),et.length!==4)return null;for(var tt=util$2.createBuffer(),rt=0;rt<et.length;++rt){var nt=parseInt(et[rt],10);if(isNaN(nt))return null;tt.putByte(nt)}return tt.getBytes()},util$2.bytesFromIPv6=function(et){var tt=0;et=et.split(":").filter(function(st){return st.length===0&&++tt,!0});for(var rt=(8-et.length+tt)*2,nt=util$2.createBuffer(),it=0;it<8;++it){if(!et[it]||et[it].length===0){nt.fillWithByte(0,rt),rt=0;continue}var ot=util$2.hexToBytes(et[it]);ot.length<2&&nt.putByte(0),nt.putBytes(ot)}return nt.getBytes()},util$2.bytesToIP=function(et){return et.length===4?util$2.bytesToIPv4(et):et.length===16?util$2.bytesToIPv6(et):null},util$2.bytesToIPv4=function(et){if(et.length!==4)return null;for(var tt=[],rt=0;rt<et.length;++rt)tt.push(et.charCodeAt(rt));return tt.join(".")},util$2.bytesToIPv6=function(et){if(et.length!==16)return null;for(var tt=[],rt=[],nt=0,it=0;it<et.length;it+=2){for(var ot=util$2.bytesToHex(et[it]+et[it+1]);ot[0]==="0"&&ot!=="0";)ot=ot.substr(1);if(ot==="0"){var st=rt[rt.length-1],at=tt.length;!st||at!==st.end+1?rt.push({start:at,end:at}):(st.end=at,st.end-st.start>rt[nt].end-rt[nt].start&&(nt=rt.length-1))}tt.push(ot)}if(rt.length>0){var ct=rt[nt];ct.end-ct.start>0&&(tt.splice(ct.start,ct.end-ct.start+1,""),ct.start===0&&tt.unshift(""),ct.end===7&&tt.push(""))}return tt.join(":")},util$2.estimateCores=function(et,tt){if(typeof et=="function"&&(tt=et,et={}),et=et||{},"cores"in util$2&&!et.update)return tt(null,util$2.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return util$2.cores=navigator.hardwareConcurrency,tt(null,util$2.cores);if(typeof Worker>"u")return util$2.cores=1,tt(null,util$2.cores);if(typeof Blob>"u")return util$2.cores=2,tt(null,util$2.cores);var rt=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(st){var at=Date.now(),ct=at+4;self.postMessage({st:at,et:ct})})}.toString(),")()"],{type:"application/javascript"}));nt([],5,16);function nt(st,at,ct){if(at===0){var ut=Math.floor(st.reduce(function(lt,ht){return lt+ht},0)/st.length);return util$2.cores=Math.max(1,ut),URL.revokeObjectURL(rt),tt(null,util$2.cores)}it(ct,function(lt,ht){st.push(ot(ct,ht)),nt(st,at-1,ct)})}function it(st,at){for(var ct=[],ut=[],lt=0;lt<st;++lt){var ht=new Worker(rt);ht.addEventListener("message",function(ft){if(ut.push(ft.data),ut.length===st){for(var dt=0;dt<st;++dt)ct[dt].terminate();at(null,ut)}}),ct.push(ht)}for(var lt=0;lt<st;++lt)ct[lt].postMessage(lt)}function ot(st,at){for(var ct=[],ut=0;ut<st;++ut)for(var lt=at[ut],ht=ct[ut]=[],ft=0;ft<st;++ft)if(ut!==ft){var dt=at[ft];(lt.st>dt.st&&lt.st<dt.et||dt.st>lt.st&&dt.st<lt.et)&&ht.push(ft)}return ct.reduce(function(pt,gt){return Math.max(pt,gt.length)},0)}};var forge$n=forge$p;forge$n.pki=forge$n.pki||{};var oids$1=forge$n.pki.oids=forge$n.oids=forge$n.oids||{};function _IN(et,tt){oids$1[et]=tt,oids$1[tt]=et}function _I_(et,tt){oids$1[et]=tt}_IN("1.2.840.113549.1.1.1","rsaEncryption"),_IN("1.2.840.113549.1.1.4","md5WithRSAEncryption"),_IN("1.2.840.113549.1.1.5","sha1WithRSAEncryption"),_IN("1.2.840.113549.1.1.7","RSAES-OAEP"),_IN("1.2.840.113549.1.1.8","mgf1"),_IN("1.2.840.113549.1.1.9","pSpecified"),_IN("1.2.840.113549.1.1.10","RSASSA-PSS"),_IN("1.2.840.113549.1.1.11","sha256WithRSAEncryption"),_IN("1.2.840.113549.1.1.12","sha384WithRSAEncryption"),_IN("1.2.840.113549.1.1.13","sha512WithRSAEncryption"),_IN("1.3.101.112","EdDSA25519"),_IN("1.2.840.10040.4.3","dsa-with-sha1"),_IN("1.3.14.3.2.7","desCBC"),_IN("1.3.14.3.2.26","sha1"),_IN("1.3.14.3.2.29","sha1WithRSASignature"),_IN("2.16.840.1.101.3.4.2.1","sha256"),_IN("2.16.840.1.101.3.4.2.2","sha384"),_IN("2.16.840.1.101.3.4.2.3","sha512"),_IN("2.16.840.1.101.3.4.2.4","sha224"),_IN("2.16.840.1.101.3.4.2.5","sha512-224"),_IN("2.16.840.1.101.3.4.2.6","sha512-256"),_IN("1.2.840.113549.2.2","md2"),_IN("1.2.840.113549.2.5","md5"),_IN("1.2.840.113549.1.7.1","data"),_IN("1.2.840.113549.1.7.2","signedData"),_IN("1.2.840.113549.1.7.3","envelopedData"),_IN("1.2.840.113549.1.7.4","signedAndEnvelopedData"),_IN("1.2.840.113549.1.7.5","digestedData"),_IN("1.2.840.113549.1.7.6","encryptedData"),_IN("1.2.840.113549.1.9.1","emailAddress"),_IN("1.2.840.113549.1.9.2","unstructuredName"),_IN("1.2.840.113549.1.9.3","contentType"),_IN("1.2.840.113549.1.9.4","messageDigest"),_IN("1.2.840.113549.1.9.5","signingTime"),_IN("1.2.840.113549.1.9.6","counterSignature"),_IN("1.2.840.113549.1.9.7","challengePassword"),_IN("1.2.840.113549.1.9.8","unstructuredAddress"),_IN("1.2.840.113549.1.9.14","extensionRequest"),_IN("1.2.840.113549.1.9.20","friendlyName"),_IN("1.2.840.113549.1.9.21","localKeyId"),_IN("1.2.840.113549.1.9.22.1","x509Certificate"),_IN("1.2.840.113549.1.12.10.1.1","keyBag"),_IN("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag"),_IN("1.2.840.113549.1.12.10.1.3","certBag"),_IN("1.2.840.113549.1.12.10.1.4","crlBag"),_IN("1.2.840.113549.1.12.10.1.5","secretBag"),_IN("1.2.840.113549.1.12.10.1.6","safeContentsBag"),_IN("1.2.840.113549.1.5.13","pkcs5PBES2"),_IN("1.2.840.113549.1.5.12","pkcs5PBKDF2"),_IN("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4"),_IN("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4"),_IN("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC"),_IN("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC"),_IN("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC"),_IN("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC"),_IN("1.2.840.113549.2.7","hmacWithSHA1"),_IN("1.2.840.113549.2.8","hmacWithSHA224"),_IN("1.2.840.113549.2.9","hmacWithSHA256"),_IN("1.2.840.113549.2.10","hmacWithSHA384"),_IN("1.2.840.113549.2.11","hmacWithSHA512"),_IN("1.2.840.113549.3.7","des-EDE3-CBC"),_IN("2.16.840.1.101.3.4.1.2","aes128-CBC"),_IN("2.16.840.1.101.3.4.1.22","aes192-CBC"),_IN("2.16.840.1.101.3.4.1.42","aes256-CBC"),_IN("2.5.4.3","commonName"),_IN("2.5.4.4","surname"),_IN("2.5.4.5","serialNumber"),_IN("2.5.4.6","countryName"),_IN("2.5.4.7","localityName"),_IN("2.5.4.8","stateOrProvinceName"),_IN("2.5.4.9","streetAddress"),_IN("2.5.4.10","organizationName"),_IN("2.5.4.11","organizationalUnitName"),_IN("2.5.4.12","title"),_IN("2.5.4.13","description"),_IN("2.5.4.15","businessCategory"),_IN("2.5.4.17","postalCode"),_IN("2.5.4.42","givenName"),_IN("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName"),_IN("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName"),_IN("2.16.840.1.113730.1.1","nsCertType"),_IN("2.16.840.1.113730.1.13","nsComment"),_I_("2.5.29.1","authorityKeyIdentifier"),_I_("2.5.29.2","keyAttributes"),_I_("2.5.29.3","certificatePolicies"),_I_("2.5.29.4","keyUsageRestriction"),_I_("2.5.29.5","policyMapping"),_I_("2.5.29.6","subtreesConstraint"),_I_("2.5.29.7","subjectAltName"),_I_("2.5.29.8","issuerAltName"),_I_("2.5.29.9","subjectDirectoryAttributes"),_I_("2.5.29.10","basicConstraints"),_I_("2.5.29.11","nameConstraints"),_I_("2.5.29.12","policyConstraints"),_I_("2.5.29.13","basicConstraints"),_IN("2.5.29.14","subjectKeyIdentifier"),_IN("2.5.29.15","keyUsage"),_I_("2.5.29.16","privateKeyUsagePeriod"),_IN("2.5.29.17","subjectAltName"),_IN("2.5.29.18","issuerAltName"),_IN("2.5.29.19","basicConstraints"),_I_("2.5.29.20","cRLNumber"),_I_("2.5.29.21","cRLReason"),_I_("2.5.29.22","expirationDate"),_I_("2.5.29.23","instructionCode"),_I_("2.5.29.24","invalidityDate"),_I_("2.5.29.25","cRLDistributionPoints"),_I_("2.5.29.26","issuingDistributionPoint"),_I_("2.5.29.27","deltaCRLIndicator"),_I_("2.5.29.28","issuingDistributionPoint"),_I_("2.5.29.29","certificateIssuer"),_I_("2.5.29.30","nameConstraints"),_IN("2.5.29.31","cRLDistributionPoints"),_IN("2.5.29.32","certificatePolicies"),_I_("2.5.29.33","policyMappings"),_I_("2.5.29.34","policyConstraints"),_IN("2.5.29.35","authorityKeyIdentifier"),_I_("2.5.29.36","policyConstraints"),_IN("2.5.29.37","extKeyUsage"),_I_("2.5.29.46","freshestCRL"),_I_("2.5.29.54","inhibitAnyPolicy"),_IN("1.3.6.1.4.1.11129.2.4.2","timestampList"),_IN("1.3.6.1.5.5.7.1.1","authorityInfoAccess"),_IN("1.3.6.1.5.5.7.3.1","serverAuth"),_IN("1.3.6.1.5.5.7.3.2","clientAuth"),_IN("1.3.6.1.5.5.7.3.3","codeSigning"),_IN("1.3.6.1.5.5.7.3.4","emailProtection"),_IN("1.3.6.1.5.5.7.3.8","timeStamping");var forge$m=forge$p,asn1$2=forge$m.asn1=forge$m.asn1||{};asn1$2.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192},asn1$2.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30},asn1$2.create=function(et,tt,rt,nt,it){if(forge$m.util.isArray(nt)){for(var ot=[],st=0;st<nt.length;++st)nt[st]!==void 0&&ot.push(nt[st]);nt=ot}var at={tagClass:et,type:tt,constructed:rt,composed:rt||forge$m.util.isArray(nt),value:nt};return it&&"bitStringContents"in it&&(at.bitStringContents=it.bitStringContents,at.original=asn1$2.copy(at)),at},asn1$2.copy=function(et,tt){var rt;if(forge$m.util.isArray(et)){rt=[];for(var nt=0;nt<et.length;++nt)rt.push(asn1$2.copy(et[nt],tt));return rt}return typeof et=="string"?et:(rt={tagClass:et.tagClass,type:et.type,constructed:et.constructed,composed:et.composed,value:asn1$2.copy(et.value,tt)},tt&&!tt.excludeBitStringContents&&(rt.bitStringContents=et.bitStringContents),rt)},asn1$2.equals=function(et,tt,rt){if(forge$m.util.isArray(et)){if(!forge$m.util.isArray(tt)||et.length!==tt.length)return!1;for(var nt=0;nt<et.length;++nt)if(!asn1$2.equals(et[nt],tt[nt]))return!1;return!0}if(typeof et!=typeof tt)return!1;if(typeof et=="string")return et===tt;var it=et.tagClass===tt.tagClass&&et.type===tt.type&&et.constructed===tt.constructed&&et.composed===tt.composed&&asn1$2.equals(et.value,tt.value);return rt&&rt.includeBitStringContents&&(it=it&&et.bitStringContents===tt.bitStringContents),it},asn1$2.getBerValueLength=function(et){var tt=et.getByte();if(tt!==128){var rt,nt=tt&128;return nt?rt=et.getInt((tt&127)<<3):rt=tt,rt}};function _checkBufferLength(et,tt,rt){if(rt>tt){var nt=new Error("Too few bytes to parse DER.");throw nt.available=et.length(),nt.remaining=tt,nt.requested=rt,nt}}var _getValueLength=function(et,tt){var rt=et.getByte();if(tt--,rt!==128){var nt,it=rt&128;if(!it)nt=rt;else{var ot=rt&127;_checkBufferLength(et,tt,ot),nt=et.getInt(ot<<3)}if(nt<0)throw new Error("Negative length: "+nt);return nt}};asn1$2.fromDer=function(et,tt){tt===void 0&&(tt={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof tt=="boolean"&&(tt={strict:tt,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in tt||(tt.strict=!0),"parseAllBytes"in tt||(tt.parseAllBytes=!0),"decodeBitStrings"in tt||(tt.decodeBitStrings=!0),typeof et=="string"&&(et=forge$m.util.createBuffer(et));var rt=et.length(),nt=_fromDer(et,et.length(),0,tt);if(tt.parseAllBytes&&et.length()!==0){var it=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw it.byteCount=rt,it.remaining=et.length(),it}return nt};function _fromDer(et,tt,rt,nt){var it;_checkBufferLength(et,tt,2);var ot=et.getByte();tt--;var st=ot&192,at=ot&31;it=et.length();var ct=_getValueLength(et,tt);if(tt-=it-et.length(),ct!==void 0&&ct>tt){if(nt.strict){var ut=new Error("Too few bytes to read ASN.1 value.");throw ut.available=et.length(),ut.remaining=tt,ut.requested=ct,ut}ct=tt}var lt,ht,ft=(ot&32)===32;if(ft)if(lt=[],ct===void 0)for(;;){if(_checkBufferLength(et,tt,2),et.bytes(2)===String.fromCharCode(0,0)){et.getBytes(2),tt-=2;break}it=et.length(),lt.push(_fromDer(et,tt,rt+1,nt)),tt-=it-et.length()}else for(;ct>0;)it=et.length(),lt.push(_fromDer(et,ct,rt+1,nt)),tt-=it-et.length(),ct-=it-et.length();if(lt===void 0&&st===asn1$2.Class.UNIVERSAL&&at===asn1$2.Type.BITSTRING&&(ht=et.bytes(ct)),lt===void 0&&nt.decodeBitStrings&&st===asn1$2.Class.UNIVERSAL&&at===asn1$2.Type.BITSTRING&&ct>1){var dt=et.read,pt=tt,gt=0;if(at===asn1$2.Type.BITSTRING&&(_checkBufferLength(et,tt,1),gt=et.getByte(),tt--),gt===0)try{it=et.length();var _t={strict:!0,decodeBitStrings:!0},mt=_fromDer(et,tt,rt+1,_t),At=it-et.length();tt-=At,at==asn1$2.Type.BITSTRING&&At++;var It=mt.tagClass;At===ct&&(It===asn1$2.Class.UNIVERSAL||It===asn1$2.Class.CONTEXT_SPECIFIC)&&(lt=[mt])}catch{}lt===void 0&&(et.read=dt,tt=pt)}if(lt===void 0){if(ct===void 0){if(nt.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");ct=tt}if(at===asn1$2.Type.BMPSTRING)for(lt="";ct>0;ct-=2)_checkBufferLength(et,tt,2),lt+=String.fromCharCode(et.getInt16()),tt-=2;else lt=et.getBytes(ct),tt-=ct}var Mt=ht===void 0?null:{bitStringContents:ht};return asn1$2.create(st,at,ft,lt,Mt)}asn1$2.toDer=function(et){var tt=forge$m.util.createBuffer(),rt=et.tagClass|et.type,nt=forge$m.util.createBuffer(),it=!1;if("bitStringContents"in et&&(it=!0,et.original&&(it=asn1$2.equals(et,et.original))),it)nt.putBytes(et.bitStringContents);else if(et.composed){et.constructed?rt|=32:nt.putByte(0);for(var ot=0;ot<et.value.length;++ot)et.value[ot]!==void 0&&nt.putBuffer(asn1$2.toDer(et.value[ot]))}else if(et.type===asn1$2.Type.BMPSTRING)for(var ot=0;ot<et.value.length;++ot)nt.putInt16(et.value.charCodeAt(ot));else et.type===asn1$2.Type.INTEGER&&et.value.length>1&&(et.value.charCodeAt(0)===0&&!(et.value.charCodeAt(1)&128)||et.value.charCodeAt(0)===255&&(et.value.charCodeAt(1)&128)===128)?nt.putBytes(et.value.substr(1)):nt.putBytes(et.value);if(tt.putByte(rt),nt.length()<=127)tt.putByte(nt.length()&127);else{var st=nt.length(),at="";do at+=String.fromCharCode(st&255),st=st>>>8;while(st>0);tt.putByte(at.length|128);for(var ot=at.length-1;ot>=0;--ot)tt.putByte(at.charCodeAt(ot))}return tt.putBuffer(nt),tt},asn1$2.oidToDer=function(et){var tt=et.split("."),rt=forge$m.util.createBuffer();rt.putByte(40*parseInt(tt[0],10)+parseInt(tt[1],10));for(var nt,it,ot,st,at=2;at<tt.length;++at){nt=!0,it=[],ot=parseInt(tt[at],10);do st=ot&127,ot=ot>>>7,nt||(st|=128),it.push(st),nt=!1;while(ot>0);for(var ct=it.length-1;ct>=0;--ct)rt.putByte(it[ct])}return rt},asn1$2.derToOid=function(et){var tt;typeof et=="string"&&(et=forge$m.util.createBuffer(et));var rt=et.getByte();tt=Math.floor(rt/40)+"."+rt%40;for(var nt=0;et.length()>0;)rt=et.getByte(),nt=nt<<7,rt&128?nt+=rt&127:(tt+="."+(nt+rt),nt=0);return tt},asn1$2.utcTimeToDate=function(et){var tt=new Date,rt=parseInt(et.substr(0,2),10);rt=rt>=50?1900+rt:2e3+rt;var nt=parseInt(et.substr(2,2),10)-1,it=parseInt(et.substr(4,2),10),ot=parseInt(et.substr(6,2),10),st=parseInt(et.substr(8,2),10),at=0;if(et.length>11){var ct=et.charAt(10),ut=10;ct!=="+"&&ct!=="-"&&(at=parseInt(et.substr(10,2),10),ut+=2)}if(tt.setUTCFullYear(rt,nt,it),tt.setUTCHours(ot,st,at,0),ut&&(ct=et.charAt(ut),ct==="+"||ct==="-")){var lt=parseInt(et.substr(ut+1,2),10),ht=parseInt(et.substr(ut+4,2),10),ft=lt*60+ht;ft*=6e4,ct==="+"?tt.setTime(+tt-ft):tt.setTime(+tt+ft)}return tt},asn1$2.generalizedTimeToDate=function(et){var tt=new Date,rt=parseInt(et.substr(0,4),10),nt=parseInt(et.substr(4,2),10)-1,it=parseInt(et.substr(6,2),10),ot=parseInt(et.substr(8,2),10),st=parseInt(et.substr(10,2),10),at=parseInt(et.substr(12,2),10),ct=0,ut=0,lt=!1;et.charAt(et.length-1)==="Z"&&(lt=!0);var ht=et.length-5,ft=et.charAt(ht);if(ft==="+"||ft==="-"){var dt=parseInt(et.substr(ht+1,2),10),pt=parseInt(et.substr(ht+4,2),10);ut=dt*60+pt,ut*=6e4,ft==="+"&&(ut*=-1),lt=!0}return et.charAt(14)==="."&&(ct=parseFloat(et.substr(14),10)*1e3),lt?(tt.setUTCFullYear(rt,nt,it),tt.setUTCHours(ot,st,at,ct),tt.setTime(+tt+ut)):(tt.setFullYear(rt,nt,it),tt.setHours(ot,st,at,ct)),tt},asn1$2.dateToUtcTime=function(et){if(typeof et=="string")return et;var tt="",rt=[];rt.push((""+et.getUTCFullYear()).substr(2)),rt.push(""+(et.getUTCMonth()+1)),rt.push(""+et.getUTCDate()),rt.push(""+et.getUTCHours()),rt.push(""+et.getUTCMinutes()),rt.push(""+et.getUTCSeconds());for(var nt=0;nt<rt.length;++nt)rt[nt].length<2&&(tt+="0"),tt+=rt[nt];return tt+="Z",tt},asn1$2.dateToGeneralizedTime=function(et){if(typeof et=="string")return et;var tt="",rt=[];rt.push(""+et.getUTCFullYear()),rt.push(""+(et.getUTCMonth()+1)),rt.push(""+et.getUTCDate()),rt.push(""+et.getUTCHours()),rt.push(""+et.getUTCMinutes()),rt.push(""+et.getUTCSeconds());for(var nt=0;nt<rt.length;++nt)rt[nt].length<2&&(tt+="0"),tt+=rt[nt];return tt+="Z",tt},asn1$2.integerToDer=function(et){var tt=forge$m.util.createBuffer();if(et>=-128&&et<128)return tt.putSignedInt(et,8);if(et>=-32768&&et<32768)return tt.putSignedInt(et,16);if(et>=-8388608&&et<8388608)return tt.putSignedInt(et,24);if(et>=-2147483648&&et<2147483648)return tt.putSignedInt(et,32);var rt=new Error("Integer too large; max is 32-bits.");throw rt.integer=et,rt},asn1$2.derToInteger=function(et){typeof et=="string"&&(et=forge$m.util.createBuffer(et));var tt=et.length()*8;if(tt>32)throw new Error("Integer too large; max is 32-bits.");return et.getSignedInt(tt)},asn1$2.validate=function(et,tt,rt,nt){var it=!1;if((et.tagClass===tt.tagClass||typeof tt.tagClass>"u")&&(et.type===tt.type||typeof tt.type>"u"))if(et.constructed===tt.constructed||typeof tt.constructed>"u"){if(it=!0,tt.value&&forge$m.util.isArray(tt.value))for(var ot=0,st=0;it&&st<tt.value.length;++st)it=tt.value[st].optional||!1,et.value[ot]&&(it=asn1$2.validate(et.value[ot],tt.value[st],rt,nt),it?++ot:tt.value[st].optional&&(it=!0)),!it&&nt&&nt.push("["+tt.name+'] Tag class "'+tt.tagClass+'", type "'+tt.type+'" expected value length "'+tt.value.length+'", got "'+et.value.length+'"');if(it&&rt&&(tt.capture&&(rt[tt.capture]=et.value),tt.captureAsn1&&(rt[tt.captureAsn1]=et),tt.captureBitStringContents&&"bitStringContents"in et&&(rt[tt.captureBitStringContents]=et.bitStringContents),tt.captureBitStringValue&&"bitStringContents"in et))if(et.bitStringContents.length<2)rt[tt.captureBitStringValue]="";else{var at=et.bitStringContents.charCodeAt(0);if(at!==0)throw new Error("captureBitStringValue only supported for zero unused bits");rt[tt.captureBitStringValue]=et.bitStringContents.slice(1)}}else nt&&nt.push("["+tt.name+'] Expected constructed "'+tt.constructed+'", got "'+et.constructed+'"');else nt&&(et.tagClass!==tt.tagClass&&nt.push("["+tt.name+'] Expected tag class "'+tt.tagClass+'", got "'+et.tagClass+'"'),et.type!==tt.type&&nt.push("["+tt.name+'] Expected type "'+tt.type+'", got "'+et.type+'"'));return it};var _nonLatinRegex=/[^\\u0000-\\u00ff]/;asn1$2.prettyPrint=function(et,tt,rt){var nt="";tt=tt||0,rt=rt||2,tt>0&&(nt+=`
`);for(var it="",ot=0;ot<tt*rt;++ot)it+=" ";switch(nt+=it+"Tag: ",et.tagClass){case asn1$2.Class.UNIVERSAL:nt+="Universal:";break;case asn1$2.Class.APPLICATION:nt+="Application:";break;case asn1$2.Class.CONTEXT_SPECIFIC:nt+="Context-Specific:";break;case asn1$2.Class.PRIVATE:nt+="Private:";break}if(et.tagClass===asn1$2.Class.UNIVERSAL)switch(nt+=et.type,et.type){case asn1$2.Type.NONE:nt+=" (None)";break;case asn1$2.Type.BOOLEAN:nt+=" (Boolean)";break;case asn1$2.Type.INTEGER:nt+=" (Integer)";break;case asn1$2.Type.BITSTRING:nt+=" (Bit string)";break;case asn1$2.Type.OCTETSTRING:nt+=" (Octet string)";break;case asn1$2.Type.NULL:nt+=" (Null)";break;case asn1$2.Type.OID:nt+=" (Object Identifier)";break;case asn1$2.Type.ODESC:nt+=" (Object Descriptor)";break;case asn1$2.Type.EXTERNAL:nt+=" (External or Instance of)";break;case asn1$2.Type.REAL:nt+=" (Real)";break;case asn1$2.Type.ENUMERATED:nt+=" (Enumerated)";break;case asn1$2.Type.EMBEDDED:nt+=" (Embedded PDV)";break;case asn1$2.Type.UTF8:nt+=" (UTF8)";break;case asn1$2.Type.ROID:nt+=" (Relative Object Identifier)";break;case asn1$2.Type.SEQUENCE:nt+=" (Sequence)";break;case asn1$2.Type.SET:nt+=" (Set)";break;case asn1$2.Type.PRINTABLESTRING:nt+=" (Printable String)";break;case asn1$2.Type.IA5String:nt+=" (IA5String (ASCII))";break;case asn1$2.Type.UTCTIME:nt+=" (UTC time)";break;case asn1$2.Type.GENERALIZEDTIME:nt+=" (Generalized time)";break;case asn1$2.Type.BMPSTRING:nt+=" (BMP String)";break}else nt+=et.type;if(nt+=`
`,nt+=it+"Constructed: "+et.constructed+`
`,et.composed){for(var st=0,at="",ot=0;ot<et.value.length;++ot)et.value[ot]!==void 0&&(st+=1,at+=asn1$2.prettyPrint(et.value[ot],tt+1,rt),ot+1<et.value.length&&(at+=","));nt+=it+"Sub values: "+st+at}else{if(nt+=it+"Value: ",et.type===asn1$2.Type.OID){var ct=asn1$2.derToOid(et.value);nt+=ct,forge$m.pki&&forge$m.pki.oids&&ct in forge$m.pki.oids&&(nt+=" ("+forge$m.pki.oids[ct]+") ")}if(et.type===asn1$2.Type.INTEGER)try{nt+=asn1$2.derToInteger(et.value)}catch{nt+="0x"+forge$m.util.bytesToHex(et.value)}else if(et.type===asn1$2.Type.BITSTRING){if(et.value.length>1?nt+="0x"+forge$m.util.bytesToHex(et.value.slice(1)):nt+="(none)",et.value.length>0){var ut=et.value.charCodeAt(0);ut==1?nt+=" (1 unused bit shown)":ut>1&&(nt+=" ("+ut+" unused bits shown)")}}else if(et.type===asn1$2.Type.OCTETSTRING)_nonLatinRegex.test(et.value)||(nt+="("+et.value+") "),nt+="0x"+forge$m.util.bytesToHex(et.value);else if(et.type===asn1$2.Type.UTF8)try{nt+=forge$m.util.decodeUtf8(et.value)}catch(lt){if(lt.message==="URI malformed")nt+="0x"+forge$m.util.bytesToHex(et.value)+" (malformed UTF8)";else throw lt}else et.type===asn1$2.Type.PRINTABLESTRING||et.type===asn1$2.Type.IA5String?nt+=et.value:_nonLatinRegex.test(et.value)?nt+="0x"+forge$m.util.bytesToHex(et.value):et.value.length===0?nt+="[null]":nt+=et.value}return nt};var forge$l=forge$p;forge$l.cipher=forge$l.cipher||{},forge$l.cipher.algorithms=forge$l.cipher.algorithms||{},forge$l.cipher.createCipher=function(et,tt){var rt=et;if(typeof rt=="string"&&(rt=forge$l.cipher.getAlgorithm(rt),rt&&(rt=rt())),!rt)throw new Error("Unsupported algorithm: "+et);return new forge$l.cipher.BlockCipher({algorithm:rt,key:tt,decrypt:!1})},forge$l.cipher.createDecipher=function(et,tt){var rt=et;if(typeof rt=="string"&&(rt=forge$l.cipher.getAlgorithm(rt),rt&&(rt=rt())),!rt)throw new Error("Unsupported algorithm: "+et);return new forge$l.cipher.BlockCipher({algorithm:rt,key:tt,decrypt:!0})},forge$l.cipher.registerAlgorithm=function(et,tt){et=et.toUpperCase(),forge$l.cipher.algorithms[et]=tt},forge$l.cipher.getAlgorithm=function(et){return et=et.toUpperCase(),et in forge$l.cipher.algorithms?forge$l.cipher.algorithms[et]:null};var BlockCipher=forge$l.cipher.BlockCipher=function(et){this.algorithm=et.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=et.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=et.decrypt,this.algorithm.initialize(et)};BlockCipher.prototype.start=function(et){et=et||{};var tt={};for(var rt in et)tt[rt]=et[rt];tt.decrypt=this._decrypt,this._finish=!1,this._input=forge$l.util.createBuffer(),this.output=et.output||forge$l.util.createBuffer(),this.mode.start(tt)},BlockCipher.prototype.update=function(et){for(et&&this._input.putBuffer(et);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()},BlockCipher.prototype.finish=function(et){et&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(rt){return et(this.blockSize,rt,!1)},this.mode.unpad=function(rt){return et(this.blockSize,rt,!0)});var tt={};return tt.decrypt=this._decrypt,tt.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,tt)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,tt))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,tt))};var forge$k=forge$p;forge$k.cipher=forge$k.cipher||{};var modes=forge$k.cipher.modes=forge$k.cipher.modes||{};modes.ecb=function(et){et=et||{},this.name="ECB",this.cipher=et.cipher,this.blockSize=et.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},modes.ecb.prototype.start=function(et){},modes.ecb.prototype.encrypt=function(et,tt,rt){if(et.length()<this.blockSize&&!(rt&&et.length()>0))return!0;for(var nt=0;nt<this._ints;++nt)this._inBlock[nt]=et.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var nt=0;nt<this._ints;++nt)tt.putInt32(this._outBlock[nt])},modes.ecb.prototype.decrypt=function(et,tt,rt){if(et.length()<this.blockSize&&!(rt&&et.length()>0))return!0;for(var nt=0;nt<this._ints;++nt)this._inBlock[nt]=et.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var nt=0;nt<this._ints;++nt)tt.putInt32(this._outBlock[nt])},modes.ecb.prototype.pad=function(et,tt){var rt=et.length()===this.blockSize?this.blockSize:this.blockSize-et.length();return et.fillWithByte(rt,rt),!0},modes.ecb.prototype.unpad=function(et,tt){if(tt.overflow>0)return!1;var rt=et.length(),nt=et.at(rt-1);return nt>this.blockSize<<2?!1:(et.truncate(nt),!0)},modes.cbc=function(et){et=et||{},this.name="CBC",this.cipher=et.cipher,this.blockSize=et.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)},modes.cbc.prototype.start=function(et){if(et.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in et)this._iv=transformIV(et.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")},modes.cbc.prototype.encrypt=function(et,tt,rt){if(et.length()<this.blockSize&&!(rt&&et.length()>0))return!0;for(var nt=0;nt<this._ints;++nt)this._inBlock[nt]=this._prev[nt]^et.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var nt=0;nt<this._ints;++nt)tt.putInt32(this._outBlock[nt]);this._prev=this._outBlock},modes.cbc.prototype.decrypt=function(et,tt,rt){if(et.length()<this.blockSize&&!(rt&&et.length()>0))return!0;for(var nt=0;nt<this._ints;++nt)this._inBlock[nt]=et.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var nt=0;nt<this._ints;++nt)tt.putInt32(this._prev[nt]^this._outBlock[nt]);this._prev=this._inBlock.slice(0)},modes.cbc.prototype.pad=function(et,tt){var rt=et.length()===this.blockSize?this.blockSize:this.blockSize-et.length();return et.fillWithByte(rt,rt),!0},modes.cbc.prototype.unpad=function(et,tt){if(tt.overflow>0)return!1;var rt=et.length(),nt=et.at(rt-1);return nt>this.blockSize<<2?!1:(et.truncate(nt),!0)},modes.cfb=function(et){et=et||{},this.name="CFB",this.cipher=et.cipher,this.blockSize=et.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=forge$k.util.createBuffer(),this._partialBytes=0},modes.cfb.prototype.start=function(et){if(!("iv"in et))throw new Error("Invalid IV parameter.");this._iv=transformIV(et.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},modes.cfb.prototype.encrypt=function(et,tt,rt){var nt=et.length();if(nt===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&nt>=this.blockSize){for(var it=0;it<this._ints;++it)this._inBlock[it]=et.getInt32()^this._outBlock[it],tt.putInt32(this._inBlock[it]);return}var ot=(this.blockSize-nt)%this.blockSize;ot>0&&(ot=this.blockSize-ot),this._partialOutput.clear();for(var it=0;it<this._ints;++it)this._partialBlock[it]=et.getInt32()^this._outBlock[it],this._partialOutput.putInt32(this._partialBlock[it]);if(ot>0)et.read-=this.blockSize;else for(var it=0;it<this._ints;++it)this._inBlock[it]=this._partialBlock[it];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),ot>0&&!rt)return tt.putBytes(this._partialOutput.getBytes(ot-this._partialBytes)),this._partialBytes=ot,!0;tt.putBytes(this._partialOutput.getBytes(nt-this._partialBytes)),this._partialBytes=0},modes.cfb.prototype.decrypt=function(et,tt,rt){var nt=et.length();if(nt===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&nt>=this.blockSize){for(var it=0;it<this._ints;++it)this._inBlock[it]=et.getInt32(),tt.putInt32(this._inBlock[it]^this._outBlock[it]);return}var ot=(this.blockSize-nt)%this.blockSize;ot>0&&(ot=this.blockSize-ot),this._partialOutput.clear();for(var it=0;it<this._ints;++it)this._partialBlock[it]=et.getInt32(),this._partialOutput.putInt32(this._partialBlock[it]^this._outBlock[it]);if(ot>0)et.read-=this.blockSize;else for(var it=0;it<this._ints;++it)this._inBlock[it]=this._partialBlock[it];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),ot>0&&!rt)return tt.putBytes(this._partialOutput.getBytes(ot-this._partialBytes)),this._partialBytes=ot,!0;tt.putBytes(this._partialOutput.getBytes(nt-this._partialBytes)),this._partialBytes=0},modes.ofb=function(et){et=et||{},this.name="OFB",this.cipher=et.cipher,this.blockSize=et.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=forge$k.util.createBuffer(),this._partialBytes=0},modes.ofb.prototype.start=function(et){if(!("iv"in et))throw new Error("Invalid IV parameter.");this._iv=transformIV(et.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},modes.ofb.prototype.encrypt=function(et,tt,rt){var nt=et.length();if(et.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&nt>=this.blockSize){for(var it=0;it<this._ints;++it)tt.putInt32(et.getInt32()^this._outBlock[it]),this._inBlock[it]=this._outBlock[it];return}var ot=(this.blockSize-nt)%this.blockSize;ot>0&&(ot=this.blockSize-ot),this._partialOutput.clear();for(var it=0;it<this._ints;++it)this._partialOutput.putInt32(et.getInt32()^this._outBlock[it]);if(ot>0)et.read-=this.blockSize;else for(var it=0;it<this._ints;++it)this._inBlock[it]=this._outBlock[it];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),ot>0&&!rt)return tt.putBytes(this._partialOutput.getBytes(ot-this._partialBytes)),this._partialBytes=ot,!0;tt.putBytes(this._partialOutput.getBytes(nt-this._partialBytes)),this._partialBytes=0},modes.ofb.prototype.decrypt=modes.ofb.prototype.encrypt,modes.ctr=function(et){et=et||{},this.name="CTR",this.cipher=et.cipher,this.blockSize=et.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=forge$k.util.createBuffer(),this._partialBytes=0},modes.ctr.prototype.start=function(et){if(!("iv"in et))throw new Error("Invalid IV parameter.");this._iv=transformIV(et.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0},modes.ctr.prototype.encrypt=function(et,tt,rt){var nt=et.length();if(nt===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&nt>=this.blockSize)for(var it=0;it<this._ints;++it)tt.putInt32(et.getInt32()^this._outBlock[it]);else{var ot=(this.blockSize-nt)%this.blockSize;ot>0&&(ot=this.blockSize-ot),this._partialOutput.clear();for(var it=0;it<this._ints;++it)this._partialOutput.putInt32(et.getInt32()^this._outBlock[it]);if(ot>0&&(et.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),ot>0&&!rt)return tt.putBytes(this._partialOutput.getBytes(ot-this._partialBytes)),this._partialBytes=ot,!0;tt.putBytes(this._partialOutput.getBytes(nt-this._partialBytes)),this._partialBytes=0}inc32(this._inBlock)},modes.ctr.prototype.decrypt=modes.ctr.prototype.encrypt,modes.gcm=function(et){et=et||{},this.name="GCM",this.cipher=et.cipher,this.blockSize=et.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=forge$k.util.createBuffer(),this._partialBytes=0,this._R=3774873600},modes.gcm.prototype.start=function(et){if(!("iv"in et))throw new Error("Invalid IV parameter.");var tt=forge$k.util.createBuffer(et.iv);this._cipherLength=0;var rt;if("additionalData"in et?rt=forge$k.util.createBuffer(et.additionalData):rt=forge$k.util.createBuffer(),"tagLength"in et?this._tagLength=et.tagLength:this._tagLength=128,this._tag=null,et.decrypt&&(this._tag=forge$k.util.createBuffer(et.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var nt=tt.length();if(nt===12)this._j0=[tt.getInt32(),tt.getInt32(),tt.getInt32(),1];else{for(this._j0=[0,0,0,0];tt.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[tt.getInt32(),tt.getInt32(),tt.getInt32(),tt.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(from64To32(nt*8)))}this._inBlock=this._j0.slice(0),inc32(this._inBlock),this._partialBytes=0,rt=forge$k.util.createBuffer(rt),this._aDataLength=from64To32(rt.length()*8);var it=rt.length()%this.blockSize;for(it&&rt.fillWithByte(0,this.blockSize-it),this._s=[0,0,0,0];rt.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[rt.getInt32(),rt.getInt32(),rt.getInt32(),rt.getInt32()])},modes.gcm.prototype.encrypt=function(et,tt,rt){var nt=et.length();if(nt===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&nt>=this.blockSize){for(var it=0;it<this._ints;++it)tt.putInt32(this._outBlock[it]^=et.getInt32());this._cipherLength+=this.blockSize}else{var ot=(this.blockSize-nt)%this.blockSize;ot>0&&(ot=this.blockSize-ot),this._partialOutput.clear();for(var it=0;it<this._ints;++it)this._partialOutput.putInt32(et.getInt32()^this._outBlock[it]);if(ot<=0||rt){if(rt){var st=nt%this.blockSize;this._cipherLength+=st,this._partialOutput.truncate(this.blockSize-st)}else this._cipherLength+=this.blockSize;for(var it=0;it<this._ints;++it)this._outBlock[it]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),ot>0&&!rt)return et.read-=this.blockSize,tt.putBytes(this._partialOutput.getBytes(ot-this._partialBytes)),this._partialBytes=ot,!0;tt.putBytes(this._partialOutput.getBytes(nt-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),inc32(this._inBlock)},modes.gcm.prototype.decrypt=function(et,tt,rt){var nt=et.length();if(nt<this.blockSize&&!(rt&&nt>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),inc32(this._inBlock),this._hashBlock[0]=et.getInt32(),this._hashBlock[1]=et.getInt32(),this._hashBlock[2]=et.getInt32(),this._hashBlock[3]=et.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var it=0;it<this._ints;++it)tt.putInt32(this._outBlock[it]^this._hashBlock[it]);nt<this.blockSize?this._cipherLength+=nt%this.blockSize:this._cipherLength+=this.blockSize},modes.gcm.prototype.afterFinish=function(et,tt){var rt=!0;tt.decrypt&&tt.overflow&&et.truncate(this.blockSize-tt.overflow),this.tag=forge$k.util.createBuffer();var nt=this._aDataLength.concat(from64To32(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,nt);var it=[];this.cipher.encrypt(this._j0,it);for(var ot=0;ot<this._ints;++ot)this.tag.putInt32(this._s[ot]^it[ot]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),tt.decrypt&&this.tag.bytes()!==this._tag&&(rt=!1),rt},modes.gcm.prototype.multiply=function(et,tt){for(var rt=[0,0,0,0],nt=tt.slice(0),it=0;it<128;++it){var ot=et[it/32|0]&1<<31-it%32;ot&&(rt[0]^=nt[0],rt[1]^=nt[1],rt[2]^=nt[2],rt[3]^=nt[3]),this.pow(nt,nt)}return rt},modes.gcm.prototype.pow=function(et,tt){for(var rt=et[3]&1,nt=3;nt>0;--nt)tt[nt]=et[nt]>>>1|(et[nt-1]&1)<<31;tt[0]=et[0]>>>1,rt&&(tt[0]^=this._R)},modes.gcm.prototype.tableMultiply=function(et){for(var tt=[0,0,0,0],rt=0;rt<32;++rt){var nt=rt/8|0,it=et[nt]>>>(7-rt%8)*4&15,ot=this._m[rt][it];tt[0]^=ot[0],tt[1]^=ot[1],tt[2]^=ot[2],tt[3]^=ot[3]}return tt},modes.gcm.prototype.ghash=function(et,tt,rt){return tt[0]^=rt[0],tt[1]^=rt[1],tt[2]^=rt[2],tt[3]^=rt[3],this.tableMultiply(tt)},modes.gcm.prototype.generateHashTable=function(et,tt){for(var rt=8/tt,nt=4*rt,it=16*rt,ot=new Array(it),st=0;st<it;++st){var at=[0,0,0,0],ct=st/nt|0,ut=(nt-1-st%nt)*tt;at[ct]=1<<tt-1<<ut,ot[st]=this.generateSubHashTable(this.multiply(at,et),tt)}return ot},modes.gcm.prototype.generateSubHashTable=function(et,tt){var rt=1<<tt,nt=rt>>>1,it=new Array(rt);it[nt]=et.slice(0);for(var ot=nt>>>1;ot>0;)this.pow(it[2*ot],it[ot]=[]),ot>>=1;for(ot=2;ot<nt;){for(var st=1;st<ot;++st){var at=it[ot],ct=it[st];it[ot+st]=[at[0]^ct[0],at[1]^ct[1],at[2]^ct[2],at[3]^ct[3]]}ot*=2}for(it[0]=[0,0,0,0],ot=nt+1;ot<rt;++ot){var ut=it[ot^nt];it[ot]=[et[0]^ut[0],et[1]^ut[1],et[2]^ut[2],et[3]^ut[3]]}return it};function transformIV(et,tt){if(typeof et=="string"&&(et=forge$k.util.createBuffer(et)),forge$k.util.isArray(et)&&et.length>4){var rt=et;et=forge$k.util.createBuffer();for(var nt=0;nt<rt.length;++nt)et.putByte(rt[nt])}if(et.length()<tt)throw new Error("Invalid IV length; got "+et.length()+" bytes and expected "+tt+" bytes.");if(!forge$k.util.isArray(et)){for(var it=[],ot=tt/4,nt=0;nt<ot;++nt)it.push(et.getInt32());et=it}return et}function inc32(et){et[et.length-1]=et[et.length-1]+1&4294967295}function from64To32(et){return[et/4294967296|0,et&4294967295]}var forge$j=forge$p;forge$j.aes=forge$j.aes||{},forge$j.aes.startEncrypting=function(et,tt,rt,nt){var it=_createCipher$1({key:et,output:rt,decrypt:!1,mode:nt});return it.start(tt),it},forge$j.aes.createEncryptionCipher=function(et,tt){return _createCipher$1({key:et,output:null,decrypt:!1,mode:tt})},forge$j.aes.startDecrypting=function(et,tt,rt,nt){var it=_createCipher$1({key:et,output:rt,decrypt:!0,mode:nt});return it.start(tt),it},forge$j.aes.createDecryptionCipher=function(et,tt){return _createCipher$1({key:et,output:null,decrypt:!0,mode:tt})},forge$j.aes.Algorithm=function(et,tt){init||initialize();var rt=this;rt.name=et,rt.mode=new tt({blockSize:16,cipher:{encrypt:function(nt,it){return _updateBlock$1(rt._w,nt,it,!1)},decrypt:function(nt,it){return _updateBlock$1(rt._w,nt,it,!0)}}}),rt._init=!1},forge$j.aes.Algorithm.prototype.initialize=function(et){if(!this._init){var tt=et.key,rt;if(typeof tt=="string"&&(tt.length===16||tt.length===24||tt.length===32))tt=forge$j.util.createBuffer(tt);else if(forge$j.util.isArray(tt)&&(tt.length===16||tt.length===24||tt.length===32)){rt=tt,tt=forge$j.util.createBuffer();for(var nt=0;nt<rt.length;++nt)tt.putByte(rt[nt])}if(!forge$j.util.isArray(tt)){rt=tt,tt=[];var it=rt.length();if(it===16||it===24||it===32){it=it>>>2;for(var nt=0;nt<it;++nt)tt.push(rt.getInt32())}}if(!forge$j.util.isArray(tt)||!(tt.length===4||tt.length===6||tt.length===8))throw new Error("Invalid key parameter.");var ot=this.mode.name,st=["CFB","OFB","CTR","GCM"].indexOf(ot)!==-1;this._w=_expandKey(tt,et.decrypt&&!st),this._init=!0}},forge$j.aes._expandKey=function(et,tt){return init||initialize(),_expandKey(et,tt)},forge$j.aes._updateBlock=_updateBlock$1,registerAlgorithm$1("AES-ECB",forge$j.cipher.modes.ecb),registerAlgorithm$1("AES-CBC",forge$j.cipher.modes.cbc),registerAlgorithm$1("AES-CFB",forge$j.cipher.modes.cfb),registerAlgorithm$1("AES-OFB",forge$j.cipher.modes.ofb),registerAlgorithm$1("AES-CTR",forge$j.cipher.modes.ctr),registerAlgorithm$1("AES-GCM",forge$j.cipher.modes.gcm);function registerAlgorithm$1(et,tt){var rt=function(){return new forge$j.aes.Algorithm(et,tt)};forge$j.cipher.registerAlgorithm(et,rt)}var init=!1,Nb=4,sbox,isbox,rcon,mix,imix;function initialize(){init=!0,rcon=[0,1,2,4,8,16,32,64,128,27,54];for(var et=new Array(256),tt=0;tt<128;++tt)et[tt]=tt<<1,et[tt+128]=tt+128<<1^283;sbox=new Array(256),isbox=new Array(256),mix=new Array(4),imix=new Array(4);for(var tt=0;tt<4;++tt)mix[tt]=new Array(256),imix[tt]=new Array(256);for(var rt=0,nt=0,it,ot,st,at,ct,ut,lt,tt=0;tt<256;++tt){at=nt^nt<<1^nt<<2^nt<<3^nt<<4,at=at>>8^at&255^99,sbox[rt]=at,isbox[at]=rt,ct=et[at],it=et[rt],ot=et[it],st=et[ot],ut=ct<<24^at<<16^at<<8^(at^ct),lt=(it^ot^st)<<24^(rt^st)<<16^(rt^ot^st)<<8^(rt^it^st);for(var ht=0;ht<4;++ht)mix[ht][rt]=ut,imix[ht][at]=lt,ut=ut<<24|ut>>>8,lt=lt<<24|lt>>>8;rt===0?rt=nt=1:(rt=it^et[et[et[it^st]]],nt^=et[et[nt]])}}function _expandKey(et,tt){for(var rt=et.slice(0),nt,it=1,ot=rt.length,st=ot+6+1,at=Nb*st,ct=ot;ct<at;++ct)nt=rt[ct-1],ct%ot===0?(nt=sbox[nt>>>16&255]<<24^sbox[nt>>>8&255]<<16^sbox[nt&255]<<8^sbox[nt>>>24]^rcon[it]<<24,it++):ot>6&&ct%ot===4&&(nt=sbox[nt>>>24]<<24^sbox[nt>>>16&255]<<16^sbox[nt>>>8&255]<<8^sbox[nt&255]),rt[ct]=rt[ct-ot]^nt;if(tt){var ut,lt=imix[0],ht=imix[1],ft=imix[2],dt=imix[3],pt=rt.slice(0);at=rt.length;for(var ct=0,gt=at-Nb;ct<at;ct+=Nb,gt-=Nb)if(ct===0||ct===at-Nb)pt[ct]=rt[gt],pt[ct+1]=rt[gt+3],pt[ct+2]=rt[gt+2],pt[ct+3]=rt[gt+1];else for(var _t=0;_t<Nb;++_t)ut=rt[gt+_t],pt[ct+(3&-_t)]=lt[sbox[ut>>>24]]^ht[sbox[ut>>>16&255]]^ft[sbox[ut>>>8&255]]^dt[sbox[ut&255]];rt=pt}return rt}function _updateBlock$1(et,tt,rt,nt){var it=et.length/4-1,ot,st,at,ct,ut;nt?(ot=imix[0],st=imix[1],at=imix[2],ct=imix[3],ut=isbox):(ot=mix[0],st=mix[1],at=mix[2],ct=mix[3],ut=sbox);var lt,ht,ft,dt,pt,gt,_t;lt=tt[0]^et[0],ht=tt[nt?3:1]^et[1],ft=tt[2]^et[2],dt=tt[nt?1:3]^et[3];for(var mt=3,At=1;At<it;++At)pt=ot[lt>>>24]^st[ht>>>16&255]^at[ft>>>8&255]^ct[dt&255]^et[++mt],gt=ot[ht>>>24]^st[ft>>>16&255]^at[dt>>>8&255]^ct[lt&255]^et[++mt],_t=ot[ft>>>24]^st[dt>>>16&255]^at[lt>>>8&255]^ct[ht&255]^et[++mt],dt=ot[dt>>>24]^st[lt>>>16&255]^at[ht>>>8&255]^ct[ft&255]^et[++mt],lt=pt,ht=gt,ft=_t;rt[0]=ut[lt>>>24]<<24^ut[ht>>>16&255]<<16^ut[ft>>>8&255]<<8^ut[dt&255]^et[++mt],rt[nt?3:1]=ut[ht>>>24]<<24^ut[ft>>>16&255]<<16^ut[dt>>>8&255]<<8^ut[lt&255]^et[++mt],rt[2]=ut[ft>>>24]<<24^ut[dt>>>16&255]<<16^ut[lt>>>8&255]<<8^ut[ht&255]^et[++mt],rt[nt?1:3]=ut[dt>>>24]<<24^ut[lt>>>16&255]<<16^ut[ht>>>8&255]<<8^ut[ft&255]^et[++mt]}function _createCipher$1(et){et=et||{};var tt=(et.mode||"CBC").toUpperCase(),rt="AES-"+tt,nt;et.decrypt?nt=forge$j.cipher.createDecipher(rt,et.key):nt=forge$j.cipher.createCipher(rt,et.key);var it=nt.start;return nt.start=function(ot,st){var at=null;st instanceof forge$j.util.ByteBuffer&&(at=st,st={}),st=st||{},st.output=at,st.iv=ot,it.call(nt,st)},nt}var forge$i=forge$p;forge$i.des=forge$i.des||{},forge$i.des.startEncrypting=function(et,tt,rt,nt){var it=_createCipher({key:et,output:rt,decrypt:!1,mode:nt||(tt===null?"ECB":"CBC")});return it.start(tt),it},forge$i.des.createEncryptionCipher=function(et,tt){return _createCipher({key:et,output:null,decrypt:!1,mode:tt})},forge$i.des.startDecrypting=function(et,tt,rt,nt){var it=_createCipher({key:et,output:rt,decrypt:!0,mode:nt||(tt===null?"ECB":"CBC")});return it.start(tt),it},forge$i.des.createDecryptionCipher=function(et,tt){return _createCipher({key:et,output:null,decrypt:!0,mode:tt})},forge$i.des.Algorithm=function(et,tt){var rt=this;rt.name=et,rt.mode=new tt({blockSize:8,cipher:{encrypt:function(nt,it){return _updateBlock(rt._keys,nt,it,!1)},decrypt:function(nt,it){return _updateBlock(rt._keys,nt,it,!0)}}}),rt._init=!1},forge$i.des.Algorithm.prototype.initialize=function(et){if(!this._init){var tt=forge$i.util.createBuffer(et.key);if(this.name.indexOf("3DES")===0&&tt.length()!==24)throw new Error("Invalid Triple-DES key size: "+tt.length()*8);this._keys=_createKeys(tt),this._init=!0}},registerAlgorithm("DES-ECB",forge$i.cipher.modes.ecb),registerAlgorithm("DES-CBC",forge$i.cipher.modes.cbc),registerAlgorithm("DES-CFB",forge$i.cipher.modes.cfb),registerAlgorithm("DES-OFB",forge$i.cipher.modes.ofb),registerAlgorithm("DES-CTR",forge$i.cipher.modes.ctr),registerAlgorithm("3DES-ECB",forge$i.cipher.modes.ecb),registerAlgorithm("3DES-CBC",forge$i.cipher.modes.cbc),registerAlgorithm("3DES-CFB",forge$i.cipher.modes.cfb),registerAlgorithm("3DES-OFB",forge$i.cipher.modes.ofb),registerAlgorithm("3DES-CTR",forge$i.cipher.modes.ctr);function registerAlgorithm(et,tt){var rt=function(){return new forge$i.des.Algorithm(et,tt)};forge$i.cipher.registerAlgorithm(et,rt)}var spfunction1=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],spfunction2=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],spfunction3=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],spfunction4=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],spfunction5=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],spfunction6=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],spfunction7=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],spfunction8=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function _createKeys(et){for(var tt=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],rt=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],nt=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],it=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],ot=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],st=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],at=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],ct=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],ut=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],lt=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],ht=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],ft=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],dt=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],pt=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],gt=et.length()>8?3:1,_t=[],mt=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],At=0,It,Mt=0;Mt<gt;Mt++){var kt=et.getInt32(),Ct=et.getInt32();It=(kt>>>4^Ct)&252645135,Ct^=It,kt^=It<<4,It=(Ct>>>-16^kt)&65535,kt^=It,Ct^=It<<-16,It=(kt>>>2^Ct)&858993459,Ct^=It,kt^=It<<2,It=(Ct>>>-16^kt)&65535,kt^=It,Ct^=It<<-16,It=(kt>>>1^Ct)&1431655765,Ct^=It,kt^=It<<1,It=(Ct>>>8^kt)&16711935,kt^=It,Ct^=It<<8,It=(kt>>>1^Ct)&1431655765,Ct^=It,kt^=It<<1,It=kt<<8|Ct>>>20&240,kt=Ct<<24|Ct<<8&16711680|Ct>>>8&65280|Ct>>>24&240,Ct=It;for(var Ut=0;Ut<mt.length;++Ut){mt[Ut]?(kt=kt<<2|kt>>>26,Ct=Ct<<2|Ct>>>26):(kt=kt<<1|kt>>>27,Ct=Ct<<1|Ct>>>27),kt&=-15,Ct&=-15;var Wt=tt[kt>>>28]|rt[kt>>>24&15]|nt[kt>>>20&15]|it[kt>>>16&15]|ot[kt>>>12&15]|st[kt>>>8&15]|at[kt>>>4&15],Ft=ct[Ct>>>28]|ut[Ct>>>24&15]|lt[Ct>>>20&15]|ht[Ct>>>16&15]|ft[Ct>>>12&15]|dt[Ct>>>8&15]|pt[Ct>>>4&15];It=(Ft>>>16^Wt)&65535,_t[At++]=Wt^It,_t[At++]=Ft^It<<16}}return _t}function _updateBlock(et,tt,rt,nt){var it=et.length===32?3:9,ot;it===3?ot=nt?[30,-2,-2]:[0,32,2]:ot=nt?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var st,at=tt[0],ct=tt[1];st=(at>>>4^ct)&252645135,ct^=st,at^=st<<4,st=(at>>>16^ct)&65535,ct^=st,at^=st<<16,st=(ct>>>2^at)&858993459,at^=st,ct^=st<<2,st=(ct>>>8^at)&16711935,at^=st,ct^=st<<8,st=(at>>>1^ct)&1431655765,ct^=st,at^=st<<1,at=at<<1|at>>>31,ct=ct<<1|ct>>>31;for(var ut=0;ut<it;ut+=3){for(var lt=ot[ut+1],ht=ot[ut+2],ft=ot[ut];ft!=lt;ft+=ht){var dt=ct^et[ft],pt=(ct>>>4|ct<<28)^et[ft+1];st=at,at=ct,ct=st^(spfunction2[dt>>>24&63]|spfunction4[dt>>>16&63]|spfunction6[dt>>>8&63]|spfunction8[dt&63]|spfunction1[pt>>>24&63]|spfunction3[pt>>>16&63]|spfunction5[pt>>>8&63]|spfunction7[pt&63])}st=at,at=ct,ct=st}at=at>>>1|at<<31,ct=ct>>>1|ct<<31,st=(at>>>1^ct)&1431655765,ct^=st,at^=st<<1,st=(ct>>>8^at)&16711935,at^=st,ct^=st<<8,st=(ct>>>2^at)&858993459,at^=st,ct^=st<<2,st=(at>>>16^ct)&65535,ct^=st,at^=st<<16,st=(at>>>4^ct)&252645135,ct^=st,at^=st<<4,rt[0]=at,rt[1]=ct}function _createCipher(et){et=et||{};var tt=(et.mode||"CBC").toUpperCase(),rt="DES-"+tt,nt;et.decrypt?nt=forge$i.cipher.createDecipher(rt,et.key):nt=forge$i.cipher.createCipher(rt,et.key);var it=nt.start;return nt.start=function(ot,st){var at=null;st instanceof forge$i.util.ByteBuffer&&(at=st,st={}),st=st||{},st.output=at,st.iv=ot,it.call(nt,st)},nt}var forge$h=forge$p;forge$h.md=forge$h.md||{},forge$h.md.algorithms=forge$h.md.algorithms||{};var forge$g=forge$p,hmac=forge$g.hmac=forge$g.hmac||{};hmac.create=function(){var et=null,tt=null,rt=null,nt=null,it={};return it.start=function(ot,st){if(ot!==null)if(typeof ot=="string")if(ot=ot.toLowerCase(),ot in forge$g.md.algorithms)tt=forge$g.md.algorithms[ot].create();else throw new Error('Unknown hash algorithm "'+ot+'"');else tt=ot;if(st===null)st=et;else{if(typeof st=="string")st=forge$g.util.createBuffer(st);else if(forge$g.util.isArray(st)){var at=st;st=forge$g.util.createBuffer();for(var ct=0;ct<at.length;++ct)st.putByte(at[ct])}var ut=st.length();ut>tt.blockLength&&(tt.start(),tt.update(st.bytes()),st=tt.digest()),rt=forge$g.util.createBuffer(),nt=forge$g.util.createBuffer(),ut=st.length();for(var ct=0;ct<ut;++ct){var at=st.at(ct);rt.putByte(54^at),nt.putByte(92^at)}if(ut<tt.blockLength)for(var at=tt.blockLength-ut,ct=0;ct<at;++ct)rt.putByte(54),nt.putByte(92);et=st,rt=rt.bytes(),nt=nt.bytes()}tt.start(),tt.update(rt)},it.update=function(ot){tt.update(ot)},it.getMac=function(){var ot=tt.digest().bytes();return tt.start(),tt.update(nt),tt.update(ot),tt.digest()},it.digest=it.getMac,it};var forge$f=forge$p,pkcs5=forge$f.pkcs5=forge$f.pkcs5||{},crypto$3;forge$f.util.isNodejs&&!forge$f.options.usePureJavaScript&&(crypto$3=require$$0$3),forge$f.pbkdf2=pkcs5.pbkdf2=function(et,tt,rt,nt,it,ot){if(typeof it=="function"&&(ot=it,it=null),forge$f.util.isNodejs&&!forge$f.options.usePureJavaScript&&crypto$3.pbkdf2&&(it===null||typeof it!="object")&&(crypto$3.pbkdf2Sync.length>4||!it||it==="sha1"))return typeof it!="string"&&(it="sha1"),et=Buffer.from(et,"binary"),tt=Buffer.from(tt,"binary"),ot?crypto$3.pbkdf2Sync.length===4?crypto$3.pbkdf2(et,tt,rt,nt,function(It,Mt){if(It)return ot(It);ot(null,Mt.toString("binary"))}):crypto$3.pbkdf2(et,tt,rt,nt,it,function(It,Mt){if(It)return ot(It);ot(null,Mt.toString("binary"))}):crypto$3.pbkdf2Sync.length===4?crypto$3.pbkdf2Sync(et,tt,rt,nt).toString("binary"):crypto$3.pbkdf2Sync(et,tt,rt,nt,it).toString("binary");if((typeof it>"u"||it===null)&&(it="sha1"),typeof it=="string"){if(!(it in forge$f.md.algorithms))throw new Error("Unknown hash algorithm: "+it);it=forge$f.md[it].create()}var st=it.digestLength;if(nt>4294967295*st){var at=new Error("Derived key is too long.");if(ot)return ot(at);throw at}var ct=Math.ceil(nt/st),ut=nt-(ct-1)*st,lt=forge$f.hmac.create();lt.start(it,et);var ht="",ft,dt,pt;if(!ot){for(var gt=1;gt<=ct;++gt){lt.start(null,null),lt.update(tt),lt.update(forge$f.util.int32ToBytes(gt)),ft=pt=lt.digest().getBytes();for(var _t=2;_t<=rt;++_t)lt.start(null,null),lt.update(pt),dt=lt.digest().getBytes(),ft=forge$f.util.xorBytes(ft,dt,st),pt=dt;ht+=gt<ct?ft:ft.substr(0,ut)}return ht}var gt=1,_t;function mt(){if(gt>ct)return ot(null,ht);lt.start(null,null),lt.update(tt),lt.update(forge$f.util.int32ToBytes(gt)),ft=pt=lt.digest().getBytes(),_t=2,At()}function At(){if(_t<=rt)return lt.start(null,null),lt.update(pt),dt=lt.digest().getBytes(),ft=forge$f.util.xorBytes(ft,dt,st),pt=dt,++_t,forge$f.util.setImmediate(At);ht+=gt<ct?ft:ft.substr(0,ut),++gt,mt()}mt()};var forge$e=forge$p,pem=forge$e.pem=forge$e.pem||{};pem.encode=function(et,tt){tt=tt||{};var rt="-----BEGIN "+et.type+`-----\r
`,nt;if(et.procType&&(nt={name:"Proc-Type",values:[String(et.procType.version),et.procType.type]},rt+=foldHeader(nt)),et.contentDomain&&(nt={name:"Content-Domain",values:[et.contentDomain]},rt+=foldHeader(nt)),et.dekInfo&&(nt={name:"DEK-Info",values:[et.dekInfo.algorithm]},et.dekInfo.parameters&&nt.values.push(et.dekInfo.parameters),rt+=foldHeader(nt)),et.headers)for(var it=0;it<et.headers.length;++it)rt+=foldHeader(et.headers[it]);return et.procType&&(rt+=`\r
`),rt+=forge$e.util.encode64(et.body,tt.maxline||64)+`\r
`,rt+="-----END "+et.type+`-----\r
`,rt},pem.decode=function(et){for(var tt=[],rt=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,nt=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,it=/\r?\n/,ot;ot=rt.exec(et),!!ot;){var st=ot[1];st==="NEW CERTIFICATE REQUEST"&&(st="CERTIFICATE REQUEST");var at={type:st,procType:null,contentDomain:null,dekInfo:null,headers:[],body:forge$e.util.decode64(ot[3])};if(tt.push(at),!!ot[2]){for(var ct=ot[2].split(it),ut=0;ot&&ut<ct.length;){for(var lt=ct[ut].replace(/\s+$/,""),ht=ut+1;ht<ct.length;++ht){var ft=ct[ht];if(!/\s/.test(ft[0]))break;lt+=ft,ut=ht}if(ot=lt.match(nt),ot){for(var dt={name:ot[1],values:[]},pt=ot[2].split(","),gt=0;gt<pt.length;++gt)dt.values.push(ltrim(pt[gt]));if(at.procType)if(!at.contentDomain&&dt.name==="Content-Domain")at.contentDomain=pt[0]||"";else if(!at.dekInfo&&dt.name==="DEK-Info"){if(dt.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');at.dekInfo={algorithm:pt[0],parameters:pt[1]||null}}else at.headers.push(dt);else{if(dt.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(dt.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');at.procType={version:pt[0],type:pt[1]}}}++ut}if(at.procType==="ENCRYPTED"&&!at.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(tt.length===0)throw new Error("Invalid PEM formatted message.");return tt};function foldHeader(et){for(var tt=et.name+": ",rt=[],nt=function(ct,ut){return" "+ut},it=0;it<et.values.length;++it)rt.push(et.values[it].replace(/^(\S+\r\n)/,nt));tt+=rt.join(",")+`\r
`;for(var ot=0,st=-1,it=0;it<tt.length;++it,++ot)if(ot>65&&st!==-1){var at=tt[st];at===","?(++st,tt=tt.substr(0,st)+`\r
 `+tt.substr(st)):tt=tt.substr(0,st)+`\r
`+at+tt.substr(st+1),ot=it-st-1,st=-1,++it}else(tt[it]===" "||tt[it]==="	"||tt[it]===",")&&(st=it);return tt}function ltrim(et){return et.replace(/^\s+/,"")}var forge$d=forge$p,sha256$3=forge$d.sha256=forge$d.sha256||{};forge$d.md.sha256=forge$d.md.algorithms.sha256=sha256$3,sha256$3.create=function(){_initialized$2||_init$2();var et=null,tt=forge$d.util.createBuffer(),rt=new Array(64),nt={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return nt.start=function(){nt.messageLength=0,nt.fullMessageLength=nt.messageLength64=[];for(var it=nt.messageLengthSize/4,ot=0;ot<it;++ot)nt.fullMessageLength.push(0);return tt=forge$d.util.createBuffer(),et={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},nt},nt.start(),nt.update=function(it,ot){ot==="utf8"&&(it=forge$d.util.encodeUtf8(it));var st=it.length;nt.messageLength+=st,st=[st/4294967296>>>0,st>>>0];for(var at=nt.fullMessageLength.length-1;at>=0;--at)nt.fullMessageLength[at]+=st[1],st[1]=st[0]+(nt.fullMessageLength[at]/4294967296>>>0),nt.fullMessageLength[at]=nt.fullMessageLength[at]>>>0,st[0]=st[1]/4294967296>>>0;return tt.putBytes(it),_update$2(et,rt,tt),(tt.read>2048||tt.length()===0)&&tt.compact(),nt},nt.digest=function(){var it=forge$d.util.createBuffer();it.putBytes(tt.bytes());var ot=nt.fullMessageLength[nt.fullMessageLength.length-1]+nt.messageLengthSize,st=ot&nt.blockLength-1;it.putBytes(_padding$2.substr(0,nt.blockLength-st));for(var at,ct,ut=nt.fullMessageLength[0]*8,lt=0;lt<nt.fullMessageLength.length-1;++lt)at=nt.fullMessageLength[lt+1]*8,ct=at/4294967296>>>0,ut+=ct,it.putInt32(ut>>>0),ut=at>>>0;it.putInt32(ut);var ht={h0:et.h0,h1:et.h1,h2:et.h2,h3:et.h3,h4:et.h4,h5:et.h5,h6:et.h6,h7:et.h7};_update$2(ht,rt,it);var ft=forge$d.util.createBuffer();return ft.putInt32(ht.h0),ft.putInt32(ht.h1),ft.putInt32(ht.h2),ft.putInt32(ht.h3),ft.putInt32(ht.h4),ft.putInt32(ht.h5),ft.putInt32(ht.h6),ft.putInt32(ht.h7),ft},nt};var _padding$2=null,_initialized$2=!1,_k$1=null;function _init$2(){_padding$2=String.fromCharCode(128),_padding$2+=forge$d.util.fillString(String.fromCharCode(0),64),_k$1=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],_initialized$2=!0}function _update$2(et,tt,rt){for(var nt,it,ot,st,at,ct,ut,lt,ht,ft,dt,pt,gt,_t,mt,At=rt.length();At>=64;){for(ut=0;ut<16;++ut)tt[ut]=rt.getInt32();for(;ut<64;++ut)nt=tt[ut-2],nt=(nt>>>17|nt<<15)^(nt>>>19|nt<<13)^nt>>>10,it=tt[ut-15],it=(it>>>7|it<<25)^(it>>>18|it<<14)^it>>>3,tt[ut]=nt+tt[ut-7]+it+tt[ut-16]|0;for(lt=et.h0,ht=et.h1,ft=et.h2,dt=et.h3,pt=et.h4,gt=et.h5,_t=et.h6,mt=et.h7,ut=0;ut<64;++ut)st=(pt>>>6|pt<<26)^(pt>>>11|pt<<21)^(pt>>>25|pt<<7),at=_t^pt&(gt^_t),ot=(lt>>>2|lt<<30)^(lt>>>13|lt<<19)^(lt>>>22|lt<<10),ct=lt&ht|ft&(lt^ht),nt=mt+st+at+_k$1[ut]+tt[ut],it=ot+ct,mt=_t,_t=gt,gt=pt,pt=dt+nt>>>0,dt=ft,ft=ht,ht=lt,lt=nt+it>>>0;et.h0=et.h0+lt|0,et.h1=et.h1+ht|0,et.h2=et.h2+ft|0,et.h3=et.h3+dt|0,et.h4=et.h4+pt|0,et.h5=et.h5+gt|0,et.h6=et.h6+_t|0,et.h7=et.h7+mt|0,At-=64}}var forge$c=forge$p,_crypto$1=null;forge$c.util.isNodejs&&!forge$c.options.usePureJavaScript&&!process.versions["node-webkit"]&&(_crypto$1=require$$0$3);var prng=forge$c.prng=forge$c.prng||{};prng.create=function(et){for(var tt={plugin:et,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},rt=et.md,nt=new Array(32),it=0;it<32;++it)nt[it]=rt.create();tt.pools=nt,tt.pool=0,tt.generate=function(ut,lt){if(!lt)return tt.generateSync(ut);var ht=tt.plugin.cipher,ft=tt.plugin.increment,dt=tt.plugin.formatKey,pt=tt.plugin.formatSeed,gt=forge$c.util.createBuffer();tt.key=null,_t();function _t(mt){if(mt)return lt(mt);if(gt.length()>=ut)return lt(null,gt.getBytes(ut));if(tt.generated>1048575&&(tt.key=null),tt.key===null)return forge$c.util.nextTick(function(){ot(_t)});var At=ht(tt.key,tt.seed);tt.generated+=At.length,gt.putBytes(At),tt.key=dt(ht(tt.key,ft(tt.seed))),tt.seed=pt(ht(tt.key,tt.seed)),forge$c.util.setImmediate(_t)}},tt.generateSync=function(ut){var lt=tt.plugin.cipher,ht=tt.plugin.increment,ft=tt.plugin.formatKey,dt=tt.plugin.formatSeed;tt.key=null;for(var pt=forge$c.util.createBuffer();pt.length()<ut;){tt.generated>1048575&&(tt.key=null),tt.key===null&&st();var gt=lt(tt.key,tt.seed);tt.generated+=gt.length,pt.putBytes(gt),tt.key=ft(lt(tt.key,ht(tt.seed))),tt.seed=dt(lt(tt.key,tt.seed))}return pt.getBytes(ut)};function ot(ut){if(tt.pools[0].messageLength>=32)return at(),ut();var lt=32-tt.pools[0].messageLength<<5;tt.seedFile(lt,function(ht,ft){if(ht)return ut(ht);tt.collect(ft),at(),ut()})}function st(){if(tt.pools[0].messageLength>=32)return at();var ut=32-tt.pools[0].messageLength<<5;tt.collect(tt.seedFileSync(ut)),at()}function at(){tt.reseeds=tt.reseeds===4294967295?0:tt.reseeds+1;var ut=tt.plugin.md.create();ut.update(tt.keyBytes);for(var lt=1,ht=0;ht<32;++ht)tt.reseeds%lt===0&&(ut.update(tt.pools[ht].digest().getBytes()),tt.pools[ht].start()),lt=lt<<1;tt.keyBytes=ut.digest().getBytes(),ut.start(),ut.update(tt.keyBytes);var ft=ut.digest().getBytes();tt.key=tt.plugin.formatKey(tt.keyBytes),tt.seed=tt.plugin.formatSeed(ft),tt.generated=0}function ct(ut){var lt=null,ht=forge$c.util.globalScope,ft=ht.crypto||ht.msCrypto;ft&&ft.getRandomValues&&(lt=function(kt){return ft.getRandomValues(kt)});var dt=forge$c.util.createBuffer();if(lt)for(;dt.length()<ut;){var pt=Math.max(1,Math.min(ut-dt.length(),65536)/4),gt=new Uint32Array(Math.floor(pt));try{lt(gt);for(var _t=0;_t<gt.length;++_t)dt.putInt32(gt[_t])}catch(kt){if(!(typeof QuotaExceededError<"u"&&kt instanceof QuotaExceededError))throw kt}}if(dt.length()<ut)for(var mt,At,It,Mt=Math.floor(Math.random()*65536);dt.length()<ut;){At=16807*(Mt&65535),mt=16807*(Mt>>16),At+=(mt&32767)<<16,At+=mt>>15,At=(At&2147483647)+(At>>31),Mt=At&4294967295;for(var _t=0;_t<3;++_t)It=Mt>>>(_t<<3),It^=Math.floor(Math.random()*256),dt.putByte(It&255)}return dt.getBytes(ut)}return _crypto$1?(tt.seedFile=function(ut,lt){_crypto$1.randomBytes(ut,function(ht,ft){if(ht)return lt(ht);lt(null,ft.toString())})},tt.seedFileSync=function(ut){return _crypto$1.randomBytes(ut).toString()}):(tt.seedFile=function(ut,lt){try{lt(null,ct(ut))}catch(ht){lt(ht)}},tt.seedFileSync=ct),tt.collect=function(ut){for(var lt=ut.length,ht=0;ht<lt;++ht)tt.pools[tt.pool].update(ut.substr(ht,1)),tt.pool=tt.pool===31?0:tt.pool+1},tt.collectInt=function(ut,lt){for(var ht="",ft=0;ft<lt;ft+=8)ht+=String.fromCharCode(ut>>ft&255);tt.collect(ht)},tt.registerWorker=function(ut){if(ut===self)tt.seedFile=function(ht,ft){function dt(pt){var gt=pt.data;gt.forge&&gt.forge.prng&&(self.removeEventListener("message",dt),ft(gt.forge.prng.err,gt.forge.prng.bytes))}self.addEventListener("message",dt),self.postMessage({forge:{prng:{needed:ht}}})};else{var lt=function(ht){var ft=ht.data;ft.forge&&ft.forge.prng&&tt.seedFile(ft.forge.prng.needed,function(dt,pt){ut.postMessage({forge:{prng:{err:dt,bytes:pt}}})})};ut.addEventListener("message",lt)}},tt};var forge$b=forge$p;(function(){if(forge$b.random&&forge$b.random.getBytes){forge$b.random;return}(function(et){var tt={},rt=new Array(4),nt=forge$b.util.createBuffer();tt.formatKey=function(ht){var ft=forge$b.util.createBuffer(ht);return ht=new Array(4),ht[0]=ft.getInt32(),ht[1]=ft.getInt32(),ht[2]=ft.getInt32(),ht[3]=ft.getInt32(),forge$b.aes._expandKey(ht,!1)},tt.formatSeed=function(ht){var ft=forge$b.util.createBuffer(ht);return ht=new Array(4),ht[0]=ft.getInt32(),ht[1]=ft.getInt32(),ht[2]=ft.getInt32(),ht[3]=ft.getInt32(),ht},tt.cipher=function(ht,ft){return forge$b.aes._updateBlock(ht,ft,rt,!1),nt.putInt32(rt[0]),nt.putInt32(rt[1]),nt.putInt32(rt[2]),nt.putInt32(rt[3]),nt.getBytes()},tt.increment=function(ht){return++ht[3],ht},tt.md=forge$b.md.sha256;function it(){var ht=forge$b.prng.create(tt);return ht.getBytes=function(ft,dt){return ht.generate(ft,dt)},ht.getBytesSync=function(ft){return ht.generate(ft)},ht}var ot=it(),st=null,at=forge$b.util.globalScope,ct=at.crypto||at.msCrypto;if(ct&&ct.getRandomValues&&(st=function(ht){return ct.getRandomValues(ht)}),forge$b.options.usePureJavaScript||!forge$b.util.isNodejs&&!st){if(ot.collectInt(+new Date,32),typeof navigator<"u"){var ut="";for(var lt in navigator)try{typeof navigator[lt]=="string"&&(ut+=navigator[lt])}catch{}ot.collect(ut),ut=null}et&&(et().mousemove(function(ht){ot.collectInt(ht.clientX,16),ot.collectInt(ht.clientY,16)}),et().keypress(function(ht){ot.collectInt(ht.charCode,8)}))}if(!forge$b.random)forge$b.random=ot;else for(var lt in ot)forge$b.random[lt]=ot[lt];forge$b.random.createInstance=it,forge$b.random})(typeof jQuery<"u"?jQuery:null)})();var forge$a=forge$p,piTable=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],s=[1,2,3,5],rol=function(et,tt){return et<<tt&65535|(et&65535)>>16-tt},ror=function(et,tt){return(et&65535)>>tt|et<<16-tt&65535};forge$a.rc2=forge$a.rc2||{},forge$a.rc2.expandKey=function(et,tt){typeof et=="string"&&(et=forge$a.util.createBuffer(et)),tt=tt||128;var rt=et,nt=et.length(),it=tt,ot=Math.ceil(it/8),st=255>>(it&7),at;for(at=nt;at<128;at++)rt.putByte(piTable[rt.at(at-1)+rt.at(at-nt)&255]);for(rt.setAt(128-ot,piTable[rt.at(128-ot)&st]),at=127-ot;at>=0;at--)rt.setAt(at,piTable[rt.at(at+1)^rt.at(at+ot)]);return rt};var createCipher=function(et,tt,rt){var nt=!1,it=null,ot=null,st=null,at,ct,ut,lt,ht=[];for(et=forge$a.rc2.expandKey(et,tt),ut=0;ut<64;ut++)ht.push(et.getInt16Le());rt?(at=function(pt){for(ut=0;ut<4;ut++)pt[ut]+=ht[lt]+(pt[(ut+3)%4]&pt[(ut+2)%4])+(~pt[(ut+3)%4]&pt[(ut+1)%4]),pt[ut]=rol(pt[ut],s[ut]),lt++},ct=function(pt){for(ut=0;ut<4;ut++)pt[ut]+=ht[pt[(ut+3)%4]&63]}):(at=function(pt){for(ut=3;ut>=0;ut--)pt[ut]=ror(pt[ut],s[ut]),pt[ut]-=ht[lt]+(pt[(ut+3)%4]&pt[(ut+2)%4])+(~pt[(ut+3)%4]&pt[(ut+1)%4]),lt--},ct=function(pt){for(ut=3;ut>=0;ut--)pt[ut]-=ht[pt[(ut+3)%4]&63]});var ft=function(pt){var gt=[];for(ut=0;ut<4;ut++){var _t=it.getInt16Le();st!==null&&(rt?_t^=st.getInt16Le():st.putInt16Le(_t)),gt.push(_t&65535)}lt=rt?0:63;for(var mt=0;mt<pt.length;mt++)for(var At=0;At<pt[mt][0];At++)pt[mt][1](gt);for(ut=0;ut<4;ut++)st!==null&&(rt?st.putInt16Le(gt[ut]):gt[ut]^=st.getInt16Le()),ot.putInt16Le(gt[ut])},dt=null;return dt={start:function(pt,gt){pt&&typeof pt=="string"&&(pt=forge$a.util.createBuffer(pt)),nt=!1,it=forge$a.util.createBuffer(),ot=gt||new forge$a.util.createBuffer,st=pt,dt.output=ot},update:function(pt){for(nt||it.putBuffer(pt);it.length()>=8;)ft([[5,at],[1,ct],[6,at],[1,ct],[5,at]])},finish:function(pt){var gt=!0;if(rt)if(pt)gt=pt(8,it,!rt);else{var _t=it.length()===8?8:8-it.length();it.fillWithByte(_t,_t)}if(gt&&(nt=!0,dt.update()),!rt&&(gt=it.length()===0,gt))if(pt)gt=pt(8,ot,!rt);else{var mt=ot.length(),At=ot.at(mt-1);At>mt?gt=!1:ot.truncate(At)}return gt}},dt};forge$a.rc2.startEncrypting=function(et,tt,rt){var nt=forge$a.rc2.createEncryptionCipher(et,128);return nt.start(tt,rt),nt},forge$a.rc2.createEncryptionCipher=function(et,tt){return createCipher(et,tt,!0)},forge$a.rc2.startDecrypting=function(et,tt,rt){var nt=forge$a.rc2.createDecryptionCipher(et,128);return nt.start(tt,rt),nt},forge$a.rc2.createDecryptionCipher=function(et,tt){return createCipher(et,tt,!1)};var forge$9=forge$p;forge$9.jsbn=forge$9.jsbn||{};var dbits;function BigInteger$2(et,tt,rt){this.data=[],et!=null&&(typeof et=="number"?this.fromNumber(et,tt,rt):tt==null&&typeof et!="string"?this.fromString(et,256):this.fromString(et,tt))}forge$9.jsbn.BigInteger=BigInteger$2;function nbi(){return new BigInteger$2(null)}function am1(et,tt,rt,nt,it,ot){for(;--ot>=0;){var st=tt*this.data[et++]+rt.data[nt]+it;it=Math.floor(st/67108864),rt.data[nt++]=st&67108863}return it}function am2(et,tt,rt,nt,it,ot){for(var st=tt&32767,at=tt>>15;--ot>=0;){var ct=this.data[et]&32767,ut=this.data[et++]>>15,lt=at*ct+ut*st;ct=st*ct+((lt&32767)<<15)+rt.data[nt]+(it&1073741823),it=(ct>>>30)+(lt>>>15)+at*ut+(it>>>30),rt.data[nt++]=ct&1073741823}return it}function am3(et,tt,rt,nt,it,ot){for(var st=tt&16383,at=tt>>14;--ot>=0;){var ct=this.data[et]&16383,ut=this.data[et++]>>14,lt=at*ct+ut*st;ct=st*ct+((lt&16383)<<14)+rt.data[nt]+it,it=(ct>>28)+(lt>>14)+at*ut,rt.data[nt++]=ct&268435455}return it}typeof navigator>"u"?(BigInteger$2.prototype.am=am3,dbits=28):navigator.appName=="Microsoft Internet Explorer"?(BigInteger$2.prototype.am=am2,dbits=30):navigator.appName!="Netscape"?(BigInteger$2.prototype.am=am1,dbits=26):(BigInteger$2.prototype.am=am3,dbits=28),BigInteger$2.prototype.DB=dbits,BigInteger$2.prototype.DM=(1<<dbits)-1,BigInteger$2.prototype.DV=1<<dbits;var BI_FP=52;BigInteger$2.prototype.FV=Math.pow(2,BI_FP),BigInteger$2.prototype.F1=BI_FP-dbits,BigInteger$2.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=new Array,rr,vv;for(rr="0".charCodeAt(0),vv=0;vv<=9;++vv)BI_RC[rr++]=vv;for(rr="a".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;for(rr="A".charCodeAt(0),vv=10;vv<36;++vv)BI_RC[rr++]=vv;function int2char(et){return BI_RM.charAt(et)}function intAt(et,tt){var rt=BI_RC[et.charCodeAt(tt)];return rt??-1}function bnpCopyTo(et){for(var tt=this.t-1;tt>=0;--tt)et.data[tt]=this.data[tt];et.t=this.t,et.s=this.s}function bnpFromInt(et){this.t=1,this.s=et<0?-1:0,et>0?this.data[0]=et:et<-1?this.data[0]=et+this.DV:this.t=0}function nbv(et){var tt=nbi();return tt.fromInt(et),tt}function bnpFromString(et,tt){var rt;if(tt==16)rt=4;else if(tt==8)rt=3;else if(tt==256)rt=8;else if(tt==2)rt=1;else if(tt==32)rt=5;else if(tt==4)rt=2;else{this.fromRadix(et,tt);return}this.t=0,this.s=0;for(var nt=et.length,it=!1,ot=0;--nt>=0;){var st=rt==8?et[nt]&255:intAt(et,nt);if(st<0){et.charAt(nt)=="-"&&(it=!0);continue}it=!1,ot==0?this.data[this.t++]=st:ot+rt>this.DB?(this.data[this.t-1]|=(st&(1<<this.DB-ot)-1)<<ot,this.data[this.t++]=st>>this.DB-ot):this.data[this.t-1]|=st<<ot,ot+=rt,ot>=this.DB&&(ot-=this.DB)}rt==8&&et[0]&128&&(this.s=-1,ot>0&&(this.data[this.t-1]|=(1<<this.DB-ot)-1<<ot)),this.clamp(),it&&BigInteger$2.ZERO.subTo(this,this)}function bnpClamp(){for(var et=this.s&this.DM;this.t>0&&this.data[this.t-1]==et;)--this.t}function bnToString(et){if(this.s<0)return"-"+this.negate().toString(et);var tt;if(et==16)tt=4;else if(et==8)tt=3;else if(et==2)tt=1;else if(et==32)tt=5;else if(et==4)tt=2;else return this.toRadix(et);var rt=(1<<tt)-1,nt,it=!1,ot="",st=this.t,at=this.DB-st*this.DB%tt;if(st-- >0)for(at<this.DB&&(nt=this.data[st]>>at)>0&&(it=!0,ot=int2char(nt));st>=0;)at<tt?(nt=(this.data[st]&(1<<at)-1)<<tt-at,nt|=this.data[--st]>>(at+=this.DB-tt)):(nt=this.data[st]>>(at-=tt)&rt,at<=0&&(at+=this.DB,--st)),nt>0&&(it=!0),it&&(ot+=int2char(nt));return it?ot:"0"}function bnNegate(){var et=nbi();return BigInteger$2.ZERO.subTo(this,et),et}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(et){var tt=this.s-et.s;if(tt!=0)return tt;var rt=this.t;if(tt=rt-et.t,tt!=0)return this.s<0?-tt:tt;for(;--rt>=0;)if((tt=this.data[rt]-et.data[rt])!=0)return tt;return 0}function nbits(et){var tt=1,rt;return(rt=et>>>16)!=0&&(et=rt,tt+=16),(rt=et>>8)!=0&&(et=rt,tt+=8),(rt=et>>4)!=0&&(et=rt,tt+=4),(rt=et>>2)!=0&&(et=rt,tt+=2),(rt=et>>1)!=0&&(et=rt,tt+=1),tt}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this.data[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(et,tt){var rt;for(rt=this.t-1;rt>=0;--rt)tt.data[rt+et]=this.data[rt];for(rt=et-1;rt>=0;--rt)tt.data[rt]=0;tt.t=this.t+et,tt.s=this.s}function bnpDRShiftTo(et,tt){for(var rt=et;rt<this.t;++rt)tt.data[rt-et]=this.data[rt];tt.t=Math.max(this.t-et,0),tt.s=this.s}function bnpLShiftTo(et,tt){var rt=et%this.DB,nt=this.DB-rt,it=(1<<nt)-1,ot=Math.floor(et/this.DB),st=this.s<<rt&this.DM,at;for(at=this.t-1;at>=0;--at)tt.data[at+ot+1]=this.data[at]>>nt|st,st=(this.data[at]&it)<<rt;for(at=ot-1;at>=0;--at)tt.data[at]=0;tt.data[ot]=st,tt.t=this.t+ot+1,tt.s=this.s,tt.clamp()}function bnpRShiftTo(et,tt){tt.s=this.s;var rt=Math.floor(et/this.DB);if(rt>=this.t){tt.t=0;return}var nt=et%this.DB,it=this.DB-nt,ot=(1<<nt)-1;tt.data[0]=this.data[rt]>>nt;for(var st=rt+1;st<this.t;++st)tt.data[st-rt-1]|=(this.data[st]&ot)<<it,tt.data[st-rt]=this.data[st]>>nt;nt>0&&(tt.data[this.t-rt-1]|=(this.s&ot)<<it),tt.t=this.t-rt,tt.clamp()}function bnpSubTo(et,tt){for(var rt=0,nt=0,it=Math.min(et.t,this.t);rt<it;)nt+=this.data[rt]-et.data[rt],tt.data[rt++]=nt&this.DM,nt>>=this.DB;if(et.t<this.t){for(nt-=et.s;rt<this.t;)nt+=this.data[rt],tt.data[rt++]=nt&this.DM,nt>>=this.DB;nt+=this.s}else{for(nt+=this.s;rt<et.t;)nt-=et.data[rt],tt.data[rt++]=nt&this.DM,nt>>=this.DB;nt-=et.s}tt.s=nt<0?-1:0,nt<-1?tt.data[rt++]=this.DV+nt:nt>0&&(tt.data[rt++]=nt),tt.t=rt,tt.clamp()}function bnpMultiplyTo(et,tt){var rt=this.abs(),nt=et.abs(),it=rt.t;for(tt.t=it+nt.t;--it>=0;)tt.data[it]=0;for(it=0;it<nt.t;++it)tt.data[it+rt.t]=rt.am(0,nt.data[it],tt,it,0,rt.t);tt.s=0,tt.clamp(),this.s!=et.s&&BigInteger$2.ZERO.subTo(tt,tt)}function bnpSquareTo(et){for(var tt=this.abs(),rt=et.t=2*tt.t;--rt>=0;)et.data[rt]=0;for(rt=0;rt<tt.t-1;++rt){var nt=tt.am(rt,tt.data[rt],et,2*rt,0,1);(et.data[rt+tt.t]+=tt.am(rt+1,2*tt.data[rt],et,2*rt+1,nt,tt.t-rt-1))>=tt.DV&&(et.data[rt+tt.t]-=tt.DV,et.data[rt+tt.t+1]=1)}et.t>0&&(et.data[et.t-1]+=tt.am(rt,tt.data[rt],et,2*rt,0,1)),et.s=0,et.clamp()}function bnpDivRemTo(et,tt,rt){var nt=et.abs();if(!(nt.t<=0)){var it=this.abs();if(it.t<nt.t){tt==null||tt.fromInt(0),rt!=null&&this.copyTo(rt);return}rt==null&&(rt=nbi());var ot=nbi(),st=this.s,at=et.s,ct=this.DB-nbits(nt.data[nt.t-1]);ct>0?(nt.lShiftTo(ct,ot),it.lShiftTo(ct,rt)):(nt.copyTo(ot),it.copyTo(rt));var ut=ot.t,lt=ot.data[ut-1];if(lt!=0){var ht=lt*(1<<this.F1)+(ut>1?ot.data[ut-2]>>this.F2:0),ft=this.FV/ht,dt=(1<<this.F1)/ht,pt=1<<this.F2,gt=rt.t,_t=gt-ut,mt=tt??nbi();for(ot.dlShiftTo(_t,mt),rt.compareTo(mt)>=0&&(rt.data[rt.t++]=1,rt.subTo(mt,rt)),BigInteger$2.ONE.dlShiftTo(ut,mt),mt.subTo(ot,ot);ot.t<ut;)ot.data[ot.t++]=0;for(;--_t>=0;){var At=rt.data[--gt]==lt?this.DM:Math.floor(rt.data[gt]*ft+(rt.data[gt-1]+pt)*dt);if((rt.data[gt]+=ot.am(0,At,rt,_t,0,ut))<At)for(ot.dlShiftTo(_t,mt),rt.subTo(mt,rt);rt.data[gt]<--At;)rt.subTo(mt,rt)}tt!=null&&(rt.drShiftTo(ut,tt),st!=at&&BigInteger$2.ZERO.subTo(tt,tt)),rt.t=ut,rt.clamp(),ct>0&&rt.rShiftTo(ct,rt),st<0&&BigInteger$2.ZERO.subTo(rt,rt)}}}function bnMod(et){var tt=nbi();return this.abs().divRemTo(et,null,tt),this.s<0&&tt.compareTo(BigInteger$2.ZERO)>0&&et.subTo(tt,tt),tt}function Classic(et){this.m=et}function cConvert(et){return et.s<0||et.compareTo(this.m)>=0?et.mod(this.m):et}function cRevert(et){return et}function cReduce(et){et.divRemTo(this.m,null,et)}function cMulTo(et,tt,rt){et.multiplyTo(tt,rt),this.reduce(rt)}function cSqrTo(et,tt){et.squareTo(tt),this.reduce(tt)}Classic.prototype.convert=cConvert,Classic.prototype.revert=cRevert,Classic.prototype.reduce=cReduce,Classic.prototype.mulTo=cMulTo,Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(this.t<1)return 0;var et=this.data[0];if(!(et&1))return 0;var tt=et&3;return tt=tt*(2-(et&15)*tt)&15,tt=tt*(2-(et&255)*tt)&255,tt=tt*(2-((et&65535)*tt&65535))&65535,tt=tt*(2-et*tt%this.DV)%this.DV,tt>0?this.DV-tt:-tt}function Montgomery(et){this.m=et,this.mp=et.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<et.DB-15)-1,this.mt2=2*et.t}function montConvert(et){var tt=nbi();return et.abs().dlShiftTo(this.m.t,tt),tt.divRemTo(this.m,null,tt),et.s<0&&tt.compareTo(BigInteger$2.ZERO)>0&&this.m.subTo(tt,tt),tt}function montRevert(et){var tt=nbi();return et.copyTo(tt),this.reduce(tt),tt}function montReduce(et){for(;et.t<=this.mt2;)et.data[et.t++]=0;for(var tt=0;tt<this.m.t;++tt){var rt=et.data[tt]&32767,nt=rt*this.mpl+((rt*this.mph+(et.data[tt]>>15)*this.mpl&this.um)<<15)&et.DM;for(rt=tt+this.m.t,et.data[rt]+=this.m.am(0,nt,et,tt,0,this.m.t);et.data[rt]>=et.DV;)et.data[rt]-=et.DV,et.data[++rt]++}et.clamp(),et.drShiftTo(this.m.t,et),et.compareTo(this.m)>=0&&et.subTo(this.m,et)}function montSqrTo(et,tt){et.squareTo(tt),this.reduce(tt)}function montMulTo(et,tt,rt){et.multiplyTo(tt,rt),this.reduce(rt)}Montgomery.prototype.convert=montConvert,Montgomery.prototype.revert=montRevert,Montgomery.prototype.reduce=montReduce,Montgomery.prototype.mulTo=montMulTo,Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return(this.t>0?this.data[0]&1:this.s)==0}function bnpExp(et,tt){if(et>4294967295||et<1)return BigInteger$2.ONE;var rt=nbi(),nt=nbi(),it=tt.convert(this),ot=nbits(et)-1;for(it.copyTo(rt);--ot>=0;)if(tt.sqrTo(rt,nt),(et&1<<ot)>0)tt.mulTo(nt,it,rt);else{var st=rt;rt=nt,nt=st}return tt.revert(rt)}function bnModPowInt(et,tt){var rt;return et<256||tt.isEven()?rt=new Classic(tt):rt=new Montgomery(tt),this.exp(et,rt)}BigInteger$2.prototype.copyTo=bnpCopyTo,BigInteger$2.prototype.fromInt=bnpFromInt,BigInteger$2.prototype.fromString=bnpFromString,BigInteger$2.prototype.clamp=bnpClamp,BigInteger$2.prototype.dlShiftTo=bnpDLShiftTo,BigInteger$2.prototype.drShiftTo=bnpDRShiftTo,BigInteger$2.prototype.lShiftTo=bnpLShiftTo,BigInteger$2.prototype.rShiftTo=bnpRShiftTo,BigInteger$2.prototype.subTo=bnpSubTo,BigInteger$2.prototype.multiplyTo=bnpMultiplyTo,BigInteger$2.prototype.squareTo=bnpSquareTo,BigInteger$2.prototype.divRemTo=bnpDivRemTo,BigInteger$2.prototype.invDigit=bnpInvDigit,BigInteger$2.prototype.isEven=bnpIsEven,BigInteger$2.prototype.exp=bnpExp,BigInteger$2.prototype.toString=bnToString,BigInteger$2.prototype.negate=bnNegate,BigInteger$2.prototype.abs=bnAbs,BigInteger$2.prototype.compareTo=bnCompareTo,BigInteger$2.prototype.bitLength=bnBitLength,BigInteger$2.prototype.mod=bnMod,BigInteger$2.prototype.modPowInt=bnModPowInt,BigInteger$2.ZERO=nbv(0),BigInteger$2.ONE=nbv(1);function bnClone(){var et=nbi();return this.copyTo(et),et}function bnIntValue(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function bnByteValue(){return this.t==0?this.s:this.data[0]<<24>>24}function bnShortValue(){return this.t==0?this.s:this.data[0]<<16>>16}function bnpChunkSize(et){return Math.floor(Math.LN2*this.DB/Math.log(et))}function bnSigNum(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function bnpToRadix(et){if(et==null&&(et=10),this.signum()==0||et<2||et>36)return"0";var tt=this.chunkSize(et),rt=Math.pow(et,tt),nt=nbv(rt),it=nbi(),ot=nbi(),st="";for(this.divRemTo(nt,it,ot);it.signum()>0;)st=(rt+ot.intValue()).toString(et).substr(1)+st,it.divRemTo(nt,it,ot);return ot.intValue().toString(et)+st}function bnpFromRadix(et,tt){this.fromInt(0),tt==null&&(tt=10);for(var rt=this.chunkSize(tt),nt=Math.pow(tt,rt),it=!1,ot=0,st=0,at=0;at<et.length;++at){var ct=intAt(et,at);if(ct<0){et.charAt(at)=="-"&&this.signum()==0&&(it=!0);continue}st=tt*st+ct,++ot>=rt&&(this.dMultiply(nt),this.dAddOffset(st,0),ot=0,st=0)}ot>0&&(this.dMultiply(Math.pow(tt,ot)),this.dAddOffset(st,0)),it&&BigInteger$2.ZERO.subTo(this,this)}function bnpFromNumber(et,tt,rt){if(typeof tt=="number")if(et<2)this.fromInt(1);else for(this.fromNumber(et,rt),this.testBit(et-1)||this.bitwiseTo(BigInteger$2.ONE.shiftLeft(et-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(tt);)this.dAddOffset(2,0),this.bitLength()>et&&this.subTo(BigInteger$2.ONE.shiftLeft(et-1),this);else{var nt=new Array,it=et&7;nt.length=(et>>3)+1,tt.nextBytes(nt),it>0?nt[0]&=(1<<it)-1:nt[0]=0,this.fromString(nt,256)}}function bnToByteArray(){var et=this.t,tt=new Array;tt[0]=this.s;var rt=this.DB-et*this.DB%8,nt,it=0;if(et-- >0)for(rt<this.DB&&(nt=this.data[et]>>rt)!=(this.s&this.DM)>>rt&&(tt[it++]=nt|this.s<<this.DB-rt);et>=0;)rt<8?(nt=(this.data[et]&(1<<rt)-1)<<8-rt,nt|=this.data[--et]>>(rt+=this.DB-8)):(nt=this.data[et]>>(rt-=8)&255,rt<=0&&(rt+=this.DB,--et)),nt&128&&(nt|=-256),it==0&&(this.s&128)!=(nt&128)&&++it,(it>0||nt!=this.s)&&(tt[it++]=nt);return tt}function bnEquals(et){return this.compareTo(et)==0}function bnMin(et){return this.compareTo(et)<0?this:et}function bnMax(et){return this.compareTo(et)>0?this:et}function bnpBitwiseTo(et,tt,rt){var nt,it,ot=Math.min(et.t,this.t);for(nt=0;nt<ot;++nt)rt.data[nt]=tt(this.data[nt],et.data[nt]);if(et.t<this.t){for(it=et.s&this.DM,nt=ot;nt<this.t;++nt)rt.data[nt]=tt(this.data[nt],it);rt.t=this.t}else{for(it=this.s&this.DM,nt=ot;nt<et.t;++nt)rt.data[nt]=tt(it,et.data[nt]);rt.t=et.t}rt.s=tt(this.s,et.s),rt.clamp()}function op_and(et,tt){return et&tt}function bnAnd(et){var tt=nbi();return this.bitwiseTo(et,op_and,tt),tt}function op_or(et,tt){return et|tt}function bnOr(et){var tt=nbi();return this.bitwiseTo(et,op_or,tt),tt}function op_xor(et,tt){return et^tt}function bnXor(et){var tt=nbi();return this.bitwiseTo(et,op_xor,tt),tt}function op_andnot(et,tt){return et&~tt}function bnAndNot(et){var tt=nbi();return this.bitwiseTo(et,op_andnot,tt),tt}function bnNot(){for(var et=nbi(),tt=0;tt<this.t;++tt)et.data[tt]=this.DM&~this.data[tt];return et.t=this.t,et.s=~this.s,et}function bnShiftLeft(et){var tt=nbi();return et<0?this.rShiftTo(-et,tt):this.lShiftTo(et,tt),tt}function bnShiftRight(et){var tt=nbi();return et<0?this.lShiftTo(-et,tt):this.rShiftTo(et,tt),tt}function lbit(et){if(et==0)return-1;var tt=0;return et&65535||(et>>=16,tt+=16),et&255||(et>>=8,tt+=8),et&15||(et>>=4,tt+=4),et&3||(et>>=2,tt+=2),et&1||++tt,tt}function bnGetLowestSetBit(){for(var et=0;et<this.t;++et)if(this.data[et]!=0)return et*this.DB+lbit(this.data[et]);return this.s<0?this.t*this.DB:-1}function cbit(et){for(var tt=0;et!=0;)et&=et-1,++tt;return tt}function bnBitCount(){for(var et=0,tt=this.s&this.DM,rt=0;rt<this.t;++rt)et+=cbit(this.data[rt]^tt);return et}function bnTestBit(et){var tt=Math.floor(et/this.DB);return tt>=this.t?this.s!=0:(this.data[tt]&1<<et%this.DB)!=0}function bnpChangeBit(et,tt){var rt=BigInteger$2.ONE.shiftLeft(et);return this.bitwiseTo(rt,tt,rt),rt}function bnSetBit(et){return this.changeBit(et,op_or)}function bnClearBit(et){return this.changeBit(et,op_andnot)}function bnFlipBit(et){return this.changeBit(et,op_xor)}function bnpAddTo(et,tt){for(var rt=0,nt=0,it=Math.min(et.t,this.t);rt<it;)nt+=this.data[rt]+et.data[rt],tt.data[rt++]=nt&this.DM,nt>>=this.DB;if(et.t<this.t){for(nt+=et.s;rt<this.t;)nt+=this.data[rt],tt.data[rt++]=nt&this.DM,nt>>=this.DB;nt+=this.s}else{for(nt+=this.s;rt<et.t;)nt+=et.data[rt],tt.data[rt++]=nt&this.DM,nt>>=this.DB;nt+=et.s}tt.s=nt<0?-1:0,nt>0?tt.data[rt++]=nt:nt<-1&&(tt.data[rt++]=this.DV+nt),tt.t=rt,tt.clamp()}function bnAdd(et){var tt=nbi();return this.addTo(et,tt),tt}function bnSubtract(et){var tt=nbi();return this.subTo(et,tt),tt}function bnMultiply(et){var tt=nbi();return this.multiplyTo(et,tt),tt}function bnDivide(et){var tt=nbi();return this.divRemTo(et,tt,null),tt}function bnRemainder(et){var tt=nbi();return this.divRemTo(et,null,tt),tt}function bnDivideAndRemainder(et){var tt=nbi(),rt=nbi();return this.divRemTo(et,tt,rt),new Array(tt,rt)}function bnpDMultiply(et){this.data[this.t]=this.am(0,et-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(et,tt){if(et!=0){for(;this.t<=tt;)this.data[this.t++]=0;for(this.data[tt]+=et;this.data[tt]>=this.DV;)this.data[tt]-=this.DV,++tt>=this.t&&(this.data[this.t++]=0),++this.data[tt]}}function NullExp(){}function nNop(et){return et}function nMulTo(et,tt,rt){et.multiplyTo(tt,rt)}function nSqrTo(et,tt){et.squareTo(tt)}NullExp.prototype.convert=nNop,NullExp.prototype.revert=nNop,NullExp.prototype.mulTo=nMulTo,NullExp.prototype.sqrTo=nSqrTo;function bnPow(et){return this.exp(et,new NullExp)}function bnpMultiplyLowerTo(et,tt,rt){var nt=Math.min(this.t+et.t,tt);for(rt.s=0,rt.t=nt;nt>0;)rt.data[--nt]=0;var it;for(it=rt.t-this.t;nt<it;++nt)rt.data[nt+this.t]=this.am(0,et.data[nt],rt,nt,0,this.t);for(it=Math.min(et.t,tt);nt<it;++nt)this.am(0,et.data[nt],rt,nt,0,tt-nt);rt.clamp()}function bnpMultiplyUpperTo(et,tt,rt){--tt;var nt=rt.t=this.t+et.t-tt;for(rt.s=0;--nt>=0;)rt.data[nt]=0;for(nt=Math.max(tt-this.t,0);nt<et.t;++nt)rt.data[this.t+nt-tt]=this.am(tt-nt,et.data[nt],rt,0,0,this.t+nt-tt);rt.clamp(),rt.drShiftTo(1,rt)}function Barrett(et){this.r2=nbi(),this.q3=nbi(),BigInteger$2.ONE.dlShiftTo(2*et.t,this.r2),this.mu=this.r2.divide(et),this.m=et}function barrettConvert(et){if(et.s<0||et.t>2*this.m.t)return et.mod(this.m);if(et.compareTo(this.m)<0)return et;var tt=nbi();return et.copyTo(tt),this.reduce(tt),tt}function barrettRevert(et){return et}function barrettReduce(et){for(et.drShiftTo(this.m.t-1,this.r2),et.t>this.m.t+1&&(et.t=this.m.t+1,et.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);et.compareTo(this.r2)<0;)et.dAddOffset(1,this.m.t+1);for(et.subTo(this.r2,et);et.compareTo(this.m)>=0;)et.subTo(this.m,et)}function barrettSqrTo(et,tt){et.squareTo(tt),this.reduce(tt)}function barrettMulTo(et,tt,rt){et.multiplyTo(tt,rt),this.reduce(rt)}Barrett.prototype.convert=barrettConvert,Barrett.prototype.revert=barrettRevert,Barrett.prototype.reduce=barrettReduce,Barrett.prototype.mulTo=barrettMulTo,Barrett.prototype.sqrTo=barrettSqrTo;function bnModPow(et,tt){var rt=et.bitLength(),nt,it=nbv(1),ot;if(rt<=0)return it;rt<18?nt=1:rt<48?nt=3:rt<144?nt=4:rt<768?nt=5:nt=6,rt<8?ot=new Classic(tt):tt.isEven()?ot=new Barrett(tt):ot=new Montgomery(tt);var st=new Array,at=3,ct=nt-1,ut=(1<<nt)-1;if(st[1]=ot.convert(this),nt>1){var lt=nbi();for(ot.sqrTo(st[1],lt);at<=ut;)st[at]=nbi(),ot.mulTo(lt,st[at-2],st[at]),at+=2}var ht=et.t-1,ft,dt=!0,pt=nbi(),gt;for(rt=nbits(et.data[ht])-1;ht>=0;){for(rt>=ct?ft=et.data[ht]>>rt-ct&ut:(ft=(et.data[ht]&(1<<rt+1)-1)<<ct-rt,ht>0&&(ft|=et.data[ht-1]>>this.DB+rt-ct)),at=nt;!(ft&1);)ft>>=1,--at;if((rt-=at)<0&&(rt+=this.DB,--ht),dt)st[ft].copyTo(it),dt=!1;else{for(;at>1;)ot.sqrTo(it,pt),ot.sqrTo(pt,it),at-=2;at>0?ot.sqrTo(it,pt):(gt=it,it=pt,pt=gt),ot.mulTo(pt,st[ft],it)}for(;ht>=0&&!(et.data[ht]&1<<rt);)ot.sqrTo(it,pt),gt=it,it=pt,pt=gt,--rt<0&&(rt=this.DB-1,--ht)}return ot.revert(it)}function bnGCD(et){var tt=this.s<0?this.negate():this.clone(),rt=et.s<0?et.negate():et.clone();if(tt.compareTo(rt)<0){var nt=tt;tt=rt,rt=nt}var it=tt.getLowestSetBit(),ot=rt.getLowestSetBit();if(ot<0)return tt;for(it<ot&&(ot=it),ot>0&&(tt.rShiftTo(ot,tt),rt.rShiftTo(ot,rt));tt.signum()>0;)(it=tt.getLowestSetBit())>0&&tt.rShiftTo(it,tt),(it=rt.getLowestSetBit())>0&&rt.rShiftTo(it,rt),tt.compareTo(rt)>=0?(tt.subTo(rt,tt),tt.rShiftTo(1,tt)):(rt.subTo(tt,rt),rt.rShiftTo(1,rt));return ot>0&&rt.lShiftTo(ot,rt),rt}function bnpModInt(et){if(et<=0)return 0;var tt=this.DV%et,rt=this.s<0?et-1:0;if(this.t>0)if(tt==0)rt=this.data[0]%et;else for(var nt=this.t-1;nt>=0;--nt)rt=(tt*rt+this.data[nt])%et;return rt}function bnModInverse(et){var tt=et.isEven();if(this.isEven()&&tt||et.signum()==0)return BigInteger$2.ZERO;for(var rt=et.clone(),nt=this.clone(),it=nbv(1),ot=nbv(0),st=nbv(0),at=nbv(1);rt.signum()!=0;){for(;rt.isEven();)rt.rShiftTo(1,rt),tt?((!it.isEven()||!ot.isEven())&&(it.addTo(this,it),ot.subTo(et,ot)),it.rShiftTo(1,it)):ot.isEven()||ot.subTo(et,ot),ot.rShiftTo(1,ot);for(;nt.isEven();)nt.rShiftTo(1,nt),tt?((!st.isEven()||!at.isEven())&&(st.addTo(this,st),at.subTo(et,at)),st.rShiftTo(1,st)):at.isEven()||at.subTo(et,at),at.rShiftTo(1,at);rt.compareTo(nt)>=0?(rt.subTo(nt,rt),tt&&it.subTo(st,it),ot.subTo(at,ot)):(nt.subTo(rt,nt),tt&&st.subTo(it,st),at.subTo(ot,at))}if(nt.compareTo(BigInteger$2.ONE)!=0)return BigInteger$2.ZERO;if(at.compareTo(et)>=0)return at.subtract(et);if(at.signum()<0)at.addTo(et,at);else return at;return at.signum()<0?at.add(et):at}var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],lplim=(1<<26)/lowprimes[lowprimes.length-1];function bnIsProbablePrime(et){var tt,rt=this.abs();if(rt.t==1&&rt.data[0]<=lowprimes[lowprimes.length-1]){for(tt=0;tt<lowprimes.length;++tt)if(rt.data[0]==lowprimes[tt])return!0;return!1}if(rt.isEven())return!1;for(tt=1;tt<lowprimes.length;){for(var nt=lowprimes[tt],it=tt+1;it<lowprimes.length&&nt<lplim;)nt*=lowprimes[it++];for(nt=rt.modInt(nt);tt<it;)if(nt%lowprimes[tt++]==0)return!1}return rt.millerRabin(et)}function bnpMillerRabin(et){var tt=this.subtract(BigInteger$2.ONE),rt=tt.getLowestSetBit();if(rt<=0)return!1;for(var nt=tt.shiftRight(rt),it=bnGetPrng(),ot,st=0;st<et;++st){do ot=new BigInteger$2(this.bitLength(),it);while(ot.compareTo(BigInteger$2.ONE)<=0||ot.compareTo(tt)>=0);var at=ot.modPow(nt,this);if(at.compareTo(BigInteger$2.ONE)!=0&&at.compareTo(tt)!=0){for(var ct=1;ct++<rt&&at.compareTo(tt)!=0;)if(at=at.modPowInt(2,this),at.compareTo(BigInteger$2.ONE)==0)return!1;if(at.compareTo(tt)!=0)return!1}}return!0}function bnGetPrng(){return{nextBytes:function(et){for(var tt=0;tt<et.length;++tt)et[tt]=Math.floor(Math.random()*256)}}}BigInteger$2.prototype.chunkSize=bnpChunkSize,BigInteger$2.prototype.toRadix=bnpToRadix,BigInteger$2.prototype.fromRadix=bnpFromRadix,BigInteger$2.prototype.fromNumber=bnpFromNumber,BigInteger$2.prototype.bitwiseTo=bnpBitwiseTo,BigInteger$2.prototype.changeBit=bnpChangeBit,BigInteger$2.prototype.addTo=bnpAddTo,BigInteger$2.prototype.dMultiply=bnpDMultiply,BigInteger$2.prototype.dAddOffset=bnpDAddOffset,BigInteger$2.prototype.multiplyLowerTo=bnpMultiplyLowerTo,BigInteger$2.prototype.multiplyUpperTo=bnpMultiplyUpperTo,BigInteger$2.prototype.modInt=bnpModInt,BigInteger$2.prototype.millerRabin=bnpMillerRabin,BigInteger$2.prototype.clone=bnClone,BigInteger$2.prototype.intValue=bnIntValue,BigInteger$2.prototype.byteValue=bnByteValue,BigInteger$2.prototype.shortValue=bnShortValue,BigInteger$2.prototype.signum=bnSigNum,BigInteger$2.prototype.toByteArray=bnToByteArray,BigInteger$2.prototype.equals=bnEquals,BigInteger$2.prototype.min=bnMin,BigInteger$2.prototype.max=bnMax,BigInteger$2.prototype.and=bnAnd,BigInteger$2.prototype.or=bnOr,BigInteger$2.prototype.xor=bnXor,BigInteger$2.prototype.andNot=bnAndNot,BigInteger$2.prototype.not=bnNot,BigInteger$2.prototype.shiftLeft=bnShiftLeft,BigInteger$2.prototype.shiftRight=bnShiftRight,BigInteger$2.prototype.getLowestSetBit=bnGetLowestSetBit,BigInteger$2.prototype.bitCount=bnBitCount,BigInteger$2.prototype.testBit=bnTestBit,BigInteger$2.prototype.setBit=bnSetBit,BigInteger$2.prototype.clearBit=bnClearBit,BigInteger$2.prototype.flipBit=bnFlipBit,BigInteger$2.prototype.add=bnAdd,BigInteger$2.prototype.subtract=bnSubtract,BigInteger$2.prototype.multiply=bnMultiply,BigInteger$2.prototype.divide=bnDivide,BigInteger$2.prototype.remainder=bnRemainder,BigInteger$2.prototype.divideAndRemainder=bnDivideAndRemainder,BigInteger$2.prototype.modPow=bnModPow,BigInteger$2.prototype.modInverse=bnModInverse,BigInteger$2.prototype.pow=bnPow,BigInteger$2.prototype.gcd=bnGCD,BigInteger$2.prototype.isProbablePrime=bnIsProbablePrime;var forge$8=forge$p,sha1=forge$8.sha1=forge$8.sha1||{};forge$8.md.sha1=forge$8.md.algorithms.sha1=sha1,sha1.create=function(){_initialized$1||_init$1();var et=null,tt=forge$8.util.createBuffer(),rt=new Array(80),nt={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return nt.start=function(){nt.messageLength=0,nt.fullMessageLength=nt.messageLength64=[];for(var it=nt.messageLengthSize/4,ot=0;ot<it;++ot)nt.fullMessageLength.push(0);return tt=forge$8.util.createBuffer(),et={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},nt},nt.start(),nt.update=function(it,ot){ot==="utf8"&&(it=forge$8.util.encodeUtf8(it));var st=it.length;nt.messageLength+=st,st=[st/4294967296>>>0,st>>>0];for(var at=nt.fullMessageLength.length-1;at>=0;--at)nt.fullMessageLength[at]+=st[1],st[1]=st[0]+(nt.fullMessageLength[at]/4294967296>>>0),nt.fullMessageLength[at]=nt.fullMessageLength[at]>>>0,st[0]=st[1]/4294967296>>>0;return tt.putBytes(it),_update$1(et,rt,tt),(tt.read>2048||tt.length()===0)&&tt.compact(),nt},nt.digest=function(){var it=forge$8.util.createBuffer();it.putBytes(tt.bytes());var ot=nt.fullMessageLength[nt.fullMessageLength.length-1]+nt.messageLengthSize,st=ot&nt.blockLength-1;it.putBytes(_padding$1.substr(0,nt.blockLength-st));for(var at,ct,ut=nt.fullMessageLength[0]*8,lt=0;lt<nt.fullMessageLength.length-1;++lt)at=nt.fullMessageLength[lt+1]*8,ct=at/4294967296>>>0,ut+=ct,it.putInt32(ut>>>0),ut=at>>>0;it.putInt32(ut);var ht={h0:et.h0,h1:et.h1,h2:et.h2,h3:et.h3,h4:et.h4};_update$1(ht,rt,it);var ft=forge$8.util.createBuffer();return ft.putInt32(ht.h0),ft.putInt32(ht.h1),ft.putInt32(ht.h2),ft.putInt32(ht.h3),ft.putInt32(ht.h4),ft},nt};var _padding$1=null,_initialized$1=!1;function _init$1(){_padding$1=String.fromCharCode(128),_padding$1+=forge$8.util.fillString(String.fromCharCode(0),64),_initialized$1=!0}function _update$1(et,tt,rt){for(var nt,it,ot,st,at,ct,ut,lt,ht=rt.length();ht>=64;){for(it=et.h0,ot=et.h1,st=et.h2,at=et.h3,ct=et.h4,lt=0;lt<16;++lt)nt=rt.getInt32(),tt[lt]=nt,ut=at^ot&(st^at),nt=(it<<5|it>>>27)+ut+ct+1518500249+nt,ct=at,at=st,st=(ot<<30|ot>>>2)>>>0,ot=it,it=nt;for(;lt<20;++lt)nt=tt[lt-3]^tt[lt-8]^tt[lt-14]^tt[lt-16],nt=nt<<1|nt>>>31,tt[lt]=nt,ut=at^ot&(st^at),nt=(it<<5|it>>>27)+ut+ct+1518500249+nt,ct=at,at=st,st=(ot<<30|ot>>>2)>>>0,ot=it,it=nt;for(;lt<32;++lt)nt=tt[lt-3]^tt[lt-8]^tt[lt-14]^tt[lt-16],nt=nt<<1|nt>>>31,tt[lt]=nt,ut=ot^st^at,nt=(it<<5|it>>>27)+ut+ct+1859775393+nt,ct=at,at=st,st=(ot<<30|ot>>>2)>>>0,ot=it,it=nt;for(;lt<40;++lt)nt=tt[lt-6]^tt[lt-16]^tt[lt-28]^tt[lt-32],nt=nt<<2|nt>>>30,tt[lt]=nt,ut=ot^st^at,nt=(it<<5|it>>>27)+ut+ct+1859775393+nt,ct=at,at=st,st=(ot<<30|ot>>>2)>>>0,ot=it,it=nt;for(;lt<60;++lt)nt=tt[lt-6]^tt[lt-16]^tt[lt-28]^tt[lt-32],nt=nt<<2|nt>>>30,tt[lt]=nt,ut=ot&st|at&(ot^st),nt=(it<<5|it>>>27)+ut+ct+2400959708+nt,ct=at,at=st,st=(ot<<30|ot>>>2)>>>0,ot=it,it=nt;for(;lt<80;++lt)nt=tt[lt-6]^tt[lt-16]^tt[lt-28]^tt[lt-32],nt=nt<<2|nt>>>30,tt[lt]=nt,ut=ot^st^at,nt=(it<<5|it>>>27)+ut+ct+3395469782+nt,ct=at,at=st,st=(ot<<30|ot>>>2)>>>0,ot=it,it=nt;et.h0=et.h0+it|0,et.h1=et.h1+ot|0,et.h2=et.h2+st|0,et.h3=et.h3+at|0,et.h4=et.h4+ct|0,ht-=64}}var forge$7=forge$p,pkcs1=forge$7.pkcs1=forge$7.pkcs1||{};pkcs1.encode_rsa_oaep=function(et,tt,rt){var nt,it,ot,st;typeof rt=="string"?(nt=rt,it=arguments[3]||void 0,ot=arguments[4]||void 0):rt&&(nt=rt.label||void 0,it=rt.seed||void 0,ot=rt.md||void 0,rt.mgf1&&rt.mgf1.md&&(st=rt.mgf1.md)),ot?ot.start():ot=forge$7.md.sha1.create(),st||(st=ot);var at=Math.ceil(et.n.bitLength()/8),ct=at-2*ot.digestLength-2;if(tt.length>ct){var ut=new Error("RSAES-OAEP input message length is too long.");throw ut.length=tt.length,ut.maxLength=ct,ut}nt||(nt=""),ot.update(nt,"raw");for(var lt=ot.digest(),ht="",ft=ct-tt.length,dt=0;dt<ft;dt++)ht+="\0";var pt=lt.getBytes()+ht+""+tt;if(!it)it=forge$7.random.getBytes(ot.digestLength);else if(it.length!==ot.digestLength){var ut=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw ut.seedLength=it.length,ut.digestLength=ot.digestLength,ut}var gt=rsa_mgf1(it,at-ot.digestLength-1,st),_t=forge$7.util.xorBytes(pt,gt,pt.length),mt=rsa_mgf1(_t,ot.digestLength,st),At=forge$7.util.xorBytes(it,mt,it.length);return"\0"+At+_t},pkcs1.decode_rsa_oaep=function(et,tt,rt){var nt,it,ot;typeof rt=="string"?(nt=rt,it=arguments[3]||void 0):rt&&(nt=rt.label||void 0,it=rt.md||void 0,rt.mgf1&&rt.mgf1.md&&(ot=rt.mgf1.md));var st=Math.ceil(et.n.bitLength()/8);if(tt.length!==st){var at=new Error("RSAES-OAEP encoded message length is invalid.");throw at.length=tt.length,at.expectedLength=st,at}if(it===void 0?it=forge$7.md.sha1.create():it.start(),ot||(ot=it),st<2*it.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");nt||(nt=""),it.update(nt,"raw");for(var ct=it.digest().getBytes(),ut=tt.charAt(0),lt=tt.substring(1,it.digestLength+1),ht=tt.substring(1+it.digestLength),ft=rsa_mgf1(ht,it.digestLength,ot),dt=forge$7.util.xorBytes(lt,ft,lt.length),pt=rsa_mgf1(dt,st-it.digestLength-1,ot),gt=forge$7.util.xorBytes(ht,pt,ht.length),_t=gt.substring(0,it.digestLength),at=ut!=="\0",mt=0;mt<it.digestLength;++mt)at|=ct.charAt(mt)!==_t.charAt(mt);for(var At=1,It=it.digestLength,Mt=it.digestLength;Mt<gt.length;Mt++){var kt=gt.charCodeAt(Mt),Ct=kt&1^1,Ut=At?65534:0;at|=kt&Ut,At=At&Ct,It+=At}if(at||gt.charCodeAt(It)!==1)throw new Error("Invalid RSAES-OAEP padding.");return gt.substring(It+1)};function rsa_mgf1(et,tt,rt){rt||(rt=forge$7.md.sha1.create());for(var nt="",it=Math.ceil(tt/rt.digestLength),ot=0;ot<it;++ot){var st=String.fromCharCode(ot>>24&255,ot>>16&255,ot>>8&255,ot&255);rt.start(),rt.update(et+st),nt+=rt.digest().getBytes()}return nt.substring(0,tt)}var forge$6=forge$p;(function(){if(forge$6.prime){forge$6.prime;return}var et=forge$6.prime=forge$6.prime||{},tt=forge$6.jsbn.BigInteger,rt=[6,4,2,4,2,4,6,2],nt=new tt(null);nt.fromInt(30);var it=function(ht,ft){return ht|ft};et.generateProbablePrime=function(ht,ft,dt){typeof ft=="function"&&(dt=ft,ft={}),ft=ft||{};var pt=ft.algorithm||"PRIMEINC";typeof pt=="string"&&(pt={name:pt}),pt.options=pt.options||{};var gt=ft.prng||forge$6.random,_t={nextBytes:function(mt){for(var At=gt.getBytesSync(mt.length),It=0;It<mt.length;++It)mt[It]=At.charCodeAt(It)}};if(pt.name==="PRIMEINC")return ot(ht,_t,pt.options,dt);throw new Error("Invalid prime generation algorithm: "+pt.name)};function ot(ht,ft,dt,pt){return"workers"in dt?ct(ht,ft,dt,pt):st(ht,ft,dt,pt)}function st(ht,ft,dt,pt){var gt=ut(ht,ft),_t=0,mt=lt(gt.bitLength());"millerRabinTests"in dt&&(mt=dt.millerRabinTests);var At=10;"maxBlockTime"in dt&&(At=dt.maxBlockTime),at(gt,ht,ft,_t,mt,At,pt)}function at(ht,ft,dt,pt,gt,_t,mt){var At=+new Date;do{if(ht.bitLength()>ft&&(ht=ut(ft,dt)),ht.isProbablePrime(gt))return mt(null,ht);ht.dAddOffset(rt[pt++%8],0)}while(_t<0||+new Date-At<_t);forge$6.util.setImmediate(function(){at(ht,ft,dt,pt,gt,_t,mt)})}function ct(ht,ft,dt,pt){if(typeof Worker>"u")return st(ht,ft,dt,pt);var gt=ut(ht,ft),_t=dt.workers,mt=dt.workLoad||100,At=mt*30/8,It=dt.workerScript||"forge/prime.worker.js";if(_t===-1)return forge$6.util.estimateCores(function(kt,Ct){kt&&(Ct=2),_t=Ct-1,Mt()});Mt();function Mt(){_t=Math.max(1,_t);for(var kt=[],Ct=0;Ct<_t;++Ct)kt[Ct]=new Worker(It);for(var Ct=0;Ct<_t;++Ct)kt[Ct].addEventListener("message",Wt);var Ut=!1;function Wt(Ft){if(!Ut){var Ce=Ft.data;if(Ce.found){for(var bt=0;bt<kt.length;++bt)kt[bt].terminate();return Ut=!0,pt(null,new tt(Ce.prime,16))}gt.bitLength()>ht&&(gt=ut(ht,ft));var yt=gt.toString(16);Ft.target.postMessage({hex:yt,workLoad:mt}),gt.dAddOffset(At,0)}}}}function ut(ht,ft){var dt=new tt(ht,ft),pt=ht-1;return dt.testBit(pt)||dt.bitwiseTo(tt.ONE.shiftLeft(pt),it,dt),dt.dAddOffset(31-dt.mod(nt).byteValue(),0),dt}function lt(ht){return ht<=100?27:ht<=150?18:ht<=200?15:ht<=250?12:ht<=300?9:ht<=350?8:ht<=400?7:ht<=500?6:ht<=600?5:ht<=800?4:ht<=1250?3:2}})();var forge$5=forge$p;if(typeof BigInteger$1>"u")var BigInteger$1=forge$5.jsbn.BigInteger;var _crypto=forge$5.util.isNodejs?require$$0$3:null,asn1$1=forge$5.asn1,util$1=forge$5.util;forge$5.pki=forge$5.pki||{},forge$5.pki.rsa=forge$5.rsa=forge$5.rsa||{};var pki$1=forge$5.pki,GCD_30_DELTA=[6,4,2,4,2,4,6,2],privateKeyValidator={name:"PrivateKeyInfo",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},rsaPrivateKeyValidator={name:"RSAPrivateKey",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},rsaPublicKeyValidator={name:"RSAPublicKey",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},publicKeyValidator=forge$5.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},digestInfoValidator={name:"DigestInfo",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:asn1$1.Class.UNIVERSAL,type:asn1$1.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},emsaPkcs1v15encode=function(et){var tt;if(et.algorithm in pki$1.oids)tt=pki$1.oids[et.algorithm];else{var rt=new Error("Unknown message digest algorithm.");throw rt.algorithm=et.algorithm,rt}var nt=asn1$1.oidToDer(tt).getBytes(),it=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[]),ot=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[]);ot.value.push(asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,nt)),ot.value.push(asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.NULL,!1,""));var st=asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OCTETSTRING,!1,et.digest().getBytes());return it.value.push(ot),it.value.push(st),asn1$1.toDer(it).getBytes()},_modPow=function(et,tt,rt){if(rt)return et.modPow(tt.e,tt.n);if(!tt.p||!tt.q)return et.modPow(tt.d,tt.n);tt.dP||(tt.dP=tt.d.mod(tt.p.subtract(BigInteger$1.ONE))),tt.dQ||(tt.dQ=tt.d.mod(tt.q.subtract(BigInteger$1.ONE))),tt.qInv||(tt.qInv=tt.q.modInverse(tt.p));var nt;do nt=new BigInteger$1(forge$5.util.bytesToHex(forge$5.random.getBytes(tt.n.bitLength()/8)),16);while(nt.compareTo(tt.n)>=0||!nt.gcd(tt.n).equals(BigInteger$1.ONE));et=et.multiply(nt.modPow(tt.e,tt.n)).mod(tt.n);for(var it=et.mod(tt.p).modPow(tt.dP,tt.p),ot=et.mod(tt.q).modPow(tt.dQ,tt.q);it.compareTo(ot)<0;)it=it.add(tt.p);var st=it.subtract(ot).multiply(tt.qInv).mod(tt.p).multiply(tt.q).add(ot);return st=st.multiply(nt.modInverse(tt.n)).mod(tt.n),st};pki$1.rsa.encrypt=function(et,tt,rt){var nt=rt,it,ot=Math.ceil(tt.n.bitLength()/8);rt!==!1&&rt!==!0?(nt=rt===2,it=_encodePkcs1_v1_5(et,tt,rt)):(it=forge$5.util.createBuffer(),it.putBytes(et));for(var st=new BigInteger$1(it.toHex(),16),at=_modPow(st,tt,nt),ct=at.toString(16),ut=forge$5.util.createBuffer(),lt=ot-Math.ceil(ct.length/2);lt>0;)ut.putByte(0),--lt;return ut.putBytes(forge$5.util.hexToBytes(ct)),ut.getBytes()},pki$1.rsa.decrypt=function(et,tt,rt,nt){var it=Math.ceil(tt.n.bitLength()/8);if(et.length!==it){var ot=new Error("Encrypted message length is invalid.");throw ot.length=et.length,ot.expected=it,ot}var st=new BigInteger$1(forge$5.util.createBuffer(et).toHex(),16);if(st.compareTo(tt.n)>=0)throw new Error("Encrypted message is invalid.");for(var at=_modPow(st,tt,rt),ct=at.toString(16),ut=forge$5.util.createBuffer(),lt=it-Math.ceil(ct.length/2);lt>0;)ut.putByte(0),--lt;return ut.putBytes(forge$5.util.hexToBytes(ct)),nt!==!1?_decodePkcs1_v1_5(ut.getBytes(),tt,rt):ut.getBytes()},pki$1.rsa.createKeyPairGenerationState=function(et,tt,rt){typeof et=="string"&&(et=parseInt(et,10)),et=et||2048,rt=rt||{};var nt=rt.prng||forge$5.random,it={nextBytes:function(at){for(var ct=nt.getBytesSync(at.length),ut=0;ut<at.length;++ut)at[ut]=ct.charCodeAt(ut)}},ot=rt.algorithm||"PRIMEINC",st;if(ot==="PRIMEINC")st={algorithm:ot,state:0,bits:et,rng:it,eInt:tt||65537,e:new BigInteger$1(null),p:null,q:null,qBits:et>>1,pBits:et-(et>>1),pqState:0,num:null,keys:null},st.e.fromInt(st.eInt);else throw new Error("Invalid key generation algorithm: "+ot);return st},pki$1.rsa.stepKeyPairGenerationState=function(et,tt){"algorithm"in et||(et.algorithm="PRIMEINC");var rt=new BigInteger$1(null);rt.fromInt(30);for(var nt=0,it=function(ht,ft){return ht|ft},ot=+new Date,st,at=0;et.keys===null&&(tt<=0||at<tt);){if(et.state===0){var ct=et.p===null?et.pBits:et.qBits,ut=ct-1;et.pqState===0?(et.num=new BigInteger$1(ct,et.rng),et.num.testBit(ut)||et.num.bitwiseTo(BigInteger$1.ONE.shiftLeft(ut),it,et.num),et.num.dAddOffset(31-et.num.mod(rt).byteValue(),0),nt=0,++et.pqState):et.pqState===1?et.num.bitLength()>ct?et.pqState=0:et.num.isProbablePrime(_getMillerRabinTests(et.num.bitLength()))?++et.pqState:et.num.dAddOffset(GCD_30_DELTA[nt++%8],0):et.pqState===2?et.pqState=et.num.subtract(BigInteger$1.ONE).gcd(et.e).compareTo(BigInteger$1.ONE)===0?3:0:et.pqState===3&&(et.pqState=0,et.p===null?et.p=et.num:et.q=et.num,et.p!==null&&et.q!==null&&++et.state,et.num=null)}else if(et.state===1)et.p.compareTo(et.q)<0&&(et.num=et.p,et.p=et.q,et.q=et.num),++et.state;else if(et.state===2)et.p1=et.p.subtract(BigInteger$1.ONE),et.q1=et.q.subtract(BigInteger$1.ONE),et.phi=et.p1.multiply(et.q1),++et.state;else if(et.state===3)et.phi.gcd(et.e).compareTo(BigInteger$1.ONE)===0?++et.state:(et.p=null,et.q=null,et.state=0);else if(et.state===4)et.n=et.p.multiply(et.q),et.n.bitLength()===et.bits?++et.state:(et.q=null,et.state=0);else if(et.state===5){var lt=et.e.modInverse(et.phi);et.keys={privateKey:pki$1.rsa.setPrivateKey(et.n,et.e,lt,et.p,et.q,lt.mod(et.p1),lt.mod(et.q1),et.q.modInverse(et.p)),publicKey:pki$1.rsa.setPublicKey(et.n,et.e)}}st=+new Date,at+=st-ot,ot=st}return et.keys!==null},pki$1.rsa.generateKeyPair=function(et,tt,rt,nt){if(arguments.length===1?typeof et=="object"?(rt=et,et=void 0):typeof et=="function"&&(nt=et,et=void 0):arguments.length===2?typeof et=="number"?typeof tt=="function"?(nt=tt,tt=void 0):typeof tt!="number"&&(rt=tt,tt=void 0):(rt=et,nt=tt,et=void 0,tt=void 0):arguments.length===3&&(typeof tt=="number"?typeof rt=="function"&&(nt=rt,rt=void 0):(nt=rt,rt=tt,tt=void 0)),rt=rt||{},et===void 0&&(et=rt.bits||2048),tt===void 0&&(tt=rt.e||65537),!forge$5.options.usePureJavaScript&&!rt.prng&&et>=256&&et<=16384&&(tt===65537||tt===3)){if(nt){if(_detectNodeCrypto("generateKeyPair"))return _crypto.generateKeyPair("rsa",{modulusLength:et,publicExponent:tt,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(at,ct,ut){if(at)return nt(at);nt(null,{privateKey:pki$1.privateKeyFromPem(ut),publicKey:pki$1.publicKeyFromPem(ct)})});if(_detectSubtleCrypto("generateKey")&&_detectSubtleCrypto("exportKey"))return util$1.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:et,publicExponent:_intToUint8Array(tt),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(at){return util$1.globalScope.crypto.subtle.exportKey("pkcs8",at.privateKey)}).then(void 0,function(at){nt(at)}).then(function(at){if(at){var ct=pki$1.privateKeyFromAsn1(asn1$1.fromDer(forge$5.util.createBuffer(at)));nt(null,{privateKey:ct,publicKey:pki$1.setRsaPublicKey(ct.n,ct.e)})}});if(_detectSubtleMsCrypto("generateKey")&&_detectSubtleMsCrypto("exportKey")){var it=util$1.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:et,publicExponent:_intToUint8Array(tt),hash:{name:"SHA-256"}},!0,["sign","verify"]);it.oncomplete=function(at){var ct=at.target.result,ut=util$1.globalScope.msCrypto.subtle.exportKey("pkcs8",ct.privateKey);ut.oncomplete=function(lt){var ht=lt.target.result,ft=pki$1.privateKeyFromAsn1(asn1$1.fromDer(forge$5.util.createBuffer(ht)));nt(null,{privateKey:ft,publicKey:pki$1.setRsaPublicKey(ft.n,ft.e)})},ut.onerror=function(lt){nt(lt)}},it.onerror=function(at){nt(at)};return}}else if(_detectNodeCrypto("generateKeyPairSync")){var ot=_crypto.generateKeyPairSync("rsa",{modulusLength:et,publicExponent:tt,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:pki$1.privateKeyFromPem(ot.privateKey),publicKey:pki$1.publicKeyFromPem(ot.publicKey)}}}var st=pki$1.rsa.createKeyPairGenerationState(et,tt,rt);if(!nt)return pki$1.rsa.stepKeyPairGenerationState(st,0),st.keys;_generateKeyPair(st,rt,nt)},pki$1.setRsaPublicKey=pki$1.rsa.setPublicKey=function(et,tt){var rt={n:et,e:tt};return rt.encrypt=function(nt,it,ot){if(typeof it=="string"?it=it.toUpperCase():it===void 0&&(it="RSAES-PKCS1-V1_5"),it==="RSAES-PKCS1-V1_5")it={encode:function(at,ct,ut){return _encodePkcs1_v1_5(at,ct,2).getBytes()}};else if(it==="RSA-OAEP"||it==="RSAES-OAEP")it={encode:function(at,ct){return forge$5.pkcs1.encode_rsa_oaep(ct,at,ot)}};else if(["RAW","NONE","NULL",null].indexOf(it)!==-1)it={encode:function(at){return at}};else if(typeof it=="string")throw new Error('Unsupported encryption scheme: "'+it+'".');var st=it.encode(nt,rt,!0);return pki$1.rsa.encrypt(st,rt,!0)},rt.verify=function(nt,it,ot,st){typeof ot=="string"?ot=ot.toUpperCase():ot===void 0&&(ot="RSASSA-PKCS1-V1_5"),st===void 0&&(st={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in st||(st._parseAllDigestBytes=!0),ot==="RSASSA-PKCS1-V1_5"?ot={verify:function(ct,ut){ut=_decodePkcs1_v1_5(ut,rt,!0);var lt=asn1$1.fromDer(ut,{parseAllBytes:st._parseAllDigestBytes}),ht={},ft=[];if(!asn1$1.validate(lt,digestInfoValidator,ht,ft)){var dt=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw dt.errors=ft,dt}var pt=asn1$1.derToOid(ht.algorithmIdentifier);if(!(pt===forge$5.oids.md2||pt===forge$5.oids.md5||pt===forge$5.oids.sha1||pt===forge$5.oids.sha224||pt===forge$5.oids.sha256||pt===forge$5.oids.sha384||pt===forge$5.oids.sha512||pt===forge$5.oids["sha512-224"]||pt===forge$5.oids["sha512-256"])){var dt=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw dt.oid=pt,dt}if((pt===forge$5.oids.md2||pt===forge$5.oids.md5)&&!("parameters"in ht))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return ct===ht.digest}}:(ot==="NONE"||ot==="NULL"||ot===null)&&(ot={verify:function(ct,ut){return ut=_decodePkcs1_v1_5(ut,rt,!0),ct===ut}});var at=pki$1.rsa.decrypt(it,rt,!0,!1);return ot.verify(nt,at,rt.n.bitLength())},rt},pki$1.setRsaPrivateKey=pki$1.rsa.setPrivateKey=function(et,tt,rt,nt,it,ot,st,at){var ct={n:et,e:tt,d:rt,p:nt,q:it,dP:ot,dQ:st,qInv:at};return ct.decrypt=function(ut,lt,ht){typeof lt=="string"?lt=lt.toUpperCase():lt===void 0&&(lt="RSAES-PKCS1-V1_5");var ft=pki$1.rsa.decrypt(ut,ct,!1,!1);if(lt==="RSAES-PKCS1-V1_5")lt={decode:_decodePkcs1_v1_5};else if(lt==="RSA-OAEP"||lt==="RSAES-OAEP")lt={decode:function(dt,pt){return forge$5.pkcs1.decode_rsa_oaep(pt,dt,ht)}};else if(["RAW","NONE","NULL",null].indexOf(lt)!==-1)lt={decode:function(dt){return dt}};else throw new Error('Unsupported encryption scheme: "'+lt+'".');return lt.decode(ft,ct,!1)},ct.sign=function(ut,lt){var ht=!1;typeof lt=="string"&&(lt=lt.toUpperCase()),lt===void 0||lt==="RSASSA-PKCS1-V1_5"?(lt={encode:emsaPkcs1v15encode},ht=1):(lt==="NONE"||lt==="NULL"||lt===null)&&(lt={encode:function(){return ut}},ht=1);var ft=lt.encode(ut,ct.n.bitLength());return pki$1.rsa.encrypt(ft,ct,ht)},ct},pki$1.wrapRsaPrivateKey=function(et){return asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,asn1$1.integerToDer(0).getBytes()),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(pki$1.oids.rsaEncryption).getBytes()),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.NULL,!1,"")]),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OCTETSTRING,!1,asn1$1.toDer(et).getBytes())])},pki$1.privateKeyFromAsn1=function(et){var tt={},rt=[];if(asn1$1.validate(et,privateKeyValidator,tt,rt)&&(et=asn1$1.fromDer(forge$5.util.createBuffer(tt.privateKey))),tt={},rt=[],!asn1$1.validate(et,rsaPrivateKeyValidator,tt,rt)){var nt=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw nt.errors=rt,nt}var it,ot,st,at,ct,ut,lt,ht;return it=forge$5.util.createBuffer(tt.privateKeyModulus).toHex(),ot=forge$5.util.createBuffer(tt.privateKeyPublicExponent).toHex(),st=forge$5.util.createBuffer(tt.privateKeyPrivateExponent).toHex(),at=forge$5.util.createBuffer(tt.privateKeyPrime1).toHex(),ct=forge$5.util.createBuffer(tt.privateKeyPrime2).toHex(),ut=forge$5.util.createBuffer(tt.privateKeyExponent1).toHex(),lt=forge$5.util.createBuffer(tt.privateKeyExponent2).toHex(),ht=forge$5.util.createBuffer(tt.privateKeyCoefficient).toHex(),pki$1.setRsaPrivateKey(new BigInteger$1(it,16),new BigInteger$1(ot,16),new BigInteger$1(st,16),new BigInteger$1(at,16),new BigInteger$1(ct,16),new BigInteger$1(ut,16),new BigInteger$1(lt,16),new BigInteger$1(ht,16))},pki$1.privateKeyToAsn1=pki$1.privateKeyToRSAPrivateKey=function(et){return asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,asn1$1.integerToDer(0).getBytes()),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,_bnToBytes(et.n)),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,_bnToBytes(et.e)),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,_bnToBytes(et.d)),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,_bnToBytes(et.p)),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,_bnToBytes(et.q)),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,_bnToBytes(et.dP)),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,_bnToBytes(et.dQ)),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,_bnToBytes(et.qInv))])},pki$1.publicKeyFromAsn1=function(et){var tt={},rt=[];if(asn1$1.validate(et,publicKeyValidator,tt,rt)){var nt=asn1$1.derToOid(tt.publicKeyOid);if(nt!==pki$1.oids.rsaEncryption){var it=new Error("Cannot read public key. Unknown OID.");throw it.oid=nt,it}et=tt.rsaPublicKey}if(rt=[],!asn1$1.validate(et,rsaPublicKeyValidator,tt,rt)){var it=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw it.errors=rt,it}var ot=forge$5.util.createBuffer(tt.publicKeyModulus).toHex(),st=forge$5.util.createBuffer(tt.publicKeyExponent).toHex();return pki$1.setRsaPublicKey(new BigInteger$1(ot,16),new BigInteger$1(st,16))},pki$1.publicKeyToAsn1=pki$1.publicKeyToSubjectPublicKeyInfo=function(et){return asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.OID,!1,asn1$1.oidToDer(pki$1.oids.rsaEncryption).getBytes()),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.NULL,!1,"")]),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.BITSTRING,!1,[pki$1.publicKeyToRSAPublicKey(et)])])},pki$1.publicKeyToRSAPublicKey=function(et){return asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.SEQUENCE,!0,[asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,_bnToBytes(et.n)),asn1$1.create(asn1$1.Class.UNIVERSAL,asn1$1.Type.INTEGER,!1,_bnToBytes(et.e))])};function _encodePkcs1_v1_5(et,tt,rt){var nt=forge$5.util.createBuffer(),it=Math.ceil(tt.n.bitLength()/8);if(et.length>it-11){var ot=new Error("Message is too long for PKCS#1 v1.5 padding.");throw ot.length=et.length,ot.max=it-11,ot}nt.putByte(0),nt.putByte(rt);var st=it-3-et.length,at;if(rt===0||rt===1){at=rt===0?0:255;for(var ct=0;ct<st;++ct)nt.putByte(at)}else for(;st>0;){for(var ut=0,lt=forge$5.random.getBytes(st),ct=0;ct<st;++ct)at=lt.charCodeAt(ct),at===0?++ut:nt.putByte(at);st=ut}return nt.putByte(0),nt.putBytes(et),nt}function _decodePkcs1_v1_5(et,tt,rt,nt){var it=Math.ceil(tt.n.bitLength()/8),ot=forge$5.util.createBuffer(et),st=ot.getByte(),at=ot.getByte();if(st!==0||rt&&at!==0&&at!==1||!rt&&at!=2||rt&&at===0&&typeof nt>"u")throw new Error("Encryption block is invalid.");var ct=0;if(at===0){ct=it-3-nt;for(var ut=0;ut<ct;++ut)if(ot.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(at===1)for(ct=0;ot.length()>1;){if(ot.getByte()!==255){--ot.read;break}++ct}else if(at===2)for(ct=0;ot.length()>1;){if(ot.getByte()===0){--ot.read;break}++ct}var lt=ot.getByte();if(lt!==0||ct!==it-3-ot.length())throw new Error("Encryption block is invalid.");return ot.getBytes()}function _generateKeyPair(et,tt,rt){typeof tt=="function"&&(rt=tt,tt={}),tt=tt||{};var nt={algorithm:{name:tt.algorithm||"PRIMEINC",options:{workers:tt.workers||2,workLoad:tt.workLoad||100,workerScript:tt.workerScript}}};"prng"in tt&&(nt.prng=tt.prng),it();function it(){ot(et.pBits,function(at,ct){if(at)return rt(at);if(et.p=ct,et.q!==null)return st(at,et.q);ot(et.qBits,st)})}function ot(at,ct){forge$5.prime.generateProbablePrime(at,nt,ct)}function st(at,ct){if(at)return rt(at);if(et.q=ct,et.p.compareTo(et.q)<0){var ut=et.p;et.p=et.q,et.q=ut}if(et.p.subtract(BigInteger$1.ONE).gcd(et.e).compareTo(BigInteger$1.ONE)!==0){et.p=null,it();return}if(et.q.subtract(BigInteger$1.ONE).gcd(et.e).compareTo(BigInteger$1.ONE)!==0){et.q=null,ot(et.qBits,st);return}if(et.p1=et.p.subtract(BigInteger$1.ONE),et.q1=et.q.subtract(BigInteger$1.ONE),et.phi=et.p1.multiply(et.q1),et.phi.gcd(et.e).compareTo(BigInteger$1.ONE)!==0){et.p=et.q=null,it();return}if(et.n=et.p.multiply(et.q),et.n.bitLength()!==et.bits){et.q=null,ot(et.qBits,st);return}var lt=et.e.modInverse(et.phi);et.keys={privateKey:pki$1.rsa.setPrivateKey(et.n,et.e,lt,et.p,et.q,lt.mod(et.p1),lt.mod(et.q1),et.q.modInverse(et.p)),publicKey:pki$1.rsa.setPublicKey(et.n,et.e)},rt(null,et.keys)}}function _bnToBytes(et){var tt=et.toString(16);tt[0]>="8"&&(tt="00"+tt);var rt=forge$5.util.hexToBytes(tt);return rt.length>1&&(rt.charCodeAt(0)===0&&!(rt.charCodeAt(1)&128)||rt.charCodeAt(0)===255&&(rt.charCodeAt(1)&128)===128)?rt.substr(1):rt}function _getMillerRabinTests(et){return et<=100?27:et<=150?18:et<=200?15:et<=250?12:et<=300?9:et<=350?8:et<=400?7:et<=500?6:et<=600?5:et<=800?4:et<=1250?3:2}function _detectNodeCrypto(et){return forge$5.util.isNodejs&&typeof _crypto[et]=="function"}function _detectSubtleCrypto(et){return typeof util$1.globalScope<"u"&&typeof util$1.globalScope.crypto=="object"&&typeof util$1.globalScope.crypto.subtle=="object"&&typeof util$1.globalScope.crypto.subtle[et]=="function"}function _detectSubtleMsCrypto(et){return typeof util$1.globalScope<"u"&&typeof util$1.globalScope.msCrypto=="object"&&typeof util$1.globalScope.msCrypto.subtle=="object"&&typeof util$1.globalScope.msCrypto.subtle[et]=="function"}function _intToUint8Array(et){for(var tt=forge$5.util.hexToBytes(et.toString(16)),rt=new Uint8Array(tt.length),nt=0;nt<tt.length;++nt)rt[nt]=tt.charCodeAt(nt);return rt}var forge$4=forge$p;if(typeof BigInteger>"u")var BigInteger=forge$4.jsbn.BigInteger;var asn1=forge$4.asn1,pki=forge$4.pki=forge$4.pki||{};pki.pbe=forge$4.pbe=forge$4.pbe||{};var oids=pki.oids,encryptedPrivateKeyValidator={name:"EncryptedPrivateKeyInfo",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},PBES2AlgorithmsValidator={name:"PBES2Algorithms",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},pkcs12PbeParamsValidator={name:"pkcs-12PbeParams",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:asn1.Class.UNIVERSAL,type:asn1.Type.INTEGER,constructed:!1,capture:"iterations"}]};pki.encryptPrivateKeyInfo=function(et,tt,rt){rt=rt||{},rt.saltSize=rt.saltSize||8,rt.count=rt.count||2048,rt.algorithm=rt.algorithm||"aes128",rt.prfAlgorithm=rt.prfAlgorithm||"sha1";var nt=forge$4.random.getBytesSync(rt.saltSize),it=rt.count,ot=asn1.integerToDer(it),st,at,ct;if(rt.algorithm.indexOf("aes")===0||rt.algorithm==="des"){var ut,lt,ht;switch(rt.algorithm){case"aes128":st=16,ut=16,lt=oids["aes128-CBC"],ht=forge$4.aes.createEncryptionCipher;break;case"aes192":st=24,ut=16,lt=oids["aes192-CBC"],ht=forge$4.aes.createEncryptionCipher;break;case"aes256":st=32,ut=16,lt=oids["aes256-CBC"],ht=forge$4.aes.createEncryptionCipher;break;case"des":st=8,ut=8,lt=oids.desCBC,ht=forge$4.des.createEncryptionCipher;break;default:var ft=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw ft.algorithm=rt.algorithm,ft}var dt="hmacWith"+rt.prfAlgorithm.toUpperCase(),pt=prfAlgorithmToMessageDigest(dt),gt=forge$4.pkcs5.pbkdf2(tt,nt,it,st,pt),_t=forge$4.random.getBytesSync(ut),mt=ht(gt);mt.start(_t),mt.update(asn1.toDer(et)),mt.finish(),ct=mt.output.getBytes();var At=createPbkdf2Params(nt,ot,st,dt);at=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(oids.pkcs5PBES2).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(oids.pkcs5PBKDF2).getBytes()),At]),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(lt).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,_t)])])])}else if(rt.algorithm==="3des"){st=24;var It=new forge$4.util.ByteBuffer(nt),gt=pki.pbe.generatePkcs12Key(tt,It,1,it,st),_t=pki.pbe.generatePkcs12Key(tt,It,2,it,st),mt=forge$4.des.createEncryptionCipher(gt);mt.start(_t),mt.update(asn1.toDer(et)),mt.finish(),ct=mt.output.getBytes(),at=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,nt),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,ot.getBytes())])])}else{var ft=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw ft.algorithm=rt.algorithm,ft}var Mt=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[at,asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,ct)]);return Mt},pki.decryptPrivateKeyInfo=function(et,tt){var rt=null,nt={},it=[];if(!asn1.validate(et,encryptedPrivateKeyValidator,nt,it)){var ot=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw ot.errors=it,ot}var st=asn1.derToOid(nt.encryptionOid),at=pki.pbe.getCipher(st,nt.encryptionParams,tt),ct=forge$4.util.createBuffer(nt.encryptedData);return at.update(ct),at.finish()&&(rt=asn1.fromDer(at.output)),rt},pki.encryptedPrivateKeyToPem=function(et,tt){var rt={type:"ENCRYPTED PRIVATE KEY",body:asn1.toDer(et).getBytes()};return forge$4.pem.encode(rt,{maxline:tt})},pki.encryptedPrivateKeyFromPem=function(et){var tt=forge$4.pem.decode(et)[0];if(tt.type!=="ENCRYPTED PRIVATE KEY"){var rt=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw rt.headerType=tt.type,rt}if(tt.procType&&tt.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return asn1.fromDer(tt.body)},pki.encryptRsaPrivateKey=function(et,tt,rt){if(rt=rt||{},!rt.legacy){var nt=pki.wrapRsaPrivateKey(pki.privateKeyToAsn1(et));return nt=pki.encryptPrivateKeyInfo(nt,tt,rt),pki.encryptedPrivateKeyToPem(nt)}var it,ot,st,at;switch(rt.algorithm){case"aes128":it="AES-128-CBC",st=16,ot=forge$4.random.getBytesSync(16),at=forge$4.aes.createEncryptionCipher;break;case"aes192":it="AES-192-CBC",st=24,ot=forge$4.random.getBytesSync(16),at=forge$4.aes.createEncryptionCipher;break;case"aes256":it="AES-256-CBC",st=32,ot=forge$4.random.getBytesSync(16),at=forge$4.aes.createEncryptionCipher;break;case"3des":it="DES-EDE3-CBC",st=24,ot=forge$4.random.getBytesSync(8),at=forge$4.des.createEncryptionCipher;break;case"des":it="DES-CBC",st=8,ot=forge$4.random.getBytesSync(8),at=forge$4.des.createEncryptionCipher;break;default:var ct=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+rt.algorithm+'".');throw ct.algorithm=rt.algorithm,ct}var ut=forge$4.pbe.opensslDeriveBytes(tt,ot.substr(0,8),st),lt=at(ut);lt.start(ot),lt.update(asn1.toDer(pki.privateKeyToAsn1(et))),lt.finish();var ht={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:it,parameters:forge$4.util.bytesToHex(ot).toUpperCase()},body:lt.output.getBytes()};return forge$4.pem.encode(ht)},pki.decryptRsaPrivateKey=function(et,tt){var rt=null,nt=forge$4.pem.decode(et)[0];if(nt.type!=="ENCRYPTED PRIVATE KEY"&&nt.type!=="PRIVATE KEY"&&nt.type!=="RSA PRIVATE KEY"){var it=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw it.headerType=it,it}if(nt.procType&&nt.procType.type==="ENCRYPTED"){var ot,st;switch(nt.dekInfo.algorithm){case"DES-CBC":ot=8,st=forge$4.des.createDecryptionCipher;break;case"DES-EDE3-CBC":ot=24,st=forge$4.des.createDecryptionCipher;break;case"AES-128-CBC":ot=16,st=forge$4.aes.createDecryptionCipher;break;case"AES-192-CBC":ot=24,st=forge$4.aes.createDecryptionCipher;break;case"AES-256-CBC":ot=32,st=forge$4.aes.createDecryptionCipher;break;case"RC2-40-CBC":ot=5,st=function(ht){return forge$4.rc2.createDecryptionCipher(ht,40)};break;case"RC2-64-CBC":ot=8,st=function(ht){return forge$4.rc2.createDecryptionCipher(ht,64)};break;case"RC2-128-CBC":ot=16,st=function(ht){return forge$4.rc2.createDecryptionCipher(ht,128)};break;default:var it=new Error('Could not decrypt private key; unsupported encryption algorithm "'+nt.dekInfo.algorithm+'".');throw it.algorithm=nt.dekInfo.algorithm,it}var at=forge$4.util.hexToBytes(nt.dekInfo.parameters),ct=forge$4.pbe.opensslDeriveBytes(tt,at.substr(0,8),ot),ut=st(ct);if(ut.start(at),ut.update(forge$4.util.createBuffer(nt.body)),ut.finish())rt=ut.output.getBytes();else return rt}else rt=nt.body;return nt.type==="ENCRYPTED PRIVATE KEY"?rt=pki.decryptPrivateKeyInfo(asn1.fromDer(rt),tt):rt=asn1.fromDer(rt),rt!==null&&(rt=pki.privateKeyFromAsn1(rt)),rt},pki.pbe.generatePkcs12Key=function(et,tt,rt,nt,it,ot){var st,at;if(typeof ot>"u"||ot===null){if(!("sha1"in forge$4.md))throw new Error('"sha1" hash algorithm unavailable.');ot=forge$4.md.sha1.create()}var ct=ot.digestLength,ut=ot.blockLength,lt=new forge$4.util.ByteBuffer,ht=new forge$4.util.ByteBuffer;if(et!=null){for(at=0;at<et.length;at++)ht.putInt16(et.charCodeAt(at));ht.putInt16(0)}var ft=ht.length(),dt=tt.length(),pt=new forge$4.util.ByteBuffer;pt.fillWithByte(rt,ut);var gt=ut*Math.ceil(dt/ut),_t=new forge$4.util.ByteBuffer;for(at=0;at<gt;at++)_t.putByte(tt.at(at%dt));var mt=ut*Math.ceil(ft/ut),At=new forge$4.util.ByteBuffer;for(at=0;at<mt;at++)At.putByte(ht.at(at%ft));var It=_t;It.putBuffer(At);for(var Mt=Math.ceil(it/ct),kt=1;kt<=Mt;kt++){var Ct=new forge$4.util.ByteBuffer;Ct.putBytes(pt.bytes()),Ct.putBytes(It.bytes());for(var Ut=0;Ut<nt;Ut++)ot.start(),ot.update(Ct.getBytes()),Ct=ot.digest();var Wt=new forge$4.util.ByteBuffer;for(at=0;at<ut;at++)Wt.putByte(Ct.at(at%ct));var Ft=Math.ceil(dt/ut)+Math.ceil(ft/ut),Ce=new forge$4.util.ByteBuffer;for(st=0;st<Ft;st++){var bt=new forge$4.util.ByteBuffer(It.getBytes(ut)),yt=511;for(at=Wt.length()-1;at>=0;at--)yt=yt>>8,yt+=Wt.at(at)+bt.at(at),bt.setAt(at,yt&255);Ce.putBuffer(bt)}It=Ce,lt.putBuffer(Ct)}return lt.truncate(lt.length()-it),lt},pki.pbe.getCipher=function(et,tt,rt){switch(et){case pki.oids.pkcs5PBES2:return pki.pbe.getCipherForPBES2(et,tt,rt);case pki.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case pki.oids["pbewithSHAAnd40BitRC2-CBC"]:return pki.pbe.getCipherForPKCS12PBE(et,tt,rt);default:var nt=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw nt.oid=et,nt.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],nt}},pki.pbe.getCipherForPBES2=function(et,tt,rt){var nt={},it=[];if(!asn1.validate(tt,PBES2AlgorithmsValidator,nt,it)){var ot=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw ot.errors=it,ot}if(et=asn1.derToOid(nt.kdfOid),et!==pki.oids.pkcs5PBKDF2){var ot=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw ot.oid=et,ot.supportedOids=["pkcs5PBKDF2"],ot}if(et=asn1.derToOid(nt.encOid),et!==pki.oids["aes128-CBC"]&&et!==pki.oids["aes192-CBC"]&&et!==pki.oids["aes256-CBC"]&&et!==pki.oids["des-EDE3-CBC"]&&et!==pki.oids.desCBC){var ot=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw ot.oid=et,ot.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],ot}var st=nt.kdfSalt,at=forge$4.util.createBuffer(nt.kdfIterationCount);at=at.getInt(at.length()<<3);var ct,ut;switch(pki.oids[et]){case"aes128-CBC":ct=16,ut=forge$4.aes.createDecryptionCipher;break;case"aes192-CBC":ct=24,ut=forge$4.aes.createDecryptionCipher;break;case"aes256-CBC":ct=32,ut=forge$4.aes.createDecryptionCipher;break;case"des-EDE3-CBC":ct=24,ut=forge$4.des.createDecryptionCipher;break;case"desCBC":ct=8,ut=forge$4.des.createDecryptionCipher;break}var lt=prfOidToMessageDigest(nt.prfOid),ht=forge$4.pkcs5.pbkdf2(rt,st,at,ct,lt),ft=nt.encIv,dt=ut(ht);return dt.start(ft),dt},pki.pbe.getCipherForPKCS12PBE=function(et,tt,rt){var nt={},it=[];if(!asn1.validate(tt,pkcs12PbeParamsValidator,nt,it)){var ot=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw ot.errors=it,ot}var st=forge$4.util.createBuffer(nt.salt),at=forge$4.util.createBuffer(nt.iterations);at=at.getInt(at.length()<<3);var ct,ut,lt;switch(et){case pki.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:ct=24,ut=8,lt=forge$4.des.startDecrypting;break;case pki.oids["pbewithSHAAnd40BitRC2-CBC"]:ct=5,ut=8,lt=function(gt,_t){var mt=forge$4.rc2.createDecryptionCipher(gt,40);return mt.start(_t,null),mt};break;default:var ot=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw ot.oid=et,ot}var ht=prfOidToMessageDigest(nt.prfOid),ft=pki.pbe.generatePkcs12Key(rt,st,1,at,ct,ht);ht.start();var dt=pki.pbe.generatePkcs12Key(rt,st,2,at,ut,ht);return lt(ft,dt)},pki.pbe.opensslDeriveBytes=function(et,tt,rt,nt){if(typeof nt>"u"||nt===null){if(!("md5"in forge$4.md))throw new Error('"md5" hash algorithm unavailable.');nt=forge$4.md.md5.create()}tt===null&&(tt="");for(var it=[hash(nt,et+tt)],ot=16,st=1;ot<rt;++st,ot+=16)it.push(hash(nt,it[st-1]+et+tt));return it.join("").substr(0,rt)};function hash(et,tt){return et.start().update(tt).digest().getBytes()}function prfOidToMessageDigest(et){var tt;if(!et)tt="hmacWithSHA1";else if(tt=pki.oids[asn1.derToOid(et)],!tt){var rt=new Error("Unsupported PRF OID.");throw rt.oid=et,rt.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],rt}return prfAlgorithmToMessageDigest(tt)}function prfAlgorithmToMessageDigest(et){var tt=forge$4.md;switch(et){case"hmacWithSHA224":tt=forge$4.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":et=et.substr(8).toLowerCase();break;default:var rt=new Error("Unsupported PRF algorithm.");throw rt.algorithm=et,rt.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],rt}if(!tt||!(et in tt))throw new Error("Unknown hash algorithm: "+et);return tt[et].create()}function createPbkdf2Params(et,tt,rt,nt){var it=asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OCTETSTRING,!1,et),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,tt.getBytes())]);return nt!=="hmacWithSHA1"&&it.value.push(asn1.create(asn1.Class.UNIVERSAL,asn1.Type.INTEGER,!1,forge$4.util.hexToBytes(rt.toString(16))),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.SEQUENCE,!0,[asn1.create(asn1.Class.UNIVERSAL,asn1.Type.OID,!1,asn1.oidToDer(pki.oids[nt]).getBytes()),asn1.create(asn1.Class.UNIVERSAL,asn1.Type.NULL,!1,"")])),it}var webcrypto$2={};webcrypto$2.get=(et=globalThis)=>{const tt=et.crypto;if(!tt||!tt.subtle)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return tt};const{concat}=require$$7$1,{fromString}=require$$9$2,webcrypto$1=webcrypto$2;function create$2({algorithm:et="AES-GCM",nonceLength:tt=12,keyLength:rt=16,digest:nt="SHA-256",saltLength:it=16,iterations:ot=32767}={}){const st=webcrypto$1.get();rt*=8;async function at(ut,lt){const ht=st.getRandomValues(new Uint8Array(it)),ft=st.getRandomValues(new Uint8Array(tt)),dt={name:et,iv:ft},pt={name:"PBKDF2",salt:ht,iterations:ot,hash:{name:nt}},gt=await st.subtle.importKey("raw",fromString(lt),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),_t=await st.subtle.deriveKey(pt,gt,{name:et,length:rt},!0,["encrypt"]),mt=await st.subtle.encrypt(dt,_t,ut);return concat([ht,dt.iv,new Uint8Array(mt)])}async function ct(ut,lt){const ht=ut.slice(0,it),ft=ut.slice(it,it+tt),dt=ut.slice(it+tt),pt={name:et,iv:ft},gt={name:"PBKDF2",salt:ht,iterations:ot,hash:{name:nt}},_t=await st.subtle.importKey("raw",fromString(lt),{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),mt=await st.subtle.deriveKey(gt,_t,{name:et,length:rt},!0,["decrypt"]),At=await st.subtle.decrypt(pt,mt,dt);return new Uint8Array(At)}return{encrypt:at,decrypt:ct}}var aesGcm_browser={create:create$2};const{base64:base64$1}=require$$4,ciphers$1=aesGcm_browser;var importer$1={import:async function(et,tt){const rt=base64$1.decode(et);return await ciphers$1.create().decrypt(rt,tt)}},forge$3=forge$p,sha512=forge$3.sha512=forge$3.sha512||{};forge$3.md.sha512=forge$3.md.algorithms.sha512=sha512;var sha384=forge$3.sha384=forge$3.sha512.sha384=forge$3.sha512.sha384||{};sha384.create=function(){return sha512.create("SHA-384")},forge$3.md.sha384=forge$3.md.algorithms.sha384=sha384,forge$3.sha512.sha256=forge$3.sha512.sha256||{create:function(){return sha512.create("SHA-512/256")}},forge$3.md["sha512/256"]=forge$3.md.algorithms["sha512/256"]=forge$3.sha512.sha256,forge$3.sha512.sha224=forge$3.sha512.sha224||{create:function(){return sha512.create("SHA-512/224")}},forge$3.md["sha512/224"]=forge$3.md.algorithms["sha512/224"]=forge$3.sha512.sha224,sha512.create=function(et){if(_initialized||_init(),typeof et>"u"&&(et="SHA-512"),!(et in _states))throw new Error("Invalid SHA-512 algorithm: "+et);for(var tt=_states[et],rt=null,nt=forge$3.util.createBuffer(),it=new Array(80),ot=0;ot<80;++ot)it[ot]=new Array(2);var st=64;switch(et){case"SHA-384":st=48;break;case"SHA-512/256":st=32;break;case"SHA-512/224":st=28;break}var at={algorithm:et.replace("-","").toLowerCase(),blockLength:128,digestLength:st,messageLength:0,fullMessageLength:null,messageLengthSize:16};return at.start=function(){at.messageLength=0,at.fullMessageLength=at.messageLength128=[];for(var ct=at.messageLengthSize/4,ut=0;ut<ct;++ut)at.fullMessageLength.push(0);nt=forge$3.util.createBuffer(),rt=new Array(tt.length);for(var ut=0;ut<tt.length;++ut)rt[ut]=tt[ut].slice(0);return at},at.start(),at.update=function(ct,ut){ut==="utf8"&&(ct=forge$3.util.encodeUtf8(ct));var lt=ct.length;at.messageLength+=lt,lt=[lt/4294967296>>>0,lt>>>0];for(var ht=at.fullMessageLength.length-1;ht>=0;--ht)at.fullMessageLength[ht]+=lt[1],lt[1]=lt[0]+(at.fullMessageLength[ht]/4294967296>>>0),at.fullMessageLength[ht]=at.fullMessageLength[ht]>>>0,lt[0]=lt[1]/4294967296>>>0;return nt.putBytes(ct),_update(rt,it,nt),(nt.read>2048||nt.length()===0)&&nt.compact(),at},at.digest=function(){var ct=forge$3.util.createBuffer();ct.putBytes(nt.bytes());var ut=at.fullMessageLength[at.fullMessageLength.length-1]+at.messageLengthSize,lt=ut&at.blockLength-1;ct.putBytes(_padding.substr(0,at.blockLength-lt));for(var ht,ft,dt=at.fullMessageLength[0]*8,pt=0;pt<at.fullMessageLength.length-1;++pt)ht=at.fullMessageLength[pt+1]*8,ft=ht/4294967296>>>0,dt+=ft,ct.putInt32(dt>>>0),dt=ht>>>0;ct.putInt32(dt);for(var gt=new Array(rt.length),pt=0;pt<rt.length;++pt)gt[pt]=rt[pt].slice(0);_update(gt,it,ct);var _t=forge$3.util.createBuffer(),mt;et==="SHA-512"?mt=gt.length:et==="SHA-384"?mt=gt.length-2:mt=gt.length-4;for(var pt=0;pt<mt;++pt)_t.putInt32(gt[pt][0]),(pt!==mt-1||et!=="SHA-512/224")&&_t.putInt32(gt[pt][1]);return _t},at};var _padding=null,_initialized=!1,_k=null,_states=null;function _init(){_padding=String.fromCharCode(128),_padding+=forge$3.util.fillString(String.fromCharCode(0),128),_k=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],_states={},_states["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],_states["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],_states["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],_states["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],_initialized=!0}function _update(et,tt,rt){for(var nt,it,ot,st,at,ct,ut,lt,ht,ft,dt,pt,gt,_t,mt,At,It,Mt,kt,Ct,Ut,Wt,Ft,Ce,bt,yt,$t,Et,Tt,Pt,St,Dt,wt,xt,Ke,Pe=rt.length();Pe>=128;){for(Tt=0;Tt<16;++Tt)tt[Tt][0]=rt.getInt32()>>>0,tt[Tt][1]=rt.getInt32()>>>0;for(;Tt<80;++Tt)Dt=tt[Tt-2],Pt=Dt[0],St=Dt[1],nt=((Pt>>>19|St<<13)^(St>>>29|Pt<<3)^Pt>>>6)>>>0,it=((Pt<<13|St>>>19)^(St<<3|Pt>>>29)^(Pt<<26|St>>>6))>>>0,xt=tt[Tt-15],Pt=xt[0],St=xt[1],ot=((Pt>>>1|St<<31)^(Pt>>>8|St<<24)^Pt>>>7)>>>0,st=((Pt<<31|St>>>1)^(Pt<<24|St>>>8)^(Pt<<25|St>>>7))>>>0,wt=tt[Tt-7],Ke=tt[Tt-16],St=it+wt[1]+st+Ke[1],tt[Tt][0]=nt+wt[0]+ot+Ke[0]+(St/4294967296>>>0)>>>0,tt[Tt][1]=St>>>0;for(gt=et[0][0],_t=et[0][1],mt=et[1][0],At=et[1][1],It=et[2][0],Mt=et[2][1],kt=et[3][0],Ct=et[3][1],Ut=et[4][0],Wt=et[4][1],Ft=et[5][0],Ce=et[5][1],bt=et[6][0],yt=et[6][1],$t=et[7][0],Et=et[7][1],Tt=0;Tt<80;++Tt)ut=((Ut>>>14|Wt<<18)^(Ut>>>18|Wt<<14)^(Wt>>>9|Ut<<23))>>>0,lt=((Ut<<18|Wt>>>14)^(Ut<<14|Wt>>>18)^(Wt<<23|Ut>>>9))>>>0,ht=(bt^Ut&(Ft^bt))>>>0,ft=(yt^Wt&(Ce^yt))>>>0,at=((gt>>>28|_t<<4)^(_t>>>2|gt<<30)^(_t>>>7|gt<<25))>>>0,ct=((gt<<4|_t>>>28)^(_t<<30|gt>>>2)^(_t<<25|gt>>>7))>>>0,dt=(gt&mt|It&(gt^mt))>>>0,pt=(_t&At|Mt&(_t^At))>>>0,St=Et+lt+ft+_k[Tt][1]+tt[Tt][1],nt=$t+ut+ht+_k[Tt][0]+tt[Tt][0]+(St/4294967296>>>0)>>>0,it=St>>>0,St=ct+pt,ot=at+dt+(St/4294967296>>>0)>>>0,st=St>>>0,$t=bt,Et=yt,bt=Ft,yt=Ce,Ft=Ut,Ce=Wt,St=Ct+it,Ut=kt+nt+(St/4294967296>>>0)>>>0,Wt=St>>>0,kt=It,Ct=Mt,It=mt,Mt=At,mt=gt,At=_t,St=it+st,gt=nt+ot+(St/4294967296>>>0)>>>0,_t=St>>>0;St=et[0][1]+_t,et[0][0]=et[0][0]+gt+(St/4294967296>>>0)>>>0,et[0][1]=St>>>0,St=et[1][1]+At,et[1][0]=et[1][0]+mt+(St/4294967296>>>0)>>>0,et[1][1]=St>>>0,St=et[2][1]+Mt,et[2][0]=et[2][0]+It+(St/4294967296>>>0)>>>0,et[2][1]=St>>>0,St=et[3][1]+Ct,et[3][0]=et[3][0]+kt+(St/4294967296>>>0)>>>0,et[3][1]=St>>>0,St=et[4][1]+Wt,et[4][0]=et[4][0]+Ut+(St/4294967296>>>0)>>>0,et[4][1]=St>>>0,St=et[5][1]+Ce,et[5][0]=et[5][0]+Ft+(St/4294967296>>>0)>>>0,et[5][1]=St>>>0,St=et[6][1]+yt,et[6][0]=et[6][0]+bt+(St/4294967296>>>0)>>>0,et[6][1]=St>>>0,St=et[7][1]+Et,et[7][0]=et[7][0]+$t+(St/4294967296>>>0)>>>0,et[7][1]=St>>>0,Pe-=128}}var rsaBrowser={};const randomBytes$1=random_browser,errcode$4=errCode$i;var randomBytes_1=function(et){if(isNaN(et)||et<=0)throw errcode$4(new Error("random bytes length must be a Number bigger than 0"),"ERR_INVALID_LENGTH");return randomBytes$1(et)},rsaUtils={},util={};(function(et){const tt=forge$p,{fromString:rt}=require$$9$2,{toString:nt}=require$$1$2,{concat:it}=require$$7$1;et.bigIntegerToUintBase64url=(ot,st)=>{let at=Uint8Array.from(ot.abs().toByteArray());if(at=at[0]===0?at.slice(1):at,st!=null){if(at.length>st)throw new Error("byte array longer than desired length");at=it([new Uint8Array(st-at.length),at])}return nt(at,"base64url")},et.base64urlToBigInteger=ot=>{const st=et.base64urlToBuffer(ot);return new tt.jsbn.BigInteger(nt(st,"base16"),16)},et.base64urlToBuffer=(ot,st)=>{let at=rt(ot,"base64urlpad");if(st!=null){if(at.length>st)throw new Error("byte array longer than desired length");at=it([new Uint8Array(st-at.length),at])}return at}})(util);const forge$2=forge$p,{bigIntegerToUintBase64url,base64urlToBigInteger}=util,{fromString:uint8ArrayFromString$2}=require$$9$2,{toString:uint8ArrayToString$3}=require$$1$2;rsaUtils.pkcs1ToJwk=function(et){const tt=forge$2.asn1.fromDer(uint8ArrayToString$3(et,"ascii")),rt=forge$2.pki.privateKeyFromAsn1(tt);return{kty:"RSA",n:bigIntegerToUintBase64url(rt.n),e:bigIntegerToUintBase64url(rt.e),d:bigIntegerToUintBase64url(rt.d),p:bigIntegerToUintBase64url(rt.p),q:bigIntegerToUintBase64url(rt.q),dp:bigIntegerToUintBase64url(rt.dP),dq:bigIntegerToUintBase64url(rt.dQ),qi:bigIntegerToUintBase64url(rt.qInv),alg:"RS256",kid:"2011-04-29"}},rsaUtils.jwkToPkcs1=function(et){const tt=forge$2.pki.privateKeyToAsn1({n:base64urlToBigInteger(et.n),e:base64urlToBigInteger(et.e),d:base64urlToBigInteger(et.d),p:base64urlToBigInteger(et.p),q:base64urlToBigInteger(et.q),dP:base64urlToBigInteger(et.dp),dQ:base64urlToBigInteger(et.dq),qInv:base64urlToBigInteger(et.qi)});return uint8ArrayFromString$2(forge$2.asn1.toDer(tt).getBytes(),"ascii")},rsaUtils.pkixToJwk=function(et){const tt=forge$2.asn1.fromDer(uint8ArrayToString$3(et,"ascii")),rt=forge$2.pki.publicKeyFromAsn1(tt);return{kty:"RSA",n:bigIntegerToUintBase64url(rt.n),e:bigIntegerToUintBase64url(rt.e),alg:"RS256",kid:"2011-04-29"}},rsaUtils.jwkToPkix=function(et){const tt=forge$2.pki.publicKeyToAsn1({n:base64urlToBigInteger(et.n),e:base64urlToBigInteger(et.e)});return uint8ArrayFromString$2(forge$2.asn1.toDer(tt).getBytes(),"ascii")};var jwk2pem,hasRequiredJwk2pem;function requireJwk2pem(){if(hasRequiredJwk2pem)return jwk2pem;hasRequiredJwk2pem=1;const et=forge$p,{base64urlToBigInteger:tt}=util;function rt(ot,st){return st.map(at=>tt(ot[at]))}function nt(ot){return et.pki.setRsaPrivateKey(...rt(ot,["n","e","d","p","q","dp","dq","qi"]))}function it(ot){return et.pki.setRsaPublicKey(...rt(ot,["n","e"]))}return jwk2pem={jwk2pub:it,jwk2priv:nt},jwk2pem}const webcrypto=webcrypto$2,randomBytes=randomBytes_1,{toString:uint8ArrayToString$2}=require$$1$2,{fromString:uint8ArrayFromString$1}=require$$9$2;rsaBrowser.utils=rsaUtils,rsaBrowser.generateKey=async function(et){const tt=await webcrypto.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:et,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),rt=await exportKey(tt);return{privateKey:rt[0],publicKey:rt[1]}},rsaBrowser.unmarshalPrivateKey=async function(et){const tt=[await webcrypto.get().subtle.importKey("jwk",et,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await derivePublicFromPrivate(et)],rt=await exportKey({privateKey:tt[0],publicKey:tt[1]});return{privateKey:rt[0],publicKey:rt[1]}},rsaBrowser.getRandomValues=randomBytes,rsaBrowser.hashAndSign=async function(et,tt){const rt=await webcrypto.get().subtle.importKey("jwk",et,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),nt=await webcrypto.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},rt,Uint8Array.from(tt));return new Uint8Array(nt,nt.byteOffset,nt.byteLength)},rsaBrowser.hashAndVerify=async function(et,tt,rt){const nt=await webcrypto.get().subtle.importKey("jwk",et,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return webcrypto.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},nt,tt,rt)};function exportKey(et){return Promise.all([webcrypto.get().subtle.exportKey("jwk",et.privateKey),webcrypto.get().subtle.exportKey("jwk",et.publicKey)])}function derivePublicFromPrivate(et){return webcrypto.get().subtle.importKey("jwk",{kty:et.kty,n:et.n,e:et.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}const{jwk2pub,jwk2priv}=requireJwk2pem();function convertKey(et,tt,rt,nt){const it=tt?jwk2pub(et):jwk2priv(et),ot=uint8ArrayToString$2(Uint8Array.from(rt),"ascii"),st=nt(ot,it);return uint8ArrayFromString$1(st,"ascii")}rsaBrowser.encrypt=function(et,tt){return convertKey(et,!0,tt,(rt,nt)=>nt.encrypt(rt))},rsaBrowser.decrypt=function(et,tt){return convertKey(et,!1,tt,(rt,nt)=>nt.decrypt(rt))};const{base64}=require$$4,ciphers=aesGcm_browser;var exporter$3={export:async function(et,tt){const rt=await ciphers.create().encrypt(et,tt);return base64.encode(rt)}};const{sha256:sha256$2}=require$$1$4,errcode$3=errCode$i,{equals:uint8ArrayEquals$2}=require$$1$3,{toString:uint8ArrayToString$1}=require$$1$2,forge$1=forge$p,crypto$2=rsaBrowser,pbm$1=keys$1,exporter$2=exporter$3;class RsaPublicKey{constructor(tt){this._key=tt}async verify(tt,rt){return crypto$2.hashAndVerify(this._key,rt,tt)}marshal(){return crypto$2.utils.jwkToPkix(this._key)}get bytes(){return pbm$1.PublicKey.encode({Type:pbm$1.KeyType.RSA,Data:this.marshal()}).finish()}encrypt(tt){return crypto$2.encrypt(this._key,tt)}equals(tt){return uint8ArrayEquals$2(this.bytes,tt.bytes)}async hash(){const{bytes:tt}=await sha256$2.digest(this.bytes);return tt}}class RsaPrivateKey{constructor(tt,rt){this._key=tt,this._publicKey=rt}genSecret(){return crypto$2.getRandomValues(16)}async sign(tt){return crypto$2.hashAndSign(this._key,tt)}get public(){if(!this._publicKey)throw errcode$3(new Error("public key not provided"),"ERR_PUBKEY_NOT_PROVIDED");return new RsaPublicKey(this._publicKey)}decrypt(tt){return crypto$2.decrypt(this._key,tt)}marshal(){return crypto$2.utils.jwkToPkcs1(this._key)}get bytes(){return pbm$1.PrivateKey.encode({Type:pbm$1.KeyType.RSA,Data:this.marshal()}).finish()}equals(tt){return uint8ArrayEquals$2(this.bytes,tt.bytes)}async hash(){const{bytes:tt}=await sha256$2.digest(this.bytes);return tt}async id(){const tt=await this.public.hash();return uint8ArrayToString$1(tt,"base58btc")}async export(tt,rt="pkcs-8"){if(rt==="pkcs-8"){const nt=new forge$1.util.ByteBuffer(this.marshal()),it=forge$1.asn1.fromDer(nt),ot=forge$1.pki.privateKeyFromAsn1(it),st={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return forge$1.pki.encryptRsaPrivateKey(ot,tt,st)}else{if(rt==="libp2p-key")return exporter$2.export(this.bytes,tt);throw errcode$3(new Error(`export format '${rt}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}}async function unmarshalRsaPrivateKey(et){const tt=crypto$2.utils.pkcs1ToJwk(et),rt=await crypto$2.unmarshalPrivateKey(tt);return new RsaPrivateKey(rt.privateKey,rt.publicKey)}function unmarshalRsaPublicKey(et){const tt=crypto$2.utils.pkixToJwk(et);return new RsaPublicKey(tt)}async function fromJwk(et){const tt=await crypto$2.unmarshalPrivateKey(et);return new RsaPrivateKey(tt.privateKey,tt.publicKey)}async function generateKeyPair$3(et){const tt=await crypto$2.generateKey(et);return new RsaPrivateKey(tt.privateKey,tt.publicKey)}var rsaClass={RsaPublicKey,RsaPrivateKey,unmarshalRsaPublicKey,unmarshalRsaPrivateKey,generateKeyPair:generateKeyPair$3,fromJwk},ed25519={},lib$1={};(function(et){Object.defineProperty(et,"__esModule",{value:!0}),et.utils=et.curve25519=et.getSharedSecret=et.sync=et.verify=et.sign=et.getPublicKey=et.Signature=et.Point=et.RistrettoPoint=et.ExtendedPoint=et.CURVE=void 0;const tt=require$$0$3,rt=BigInt(0),nt=BigInt(1),it=BigInt(2),ot=BigInt(8),st=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),at=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:st,n:st,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")});et.CURVE=at;const ct=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),ut=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742");const lt=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),ht=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),ft=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),dt=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");class pt{constructor(Ot,Kt,$e,nr){this.x=Ot,this.y=Kt,this.z=$e,this.t=nr}static fromAffine(Ot){if(!(Ot instanceof kt))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return Ot.equals(kt.ZERO)?pt.ZERO:new pt(Ot.x,Ot.y,nt,St(Ot.x*Ot.y))}static toAffineBatch(Ot){const Kt=wt(Ot.map($e=>$e.z));return Ot.map(($e,nr)=>$e.toAffine(Kt[nr]))}static normalizeZ(Ot){return this.toAffineBatch(Ot).map(this.fromAffine)}equals(Ot){_t(Ot);const{x:Kt,y:$e,z:nr}=this,{x:Ze,y:tr,z:lr}=Ot,dr=St(Kt*lr),br=St(Ze*nr),Rr=St($e*lr),Er=St(tr*nr);return dr===br&&Rr===Er}negate(){return new pt(St(-this.x),this.y,this.z,St(-this.t))}double(){const{x:Ot,y:Kt,z:$e}=this,{a:nr}=at,Ze=St(Ot*Ot),tr=St(Kt*Kt),lr=St(it*St($e*$e)),dr=St(nr*Ze),br=Ot+Kt,Rr=St(St(br*br)-Ze-tr),Er=dr+tr,_r=Er-lr,Cr=dr-tr,Ar=St(Rr*_r),Zt=St(Er*Cr),Vt=St(Rr*Cr),Jt=St(_r*Er);return new pt(Ar,Zt,Jt,Vt)}add(Ot){_t(Ot);const{x:Kt,y:$e,z:nr,t:Ze}=this,{x:tr,y:lr,z:dr,t:br}=Ot,Rr=St(($e-Kt)*(lr+tr)),Er=St(($e+Kt)*(lr-tr)),_r=St(Er-Rr);if(_r===rt)return this.double();const Cr=St(nr*it*br),Ar=St(Ze*it*dr),Zt=Ar+Cr,Vt=Er+Rr,Jt=Ar-Cr,Ue=St(Zt*_r),er=St(Vt*Jt),sr=St(Zt*Jt),hr=St(_r*Vt);return new pt(Ue,er,hr,sr)}subtract(Ot){return this.add(Ot.negate())}precomputeWindow(Ot){const Kt=1+256/Ot,$e=[];let nr=this,Ze=nr;for(let tr=0;tr<Kt;tr++){Ze=nr,$e.push(Ze);for(let lr=1;lr<2**(Ot-1);lr++)Ze=Ze.add(nr),$e.push(Ze);nr=Ze.double()}return $e}wNAF(Ot,Kt){!Kt&&this.equals(pt.BASE)&&(Kt=kt.BASE);const $e=Kt&&Kt._WINDOW_SIZE||1;if(256%$e)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let nr=Kt&&Mt.get(Kt);nr||(nr=this.precomputeWindow($e),Kt&&$e!==1&&(nr=pt.normalizeZ(nr),Mt.set(Kt,nr)));let Ze=pt.ZERO,tr=pt.BASE;const lr=1+256/$e,dr=2**($e-1),br=BigInt(2**$e-1),Rr=2**$e,Er=BigInt($e);for(let _r=0;_r<lr;_r++){const Cr=_r*dr;let Ar=Number(Ot&br);Ot>>=Er,Ar>dr&&(Ar-=Rr,Ot+=nt);const Zt=Cr,Vt=Cr+Math.abs(Ar)-1,Jt=_r%2!==0,Ue=Ar<0;Ar===0?tr=tr.add(gt(Jt,nr[Zt])):Ze=Ze.add(gt(Ue,nr[Vt]))}return pt.normalizeZ([Ze,tr])[0]}multiply(Ot,Kt){return this.wNAF(Ge(Ot,at.l),Kt)}multiplyUnsafe(Ot){let Kt=Ge(Ot,at.l,!1);const $e=pt.BASE,nr=pt.ZERO;if(Kt===rt)return nr;if(this.equals(nr)||Kt===nt)return this;if(this.equals($e))return this.wNAF(Kt);let Ze=nr,tr=this;for(;Kt>rt;)Kt&nt&&(Ze=Ze.add(tr)),tr=tr.double(),Kt>>=nt;return Ze}isSmallOrder(){return this.multiplyUnsafe(at.h).equals(pt.ZERO)}isTorsionFree(){let Ot=this.multiplyUnsafe(at.l/it).double();return at.l%it&&(Ot=Ot.add(this)),Ot.equals(pt.ZERO)}toAffine(Ot){const{x:Kt,y:$e,z:nr}=this,Ze=this.equals(pt.ZERO);Ot==null&&(Ot=Ze?ot:Dt(nr));const tr=St(Kt*Ot),lr=St($e*Ot),dr=St(nr*Ot);if(Ze)return kt.ZERO;if(dr!==nt)throw new Error("invZ was invalid");return new kt(tr,lr)}fromRistrettoBytes(){At()}toRistrettoBytes(){At()}fromRistrettoHash(){At()}}et.ExtendedPoint=pt,pt.BASE=new pt(at.Gx,at.Gy,nt,St(at.Gx*at.Gy)),pt.ZERO=new pt(rt,nt,nt,rt);function gt(Nt,Ot){const Kt=Ot.negate();return Nt?Kt:Ot}function _t(Nt){if(!(Nt instanceof pt))throw new TypeError("ExtendedPoint expected")}function mt(Nt){if(!(Nt instanceof It))throw new TypeError("RistrettoPoint expected")}function At(){throw new Error("Legacy method: switch to RistrettoPoint")}class It{constructor(Ot){this.ep=Ot}static calcElligatorRistrettoMap(Ot){const{d:Kt}=at,$e=St(ut*Ot*Ot),nr=St(($e+nt)*ft);let Ze=BigInt(-1);const tr=St((Ze-Kt*$e)*St($e+Kt));let{isValid:lr,value:dr}=Pe(nr,tr),br=St(dr*Ot);$t(br)||(br=St(-br)),lr||(dr=br),lr||(Ze=$e);const Rr=St(Ze*($e-nt)*dt-tr),Er=dr*dr,_r=St((dr+dr)*tr),Cr=St(Rr*lt),Ar=St(nt-Er),Zt=St(nt+Er);return new pt(St(_r*Zt),St(Ar*Cr),St(Cr*Zt),St(_r*Ar))}static hashToCurve(Ot){Ot=qt(Ot,64);const Kt=Pt(Ot.slice(0,32)),$e=this.calcElligatorRistrettoMap(Kt),nr=Pt(Ot.slice(32,64)),Ze=this.calcElligatorRistrettoMap(nr);return new It($e.add(Ze))}static fromHex(Ot){Ot=qt(Ot,32);const{a:Kt,d:$e}=at,nr="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",Ze=Pt(Ot);if(!jt(yt(Ze),Ot)||$t(Ze))throw new Error(nr);const tr=St(Ze*Ze),lr=St(nt+Kt*tr),dr=St(nt-Kt*tr),br=St(lr*lr),Rr=St(dr*dr),Er=St(Kt*$e*br-Rr),{isValid:_r,value:Cr}=Ht(St(Er*Rr)),Ar=St(Cr*dr),Zt=St(Cr*Ar*Er);let Vt=St((Ze+Ze)*Ar);$t(Vt)&&(Vt=St(-Vt));const Jt=St(lr*Zt),Ue=St(Vt*Jt);if(!_r||$t(Ue)||Jt===rt)throw new Error(nr);return new It(new pt(Vt,Jt,nt,Ue))}toRawBytes(){let{x:Ot,y:Kt,z:$e,t:nr}=this.ep;const Ze=St(St($e+Kt)*St($e-Kt)),tr=St(Ot*Kt),lr=St(tr*tr),{value:dr}=Ht(St(Ze*lr)),br=St(dr*Ze),Rr=St(dr*tr),Er=St(br*Rr*nr);let _r;if($t(nr*Er)){let Ar=St(Kt*ut),Zt=St(Ot*ut);Ot=Ar,Kt=Zt,_r=St(br*ht)}else _r=Rr;$t(Ot*Er)&&(Kt=St(-Kt));let Cr=St(($e-Kt)*_r);return $t(Cr)&&(Cr=St(-Cr)),yt(Cr)}toHex(){return Ft(this.toRawBytes())}toString(){return this.toHex()}equals(Ot){mt(Ot);const Kt=this.ep,$e=Ot.ep,nr=St(Kt.x*$e.y)===St(Kt.y*$e.x),Ze=St(Kt.y*$e.y)===St(Kt.x*$e.x);return nr||Ze}add(Ot){return mt(Ot),new It(this.ep.add(Ot.ep))}subtract(Ot){return mt(Ot),new It(this.ep.subtract(Ot.ep))}multiply(Ot){return new It(this.ep.multiply(Ot))}multiplyUnsafe(Ot){return new It(this.ep.multiplyUnsafe(Ot))}}et.RistrettoPoint=It,It.BASE=new It(pt.BASE),It.ZERO=new It(pt.ZERO);const Mt=new WeakMap;class kt{constructor(Ot,Kt){this.x=Ot,this.y=Kt}_setWindowSize(Ot){this._WINDOW_SIZE=Ot,Mt.delete(this)}static fromHex(Ot,Kt=!0){const{d:$e,P:nr}=at;Ot=qt(Ot,32);const Ze=Ot.slice();Ze[31]=Ot[31]&-129;const tr=Et(Ze);if(Kt&&tr>=nr)throw new Error("Expected 0 < hex < P");if(!Kt&&tr>=ct)throw new Error("Expected 0 < hex < 2**256");const lr=St(tr*tr),dr=St(lr-nt),br=St($e*lr+nt);let{isValid:Rr,value:Er}=Pe(dr,br);if(!Rr)throw new Error("Point.fromHex: invalid y coordinate");const _r=(Er&nt)===nt;return(Ot[31]&128)!==0!==_r&&(Er=St(-Er)),new kt(Er,tr)}static async fromPrivateKey(Ot){return(await ar(Ot)).point}toRawBytes(){const Ot=yt(this.y);return Ot[31]|=this.x&nt?128:0,Ot}toHex(){return Ft(this.toRawBytes())}toX25519(){const{y:Ot}=this,Kt=St((nt+Ot)*Dt(nt-Ot));return yt(Kt)}isTorsionFree(){return pt.fromAffine(this).isTorsionFree()}equals(Ot){return this.x===Ot.x&&this.y===Ot.y}negate(){return new kt(St(-this.x),this.y)}add(Ot){return pt.fromAffine(this).add(pt.fromAffine(Ot)).toAffine()}subtract(Ot){return this.add(Ot.negate())}multiply(Ot){return pt.fromAffine(this).multiply(Ot,this).toAffine()}}et.Point=kt,kt.BASE=new kt(at.Gx,at.Gy),kt.ZERO=new kt(rt,nt);class Ct{constructor(Ot,Kt){this.r=Ot,this.s=Kt,this.assertValidity()}static fromHex(Ot){const Kt=qt(Ot,64),$e=kt.fromHex(Kt.slice(0,32),!1),nr=Et(Kt.slice(32,64));return new Ct($e,nr)}assertValidity(){const{r:Ot,s:Kt}=this;if(!(Ot instanceof kt))throw new Error("Expected Point instance");return Ge(Kt,at.l,!1),this}toRawBytes(){const Ot=new Uint8Array(64);return Ot.set(this.r.toRawBytes()),Ot.set(yt(this.s),32),Ot}toHex(){return Ft(this.toRawBytes())}}et.Signature=Ct;function Ut(...Nt){if(!Nt.every($e=>$e instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(Nt.length===1)return Nt[0];const Ot=Nt.reduce(($e,nr)=>$e+nr.length,0),Kt=new Uint8Array(Ot);for(let $e=0,nr=0;$e<Nt.length;$e++){const Ze=Nt[$e];Kt.set(Ze,nr),nr+=Ze.length}return Kt}const Wt=Array.from({length:256},(Nt,Ot)=>Ot.toString(16).padStart(2,"0"));function Ft(Nt){if(!(Nt instanceof Uint8Array))throw new Error("Uint8Array expected");let Ot="";for(let Kt=0;Kt<Nt.length;Kt++)Ot+=Wt[Nt[Kt]];return Ot}function Ce(Nt){if(typeof Nt!="string")throw new TypeError("hexToBytes: expected string, got "+typeof Nt);if(Nt.length%2)throw new Error("hexToBytes: received invalid unpadded hex");const Ot=new Uint8Array(Nt.length/2);for(let Kt=0;Kt<Ot.length;Kt++){const $e=Kt*2,nr=Nt.slice($e,$e+2),Ze=Number.parseInt(nr,16);if(Number.isNaN(Ze)||Ze<0)throw new Error("Invalid byte sequence");Ot[Kt]=Ze}return Ot}function bt(Nt){const Ot=Nt.toString(16).padStart(64,"0");return Ce(Ot)}function yt(Nt){return bt(Nt).reverse()}function $t(Nt){return(St(Nt)&nt)===nt}function Et(Nt){if(!(Nt instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+Ft(Uint8Array.from(Nt).reverse()))}const Tt=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function Pt(Nt){return St(Et(Nt)&Tt)}function St(Nt,Ot=at.P){const Kt=Nt%Ot;return Kt>=rt?Kt:Ot+Kt}function Dt(Nt,Ot=at.P){if(Nt===rt||Ot<=rt)throw new Error(`invert: expected positive integers, got n=${Nt} mod=${Ot}`);let Kt=St(Nt,Ot),$e=Ot,nr=rt,Ze=nt;for(;Kt!==rt;){const tr=$e/Kt,lr=$e%Kt,dr=nr-Ze*tr;$e=Kt,Kt=lr,nr=Ze,Ze=dr}if($e!==nt)throw new Error("invert: does not exist");return St(nr,Ot)}function wt(Nt,Ot=at.P){const Kt=new Array(Nt.length),$e=Nt.reduce((Ze,tr,lr)=>tr===rt?Ze:(Kt[lr]=Ze,St(Ze*tr,Ot)),nt),nr=Dt($e,Ot);return Nt.reduceRight((Ze,tr,lr)=>tr===rt?Ze:(Kt[lr]=St(Ze*Kt[lr],Ot),St(Ze*tr,Ot)),nr),Kt}function xt(Nt,Ot){const{P:Kt}=at;let $e=Nt;for(;Ot-- >rt;)$e*=$e,$e%=Kt;return $e}function Ke(Nt){const{P:Ot}=at,Kt=BigInt(5),$e=BigInt(10),nr=BigInt(20),Ze=BigInt(40),tr=BigInt(80),lr=Nt*Nt%Ot*Nt%Ot,dr=xt(lr,it)*lr%Ot,br=xt(dr,nt)*Nt%Ot,Rr=xt(br,Kt)*br%Ot,Er=xt(Rr,$e)*Rr%Ot,_r=xt(Er,nr)*Er%Ot,Cr=xt(_r,Ze)*_r%Ot,Ar=xt(Cr,tr)*Cr%Ot,Zt=xt(Ar,tr)*Cr%Ot,Vt=xt(Zt,$e)*Rr%Ot;return{pow_p_5_8:xt(Vt,it)*Nt%Ot,b2:lr}}function Pe(Nt,Ot){const Kt=St(Ot*Ot*Ot),$e=St(Kt*Kt*Ot),nr=Ke(Nt*$e).pow_p_5_8;let Ze=St(Nt*Kt*nr);const tr=St(Ot*Ze*Ze),lr=Ze,dr=St(Ze*ut),br=tr===Nt,Rr=tr===St(-Nt),Er=tr===St(-Nt*ut);return br&&(Ze=lr),(Rr||Er)&&(Ze=dr),$t(Ze)&&(Ze=St(-Ze)),{isValid:br||Rr,value:Ze}}function Ht(Nt){return Pe(nt,Nt)}function zt(Nt){return St(Et(Nt),at.l)}function jt(Nt,Ot){if(Nt.length!==Ot.length)return!1;for(let Kt=0;Kt<Nt.length;Kt++)if(Nt[Kt]!==Ot[Kt])return!1;return!0}function qt(Nt,Ot){const Kt=Nt instanceof Uint8Array?Uint8Array.from(Nt):Ce(Nt);if(typeof Ot=="number"&&Kt.length!==Ot)throw new Error(`Expected ${Ot} bytes`);return Kt}function Ge(Nt,Ot,Kt=!0){if(!Ot)throw new TypeError("Specify max value");if(typeof Nt=="number"&&Number.isSafeInteger(Nt)&&(Nt=BigInt(Nt)),typeof Nt=="bigint"&&Nt<Ot){if(Kt){if(rt<Nt)return Nt}else if(rt<=Nt)return Nt}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function Ie(Nt){return Nt[0]&=248,Nt[31]&=127,Nt[31]|=64,Nt}function Xe(Nt){return Et(Ie(qt(Nt,32)))}function Je(Nt){if(Nt=typeof Nt=="bigint"||typeof Nt=="number"?bt(Ge(Nt,ct)):qt(Nt),Nt.length!==32)throw new Error("Expected 32 bytes");return Nt}function Qe(Nt){const Ot=Ie(Nt.slice(0,32)),Kt=Nt.slice(32,64),$e=zt(Ot),nr=kt.BASE.multiply($e),Ze=nr.toRawBytes();return{head:Ot,prefix:Kt,scalar:$e,point:nr,pointBytes:Ze}}let We;function ur(...Nt){if(typeof We!="function")throw new Error("utils.sha512Sync must be set to use sync methods");return We(...Nt)}async function ar(Nt){return Qe(await et.utils.sha512(Je(Nt)))}function cr(Nt){return Qe(ur(Je(Nt)))}async function $r(Nt){return(await ar(Nt)).pointBytes}et.getPublicKey=$r;function fr(Nt){return cr(Nt).pointBytes}async function ue(Nt,Ot){Nt=qt(Nt);const{prefix:Kt,scalar:$e,pointBytes:nr}=await ar(Ot),Ze=zt(await et.utils.sha512(Kt,Nt)),tr=kt.BASE.multiply(Ze),lr=zt(await et.utils.sha512(tr.toRawBytes(),nr,Nt)),dr=St(Ze+lr*$e,at.l);return new Ct(tr,dr).toRawBytes()}et.sign=ue;function Qt(Nt,Ot){Nt=qt(Nt);const{prefix:Kt,scalar:$e,pointBytes:nr}=cr(Ot),Ze=zt(ur(Kt,Nt)),tr=kt.BASE.multiply(Ze),lr=zt(ur(tr.toRawBytes(),nr,Nt)),dr=St(Ze+lr*$e,at.l);return new Ct(tr,dr).toRawBytes()}function me(Nt,Ot,Kt){Ot=qt(Ot),Kt instanceof kt||(Kt=kt.fromHex(Kt,!1));const{r:$e,s:nr}=Nt instanceof Ct?Nt.assertValidity():Ct.fromHex(Nt),Ze=pt.BASE.multiplyUnsafe(nr);return{r:$e,s:nr,SB:Ze,pub:Kt,msg:Ot}}function Lt(Nt,Ot,Kt,$e){const nr=zt($e),Ze=pt.fromAffine(Nt).multiplyUnsafe(nr);return pt.fromAffine(Ot).add(Ze).subtract(Kt).multiplyUnsafe(at.h).equals(pt.ZERO)}async function Gt(Nt,Ot,Kt){const{r:$e,SB:nr,msg:Ze,pub:tr}=me(Nt,Ot,Kt),lr=await et.utils.sha512($e.toRawBytes(),tr.toRawBytes(),Ze);return Lt(tr,$e,nr,lr)}et.verify=Gt;function Xt(Nt,Ot,Kt){const{r:$e,SB:nr,msg:Ze,pub:tr}=me(Nt,Ot,Kt),lr=ur($e.toRawBytes(),tr.toRawBytes(),Ze);return Lt(tr,$e,nr,lr)}et.sync={getExtendedPublicKey:cr,getPublicKey:fr,sign:Qt,verify:Xt};async function Yt(Nt,Ot){const{head:Kt}=await ar(Nt),$e=kt.fromHex(Ot).toX25519();return et.curve25519.scalarMult(Kt,$e)}et.getSharedSecret=Yt,kt.BASE._setWindowSize(8);function He(Nt,Ot,Kt){const $e=St(Nt*(Ot-Kt));return Ot=St(Ot-$e),Kt=St(Kt+$e),[Ot,Kt]}function ir(Nt,Ot){const{P:Kt}=at,$e=Ge(Nt,Kt),nr=Ge(Ot,Kt),Ze=BigInt(121665),tr=$e;let lr=nt,dr=rt,br=$e,Rr=nt,Er=rt,_r;for(let Vt=BigInt(255-1);Vt>=rt;Vt--){const Jt=nr>>Vt&nt;Er^=Jt,_r=He(Er,lr,br),lr=_r[0],br=_r[1],_r=He(Er,dr,Rr),dr=_r[0],Rr=_r[1],Er=Jt;const Ue=lr+dr,er=St(Ue*Ue),sr=lr-dr,hr=St(sr*sr),gr=er-hr,mr=br+Rr,vr=br-Rr,Tr=St(vr*Ue),wr=St(mr*sr),Sr=Tr+wr,Pr=Tr-wr;br=St(Sr*Sr),Rr=St(tr*St(Pr*Pr)),lr=St(er*hr),dr=St(gr*(er+St(Ze*gr)))}_r=He(Er,lr,br),lr=_r[0],br=_r[1],_r=He(Er,dr,Rr),dr=_r[0],Rr=_r[1];const{pow_p_5_8:Cr,b2:Ar}=Ke(dr),Zt=St(xt(Cr,BigInt(3))*Ar);return St(lr*Zt)}function vt(Nt){return yt(St(Nt,at.P))}function Rt(Nt){const Ot=qt(Nt,32);return Ot[31]&=127,Et(Ot)}et.curve25519={BASE_POINT_U:"0900000000000000000000000000000000000000000000000000000000000000",scalarMult(Nt,Ot){const Kt=Rt(Ot),$e=Xe(Nt),nr=ir(Kt,$e);if(nr===rt)throw new Error("Invalid private or public key received");return vt(nr)},scalarMultBase(Nt){return et.curve25519.scalarMult(Nt,et.curve25519.BASE_POINT_U)}};const Bt={node:tt,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};et.utils={bytesToHex:Ft,hexToBytes:Ce,concatBytes:Ut,getExtendedPublicKey:ar,mod:St,invert:Dt,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:Nt=>{if(Nt=qt(Nt),Nt.length<40||Nt.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return St(Et(Nt),at.l-nt)+nt},randomBytes:(Nt=32)=>{if(Bt.web)return Bt.web.getRandomValues(new Uint8Array(Nt));if(Bt.node){const{randomBytes:Ot}=Bt.node;return new Uint8Array(Ot(Nt).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>et.utils.randomBytes(32),sha512:async(...Nt)=>{const Ot=Ut(...Nt);if(Bt.web){const Kt=await Bt.web.subtle.digest("SHA-512",Ot.buffer);return new Uint8Array(Kt)}else{if(Bt.node)return Uint8Array.from(Bt.node.createHash("sha512").update(Ot).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(Nt=8,Ot=kt.BASE){const Kt=Ot.equals(kt.BASE)?Ot:new kt(Ot.x,Ot.y);return Kt._setWindowSize(Nt),Kt.multiply(it),Kt},sha512Sync:void 0},Object.defineProperties(et.utils,{sha512Sync:{configurable:!1,get(){return We},set(Nt){We||(We=Nt)}}})})(lib$1),function(et){const tt=lib$1,rt=32,nt=64,it=32;et.publicKeyLength=rt,et.privateKeyLength=nt,et.generateKey=async function(){const st=tt.utils.randomPrivateKey(),at=await tt.getPublicKey(st);return{privateKey:ot(st,at),publicKey:at}},et.generateKeyFromSeed=async function(st){if(st.length!==it)throw new TypeError('"seed" must be 32 bytes in length.');if(!(st instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');const at=st,ct=await tt.getPublicKey(at);return{privateKey:ot(at,ct),publicKey:ct}},et.hashAndSign=function(st,at){const ct=st.slice(0,it);return tt.sign(at,ct)},et.hashAndVerify=function(st,at,ct){return tt.verify(at,ct,st)};function ot(st,at){const ct=new Uint8Array(et.privateKeyLength);for(let ut=0;ut<it;ut++)ct[ut]=st[ut],ct[it+ut]=at[ut];return ct}}(ed25519);const errcode$2=errCode$i,{equals:uint8ArrayEquals$1}=require$$1$3,{sha256:sha256$1}=require$$1$4,{base58btc:base58btc$1}=require$$1$5,{identity}=require$$7,crypto$1=ed25519,pbm=keys$1,exporter$1=exporter$3;class Ed25519PublicKey{constructor(tt){this._key=ensureKey(tt,crypto$1.publicKeyLength)}async verify(tt,rt){return crypto$1.hashAndVerify(this._key,rt,tt)}marshal(){return this._key}get bytes(){return pbm.PublicKey.encode({Type:pbm.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(tt){return uint8ArrayEquals$1(this.bytes,tt.bytes)}async hash(){const{bytes:tt}=await sha256$1.digest(this.bytes);return tt}}class Ed25519PrivateKey{constructor(tt,rt){this._key=ensureKey(tt,crypto$1.privateKeyLength),this._publicKey=ensureKey(rt,crypto$1.publicKeyLength)}async sign(tt){return crypto$1.hashAndSign(this._key,tt)}get public(){return new Ed25519PublicKey(this._publicKey)}marshal(){return this._key}get bytes(){return pbm.PrivateKey.encode({Type:pbm.KeyType.Ed25519,Data:this.marshal()}).finish()}equals(tt){return uint8ArrayEquals$1(this.bytes,tt.bytes)}async hash(){const{bytes:tt}=await sha256$1.digest(this.bytes);return tt}async id(){const tt=await identity.digest(this.public.bytes);return base58btc$1.encode(tt.bytes).substring(1)}async export(tt,rt="libp2p-key"){if(rt==="libp2p-key")return exporter$1.export(this.bytes,tt);throw errcode$2(new Error(`export format '${rt}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function unmarshalEd25519PrivateKey(et){if(et.length>crypto$1.privateKeyLength){et=ensureKey(et,crypto$1.privateKeyLength+crypto$1.publicKeyLength);const nt=et.slice(0,crypto$1.privateKeyLength),it=et.slice(crypto$1.privateKeyLength,et.length);return new Ed25519PrivateKey(nt,it)}et=ensureKey(et,crypto$1.privateKeyLength);const tt=et.slice(0,crypto$1.privateKeyLength),rt=et.slice(crypto$1.publicKeyLength);return new Ed25519PrivateKey(tt,rt)}function unmarshalEd25519PublicKey(et){return et=ensureKey(et,crypto$1.publicKeyLength),new Ed25519PublicKey(et)}async function generateKeyPair$2(){const{privateKey:et,publicKey:tt}=await crypto$1.generateKey();return new Ed25519PrivateKey(et,tt)}async function generateKeyPairFromSeed$1(et){const{privateKey:tt,publicKey:rt}=await crypto$1.generateKeyFromSeed(et);return new Ed25519PrivateKey(tt,rt)}function ensureKey(et,tt){if(et=Uint8Array.from(et||[]),et.length!==tt)throw errcode$2(new Error(`Key must be a Uint8Array of length ${tt}, got ${et.length}`),"ERR_INVALID_KEY_TYPE");return et}var ed25519Class={Ed25519PublicKey,Ed25519PrivateKey,unmarshalEd25519PrivateKey,unmarshalEd25519PublicKey,generateKeyPair:generateKeyPair$2,generateKeyPairFromSeed:generateKeyPairFromSeed$1},lib={},hasRequiredLib;function requireLib(){return hasRequiredLib||(hasRequiredLib=1,function(et){Object.defineProperty(et,"__esModule",{value:!0}),et.utils=et.schnorr=et.verify=et.signSync=et.sign=et.getSharedSecret=et.recoverPublicKey=et.getPublicKey=et.Signature=et.Point=et.CURVE=void 0;const tt=require$$0$3,rt=BigInt(0),nt=BigInt(1),it=BigInt(2),ot=BigInt(3),st=BigInt(8),at=Object.freeze({a:rt,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:nt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")});et.CURVE=at;const ct=(Zt,Vt)=>(Zt+Vt/it)/Vt,ut={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(Zt){const{n:Vt}=at,Jt=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),Ue=-nt*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),er=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),sr=Jt,hr=BigInt("0x100000000000000000000000000000000"),gr=ct(sr*Zt,Vt),mr=ct(-Ue*Zt,Vt);let vr=Ht(Zt-gr*Jt-mr*er,Vt),Tr=Ht(-gr*Ue-mr*sr,Vt);const wr=vr>hr,Sr=Tr>hr;if(wr&&(vr=Vt-vr),Sr&&(Tr=Vt-Tr),vr>hr||Tr>hr)throw new Error("splitScalarEndo: Endomorphism failed, k="+Zt);return{k1neg:wr,k1:vr,k2neg:Sr,k2:Tr}}},lt=32,ht=32,ft=32,dt=lt+1,pt=2*lt+1;function gt(Zt){const{a:Vt,b:Jt}=at,Ue=Ht(Zt*Zt),er=Ht(Ue*Zt);return Ht(er+Vt*Zt+Jt)}const _t=at.a===rt;class mt extends Error{constructor(Vt){super(Vt)}}function At(Zt){if(!(Zt instanceof It))throw new TypeError("JacobianPoint expected")}class It{constructor(Vt,Jt,Ue){this.x=Vt,this.y=Jt,this.z=Ue}static fromAffine(Vt){if(!(Vt instanceof Ct))throw new TypeError("JacobianPoint#fromAffine: expected Point");return Vt.equals(Ct.ZERO)?It.ZERO:new It(Vt.x,Vt.y,nt)}static toAffineBatch(Vt){const Jt=Ge(Vt.map(Ue=>Ue.z));return Vt.map((Ue,er)=>Ue.toAffine(Jt[er]))}static normalizeZ(Vt){return It.toAffineBatch(Vt).map(It.fromAffine)}equals(Vt){At(Vt);const{x:Jt,y:Ue,z:er}=this,{x:sr,y:hr,z:gr}=Vt,mr=Ht(er*er),vr=Ht(gr*gr),Tr=Ht(Jt*vr),wr=Ht(sr*mr),Sr=Ht(Ht(Ue*gr)*vr),Pr=Ht(Ht(hr*er)*mr);return Tr===wr&&Sr===Pr}negate(){return new It(this.x,Ht(-this.y),this.z)}double(){const{x:Vt,y:Jt,z:Ue}=this,er=Ht(Vt*Vt),sr=Ht(Jt*Jt),hr=Ht(sr*sr),gr=Vt+sr,mr=Ht(it*(Ht(gr*gr)-er-hr)),vr=Ht(ot*er),Tr=Ht(vr*vr),wr=Ht(Tr-it*mr),Sr=Ht(vr*(mr-wr)-st*hr),Pr=Ht(it*Jt*Ue);return new It(wr,Sr,Pr)}add(Vt){At(Vt);const{x:Jt,y:Ue,z:er}=this,{x:sr,y:hr,z:gr}=Vt;if(sr===rt||hr===rt)return this;if(Jt===rt||Ue===rt)return Vt;const mr=Ht(er*er),vr=Ht(gr*gr),Tr=Ht(Jt*vr),wr=Ht(sr*mr),Sr=Ht(Ht(Ue*gr)*vr),Pr=Ht(Ht(hr*er)*mr),Ir=Ht(wr-Tr),Br=Ht(Pr-Sr);if(Ir===rt)return Br===rt?this.double():It.ZERO;const qr=Ht(Ir*Ir),Le=Ht(Ir*qr),yr=Ht(Tr*qr),pr=Ht(Br*Br-Le-it*yr),kr=Ht(Br*(yr-pr)-Sr*Le),Dr=Ht(er*gr*Ir);return new It(pr,kr,Dr)}subtract(Vt){return this.add(Vt.negate())}multiplyUnsafe(Vt){const Jt=It.ZERO;if(typeof Vt=="bigint"&&Vt===rt)return Jt;let Ue=Pe(Vt);if(Ue===nt)return this;if(!_t){let wr=Jt,Sr=this;for(;Ue>rt;)Ue&nt&&(wr=wr.add(Sr)),Sr=Sr.double(),Ue>>=nt;return wr}let{k1neg:er,k1:sr,k2neg:hr,k2:gr}=ut.splitScalar(Ue),mr=Jt,vr=Jt,Tr=this;for(;sr>rt||gr>rt;)sr&nt&&(mr=mr.add(Tr)),gr&nt&&(vr=vr.add(Tr)),Tr=Tr.double(),sr>>=nt,gr>>=nt;return er&&(mr=mr.negate()),hr&&(vr=vr.negate()),vr=new It(Ht(vr.x*ut.beta),vr.y,vr.z),mr.add(vr)}precomputeWindow(Vt){const Jt=_t?128/Vt+1:256/Vt+1,Ue=[];let er=this,sr=er;for(let hr=0;hr<Jt;hr++){sr=er,Ue.push(sr);for(let gr=1;gr<2**(Vt-1);gr++)sr=sr.add(er),Ue.push(sr);er=sr.double()}return Ue}wNAF(Vt,Jt){!Jt&&this.equals(It.BASE)&&(Jt=Ct.BASE);const Ue=Jt&&Jt._WINDOW_SIZE||1;if(256%Ue)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let er=Jt&&kt.get(Jt);er||(er=this.precomputeWindow(Ue),Jt&&Ue!==1&&(er=It.normalizeZ(er),kt.set(Jt,er)));let sr=It.ZERO,hr=It.BASE;const gr=1+(_t?128/Ue:256/Ue),mr=2**(Ue-1),vr=BigInt(2**Ue-1),Tr=2**Ue,wr=BigInt(Ue);for(let Sr=0;Sr<gr;Sr++){const Pr=Sr*mr;let Ir=Number(Vt&vr);Vt>>=wr,Ir>mr&&(Ir-=Tr,Vt+=nt);const Br=Pr,qr=Pr+Math.abs(Ir)-1,Le=Sr%2!==0,yr=Ir<0;Ir===0?hr=hr.add(Mt(Le,er[Br])):sr=sr.add(Mt(yr,er[qr]))}return{p:sr,f:hr}}multiply(Vt,Jt){let Ue=Pe(Vt),er,sr;if(_t){const{k1neg:hr,k1:gr,k2neg:mr,k2:vr}=ut.splitScalar(Ue);let{p:Tr,f:wr}=this.wNAF(gr,Jt),{p:Sr,f:Pr}=this.wNAF(vr,Jt);Tr=Mt(hr,Tr),Sr=Mt(mr,Sr),Sr=new It(Ht(Sr.x*ut.beta),Sr.y,Sr.z),er=Tr.add(Sr),sr=wr.add(Pr)}else{const{p:hr,f:gr}=this.wNAF(Ue,Jt);er=hr,sr=gr}return It.normalizeZ([er,sr])[0]}toAffine(Vt){const{x:Jt,y:Ue,z:er}=this,sr=this.equals(It.ZERO);Vt==null&&(Vt=sr?st:qt(er));const hr=Vt,gr=Ht(hr*hr),mr=Ht(gr*hr),vr=Ht(Jt*gr),Tr=Ht(Ue*mr),wr=Ht(er*hr);if(sr)return Ct.ZERO;if(wr!==nt)throw new Error("invZ was invalid");return new Ct(vr,Tr)}}It.BASE=new It(at.Gx,at.Gy,nt),It.ZERO=new It(rt,nt,rt);function Mt(Zt,Vt){const Jt=Vt.negate();return Zt?Jt:Vt}const kt=new WeakMap;class Ct{constructor(Vt,Jt){this.x=Vt,this.y=Jt}_setWindowSize(Vt){this._WINDOW_SIZE=Vt,kt.delete(this)}hasEvenY(){return this.y%it===rt}static fromCompressedHex(Vt){const Jt=Vt.length===32,Ue=xt(Jt?Vt:Vt.subarray(1));if(!ar(Ue))throw new Error("Point is not on curve");const er=gt(Ue);let sr=jt(er);const hr=(sr&nt)===nt;Jt?hr&&(sr=Ht(-sr)):(Vt[0]&1)===1!==hr&&(sr=Ht(-sr));const gr=new Ct(Ue,sr);return gr.assertValidity(),gr}static fromUncompressedHex(Vt){const Jt=xt(Vt.subarray(1,lt+1)),Ue=xt(Vt.subarray(lt+1,lt*2+1)),er=new Ct(Jt,Ue);return er.assertValidity(),er}static fromHex(Vt){const Jt=Ke(Vt),Ue=Jt.length,er=Jt[0];if(Ue===lt)return this.fromCompressedHex(Jt);if(Ue===dt&&(er===2||er===3))return this.fromCompressedHex(Jt);if(Ue===pt&&er===4)return this.fromUncompressedHex(Jt);throw new Error(`Point.fromHex: received invalid point. Expected 32-${dt} compressed bytes or ${pt} uncompressed bytes, not ${Ue}`)}static fromPrivateKey(Vt){return Ct.BASE.multiply($r(Vt))}static fromSignature(Vt,Jt,Ue){const{r:er,s:sr}=ue(Jt);if(![0,1,2,3].includes(Ue))throw new Error("Cannot recover: invalid recovery bit");const hr=Xe(Ke(Vt)),{n:gr}=at,mr=Ue===2||Ue===3?er+gr:er,vr=qt(mr,gr),Tr=Ht(-hr*vr,gr),wr=Ht(sr*vr,gr),Sr=Ue&1?"03":"02",Pr=Ct.fromHex(Sr+Tt(mr)),Ir=Ct.BASE.multiplyAndAddUnsafe(Pr,Tr,wr);if(!Ir)throw new Error("Cannot recover signature: point at infinify");return Ir.assertValidity(),Ir}toRawBytes(Vt=!1){return wt(this.toHex(Vt))}toHex(Vt=!1){const Jt=Tt(this.x);return Vt?`${this.hasEvenY()?"02":"03"}${Jt}`:`04${Jt}${Tt(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){const Vt="Point is not on elliptic curve",{x:Jt,y:Ue}=this;if(!ar(Jt)||!ar(Ue))throw new Error(Vt);const er=Ht(Ue*Ue),sr=gt(Jt);if(Ht(er-sr)!==rt)throw new Error(Vt)}equals(Vt){return this.x===Vt.x&&this.y===Vt.y}negate(){return new Ct(this.x,Ht(-this.y))}double(){return It.fromAffine(this).double().toAffine()}add(Vt){return It.fromAffine(this).add(It.fromAffine(Vt)).toAffine()}subtract(Vt){return this.add(Vt.negate())}multiply(Vt){return It.fromAffine(this).multiply(Vt,this).toAffine()}multiplyAndAddUnsafe(Vt,Jt,Ue){const er=It.fromAffine(this),sr=Jt===rt||Jt===nt||this!==Ct.BASE?er.multiplyUnsafe(Jt):er.multiply(Jt),hr=It.fromAffine(Vt).multiplyUnsafe(Ue),gr=sr.add(hr);return gr.equals(It.ZERO)?void 0:gr.toAffine()}}et.Point=Ct,Ct.BASE=new Ct(at.Gx,at.Gy),Ct.ZERO=new Ct(rt,rt);function Ut(Zt){return Number.parseInt(Zt[0],16)>=8?"00"+Zt:Zt}function Wt(Zt){if(Zt.length<2||Zt[0]!==2)throw new Error(`Invalid signature integer tag: ${$t(Zt)}`);const Vt=Zt[1],Jt=Zt.subarray(2,Vt+2);if(!Vt||Jt.length!==Vt)throw new Error("Invalid signature integer: wrong length");if(Jt[0]===0&&Jt[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:xt(Jt),left:Zt.subarray(Vt+2)}}function Ft(Zt){if(Zt.length<2||Zt[0]!=48)throw new Error(`Invalid signature tag: ${$t(Zt)}`);if(Zt[1]!==Zt.length-2)throw new Error("Invalid signature: incorrect length");const{data:Vt,left:Jt}=Wt(Zt.subarray(2)),{data:Ue,left:er}=Wt(Jt);if(er.length)throw new Error(`Invalid signature: left bytes after parsing: ${$t(er)}`);return{r:Vt,s:Ue}}class Ce{constructor(Vt,Jt){this.r=Vt,this.s=Jt,this.assertValidity()}static fromCompact(Vt){const Jt=Vt instanceof Uint8Array,Ue="Signature.fromCompact";if(typeof Vt!="string"&&!Jt)throw new TypeError(`${Ue}: Expected string or Uint8Array`);const er=Jt?$t(Vt):Vt;if(er.length!==128)throw new Error(`${Ue}: Expected 64-byte hex`);return new Ce(Dt(er.slice(0,64)),Dt(er.slice(64,128)))}static fromDER(Vt){const Jt=Vt instanceof Uint8Array;if(typeof Vt!="string"&&!Jt)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");const{r:Ue,s:er}=Ft(Jt?Vt:wt(Vt));return new Ce(Ue,er)}static fromHex(Vt){return this.fromDER(Vt)}assertValidity(){const{r:Vt,s:Jt}=this;if(!ur(Vt))throw new Error("Invalid Signature: r must be 0 < r < n");if(!ur(Jt))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){const Vt=at.n>>nt;return this.s>Vt}normalizeS(){return this.hasHighS()?new Ce(this.r,Ht(-this.s,at.n)):this}toDERRawBytes(){return wt(this.toDERHex())}toDERHex(){const Vt=Ut(St(this.s)),Jt=Ut(St(this.r)),Ue=Vt.length/2,er=Jt.length/2,sr=St(Ue),hr=St(er);return`30${St(er+Ue+4)}02${hr}${Jt}02${sr}${Vt}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return wt(this.toCompactHex())}toCompactHex(){return Tt(this.r)+Tt(this.s)}}et.Signature=Ce;function bt(...Zt){if(!Zt.every(Ue=>Ue instanceof Uint8Array))throw new Error("Uint8Array list expected");if(Zt.length===1)return Zt[0];const Vt=Zt.reduce((Ue,er)=>Ue+er.length,0),Jt=new Uint8Array(Vt);for(let Ue=0,er=0;Ue<Zt.length;Ue++){const sr=Zt[Ue];Jt.set(sr,er),er+=sr.length}return Jt}const yt=Array.from({length:256},(Zt,Vt)=>Vt.toString(16).padStart(2,"0"));function $t(Zt){if(!(Zt instanceof Uint8Array))throw new Error("Expected Uint8Array");let Vt="";for(let Jt=0;Jt<Zt.length;Jt++)Vt+=yt[Zt[Jt]];return Vt}const Et=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function Tt(Zt){if(typeof Zt!="bigint")throw new Error("Expected bigint");if(!(rt<=Zt&&Zt<Et))throw new Error("Expected number 0 <= n < 2^256");return Zt.toString(16).padStart(64,"0")}function Pt(Zt){const Vt=wt(Tt(Zt));if(Vt.length!==32)throw new Error("Error: expected 32 bytes");return Vt}function St(Zt){const Vt=Zt.toString(16);return Vt.length&1?`0${Vt}`:Vt}function Dt(Zt){if(typeof Zt!="string")throw new TypeError("hexToNumber: expected string, got "+typeof Zt);return BigInt(`0x${Zt}`)}function wt(Zt){if(typeof Zt!="string")throw new TypeError("hexToBytes: expected string, got "+typeof Zt);if(Zt.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+Zt.length);const Vt=new Uint8Array(Zt.length/2);for(let Jt=0;Jt<Vt.length;Jt++){const Ue=Jt*2,er=Zt.slice(Ue,Ue+2),sr=Number.parseInt(er,16);if(Number.isNaN(sr)||sr<0)throw new Error("Invalid byte sequence");Vt[Jt]=sr}return Vt}function xt(Zt){return Dt($t(Zt))}function Ke(Zt){return Zt instanceof Uint8Array?Uint8Array.from(Zt):wt(Zt)}function Pe(Zt){if(typeof Zt=="number"&&Number.isSafeInteger(Zt)&&Zt>0)return BigInt(Zt);if(typeof Zt=="bigint"&&ur(Zt))return Zt;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function Ht(Zt,Vt=at.P){const Jt=Zt%Vt;return Jt>=rt?Jt:Vt+Jt}function zt(Zt,Vt){const{P:Jt}=at;let Ue=Zt;for(;Vt-- >rt;)Ue*=Ue,Ue%=Jt;return Ue}function jt(Zt){const{P:Vt}=at,Jt=BigInt(6),Ue=BigInt(11),er=BigInt(22),sr=BigInt(23),hr=BigInt(44),gr=BigInt(88),mr=Zt*Zt*Zt%Vt,vr=mr*mr*Zt%Vt,Tr=zt(vr,ot)*vr%Vt,wr=zt(Tr,ot)*vr%Vt,Sr=zt(wr,it)*mr%Vt,Pr=zt(Sr,Ue)*Sr%Vt,Ir=zt(Pr,er)*Pr%Vt,Br=zt(Ir,hr)*Ir%Vt,qr=zt(Br,gr)*Br%Vt,Le=zt(qr,hr)*Ir%Vt,yr=zt(Le,ot)*vr%Vt,pr=zt(yr,sr)*Pr%Vt,kr=zt(pr,Jt)*mr%Vt,Dr=zt(kr,it);if(Dr*Dr%Vt!==Zt)throw new Error("Cannot find square root");return Dr}function qt(Zt,Vt=at.P){if(Zt===rt||Vt<=rt)throw new Error(`invert: expected positive integers, got n=${Zt} mod=${Vt}`);let Jt=Ht(Zt,Vt),Ue=Vt,er=rt,sr=nt;for(;Jt!==rt;){const hr=Ue/Jt,gr=Ue%Jt,mr=er-sr*hr;Ue=Jt,Jt=gr,er=sr,sr=mr}if(Ue!==nt)throw new Error("invert: does not exist");return Ht(er,Vt)}function Ge(Zt,Vt=at.P){const Jt=new Array(Zt.length),Ue=Zt.reduce((sr,hr,gr)=>hr===rt?sr:(Jt[gr]=sr,Ht(sr*hr,Vt)),nt),er=qt(Ue,Vt);return Zt.reduceRight((sr,hr,gr)=>hr===rt?sr:(Jt[gr]=Ht(sr*Jt[gr],Vt),Ht(sr*hr,Vt)),er),Jt}function Ie(Zt){const Vt=Zt.length*8-ht*8,Jt=xt(Zt);return Vt>0?Jt>>BigInt(Vt):Jt}function Xe(Zt,Vt=!1){const Jt=Ie(Zt);if(Vt)return Jt;const{n:Ue}=at;return Jt>=Ue?Jt-Ue:Jt}let Je,Qe;class We{constructor(Vt,Jt){if(this.hashLen=Vt,this.qByteLen=Jt,typeof Vt!="number"||Vt<2)throw new Error("hashLen must be a number");if(typeof Jt!="number"||Jt<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(Vt).fill(1),this.k=new Uint8Array(Vt).fill(0),this.counter=0}hmac(...Vt){return et.utils.hmacSha256(this.k,...Vt)}hmacSync(...Vt){return Qe(this.k,...Vt)}checkSync(){if(typeof Qe!="function")throw new mt("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(Vt=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),Vt),this.v=await this.hmac(this.v),Vt.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),Vt),this.v=await this.hmac(this.v))}reseedSync(Vt=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),Vt),this.v=this.hmacSync(this.v),Vt.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),Vt),this.v=this.hmacSync(this.v))}async generate(){this.incr();let Vt=0;const Jt=[];for(;Vt<this.qByteLen;){this.v=await this.hmac(this.v);const Ue=this.v.slice();Jt.push(Ue),Vt+=this.v.length}return bt(...Jt)}generateSync(){this.checkSync(),this.incr();let Vt=0;const Jt=[];for(;Vt<this.qByteLen;){this.v=this.hmacSync(this.v);const Ue=this.v.slice();Jt.push(Ue),Vt+=this.v.length}return bt(...Jt)}}function ur(Zt){return rt<Zt&&Zt<at.n}function ar(Zt){return rt<Zt&&Zt<at.P}function cr(Zt,Vt,Jt,Ue=!0){const{n:er}=at,sr=Xe(Zt,!0);if(!ur(sr))return;const hr=qt(sr,er),gr=Ct.BASE.multiply(sr),mr=Ht(gr.x,er);if(mr===rt)return;const vr=Ht(hr*Ht(Vt+Jt*mr,er),er);if(vr===rt)return;let Tr=new Ce(mr,vr),wr=(gr.x===Tr.r?0:2)|Number(gr.y&nt);return Ue&&Tr.hasHighS()&&(Tr=Tr.normalizeS(),wr^=1),{sig:Tr,recovery:wr}}function $r(Zt){let Vt;if(typeof Zt=="bigint")Vt=Zt;else if(typeof Zt=="number"&&Number.isSafeInteger(Zt)&&Zt>0)Vt=BigInt(Zt);else if(typeof Zt=="string"){if(Zt.length!==2*ht)throw new Error("Expected 32 bytes of private key");Vt=Dt(Zt)}else if(Zt instanceof Uint8Array){if(Zt.length!==ht)throw new Error("Expected 32 bytes of private key");Vt=xt(Zt)}else throw new TypeError("Expected valid private key");if(!ur(Vt))throw new Error("Expected private key: 0 < key < n");return Vt}function fr(Zt){return Zt instanceof Ct?(Zt.assertValidity(),Zt):Ct.fromHex(Zt)}function ue(Zt){if(Zt instanceof Ce)return Zt.assertValidity(),Zt;try{return Ce.fromDER(Zt)}catch{return Ce.fromCompact(Zt)}}function Qt(Zt,Vt=!1){return Ct.fromPrivateKey(Zt).toRawBytes(Vt)}et.getPublicKey=Qt;function me(Zt,Vt,Jt,Ue=!1){return Ct.fromSignature(Zt,Vt,Jt).toRawBytes(Ue)}et.recoverPublicKey=me;function Lt(Zt){const Vt=Zt instanceof Uint8Array,Jt=typeof Zt=="string",Ue=(Vt||Jt)&&Zt.length;return Vt?Ue===dt||Ue===pt:Jt?Ue===dt*2||Ue===pt*2:Zt instanceof Ct}function Gt(Zt,Vt,Jt=!1){if(Lt(Zt))throw new TypeError("getSharedSecret: first arg must be private key");if(!Lt(Vt))throw new TypeError("getSharedSecret: second arg must be public key");const Ue=fr(Vt);return Ue.assertValidity(),Ue.multiply($r(Zt)).toRawBytes(Jt)}et.getSharedSecret=Gt;function Xt(Zt){const Vt=Zt.length>lt?Zt.slice(0,lt):Zt;return xt(Vt)}function Yt(Zt){const Vt=Xt(Zt),Jt=Ht(Vt,at.n);return He(Jt<rt?Vt:Jt)}function He(Zt){return Pt(Zt)}function ir(Zt,Vt,Jt){if(Zt==null)throw new Error(`sign: expected valid message hash, not "${Zt}"`);const Ue=Ke(Zt),er=$r(Vt),sr=[He(er),Yt(Ue)];if(Jt!=null){Jt===!0&&(Jt=et.utils.randomBytes(lt));const mr=Ke(Jt);if(mr.length!==lt)throw new Error(`sign: Expected ${lt} bytes of extra data`);sr.push(mr)}const hr=bt(...sr),gr=Xt(Ue);return{seed:hr,m:gr,d:er}}function vt(Zt,Vt){const{sig:Jt,recovery:Ue}=Zt,{der:er,recovered:sr}=Object.assign({canonical:!0,der:!0},Vt),hr=er?Jt.toDERRawBytes():Jt.toCompactRawBytes();return sr?[hr,Ue]:hr}async function Rt(Zt,Vt,Jt={}){const{seed:Ue,m:er,d:sr}=ir(Zt,Vt,Jt.extraEntropy),hr=new We(ft,ht);await hr.reseed(Ue);let gr;for(;!(gr=cr(await hr.generate(),er,sr,Jt.canonical));)await hr.reseed();return vt(gr,Jt)}et.sign=Rt;function Bt(Zt,Vt,Jt={}){const{seed:Ue,m:er,d:sr}=ir(Zt,Vt,Jt.extraEntropy),hr=new We(ft,ht);hr.reseedSync(Ue);let gr;for(;!(gr=cr(hr.generateSync(),er,sr,Jt.canonical));)hr.reseedSync();return vt(gr,Jt)}et.signSync=Bt;const Nt={strict:!0};function Ot(Zt,Vt,Jt,Ue=Nt){let er;try{er=ue(Zt),Vt=Ke(Vt)}catch{return!1}const{r:sr,s:hr}=er;if(Ue.strict&&er.hasHighS())return!1;const gr=Xe(Vt);let mr;try{mr=fr(Jt)}catch{return!1}const{n:vr}=at,Tr=qt(hr,vr),wr=Ht(gr*Tr,vr),Sr=Ht(sr*Tr,vr),Pr=Ct.BASE.multiplyAndAddUnsafe(mr,wr,Sr);return Pr?Ht(Pr.x,vr)===sr:!1}et.verify=Ot;function Kt(Zt){return Ht(xt(Zt),at.n)}class $e{constructor(Vt,Jt){this.r=Vt,this.s=Jt,this.assertValidity()}static fromHex(Vt){const Jt=Ke(Vt);if(Jt.length!==64)throw new TypeError(`SchnorrSignature.fromHex: expected 64 bytes, not ${Jt.length}`);const Ue=xt(Jt.subarray(0,32)),er=xt(Jt.subarray(32,64));return new $e(Ue,er)}assertValidity(){const{r:Vt,s:Jt}=this;if(!ar(Vt)||!ur(Jt))throw new Error("Invalid signature")}toHex(){return Tt(this.r)+Tt(this.s)}toRawBytes(){return wt(this.toHex())}}function nr(Zt){return Ct.fromPrivateKey(Zt).toRawX()}class Ze{constructor(Vt,Jt,Ue=et.utils.randomBytes()){if(Vt==null)throw new TypeError(`sign: Expected valid message, not "${Vt}"`);this.m=Ke(Vt);const{x:er,scalar:sr}=this.getScalar($r(Jt));if(this.px=er,this.d=sr,this.rand=Ke(Ue),this.rand.length!==32)throw new TypeError("sign: Expected 32 bytes of aux randomness")}getScalar(Vt){const Jt=Ct.fromPrivateKey(Vt),Ue=Jt.hasEvenY()?Vt:at.n-Vt;return{point:Jt,scalar:Ue,x:Jt.toRawX()}}initNonce(Vt,Jt){return Pt(Vt^xt(Jt))}finalizeNonce(Vt){const Jt=Ht(xt(Vt),at.n);if(Jt===rt)throw new Error("sign: Creation of signature failed. k is zero");const{point:Ue,x:er,scalar:sr}=this.getScalar(Jt);return{R:Ue,rx:er,k:sr}}finalizeSig(Vt,Jt,Ue,er){return new $e(Vt.x,Ht(Jt+Ue*er,at.n)).toRawBytes()}error(){throw new Error("sign: Invalid signature produced")}async calc(){const{m:Vt,d:Jt,px:Ue,rand:er}=this,sr=et.utils.taggedHash,hr=this.initNonce(Jt,await sr(Cr.aux,er)),{R:gr,rx:mr,k:vr}=this.finalizeNonce(await sr(Cr.nonce,hr,Ue,Vt)),Tr=Kt(await sr(Cr.challenge,mr,Ue,Vt)),wr=this.finalizeSig(gr,vr,Tr,Jt);return await Rr(wr,Vt,Ue)||this.error(),wr}calcSync(){const{m:Vt,d:Jt,px:Ue,rand:er}=this,sr=et.utils.taggedHashSync,hr=this.initNonce(Jt,sr(Cr.aux,er)),{R:gr,rx:mr,k:vr}=this.finalizeNonce(sr(Cr.nonce,hr,Ue,Vt)),Tr=Kt(sr(Cr.challenge,mr,Ue,Vt)),wr=this.finalizeSig(gr,vr,Tr,Jt);return Er(wr,Vt,Ue)||this.error(),wr}}async function tr(Zt,Vt,Jt){return new Ze(Zt,Vt,Jt).calc()}function lr(Zt,Vt,Jt){return new Ze(Zt,Vt,Jt).calcSync()}function dr(Zt,Vt,Jt){const Ue=Zt instanceof $e,er=Ue?Zt:$e.fromHex(Zt);return Ue&&er.assertValidity(),{...er,m:Ke(Vt),P:fr(Jt)}}function br(Zt,Vt,Jt,Ue){const er=Ct.BASE.multiplyAndAddUnsafe(Vt,$r(Jt),Ht(-Ue,at.n));return!(!er||!er.hasEvenY()||er.x!==Zt)}async function Rr(Zt,Vt,Jt){try{const{r:Ue,s:er,m:sr,P:hr}=dr(Zt,Vt,Jt),gr=Kt(await et.utils.taggedHash(Cr.challenge,Pt(Ue),hr.toRawX(),sr));return br(Ue,hr,er,gr)}catch{return!1}}function Er(Zt,Vt,Jt){try{const{r:Ue,s:er,m:sr,P:hr}=dr(Zt,Vt,Jt),gr=Kt(et.utils.taggedHashSync(Cr.challenge,Pt(Ue),hr.toRawX(),sr));return br(Ue,hr,er,gr)}catch(Ue){if(Ue instanceof mt)throw Ue;return!1}}et.schnorr={Signature:$e,getPublicKey:nr,sign:tr,verify:Rr,signSync:lr,verifySync:Er},Ct.BASE._setWindowSize(8);const _r={node:tt,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},Cr={challenge:"BIP0340/challenge",aux:"BIP0340/aux",nonce:"BIP0340/nonce"},Ar={};et.utils={bytesToHex:$t,hexToBytes:wt,concatBytes:bt,mod:Ht,invert:qt,isValidPrivateKey(Zt){try{return $r(Zt),!0}catch{return!1}},_bigintTo32Bytes:Pt,_normalizePrivateKey:$r,hashToPrivateKey:Zt=>{Zt=Ke(Zt);const Vt=ht+8;if(Zt.length<Vt||Zt.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");const Jt=Ht(xt(Zt),at.n-nt)+nt;return Pt(Jt)},randomBytes:(Zt=32)=>{if(_r.web)return _r.web.getRandomValues(new Uint8Array(Zt));if(_r.node){const{randomBytes:Vt}=_r.node;return Uint8Array.from(Vt(Zt))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>et.utils.hashToPrivateKey(et.utils.randomBytes(ht+8)),precompute(Zt=8,Vt=Ct.BASE){const Jt=Vt===Ct.BASE?Vt:new Ct(Vt.x,Vt.y);return Jt._setWindowSize(Zt),Jt.multiply(ot),Jt},sha256:async(...Zt)=>{if(_r.web){const Vt=await _r.web.subtle.digest("SHA-256",bt(...Zt));return new Uint8Array(Vt)}else if(_r.node){const{createHash:Vt}=_r.node,Jt=Vt("sha256");return Zt.forEach(Ue=>Jt.update(Ue)),Uint8Array.from(Jt.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(Zt,...Vt)=>{if(_r.web){const Jt=await _r.web.subtle.importKey("raw",Zt,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),Ue=bt(...Vt),er=await _r.web.subtle.sign("HMAC",Jt,Ue);return new Uint8Array(er)}else if(_r.node){const{createHmac:Jt}=_r.node,Ue=Jt("sha256",Zt);return Vt.forEach(er=>Ue.update(er)),Uint8Array.from(Ue.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(Zt,...Vt)=>{let Jt=Ar[Zt];if(Jt===void 0){const Ue=await et.utils.sha256(Uint8Array.from(Zt,er=>er.charCodeAt(0)));Jt=bt(Ue,Ue),Ar[Zt]=Jt}return et.utils.sha256(Jt,...Vt)},taggedHashSync:(Zt,...Vt)=>{if(typeof Je!="function")throw new mt("sha256Sync is undefined, you need to set it");let Jt=Ar[Zt];if(Jt===void 0){const Ue=Je(Uint8Array.from(Zt,er=>er.charCodeAt(0)));Jt=bt(Ue,Ue),Ar[Zt]=Jt}return Je(Jt,...Vt)},_JacobianPoint:It},Object.defineProperties(et.utils,{sha256Sync:{configurable:!1,get(){return Je},set(Zt){Je||(Je=Zt)}},hmacSha256Sync:{configurable:!1,get(){return Qe},set(Zt){Qe||(Qe=Zt)}}})}(lib)),lib}var secp256k1,hasRequiredSecp256k1;function requireSecp256k1(){if(hasRequiredSecp256k1)return secp256k1;hasRequiredSecp256k1=1;const et=errCode$i,tt=requireLib(),{sha256:rt}=require$$1$4;return secp256k1=()=>{function nt(){return tt.utils.randomPrivateKey()}async function it(ht,ft){const{digest:dt}=await rt.digest(ft);try{return await tt.sign(dt,ht)}catch(pt){throw et(pt,"ERR_INVALID_INPUT")}}async function ot(ht,ft,dt){try{const{digest:pt}=await rt.digest(dt);return tt.verify(ft,pt,ht)}catch(pt){throw et(pt,"ERR_INVALID_INPUT")}}function st(ht){return tt.Point.fromHex(ht).toRawBytes(!0)}function at(ht){return tt.Point.fromHex(ht).toRawBytes(!1)}function ct(ht){try{tt.getPublicKey(ht,!0)}catch(ft){throw et(ft,"ERR_INVALID_PRIVATE_KEY")}}function ut(ht){try{tt.Point.fromHex(ht)}catch(ft){throw et(ft,"ERR_INVALID_PUBLIC_KEY")}}function lt(ht){try{return tt.getPublicKey(ht,!0)}catch(ft){throw et(ft,"ERR_INVALID_PRIVATE_KEY")}}return{generateKey:nt,privateKeyLength:32,hashAndSign:it,hashAndVerify:ot,compressPublicKey:st,decompressPublicKey:at,validatePrivateKey:ct,validatePublicKey:ut,computePublicKey:lt}},secp256k1}const{sha256}=require$$1$4,errcode$1=errCode$i,{equals:uint8ArrayEquals}=require$$1$3,{toString:uint8ArrayToString}=require$$1$2,exporter=exporter$3;var secp256k1Class=(et,tt,rt)=>{rt=rt||requireSecp256k1()();class nt{constructor(ut){rt.validatePublicKey(ut),this._key=ut}verify(ut,lt){return rt.hashAndVerify(this._key,lt,ut)}marshal(){return rt.compressPublicKey(this._key)}get bytes(){return et.PublicKey.encode({Type:et.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(ut){return uint8ArrayEquals(this.bytes,ut.bytes)}async hash(){const{bytes:ut}=await sha256.digest(this.bytes);return ut}}class it{constructor(ut,lt){this._key=ut,this._publicKey=lt||rt.computePublicKey(ut),rt.validatePrivateKey(this._key),rt.validatePublicKey(this._publicKey)}sign(ut){return rt.hashAndSign(this._key,ut)}get public(){return new nt(this._publicKey)}marshal(){return this._key}get bytes(){return et.PrivateKey.encode({Type:et.KeyType.Secp256k1,Data:this.marshal()}).finish()}equals(ut){return uint8ArrayEquals(this.bytes,ut.bytes)}async hash(){const{bytes:ut}=await sha256.digest(this.bytes);return ut}async id(){const ut=await this.public.hash();return uint8ArrayToString(ut,"base58btc")}async export(ut,lt="libp2p-key"){if(lt==="libp2p-key")return exporter.export(this.bytes,ut);throw errcode$1(new Error(`export format '${lt}' is not supported`),"ERR_INVALID_EXPORT_FORMAT")}}function ot(ct){return new it(ct)}function st(ct){return new nt(ct)}async function at(){const ct=await rt.generateKey();return new it(ct)}return{Secp256k1PublicKey:nt,Secp256k1PrivateKey:it,unmarshalSecp256k1PrivateKey:ot,unmarshalSecp256k1PublicKey:st,generateKeyPair:at}},indexBrowser={},lengths,hasRequiredLengths;function requireLengths(){return hasRequiredLengths||(hasRequiredLengths=1,lengths={SHA1:20,SHA256:32,SHA512:64}),lengths}var hasRequiredIndexBrowser;function requireIndexBrowser(){if(hasRequiredIndexBrowser)return indexBrowser;hasRequiredIndexBrowser=1;const et=webcrypto$2,tt=requireLengths(),rt={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},nt=async(it,ot)=>{const st=await et.get().subtle.sign({name:"HMAC"},it,ot);return new Uint8Array(st,st.byteOffset,st.byteLength)};return indexBrowser.create=async function(it,ot){const st=rt[it],at=await et.get().subtle.importKey("raw",ot,{name:"HMAC",hash:{name:st}},!1,["sign"]);return{async digest(ct){return nt(at,ct)},length:tt[it]}},indexBrowser}var keyStretcher,hasRequiredKeyStretcher;function requireKeyStretcher(){if(hasRequiredKeyStretcher)return keyStretcher;hasRequiredKeyStretcher=1;const et=errCode$i,{concat:tt}=require$$7$1,{fromString:rt}=require$$9$2,nt=requireIndexBrowser(),it={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,cipherKeySize:32}};return keyStretcher=async(ot,st,at)=>{const ct=it[ot];if(!ct){const Ut=Object.keys(it).join(" / ");throw et(new Error(`unknown cipher type '${ot}'. Must be ${Ut}`),"ERR_INVALID_CIPHER_TYPE")}if(!st)throw et(new Error("missing hash type"),"ERR_MISSING_HASH_TYPE");const ut=ct.keySize,lt=ct.ivSize,ht=20,ft=rt("key expansion"),dt=2*(lt+ut+ht),pt=await nt.create(st,at);let gt=await pt.digest(ft);const _t=[];let mt=0;for(;mt<dt;){const Ut=await pt.digest(tt([gt,ft]));let Wt=Ut.length;mt+Wt>dt&&(Wt=dt-mt),_t.push(Ut),mt+=Wt,gt=await pt.digest(gt)}const At=dt/2,It=tt(_t),Mt=It.slice(0,At),kt=It.slice(At,dt),Ct=Ut=>({iv:Ut.slice(0,lt),cipherKey:Ut.slice(lt,lt+ut),macKey:Ut.slice(lt+ut)});return{k1:Ct(Mt),k2:Ct(kt)}},keyStretcher}var ecdhBrowser={},validateCurveType,hasRequiredValidateCurveType;function requireValidateCurveType(){if(hasRequiredValidateCurveType)return validateCurveType;hasRequiredValidateCurveType=1;const et=errCode$i;return validateCurveType=function(tt,rt){if(!tt.includes(rt)){const nt=tt.join(" / ");throw et(new Error(`Unknown curve: ${rt}. Must be ${nt}`),"ERR_INVALID_CURVE")}},validateCurveType}var hasRequiredEcdhBrowser;function requireEcdhBrowser(){if(hasRequiredEcdhBrowser)return ecdhBrowser;hasRequiredEcdhBrowser=1;const et=errCode$i,tt=webcrypto$2,{base64urlToBuffer:rt}=util,nt=requireValidateCurveType(),{toString:it}=require$$1$2,{concat:ot}=require$$7$1,{equals:st}=require$$1$3,at={"P-256":256,"P-384":384,"P-521":521};ecdhBrowser.generateEphmeralKeyPair=async function(ft){nt(Object.keys(at),ft);const dt=await tt.get().subtle.generateKey({name:"ECDH",namedCurve:ft},!0,["deriveBits"]),pt=async(_t,mt)=>{let At;mt?At=await tt.get().subtle.importKey("jwk",ht(ft,mt),{name:"ECDH",namedCurve:ft},!1,["deriveBits"]):At=dt.privateKey;const It=[await tt.get().subtle.importKey("jwk",lt(ft,_t),{name:"ECDH",namedCurve:ft},!1,[]),At],Mt=await tt.get().subtle.deriveBits({name:"ECDH",namedCurve:ft,public:It[0]},It[1],at[ft]);return new Uint8Array(Mt,Mt.byteOffset,Mt.byteLength)},gt=await tt.get().subtle.exportKey("jwk",dt.publicKey);return{key:ut(gt),genSharedKey:pt}};const ct={"P-256":32,"P-384":48,"P-521":66};function ut(ft){const dt=ct[ft.crv];return ot([Uint8Array.from([4]),rt(ft.x,dt),rt(ft.y,dt)],1+dt*2)}function lt(ft,dt){const pt=ct[ft];if(st(!dt.slice(0,1),Uint8Array.from([4])))throw et(new Error("Cannot unmarshal public key - invalid key format"),"ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:ft,x:it(dt.slice(1,pt+1),"base64url"),y:it(dt.slice(1+pt),"base64url"),ext:!0}}const ht=(ft,dt)=>({...lt(ft,dt.public),d:it(dt.private,"base64url")});return ecdhBrowser}var ephemeralKeys,hasRequiredEphemeralKeys;function requireEphemeralKeys(){if(hasRequiredEphemeralKeys)return ephemeralKeys;hasRequiredEphemeralKeys=1;const et=requireEcdhBrowser();return ephemeralKeys=async tt=>et.generateEphmeralKeyPair(tt),ephemeralKeys}const keysPBM=keys$1,forge=forge$p,errcode=errCode$i,{fromString:uint8ArrayFromString}=require$$9$2,importer=importer$1,supportedKeys={rsa:rsaClass,ed25519:ed25519Class,secp256k1:secp256k1Class(keysPBM)},ErrMissingSecp256K1={message:"secp256k1 support requires libp2p-crypto-secp256k1 package",code:"ERR_MISSING_PACKAGE"};function typeToKey(et){const tt=supportedKeys[et.toLowerCase()];if(!tt){const rt=Object.keys(supportedKeys).join(" / ");throw errcode(new Error(`invalid or unsupported key type ${et}. Must be ${rt}`),"ERR_UNSUPPORTED_KEY_TYPE")}return tt}const generateKeyPair$1=async(et,tt)=>typeToKey(et).generateKeyPair(tt),generateKeyPairFromSeed=async(et,tt,rt)=>{const nt=typeToKey(et);if(et.toLowerCase()!=="ed25519")throw errcode(new Error("Seed key derivation is unimplemented for RSA or secp256k1"),"ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return nt.generateKeyPairFromSeed(tt,rt)},unmarshalPublicKey=et=>{const tt=keysPBM.PublicKey.decode(et),rt=tt.Data;switch(tt.Type){case keysPBM.KeyType.RSA:return supportedKeys.rsa.unmarshalRsaPublicKey(rt);case keysPBM.KeyType.Ed25519:return supportedKeys.ed25519.unmarshalEd25519PublicKey(rt);case keysPBM.KeyType.Secp256k1:if(supportedKeys.secp256k1)return supportedKeys.secp256k1.unmarshalSecp256k1PublicKey(rt);throw errcode(new Error(ErrMissingSecp256K1.message),ErrMissingSecp256K1.code);default:typeToKey(tt.Type)}},marshalPublicKey=(et,tt)=>(tt=(tt||"rsa").toLowerCase(),typeToKey(tt),et.bytes),unmarshalPrivateKey=async et=>{const tt=keysPBM.PrivateKey.decode(et),rt=tt.Data;switch(tt.Type){case keysPBM.KeyType.RSA:return supportedKeys.rsa.unmarshalRsaPrivateKey(rt);case keysPBM.KeyType.Ed25519:return supportedKeys.ed25519.unmarshalEd25519PrivateKey(rt);case keysPBM.KeyType.Secp256k1:if(supportedKeys.secp256k1)return supportedKeys.secp256k1.unmarshalSecp256k1PrivateKey(rt);throw errcode(new Error(ErrMissingSecp256K1.message),ErrMissingSecp256K1.code);default:typeToKey(tt.Type)}},marshalPrivateKey=(et,tt)=>(tt=(tt||"rsa").toLowerCase(),typeToKey(tt),et.bytes),importKey=async(et,tt)=>{try{const it=await importer.import(et,tt);return unmarshalPrivateKey(it)}catch{}const rt=forge.pki.decryptRsaPrivateKey(et,tt);if(rt===null)throw errcode(new Error("Cannot read the key, most likely the password is wrong or not a RSA key"),"ERR_CANNOT_DECRYPT_PEM");let nt=forge.asn1.toDer(forge.pki.privateKeyToAsn1(rt));return nt=uint8ArrayFromString(nt.getBytes(),"ascii"),supportedKeys.rsa.unmarshalRsaPrivateKey(nt)};var keys={supportedKeys,keysPBM,keyStretcher:requireKeyStretcher(),generateEphemeralKeyPair:requireEphemeralKeys(),generateKeyPair:generateKeyPair$1,generateKeyPairFromSeed,unmarshalPublicKey,marshalPublicKey,unmarshalPrivateKey,marshalPrivateKey,import:importKey},$protobuf$1=minimal,$Reader$1=$protobuf$1.Reader,$Writer$1=$protobuf$1.Writer,$util$1=$protobuf$1.util,$root$1=$protobuf$1.roots["libp2p-peer-id"]||($protobuf$1.roots["libp2p-peer-id"]={});$root$1.PeerIdProto=function(){function et(tt){if(tt)for(var rt=Object.keys(tt),nt=0;nt<rt.length;++nt)tt[rt[nt]]!=null&&(this[rt[nt]]=tt[rt[nt]])}return et.prototype.id=$util$1.newBuffer([]),et.prototype.pubKey=$util$1.newBuffer([]),et.prototype.privKey=$util$1.newBuffer([]),et.encode=function(tt,rt){return rt||(rt=$Writer$1.create()),rt.uint32(10).bytes(tt.id),tt.pubKey!=null&&Object.hasOwnProperty.call(tt,"pubKey")&&rt.uint32(18).bytes(tt.pubKey),tt.privKey!=null&&Object.hasOwnProperty.call(tt,"privKey")&&rt.uint32(26).bytes(tt.privKey),rt},et.decode=function(tt,rt){tt instanceof $Reader$1||(tt=$Reader$1.create(tt));for(var nt=rt===void 0?tt.len:tt.pos+rt,it=new $root$1.PeerIdProto;tt.pos<nt;){var ot=tt.uint32();switch(ot>>>3){case 1:it.id=tt.bytes();break;case 2:it.pubKey=tt.bytes();break;case 3:it.privKey=tt.bytes();break;default:tt.skipType(ot&7);break}}if(!it.hasOwnProperty("id"))throw $util$1.ProtocolError("missing required 'id'",{instance:it});return it},et.fromObject=function(tt){if(tt instanceof $root$1.PeerIdProto)return tt;var rt=new $root$1.PeerIdProto;return tt.id!=null&&(typeof tt.id=="string"?$util$1.base64.decode(tt.id,rt.id=$util$1.newBuffer($util$1.base64.length(tt.id)),0):tt.id.length&&(rt.id=tt.id)),tt.pubKey!=null&&(typeof tt.pubKey=="string"?$util$1.base64.decode(tt.pubKey,rt.pubKey=$util$1.newBuffer($util$1.base64.length(tt.pubKey)),0):tt.pubKey.length&&(rt.pubKey=tt.pubKey)),tt.privKey!=null&&(typeof tt.privKey=="string"?$util$1.base64.decode(tt.privKey,rt.privKey=$util$1.newBuffer($util$1.base64.length(tt.privKey)),0):tt.privKey.length&&(rt.privKey=tt.privKey)),rt},et.toObject=function(tt,rt){rt||(rt={});var nt={};return rt.defaults&&(rt.bytes===String?nt.id="":(nt.id=[],rt.bytes!==Array&&(nt.id=$util$1.newBuffer(nt.id))),rt.bytes===String?nt.pubKey="":(nt.pubKey=[],rt.bytes!==Array&&(nt.pubKey=$util$1.newBuffer(nt.pubKey))),rt.bytes===String?nt.privKey="":(nt.privKey=[],rt.bytes!==Array&&(nt.privKey=$util$1.newBuffer(nt.privKey)))),tt.id!=null&&tt.hasOwnProperty("id")&&(nt.id=rt.bytes===String?$util$1.base64.encode(tt.id,0,tt.id.length):rt.bytes===Array?Array.prototype.slice.call(tt.id):tt.id),tt.pubKey!=null&&tt.hasOwnProperty("pubKey")&&(nt.pubKey=rt.bytes===String?$util$1.base64.encode(tt.pubKey,0,tt.pubKey.length):rt.bytes===Array?Array.prototype.slice.call(tt.pubKey):tt.pubKey),tt.privKey!=null&&tt.hasOwnProperty("privKey")&&(nt.privKey=rt.bytes===String?$util$1.base64.encode(tt.privKey,0,tt.privKey.length):rt.bytes===Array?Array.prototype.slice.call(tt.privKey):tt.privKey),nt},et.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf$1.util.toJSONOptions)},et}();var proto=$root$1;(function(et,tt){const{CID:rt}=require$$6$2,nt=require$$4$1,it=require$$2,ot=require$$1$5,st=require$$4,{base58btc:at}=require$$1$5,{base32:ct}=require$$4$1,{base16:ut}=require$$5$1,lt=require$$6$1,ht=keys,ft=classIsExports,{PeerIdProto:dt}=proto,{equals:pt}=require$$1$3,{fromString:gt}=require$$9$2,{toString:_t}=require$$1$2,{identity:mt}=require$$7,At={...nt,...it,...ot,...st},It=Object.keys(At).reduce((yt,$t)=>yt.or(At[$t]),ct.decoder),Mt=112,kt=114;class Ct{constructor($t,Et,Tt){if(!($t instanceof Uint8Array))throw new Error("invalid id provided");if(Et&&Tt&&!pt(Et.public.bytes,Tt.bytes))throw new Error("inconsistent arguments");this._id=$t,this._idB58String=at.encode(this.id).substring(1),this._privKey=Et,this._pubKey=Tt}get id(){return this._id}set id($t){throw new Error("Id is immutable")}get privKey(){return this._privKey}set privKey($t){this._privKey=$t}get pubKey(){if(this._pubKey)return this._pubKey;if(this._privKey)return this._privKey.public;try{const $t=lt.decode(this.id);$t.code===mt.code&&(this._pubKey=ht.unmarshalPublicKey($t.digest))}catch{}return this._pubKey}set pubKey($t){this._pubKey=$t}marshalPubKey(){if(this.pubKey)return ht.marshalPublicKey(this.pubKey)}marshalPrivKey(){if(this.privKey)return ht.marshalPrivateKey(this.privKey)}marshal($t){return dt.encode({id:this.toBytes(),pubKey:this.marshalPubKey(),privKey:$t?null:this.marshalPrivKey()}).finish()}toPrint(){let $t=this.toB58String();$t.startsWith("Qm")&&($t=$t.slice(2));let Et=6;return $t.length<Et&&(Et=$t.length),"<peer.ID "+$t.substr(0,Et)+">"}toJSON(){return{id:this.toB58String(),privKey:bt(this.marshalPrivKey()),pubKey:bt(this.marshalPubKey())}}toHexString(){return ut.encode(this.id).substring(1)}toBytes(){return this.id}toB58String(){return this._idB58String}toString(){if(!this._idCIDString){const $t=rt.createV1(kt,lt.decode(this.id));Object.defineProperty(this,"_idCIDString",{value:$t.toString(),enumerable:!1})}return this._idCIDString}equals($t){if($t instanceof Uint8Array)return pt(this.id,$t);if($t.id)return pt(this.id,$t.id);throw new Error("not valid Id")}isEqual($t){return this.equals($t)}isValid(){return!!(this.privKey&&this.privKey.public&&this.privKey.public.bytes&&this.pubKey.bytes instanceof Uint8Array&&pt(this.privKey.public.bytes,this.pubKey.bytes))}hasInlinePublicKey(){try{if(lt.decode(this.id).code===mt.code)return!0}catch{}return!1}}const Ut=ft(Ct,{className:"PeerId",symbolName:"@libp2p/js-peer-id/PeerId"});tt=et.exports=Ut;const Wt=yt=>yt.bytes.length<=42?lt.create(mt.code,yt.bytes).bytes:yt.hash(),Ft=async(yt,$t)=>{const Et=await Wt($t);return new Ut(Et,yt,$t)};tt.create=async yt=>{yt=yt||{},yt.bits=yt.bits||2048,yt.keyType=yt.keyType||"RSA";const $t=await ht.generateKeyPair(yt.keyType,yt.bits);return Ft($t,$t.public)},tt.createFromHexString=yt=>new Ut(ut.decode("f"+yt)),tt.createFromBytes=yt=>{try{const $t=rt.decode(yt);if(!Ce($t))throw new Error("Supplied PeerID CID is invalid");return tt.createFromCID($t)}catch{if(lt.decode(yt).code!==mt.code)throw new Error("Supplied PeerID CID is invalid");return new Ut(yt)}},tt.createFromB58String=yt=>tt.createFromBytes(at.decode("z"+yt));const Ce=yt=>yt.code===kt||yt.code===Mt;tt.createFromCID=yt=>{if(yt=rt.asCID(yt),!yt||!Ce(yt))throw new Error("Supplied PeerID CID is invalid");return new Ut(yt.multihash.bytes)},tt.createFromPubKey=async yt=>{let $t=yt;if(typeof $t=="string"&&($t=gt(yt,"base64pad")),!($t instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");const Et=await ht.unmarshalPublicKey($t);return Ft(void 0,Et)},tt.createFromPrivKey=async yt=>{if(typeof yt=="string"&&(yt=gt(yt,"base64pad")),!(yt instanceof Uint8Array))throw new Error("Supplied key is neither a base64 string nor a Uint8Array");const $t=await ht.unmarshalPrivateKey(yt);return Ft($t,$t.public)},tt.createFromJSON=async yt=>{const $t=at.decode("z"+yt.id),Et=yt.privKey&&gt(yt.privKey,"base64pad"),Tt=yt.pubKey&&gt(yt.pubKey,"base64pad"),Pt=Tt&&await ht.unmarshalPublicKey(Tt);if(!Et)return new Ut($t,void 0,Pt);const St=await ht.unmarshalPrivateKey(Et),Dt=await Wt(St.public);let wt;if(Pt&&(wt=await Wt(Pt)),Pt&&!pt(Dt,wt))throw new Error("Public and private key do not match");if($t&&!pt(Dt,$t))throw new Error("Id and private key do not match");return new Ut($t,St,Pt)},tt.createFromProtobuf=async yt=>{typeof yt=="string"&&(yt=gt(yt,"base16"));let{id:$t,privKey:Et,pubKey:Tt}=dt.decode(yt);Et=Et?await ht.unmarshalPrivateKey(Et):!1,Tt=Tt?await ht.unmarshalPublicKey(Tt):!1;let Pt,St;if(Et&&(St=await Wt(Et.public)),Tt&&(Pt=await Wt(Tt)),Et){if(Tt&&!pt(St,Pt))throw new Error("Public and private key do not match");return new Ut(St,Et,Et.public)}if(Tt)return new Ut(Pt,void 0,Tt);if($t)return new Ut($t);throw new Error("Protobuf did not contain any usable key material")},tt.parse=yt=>((yt.charAt(0)==="1"||yt.charAt(0)==="Q")&&(yt=`z${yt}`),tt.createFromBytes(It.decode(yt))),tt.isPeerId=yt=>!!(typeof yt=="object"&&yt._id&&yt._idB58String);function bt(yt){if(yt)return _t(yt,"base64pad")}})(src$1,src$1.exports);const debug=browserExports,log=debug("libp2p-delegated-content-routing");log.error=debug("libp2p-delegated-content-routing:error");var movingAverage={exports:{}};(function(et,tt){const rt=Math.exp;et.exports=function(nt){if(typeof nt!="number")throw new Error("must provide a timespan to the moving average constructor");if(nt<=0)throw new Error("must provide a timespan > 0 to the moving average constructor");let it,ot=0,st=0,at=0,ct,ut={};function lt(ht,ft){return 1-rt(-(ht-ft)/nt)}return ut.push=function(ht,ft){if(ct){const dt=lt(ht,ct),pt=ft-it,gt=dt*pt;it=dt*ft+(1-dt)*it,ot=(1-dt)*(ot+pt*gt),st=Math.sqrt(ot),at=it+dt*pt}else it=ft;ct=ht},ut.movingAverage=function(){return it},ut.variance=function(){return ot},ut.deviation=function(){return st},ut.forecast=function(){return at},ut}})(movingAverage),mergeOptions.bind({ignoreUndefined:!0}),browserExports("ipfs:components:peer:storage"),src$8.errors,mergeOptions.bind({ignoreUndefined:!0});var encode_1=encode,MSB$1=128,REST$1=127,MSBALL=~REST$1,INT=Math.pow(2,31);function encode(et,tt,rt){tt=tt||[],rt=rt||0;for(var nt=rt;et>=INT;)tt[rt++]=et&255|MSB$1,et/=128;for(;et&MSBALL;)tt[rt++]=et&255|MSB$1,et>>>=7;return tt[rt]=et|0,encode.bytes=rt-nt+1,tt}var decode=read,MSB=128,REST=127;function read(et,nt){var rt=0,nt=nt||0,it=0,ot=nt,st,at=et.length;do{if(ot>=at)throw read.bytes=0,new RangeError("Could not decode varint");st=et[ot++],rt+=it<28?(st&REST)<<it:(st&REST)*Math.pow(2,it),it+=7}while(st>=MSB);return read.bytes=ot-nt,rt}var N1=Math.pow(2,7),N2=Math.pow(2,14),N3=Math.pow(2,21),N4=Math.pow(2,28),N5=Math.pow(2,35),N6=Math.pow(2,42),N7=Math.pow(2,49),N8=Math.pow(2,56),N9=Math.pow(2,63),length=function(et){return et<N1?1:et<N2?2:et<N3?3:et<N4?4:et<N5?5:et<N6?6:et<N7?7:et<N8?8:et<N9?9:10},varint$1={encode:encode_1,decode,encodingLength:length};const varint=varint$1;var src=et=>{if(!(et instanceof Uint8Array))throw new Error("arg needs to be a Uint8Array");const tt=[];for(;et.length>0;){const rt=varint.decode(et);tt.push(rt),et=et.slice(varint.decode.bytes)}return tt};const{base58btc}=require$$1$5;class WantListEntry{constructor(tt,rt,nt){this._refCounter=1,this.cid=tt,this.priority=rt||1,this.wantType=nt}inc(){this._refCounter+=1}dec(){this._refCounter=Math.max(0,this._refCounter-1)}hasRefs(){return this._refCounter>0}get[Symbol.toStringTag](){return`WantlistEntry <key: ${this.cid.toString(base58btc)}, priority: ${this.priority}, refs: ${this._refCounter}>`}equals(tt){return this._refCounter===tt._refCounter&&this.cid.equals(tt.cid)&&this.priority===tt.priority&&this.wantType===tt.wantType}}var entry$1=WantListEntry,wantlist,hasRequiredWantlist;function requireWantlist(){if(hasRequiredWantlist)return wantlist;hasRequiredWantlist=1;const et=entry$1,{base58btc:tt}=require$$1$5,rt=(it,ot)=>Array.prototype.slice.call(ot,0).sort((st,at)=>{const ct=it(st),ut=it(at);return ct<ut?-1:ct>ut?1:0});class nt{constructor(ot){this.set=new Map,this._stats=ot}get length(){return this.set.size}add(ot,st,at){const ct=requireMessage(),ut=ot.toString(tt),lt=this.set.get(ut);lt?(lt.inc(),lt.priority=st,lt.wantType===ct.WantType.Have&&at===ct.WantType.Block&&(lt.wantType=at)):(this.set.set(ut,new et(ot,st,at)),this._stats&&this._stats.push(null,"wantListSize",1))}remove(ot){const st=ot.toString(tt),at=this.set.get(st);at&&(at.dec(),!at.hasRefs()&&(this.set.delete(st),this._stats&&this._stats.push(null,"wantListSize",-1)))}removeForce(ot){this.set.has(ot)&&this.set.delete(ot)}forEach(ot){return this.set.forEach(ot)}entries(){return this.set.entries()}sortedEntries(){return new Map(rt(ot=>ot[1].key,Array.from(this.set.entries())))}contains(ot){const st=ot.toString(tt);return this.set.has(st)}get(ot){const st=ot.toString(tt);return this.set.get(st)}}return nt.Entry=et,wantlist=nt,wantlist}var entry,hasRequiredEntry;function requireEntry(){if(hasRequiredEntry)return entry;hasRequiredEntry=1;const et=requireWantlist().Entry,{base58btc:tt}=require$$1$5;return entry=class{constructor(rt,nt,it,ot,st){this.entry=new et(rt,nt,it),this.cancel=!!ot,this.sendDontHave=!!st}get cid(){return this.entry.cid}set cid(rt){this.entry.cid=rt}get priority(){return this.entry.priority}set priority(rt){this.entry.priority=rt}get wantType(){return this.entry.wantType}set wantType(rt){this.entry.wantType=rt}get[Symbol.toStringTag](){return`BitswapMessageEntry ${this.cid.toString(tt)} <cancel: ${this.cancel}, priority: ${this.priority}>`}equals(rt){return this.cancel===rt.cancel&&this.sendDontHave===rt.sendDontHave&&this.wantType===rt.wantType&&this.entry.equals(rt.entry)}},entry}var utils,hasRequiredUtils;function requireUtils(){if(hasRequiredUtils)return utils;hasRequiredUtils=1;const et=browserExports,{equals:tt}=require$$1$3,rt=requireEntry(),nt=(ot,st)=>{const at=["bitswap"];return st&&at.push(st),ot&&at.push(`${ot.toB58String().slice(0,8)}`),Object.assign(et(at.join(":")),{error:et(at.concat(["error"]).join(":"))})},it=(ot,st,at)=>{let ct=0;const ut=at.length;for(;ct<ut;){if(ot(st,at[ct]))return!0;ct+=1}return!1};return utils={logger:nt,includesWith:it,uniqWith:(ot,st)=>{let at=0;const ct=st.length,ut=[];let lt;for(;at<ct;)lt=st[at],it(ot,lt,ut)||(ut[ut.length]=lt),at+=1;return ut},groupBy:(ot,st)=>st.reduce((at,ct)=>{const ut=ot(ct);return at[ut]?at[ut].push(ct):at[ut]=[ct],at},{}),pullAllWith:(ot,st,at)=>st.filter(ct=>!it(ot,ct,at)),sortBy:(ot,st)=>Array.prototype.slice.call(st,0).sort((at,ct)=>{const ut=ot(at),lt=ot(ct);return ut<lt?-1:ut>lt?1:0}),isMapEqual:(ot,st)=>{if(ot.size!==st.size)return!1;for(const[at,ct]of ot){const ut=st.get(at);if(ut===void 0||ct instanceof Uint8Array&&ut instanceof Uint8Array&&!tt(ct,ut)||ct instanceof rt&&ut instanceof rt&&!ct.equals(ut))return!1}return!0}},utils}var $protobuf=minimal,$Reader=$protobuf.Reader,$Writer=$protobuf.Writer,$util=$protobuf.util,$root=$protobuf.roots["ipfs-bitswap"]||($protobuf.roots["ipfs-bitswap"]={});$root.Message=function(){function et(tt){if(this.blocks=[],this.payload=[],this.blockPresences=[],tt)for(var rt=Object.keys(tt),nt=0;nt<rt.length;++nt)tt[rt[nt]]!=null&&(this[rt[nt]]=tt[rt[nt]])}return et.prototype.wantlist=null,et.prototype.blocks=$util.emptyArray,et.prototype.payload=$util.emptyArray,et.prototype.blockPresences=$util.emptyArray,et.prototype.pendingBytes=0,et.encode=function(tt,rt){if(rt||(rt=$Writer.create()),tt.wantlist!=null&&Object.hasOwnProperty.call(tt,"wantlist")&&$root.Message.Wantlist.encode(tt.wantlist,rt.uint32(10).fork()).ldelim(),tt.blocks!=null&&tt.blocks.length)for(var nt=0;nt<tt.blocks.length;++nt)rt.uint32(18).bytes(tt.blocks[nt]);if(tt.payload!=null&&tt.payload.length)for(var nt=0;nt<tt.payload.length;++nt)$root.Message.Block.encode(tt.payload[nt],rt.uint32(26).fork()).ldelim();if(tt.blockPresences!=null&&tt.blockPresences.length)for(var nt=0;nt<tt.blockPresences.length;++nt)$root.Message.BlockPresence.encode(tt.blockPresences[nt],rt.uint32(34).fork()).ldelim();return tt.pendingBytes!=null&&Object.hasOwnProperty.call(tt,"pendingBytes")&&rt.uint32(40).int32(tt.pendingBytes),rt},et.decode=function(tt,rt){tt instanceof $Reader||(tt=$Reader.create(tt));for(var nt=rt===void 0?tt.len:tt.pos+rt,it=new $root.Message;tt.pos<nt;){var ot=tt.uint32();switch(ot>>>3){case 1:it.wantlist=$root.Message.Wantlist.decode(tt,tt.uint32());break;case 2:it.blocks&&it.blocks.length||(it.blocks=[]),it.blocks.push(tt.bytes());break;case 3:it.payload&&it.payload.length||(it.payload=[]),it.payload.push($root.Message.Block.decode(tt,tt.uint32()));break;case 4:it.blockPresences&&it.blockPresences.length||(it.blockPresences=[]),it.blockPresences.push($root.Message.BlockPresence.decode(tt,tt.uint32()));break;case 5:it.pendingBytes=tt.int32();break;default:tt.skipType(ot&7);break}}return it},et.fromObject=function(tt){if(tt instanceof $root.Message)return tt;var rt=new $root.Message;if(tt.wantlist!=null){if(typeof tt.wantlist!="object")throw TypeError(".Message.wantlist: object expected");rt.wantlist=$root.Message.Wantlist.fromObject(tt.wantlist)}if(tt.blocks){if(!Array.isArray(tt.blocks))throw TypeError(".Message.blocks: array expected");rt.blocks=[];for(var nt=0;nt<tt.blocks.length;++nt)typeof tt.blocks[nt]=="string"?$util.base64.decode(tt.blocks[nt],rt.blocks[nt]=$util.newBuffer($util.base64.length(tt.blocks[nt])),0):tt.blocks[nt].length&&(rt.blocks[nt]=tt.blocks[nt])}if(tt.payload){if(!Array.isArray(tt.payload))throw TypeError(".Message.payload: array expected");rt.payload=[];for(var nt=0;nt<tt.payload.length;++nt){if(typeof tt.payload[nt]!="object")throw TypeError(".Message.payload: object expected");rt.payload[nt]=$root.Message.Block.fromObject(tt.payload[nt])}}if(tt.blockPresences){if(!Array.isArray(tt.blockPresences))throw TypeError(".Message.blockPresences: array expected");rt.blockPresences=[];for(var nt=0;nt<tt.blockPresences.length;++nt){if(typeof tt.blockPresences[nt]!="object")throw TypeError(".Message.blockPresences: object expected");rt.blockPresences[nt]=$root.Message.BlockPresence.fromObject(tt.blockPresences[nt])}}return tt.pendingBytes!=null&&(rt.pendingBytes=tt.pendingBytes|0),rt},et.toObject=function(tt,rt){rt||(rt={});var nt={};if((rt.arrays||rt.defaults)&&(nt.blocks=[],nt.payload=[],nt.blockPresences=[]),rt.defaults&&(nt.wantlist=null,nt.pendingBytes=0),tt.wantlist!=null&&tt.hasOwnProperty("wantlist")&&(nt.wantlist=$root.Message.Wantlist.toObject(tt.wantlist,rt)),tt.blocks&&tt.blocks.length){nt.blocks=[];for(var it=0;it<tt.blocks.length;++it)nt.blocks[it]=rt.bytes===String?$util.base64.encode(tt.blocks[it],0,tt.blocks[it].length):rt.bytes===Array?Array.prototype.slice.call(tt.blocks[it]):tt.blocks[it]}if(tt.payload&&tt.payload.length){nt.payload=[];for(var it=0;it<tt.payload.length;++it)nt.payload[it]=$root.Message.Block.toObject(tt.payload[it],rt)}if(tt.blockPresences&&tt.blockPresences.length){nt.blockPresences=[];for(var it=0;it<tt.blockPresences.length;++it)nt.blockPresences[it]=$root.Message.BlockPresence.toObject(tt.blockPresences[it],rt)}return tt.pendingBytes!=null&&tt.hasOwnProperty("pendingBytes")&&(nt.pendingBytes=tt.pendingBytes),nt},et.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},et.Wantlist=function(){function tt(rt){if(this.entries=[],rt)for(var nt=Object.keys(rt),it=0;it<nt.length;++it)rt[nt[it]]!=null&&(this[nt[it]]=rt[nt[it]])}return tt.prototype.entries=$util.emptyArray,tt.prototype.full=!1,tt.encode=function(rt,nt){if(nt||(nt=$Writer.create()),rt.entries!=null&&rt.entries.length)for(var it=0;it<rt.entries.length;++it)$root.Message.Wantlist.Entry.encode(rt.entries[it],nt.uint32(10).fork()).ldelim();return rt.full!=null&&Object.hasOwnProperty.call(rt,"full")&&nt.uint32(16).bool(rt.full),nt},tt.decode=function(rt,nt){rt instanceof $Reader||(rt=$Reader.create(rt));for(var it=nt===void 0?rt.len:rt.pos+nt,ot=new $root.Message.Wantlist;rt.pos<it;){var st=rt.uint32();switch(st>>>3){case 1:ot.entries&&ot.entries.length||(ot.entries=[]),ot.entries.push($root.Message.Wantlist.Entry.decode(rt,rt.uint32()));break;case 2:ot.full=rt.bool();break;default:rt.skipType(st&7);break}}return ot},tt.fromObject=function(rt){if(rt instanceof $root.Message.Wantlist)return rt;var nt=new $root.Message.Wantlist;if(rt.entries){if(!Array.isArray(rt.entries))throw TypeError(".Message.Wantlist.entries: array expected");nt.entries=[];for(var it=0;it<rt.entries.length;++it){if(typeof rt.entries[it]!="object")throw TypeError(".Message.Wantlist.entries: object expected");nt.entries[it]=$root.Message.Wantlist.Entry.fromObject(rt.entries[it])}}return rt.full!=null&&(nt.full=!!rt.full),nt},tt.toObject=function(rt,nt){nt||(nt={});var it={};if((nt.arrays||nt.defaults)&&(it.entries=[]),nt.defaults&&(it.full=!1),rt.entries&&rt.entries.length){it.entries=[];for(var ot=0;ot<rt.entries.length;++ot)it.entries[ot]=$root.Message.Wantlist.Entry.toObject(rt.entries[ot],nt)}return rt.full!=null&&rt.hasOwnProperty("full")&&(it.full=rt.full),it},tt.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},tt.WantType=function(){var rt={},nt=Object.create(rt);return nt[rt[0]="Block"]=0,nt[rt[1]="Have"]=1,nt}(),tt.Entry=function(){function rt(nt){if(nt)for(var it=Object.keys(nt),ot=0;ot<it.length;++ot)nt[it[ot]]!=null&&(this[it[ot]]=nt[it[ot]])}return rt.prototype.block=$util.newBuffer([]),rt.prototype.priority=0,rt.prototype.cancel=!1,rt.prototype.wantType=0,rt.prototype.sendDontHave=!1,rt.encode=function(nt,it){return it||(it=$Writer.create()),nt.block!=null&&Object.hasOwnProperty.call(nt,"block")&&it.uint32(10).bytes(nt.block),nt.priority!=null&&Object.hasOwnProperty.call(nt,"priority")&&it.uint32(16).int32(nt.priority),nt.cancel!=null&&Object.hasOwnProperty.call(nt,"cancel")&&it.uint32(24).bool(nt.cancel),nt.wantType!=null&&Object.hasOwnProperty.call(nt,"wantType")&&it.uint32(32).int32(nt.wantType),nt.sendDontHave!=null&&Object.hasOwnProperty.call(nt,"sendDontHave")&&it.uint32(40).bool(nt.sendDontHave),it},rt.decode=function(nt,it){nt instanceof $Reader||(nt=$Reader.create(nt));for(var ot=it===void 0?nt.len:nt.pos+it,st=new $root.Message.Wantlist.Entry;nt.pos<ot;){var at=nt.uint32();switch(at>>>3){case 1:st.block=nt.bytes();break;case 2:st.priority=nt.int32();break;case 3:st.cancel=nt.bool();break;case 4:st.wantType=nt.int32();break;case 5:st.sendDontHave=nt.bool();break;default:nt.skipType(at&7);break}}return st},rt.fromObject=function(nt){if(nt instanceof $root.Message.Wantlist.Entry)return nt;var it=new $root.Message.Wantlist.Entry;switch(nt.block!=null&&(typeof nt.block=="string"?$util.base64.decode(nt.block,it.block=$util.newBuffer($util.base64.length(nt.block)),0):nt.block.length&&(it.block=nt.block)),nt.priority!=null&&(it.priority=nt.priority|0),nt.cancel!=null&&(it.cancel=!!nt.cancel),nt.wantType){case"Block":case 0:it.wantType=0;break;case"Have":case 1:it.wantType=1;break}return nt.sendDontHave!=null&&(it.sendDontHave=!!nt.sendDontHave),it},rt.toObject=function(nt,it){it||(it={});var ot={};return it.defaults&&(it.bytes===String?ot.block="":(ot.block=[],it.bytes!==Array&&(ot.block=$util.newBuffer(ot.block))),ot.priority=0,ot.cancel=!1,ot.wantType=it.enums===String?"Block":0,ot.sendDontHave=!1),nt.block!=null&&nt.hasOwnProperty("block")&&(ot.block=it.bytes===String?$util.base64.encode(nt.block,0,nt.block.length):it.bytes===Array?Array.prototype.slice.call(nt.block):nt.block),nt.priority!=null&&nt.hasOwnProperty("priority")&&(ot.priority=nt.priority),nt.cancel!=null&&nt.hasOwnProperty("cancel")&&(ot.cancel=nt.cancel),nt.wantType!=null&&nt.hasOwnProperty("wantType")&&(ot.wantType=it.enums===String?$root.Message.Wantlist.WantType[nt.wantType]:nt.wantType),nt.sendDontHave!=null&&nt.hasOwnProperty("sendDontHave")&&(ot.sendDontHave=nt.sendDontHave),ot},rt.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},rt}(),tt}(),et.Block=function(){function tt(rt){if(rt)for(var nt=Object.keys(rt),it=0;it<nt.length;++it)rt[nt[it]]!=null&&(this[nt[it]]=rt[nt[it]])}return tt.prototype.prefix=$util.newBuffer([]),tt.prototype.data=$util.newBuffer([]),tt.encode=function(rt,nt){return nt||(nt=$Writer.create()),rt.prefix!=null&&Object.hasOwnProperty.call(rt,"prefix")&&nt.uint32(10).bytes(rt.prefix),rt.data!=null&&Object.hasOwnProperty.call(rt,"data")&&nt.uint32(18).bytes(rt.data),nt},tt.decode=function(rt,nt){rt instanceof $Reader||(rt=$Reader.create(rt));for(var it=nt===void 0?rt.len:rt.pos+nt,ot=new $root.Message.Block;rt.pos<it;){var st=rt.uint32();switch(st>>>3){case 1:ot.prefix=rt.bytes();break;case 2:ot.data=rt.bytes();break;default:rt.skipType(st&7);break}}return ot},tt.fromObject=function(rt){if(rt instanceof $root.Message.Block)return rt;var nt=new $root.Message.Block;return rt.prefix!=null&&(typeof rt.prefix=="string"?$util.base64.decode(rt.prefix,nt.prefix=$util.newBuffer($util.base64.length(rt.prefix)),0):rt.prefix.length&&(nt.prefix=rt.prefix)),rt.data!=null&&(typeof rt.data=="string"?$util.base64.decode(rt.data,nt.data=$util.newBuffer($util.base64.length(rt.data)),0):rt.data.length&&(nt.data=rt.data)),nt},tt.toObject=function(rt,nt){nt||(nt={});var it={};return nt.defaults&&(nt.bytes===String?it.prefix="":(it.prefix=[],nt.bytes!==Array&&(it.prefix=$util.newBuffer(it.prefix))),nt.bytes===String?it.data="":(it.data=[],nt.bytes!==Array&&(it.data=$util.newBuffer(it.data)))),rt.prefix!=null&&rt.hasOwnProperty("prefix")&&(it.prefix=nt.bytes===String?$util.base64.encode(rt.prefix,0,rt.prefix.length):nt.bytes===Array?Array.prototype.slice.call(rt.prefix):rt.prefix),rt.data!=null&&rt.hasOwnProperty("data")&&(it.data=nt.bytes===String?$util.base64.encode(rt.data,0,rt.data.length):nt.bytes===Array?Array.prototype.slice.call(rt.data):rt.data),it},tt.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},tt}(),et.BlockPresenceType=function(){var tt={},rt=Object.create(tt);return rt[tt[0]="Have"]=0,rt[tt[1]="DontHave"]=1,rt}(),et.BlockPresence=function(){function tt(rt){if(rt)for(var nt=Object.keys(rt),it=0;it<nt.length;++it)rt[nt[it]]!=null&&(this[nt[it]]=rt[nt[it]])}return tt.prototype.cid=$util.newBuffer([]),tt.prototype.type=0,tt.encode=function(rt,nt){return nt||(nt=$Writer.create()),rt.cid!=null&&Object.hasOwnProperty.call(rt,"cid")&&nt.uint32(10).bytes(rt.cid),rt.type!=null&&Object.hasOwnProperty.call(rt,"type")&&nt.uint32(16).int32(rt.type),nt},tt.decode=function(rt,nt){rt instanceof $Reader||(rt=$Reader.create(rt));for(var it=nt===void 0?rt.len:rt.pos+nt,ot=new $root.Message.BlockPresence;rt.pos<it;){var st=rt.uint32();switch(st>>>3){case 1:ot.cid=rt.bytes();break;case 2:ot.type=rt.int32();break;default:rt.skipType(st&7);break}}return ot},tt.fromObject=function(rt){if(rt instanceof $root.Message.BlockPresence)return rt;var nt=new $root.Message.BlockPresence;switch(rt.cid!=null&&(typeof rt.cid=="string"?$util.base64.decode(rt.cid,nt.cid=$util.newBuffer($util.base64.length(rt.cid)),0):rt.cid.length&&(nt.cid=rt.cid)),rt.type){case"Have":case 0:nt.type=0;break;case"DontHave":case 1:nt.type=1;break}return nt},tt.toObject=function(rt,nt){nt||(nt={});var it={};return nt.defaults&&(nt.bytes===String?it.cid="":(it.cid=[],nt.bytes!==Array&&(it.cid=$util.newBuffer(it.cid))),it.type=nt.enums===String?"Have":0),rt.cid!=null&&rt.hasOwnProperty("cid")&&(it.cid=nt.bytes===String?$util.base64.encode(rt.cid,0,rt.cid.length):nt.bytes===Array?Array.prototype.slice.call(rt.cid):rt.cid),rt.type!=null&&rt.hasOwnProperty("type")&&(it.type=nt.enums===String?$root.Message.BlockPresenceType[rt.type]:rt.type),it},tt.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},tt}(),et}();var message$1=$root,message,hasRequiredMessage;function requireMessage(){if(hasRequiredMessage)return message;hasRequiredMessage=1;const{CID:et}=require$$9,{sha256:tt}=require$$1$4,{base58btc:rt}=require$$1$5,nt=src,{isMapEqual:it}=requireUtils(),{Message:ot}=message$1,st=requireEntry(),{concat:at}=require$$7$1,ct=errCode$i;class ut{constructor(ht){this.full=ht,this.wantlist=new Map,this.blocks=new Map,this.blockPresences=new Map,this.pendingBytes=0}get empty(){return this.blocks.size===0&&this.wantlist.size===0&&this.blockPresences.size===0}addEntry(ht,ft,dt,pt,gt){dt==null&&(dt=ut.WantType.Block);const _t=ht.toString(rt),mt=this.wantlist.get(_t);mt?(mt.wantType===dt&&(mt.priority=ft),pt&&(mt.cancel=!!pt),gt&&(mt.sendDontHave=!!gt),dt===ut.WantType.Block&&mt.wantType===ut.WantType.Have&&(mt.wantType=dt)):this.wantlist.set(_t,new st(ht,ft,dt,pt,gt))}addBlock(ht,ft){const dt=ht.toString(rt);this.blocks.set(dt,ft)}addHave(ht){const ft=ht.toString(rt);this.blockPresences.has(ft)||this.blockPresences.set(ft,ut.BlockPresenceType.Have)}addDontHave(ht){const ft=ht.toString(rt);this.blockPresences.has(ft)||this.blockPresences.set(ft,ut.BlockPresenceType.DontHave)}cancel(ht){const ft=ht.toString(rt);this.wantlist.delete(ft),this.addEntry(ht,0,ut.WantType.Block,!0,!1)}setPendingBytes(ht){this.pendingBytes=ht}serializeToBitswap100(){const ht={wantlist:{entries:Array.from(this.wantlist.values()).map(ft=>({block:ft.cid.bytes,priority:Number(ft.priority),cancel:!!ft.cancel})),full:this.full?!0:void 0},blocks:Array.from(this.blocks.values())};return ot.encode(ht).finish()}serializeToBitswap110(){const ht={wantlist:{entries:Array.from(this.wantlist.values()).map(ft=>({block:ft.cid.bytes,priority:Number(ft.priority),wantType:ft.wantType,cancel:!!ft.cancel,sendDontHave:!!ft.sendDontHave})),full:this.full?!0:void 0},blockPresences:[],payload:[],pendingBytes:this.pendingBytes};for(const[ft,dt]of this.blocks.entries()){const pt=et.parse(ft),gt=Uint8Array.from([pt.code]),_t=pt.multihash.bytes.subarray(0,2),mt=at([[pt.version],gt,_t],1+gt.byteLength+_t.byteLength);ht.payload.push(new ot.Block({prefix:mt,data:dt}))}for(const[ft,dt]of this.blockPresences)ht.blockPresences.push(new ot.BlockPresence({cid:et.parse(ft).bytes,type:dt}));return this.pendingBytes>0&&(ht.pendingBytes=this.pendingBytes),ot.encode(ht).finish()}equals(ht){return!(this.full!==ht.full||this.pendingBytes!==ht.pendingBytes||!it(this.wantlist,ht.wantlist)||!it(this.blocks,ht.blocks)||!it(this.blockPresences,ht.blockPresences))}get[Symbol.toStringTag](){const ht=Array.from(this.wantlist.keys()),ft=Array.from(this.blocks.keys());return`BitswapMessage <full: ${this.full}, list: ${ht}, blocks: ${ft}>`}}return ut.deserialize=async(lt,ht={})=>{const ft=ot.decode(lt),dt=ft.wantlist&&ft.wantlist.full||!1,pt=new ut(dt);return ft.wantlist&&ft.wantlist.entries&&ft.wantlist.entries.forEach(gt=>{if(!gt.block)return;const _t=et.decode(gt.block);pt.addEntry(_t,gt.priority||0,gt.wantType,!!gt.cancel,!!gt.sendDontHave)}),ft.blockPresences&&ft.blockPresences.forEach(gt=>{if(!gt.cid)return;const _t=et.decode(gt.cid);gt.type===ut.BlockPresenceType.Have?pt.addHave(_t):pt.addDontHave(_t)}),ft.blocks.length>0?(await Promise.all(ft.blocks.map(async gt=>{const _t=await tt.digest(gt),mt=et.createV0(_t);pt.addBlock(mt,gt)})),pt):(ft.payload.length>0&&(await Promise.all(ft.payload.map(async gt=>{if(!gt.prefix||!gt.data)return;const _t=nt(gt.prefix),mt=_t[0],At=_t[1],It=_t[2],Mt=It===tt.code?tt:ht[It];if(!Mt)throw ct(new Error("Unknown hash algorithm"),"ERR_UNKNOWN_HASH_ALG");const kt=await Mt.digest(gt.data),Ct=et.create(mt,At,kt);pt.addBlock(Ct,gt.data)})),pt.setPendingBytes(ft.pendingBytes)),pt)},ut.blockPresenceSize=lt=>lt.bytes.length+1,ut.Entry=st,ut.WantType={Block:ot.Wantlist.WantType.Block,Have:ot.Wantlist.WantType.Have},ut.BlockPresenceType={Have:ot.BlockPresenceType.Have,DontHave:ot.BlockPresenceType.DontHave},message=ut,message}requireMessage(),requireUtils().logger,requireMessage(),requireWantlist(),requireUtils().logger,requireMessage(),requireUtils().logger,requireWantlist();const Message=requireMessage();Message.WantType,requireWantlist(),requireUtils(),requireUtils().logger,requireUtils().logger,mergeOptions.bind({ignoreUndefined:!0}),browserExports("ipfs");const occupiedRooms={},sockets={},socketListeners={},hashLimit=20,offerPoolSize=10,defaultRedundancy=2,defaultAnnounceSecs=33,maxAnnounceSecs=120,trackerAction="announce",defaultTrackerUrls=["wss://fediverse.tv/tracker/socket","wss://tracker.files.fm:7073/announce","wss://tracker.openwebtorrent.com","wss://tracker.btorrent.xyz","wss://qot.abiir.top:443/announce","wss://spacetradersapi-chatbox.herokuapp.com:443/announce"],joinRoom=initGuard(occupiedRooms,(et,tt)=>new Promise(async(rt,nt)=>{const it={},ot=et.password&&await genKey(et.password,tt),st=(et.trackerUrls||defaultTrackerUrls).slice(0,et.trackerUrls?et.trackerUrls.length:et.trackerRedundancy||defaultRedundancy);if(!st.length)throw nt(()=>mkErr("trackerUrls is empty"));const at=crypto.subtle.digest("SHA-1",encodeBytes$1(`${libName}:${et.appId}:${tt}`)).then(Ct=>Array.from(new Uint8Array(Ct)).map(Ut=>Ut.toString(36)).join("").slice(0,hashLimit)),ct=Ct=>fromEntries(new Array(Ct).fill("").map(()=>{const Ut=initPeer(!0,!1,et.rtcConfig);return[genId(hashLimit),{peer:Ut,offerP:new Promise(Wt=>Ut.once(events$2.signal,Wt))}]})),ut=()=>ct(offerPoolSize),lt=async(Ct,Ut)=>{const Wt=await at;let Ft;try{Ft=JSON.parse(Ut.data)}catch{console.error(`${libName}: received malformed SDP JSON`);return}if(Ft.info_hash!==Wt||Ft.peer_id&&Ft.peer_id===selfId)return;const Ce=Ft["failure reason"];if(Ce){console.warn(`${libName}: torrent tracker failure (${Ce})`);return}if(Ft.interval&&Ft.interval>mt&&Ft.interval<=maxAnnounceSecs&&(clearInterval(At),mt=Ft.interval,At=setInterval(dt,mt*1e3)),Ft.offer&&Ft.offer_id){if(it[Ft.peer_id]||Mt[Ft.offer_id])return;Mt[Ft.offer_id]=!0;const bt=initPeer(!1,!1,et.rtcConfig);bt.once(events$2.signal,async yt=>Ct.send(JSON.stringify({answer:ot?{...yt,sdp:await encrypt(ot,yt.sdp)}:yt,action:trackerAction,info_hash:Wt,peer_id:selfId,to_peer_id:Ft.peer_id,offer_id:Ft.offer_id}))),bt.on(events$2.connect,()=>gt(bt,Ft.peer_id,`${Ft.offer_id}`)),bt.on(events$2.close,()=>_t(bt,Ft.peer_id,`${Ft.offer_id}`)),bt.signal(ot?{...Ft.offer,sdp:await decrypt(ot,Ft.offer.sdp),type:"offer"}:{...Ft.offer,type:"offer"});return}if(Ft.answer){if(it[Ft.peer_id]||Mt[Ft.offer_id])return;const bt=kt[Ft.offer_id];if(bt){const{peer:yt}=bt;if(yt.destroyed)return;Mt[Ft.offer_id]=!0,yt.on(events$2.connect,()=>gt(yt,Ft.peer_id,`${Ft.offer_id}`)),yt.on(events$2.close,()=>_t(yt,Ft.peer_id,`${Ft.offer_id}`)),yt.signal(ot?{...Ft.answer,sdp:await decrypt(ot,Ft.answer.sdp),type:"answer"}:{...Ft.answer,type:"answer"})}}},ht=async(Ct,Ut)=>Ct.send(JSON.stringify({action:trackerAction,info_hash:Ut,numwant:offerPoolSize,peer_id:selfId,offers:await Promise.all(entries$1(kt).map(async([Wt,{offerP:Ft}])=>{const Ce=await Ft;return{offer_id:Wt,offer:ot?{...Ce,sdp:await encrypt(ot,Ce.sdp)}:Ce}}))})),ft=(Ct,Ut,Wt=!1)=>(Wt||!sockets[Ct]?(socketListeners[Ct]={...socketListeners[Ct],[Ut]:lt},sockets[Ct]=new Promise(Ft=>{const Ce=new WebSocket(Ct);Ce.onopen=Ft.bind(null,Ce),Ce.onmessage=bt=>values(socketListeners[Ct]).forEach(yt=>yt(Ce,bt))})):socketListeners[Ct][Ut]=lt,sockets[Ct]),dt=async()=>{const Ct=await at;kt&&pt(),kt=ut(),st.forEach(async Ut=>{const Wt=await ft(Ut,Ct);Wt.readyState===WebSocket.OPEN?ht(Wt,Ct):Wt.readyState!==WebSocket.CONNECTING&&ht(await ft(Ut,Ct,!0),Ct)})},pt=()=>{entries$1(kt).forEach(([Ct,{peer:Ut}])=>{!Mt[Ct]&&!it[Ct]&&Ut.destroy()}),Mt={}},gt=(Ct,Ut,Wt)=>{It(Ct,Ut),it[Ut]=!0,Wt&&(it[Wt]=!0)},_t=(Ct,Ut,Wt)=>{delete it[Ut],Ct.destroy(),Wt in kt&&(delete kt[Wt],kt={...kt,...ct(1)})};let mt=defaultAnnounceSecs,At=setInterval(dt,mt*1e3),It=noOp,Mt={},kt;return occupiedRooms[tt]=!0,dt(),rt(await room(Ct=>{It=Ct},async()=>{const Ct=await at;st.forEach(Ut=>delete socketListeners[Ut][Ct]),delete occupiedRooms[tt],clearInterval(At),pt()},et.encryptDecrypt))}));function _extends$7(){return _extends$7=Object.assign?Object.assign.bind():function(et){for(var tt=1;tt<arguments.length;tt++){var rt=arguments[tt];for(var nt in rt)Object.prototype.hasOwnProperty.call(rt,nt)&&(et[nt]=rt[nt])}return et},_extends$7.apply(this,arguments)}function g$3(et,tt){for(var rt in tt)et[rt]=tt[rt];return et}function C$2(et,tt){for(var rt in et)if(rt!=="__source"&&!(rt in tt))return!0;for(var nt in tt)if(nt!=="__source"&&et[nt]!==tt[nt])return!0;return!1}function E$2(et,tt){return et===tt&&(et!==0||1/et==1/tt)||et!=et&&tt!=tt}function w$4(et){this.props=et}function x$3(et,tt){function rt(it){var ot=this.props.ref,st=ot==it.ref;return!st&&ot&&(ot.call?ot(null):ot.current=null),tt?!tt(this.props,it)||!st:C$2(this.props,it)}function nt(it){return this.shouldComponentUpdate=rt,y$4(et,it)}return nt.displayName="Memo("+(et.displayName||et.name)+")",nt.prototype.isReactComponent=!0,nt.__f=!0,nt}(w$4.prototype=new b$5).isPureReactComponent=!0,w$4.prototype.shouldComponentUpdate=function(et,tt){return C$2(this.props,et)||C$2(this.state,tt)};var R=l$3.__b;l$3.__b=function(et){et.type&&et.type.__f&&et.ref&&(et.props.ref=et.ref,et.ref=null),R&&R(et)};var N$1=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function k$4(et){function tt(rt){var nt=g$3({},rt);return delete nt.ref,et(nt,rt.ref||null)}return tt.$$typeof=N$1,tt.render=tt,tt.prototype.isReactComponent=tt.__f=!0,tt.displayName="ForwardRef("+(et.displayName||et.name)+")",tt}var A$1=function(et,tt){return et==null?null:S$2(S$2(et).map(tt))},O={map:A$1,forEach:A$1,count:function(et){return et?S$2(et).length:0},only:function(et){var tt=S$2(et);if(tt.length!==1)throw"Children.only";return tt[0]},toArray:S$2},T$1=l$3.__e;l$3.__e=function(et,tt,rt,nt){if(et.then){for(var it,ot=tt;ot=ot.__;)if((it=ot.__c)&&it.__c)return tt.__e==null&&(tt.__e=rt.__e,tt.__k=rt.__k),it.__c(et,tt)}T$1(et,tt,rt,nt)};var I$1=l$3.unmount;function L$2(et,tt,rt){return et&&(et.__c&&et.__c.__H&&(et.__c.__H.__.forEach(function(nt){typeof nt.__c=="function"&&nt.__c()}),et.__c.__H=null),(et=g$3({},et)).__c!=null&&(et.__c.__P===rt&&(et.__c.__P=tt),et.__c=null),et.__k=et.__k&&et.__k.map(function(nt){return L$2(nt,tt,rt)})),et}function U$1(et,tt,rt){return et&&(et.__v=null,et.__k=et.__k&&et.__k.map(function(nt){return U$1(nt,tt,rt)}),et.__c&&et.__c.__P===tt&&(et.__e&&rt.insertBefore(et.__e,et.__d),et.__c.__e=!0,et.__c.__P=rt)),et}function D$1(){this.__u=0,this.t=null,this.__b=null}function F$1(et){var tt=et.__.__c;return tt&&tt.__a&&tt.__a(et)}function M$1(et){var tt,rt,nt;function it(ot){if(tt||(tt=et()).then(function(st){rt=st.default||st},function(st){nt=st}),nt)throw nt;if(!rt)throw tt;return y$4(rt,ot)}return it.displayName="Lazy",it.__f=!0,it}function V$1(){this.u=null,this.o=null}l$3.unmount=function(et){var tt=et.__c;tt&&tt.__R&&tt.__R(),tt&&et.__h===!0&&(et.type=null),I$1&&I$1(et)},(D$1.prototype=new b$5).__c=function(et,tt){var rt=tt.__c,nt=this;nt.t==null&&(nt.t=[]),nt.t.push(rt);var it=F$1(nt.__v),ot=!1,st=function(){ot||(ot=!0,rt.__R=null,it?it(at):at())};rt.__R=st;var at=function(){if(!--nt.__u){if(nt.state.__a){var ut=nt.state.__a;nt.__v.__k[0]=U$1(ut,ut.__c.__P,ut.__c.__O)}var lt;for(nt.setState({__a:nt.__b=null});lt=nt.t.pop();)lt.forceUpdate()}},ct=tt.__h===!0;nt.__u++||ct||nt.setState({__a:nt.__b=nt.__v.__k[0]}),et.then(st,st)},D$1.prototype.componentWillUnmount=function(){this.t=[]},D$1.prototype.render=function(et,tt){if(this.__b){if(this.__v.__k){var rt=document.createElement("div"),nt=this.__v.__k[0].__c;this.__v.__k[0]=L$2(this.__b,rt,nt.__O=nt.__P)}this.__b=null}var it=tt.__a&&y$4(k$6,null,et.fallback);return it&&(it.__h=null),[y$4(k$6,null,tt.__a?null:et.children),it]};var W$1=function(et,tt,rt){if(++rt[1]===rt[0]&&et.o.delete(tt),et.props.revealOrder&&(et.props.revealOrder[0]!=="t"||!et.o.size))for(rt=et.u;rt;){for(;rt.length>3;)rt.pop()();if(rt[1]<rt[0])break;et.u=rt=rt[2]}};function P(et){return this.getChildContext=function(){return et.context},et.children}function j$1(et){var tt=this,rt=et.i;tt.componentWillUnmount=function(){D$3(null,tt.l),tt.l=null,tt.i=null},tt.i&&tt.i!==rt&&tt.componentWillUnmount(),et.__v?(tt.l||(tt.i=rt,tt.l={nodeType:1,parentNode:rt,childNodes:[],appendChild:function(nt){this.childNodes.push(nt),tt.i.appendChild(nt)},insertBefore:function(nt,it){this.childNodes.push(nt),tt.i.appendChild(nt)},removeChild:function(nt){this.childNodes.splice(this.childNodes.indexOf(nt)>>>1,1),tt.i.removeChild(nt)}}),D$3(y$4(P,{context:tt.context},et.__v),tt.l)):tt.l&&tt.componentWillUnmount()}function z$3(et,tt){var rt=y$4(j$1,{__v:et,i:tt});return rt.containerInfo=tt,rt}(V$1.prototype=new b$5).__a=function(et){var tt=this,rt=F$1(tt.__v),nt=tt.o.get(et);return nt[0]++,function(it){var ot=function(){tt.props.revealOrder?(nt.push(it),W$1(tt,et,nt)):it()};rt?rt(ot):ot()}},V$1.prototype.render=function(et){this.u=null,this.o=new Map;var tt=S$2(et.children);et.revealOrder&&et.revealOrder[0]==="b"&&tt.reverse();for(var rt=tt.length;rt--;)this.o.set(tt[rt],this.u=[1,0,this.u]);return et.children},V$1.prototype.componentDidUpdate=V$1.prototype.componentDidMount=function(){var et=this;this.o.forEach(function(tt,rt){W$1(et,rt,tt)})};var B$1=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,H$2=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Z$1=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Y$1=/[A-Z0-9]/g,$$1=typeof document<"u",q$4=function(et){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/:/fil|che|ra/).test(et)};function G$1(et,tt,rt){return tt.__k==null&&(tt.textContent=""),D$3(et,tt),typeof rt=="function"&&rt(),et?et.__c:null}function J$1(et,tt,rt){return E$3(et,tt),typeof rt=="function"&&rt(),et?et.__c:null}b$5.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(et){Object.defineProperty(b$5.prototype,et,{configurable:!0,get:function(){return this["UNSAFE_"+et]},set:function(tt){Object.defineProperty(this,et,{configurable:!0,writable:!0,value:tt})}})});var K$1=l$3.event;function Q$1(){}function X$1(){return this.cancelBubble}function nn(){return this.defaultPrevented}l$3.event=function(et){return K$1&&(et=K$1(et)),et.persist=Q$1,et.isPropagationStopped=X$1,et.isDefaultPrevented=nn,et.nativeEvent=et};var tn,en={enumerable:!1,configurable:!0,get:function(){return this.class}},rn=l$3.vnode;l$3.vnode=function(et){typeof et.type=="string"&&function(tt){var rt=tt.props,nt=tt.type,it={};for(var ot in rt){var st=rt[ot];if(!(ot==="value"&&"defaultValue"in rt&&st==null||$$1&&ot==="children"&&nt==="noscript"||ot==="class"||ot==="className")){var at=ot.toLowerCase();ot==="defaultValue"&&"value"in rt&&rt.value==null?ot="value":ot==="download"&&st===!0?st="":at==="ondoubleclick"?ot="ondblclick":at!=="onchange"||nt!=="input"&&nt!=="textarea"||q$4(rt.type)?at==="onfocus"?ot="onfocusin":at==="onblur"?ot="onfocusout":Z$1.test(ot)?ot=at:nt.indexOf("-")===-1&&H$2.test(ot)?ot=ot.replace(Y$1,"-$&").toLowerCase():st===null&&(st=void 0):at=ot="oninput",at==="oninput"&&it[ot=at]&&(ot="oninputCapture"),it[ot]=st}}nt=="select"&&it.multiple&&Array.isArray(it.value)&&(it.value=S$2(rt.children).forEach(function(ct){ct.props.selected=it.value.indexOf(ct.props.value)!=-1})),nt=="select"&&it.defaultValue!=null&&(it.value=S$2(rt.children).forEach(function(ct){ct.props.selected=it.multiple?it.defaultValue.indexOf(ct.props.value)!=-1:it.defaultValue==ct.props.value})),rt.class&&!rt.className?(it.class=rt.class,Object.defineProperty(it,"className",en)):(rt.className&&!rt.class||rt.class&&rt.className)&&(it.class=it.className=rt.className),tt.props=it}(et),et.$$typeof=B$1,rn&&rn(et)};var un=l$3.__r;l$3.__r=function(et){un&&un(et),tn=et.__c};var on=l$3.diffed;l$3.diffed=function(et){on&&on(et);var tt=et.props,rt=et.__e;rt!=null&&et.type==="textarea"&&"value"in tt&&tt.value!==rt.value&&(rt.value=tt.value==null?"":tt.value),tn=null};var ln={ReactCurrentDispatcher:{current:{readContext:function(et){return tn.__n[et.__c].props.value}}}},cn="17.0.2";function fn(et){return y$4.bind(null,et)}function an(et){return!!et&&et.$$typeof===B$1}function sn(et){return an(et)?F$3.apply(null,arguments):et}function hn(et){return!!et.__k&&(D$3(null,et),!0)}function vn(et){return et&&(et.base||et.nodeType===1&&et)||null}var dn=function(et,tt){return et(tt)},pn=function(et,tt){return et(tt)},mn=k$6;function yn(et){et()}function _n(et){return et}function bn(){return[!1,yn]}var Sn=y$3;function gn(et,tt){var rt=tt(),nt=h$4({h:{__:rt,v:tt}}),it=nt[0].h,ot=nt[1];return y$3(function(){it.__=rt,it.v=tt,E$2(it.__,tt())||ot({h:it})},[et,rt,tt]),p$5(function(){return E$2(it.__,it.v())||ot({h:it}),et(function(){E$2(it.__,it.v())||ot({h:it})})},[et]),rt}var Cn={useState:h$4,useId:V$3,useReducer:s$2,useEffect:p$5,useLayoutEffect:y$3,useInsertionEffect:Sn,useTransition:bn,useDeferredValue:_n,useSyncExternalStore:gn,startTransition:yn,useRef:_$2,useImperativeHandle:A$3,useMemo:F$2,useCallback:T$2,useContext:q$5,useDebugValue:x$4,version:"17.0.2",Children:O,render:G$1,hydrate:J$1,unmountComponentAtNode:hn,createPortal:z$3,createElement:y$4,createContext:G$2,createFactory:fn,cloneElement:sn,createRef:_$3,Fragment:k$6,isValidElement:an,findDOMNode:vn,Component:b$5,PureComponent:w$4,memo:x$3,forwardRef:k$4,flushSync:pn,unstable_batchedUpdates:dn,StrictMode:mn,Suspense:D$1,SuspenseList:V$1,lazy:M$1,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:ln};const compat_module=Object.freeze(Object.defineProperty({__proto__:null,Children:O,Component:b$5,Fragment:k$6,PureComponent:w$4,StrictMode:mn,Suspense:D$1,SuspenseList:V$1,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:ln,cloneElement:sn,createContext:G$2,createElement:y$4,createFactory:fn,createPortal:z$3,createRef:_$3,default:Cn,findDOMNode:vn,flushSync:pn,forwardRef:k$4,hydrate:J$1,isValidElement:an,lazy:M$1,memo:x$3,render:G$1,startTransition:yn,unmountComponentAtNode:hn,unstable_batchedUpdates:dn,useCallback:T$2,useContext:q$5,useDebugValue:x$4,useDeferredValue:_n,useEffect:p$5,useErrorBoundary:P$1,useId:V$3,useImperativeHandle:A$3,useInsertionEffect:Sn,useLayoutEffect:y$3,useMemo:F$2,useReducer:s$2,useRef:_$2,useState:h$4,useSyncExternalStore:gn,useTransition:bn,version:cn},Symbol.toStringTag,{value:"Module"}));function $e42e1063c40fb3ef$export$b9ecd428b558ff10(et,tt,{checkForDefaultPrevented:rt=!0}={}){return function(nt){if(et==null||et(nt),rt===!1||!nt.defaultPrevented)return tt==null?void 0:tt(nt)}}function $c512c27ab02ef895$export$50c7b4e9d9f19c1(et,tt=[]){let rt=[];function nt(ot,st){const at=G$2(st),ct=rt.length;rt=[...rt,st];function ut(ht){const{scope:ft,children:dt,...pt}=ht,gt=(ft==null?void 0:ft[et][ct])||at,_t=F$2(()=>pt,Object.values(pt));return y$4(gt.Provider,{value:_t},dt)}function lt(ht,ft){const dt=(ft==null?void 0:ft[et][ct])||at,pt=q$5(dt);if(pt)return pt;if(st!==void 0)return st;throw new Error(`\`${ht}\` must be used within \`${ot}\``)}return ut.displayName=ot+"Provider",[ut,lt]}const it=()=>{const ot=rt.map(st=>G$2(st));return function(st){const at=(st==null?void 0:st[et])||ot;return F$2(()=>({[`__scope${et}`]:{...st,[et]:at}}),[st,at])}};return it.scopeName=et,[nt,$c512c27ab02ef895$var$composeContextScopes(it,...tt)]}function $c512c27ab02ef895$var$composeContextScopes(...et){const tt=et[0];if(et.length===1)return tt;const rt=()=>{const nt=et.map(it=>({useScope:it(),scopeName:it.scopeName}));return function(it){const ot=nt.reduce((st,{useScope:at,scopeName:ct})=>{const ut=at(it)[`__scope${ct}`];return{...st,...ut}},{});return F$2(()=>({[`__scope${tt.scopeName}`]:ot}),[ot])}};return rt.scopeName=tt.scopeName,rt}function $6ed0406888f73fc4$var$setRef(et,tt){typeof et=="function"?et(tt):et!=null&&(et.current=tt)}function $6ed0406888f73fc4$export$43e446d32b3d21af(...et){return tt=>et.forEach(rt=>$6ed0406888f73fc4$var$setRef(rt,tt))}function $6ed0406888f73fc4$export$c7b2cbe3552a0d05(...et){return T$2($6ed0406888f73fc4$export$43e446d32b3d21af(...et),et)}const $5e63c961fc1ce211$export$8c6ed5c666ac1360=k$4((et,tt)=>{const{children:rt,...nt}=et,it=O.toArray(rt),ot=it.find($5e63c961fc1ce211$var$isSlottable);if(ot){const st=ot.props.children,at=it.map(ct=>ct===ot?O.count(st)>1?O.only(null):an(st)?st.props.children:null:ct);return y$4($5e63c961fc1ce211$var$SlotClone,_extends$7({},nt,{ref:tt}),an(st)?sn(st,void 0,at):null)}return y$4($5e63c961fc1ce211$var$SlotClone,_extends$7({},nt,{ref:tt}),rt)});$5e63c961fc1ce211$export$8c6ed5c666ac1360.displayName="Slot";const $5e63c961fc1ce211$var$SlotClone=k$4((et,tt)=>{const{children:rt,...nt}=et;return an(rt)?sn(rt,{...$5e63c961fc1ce211$var$mergeProps(nt,rt.props),ref:tt?$6ed0406888f73fc4$export$43e446d32b3d21af(tt,rt.ref):rt.ref}):O.count(rt)>1?O.only(null):null});$5e63c961fc1ce211$var$SlotClone.displayName="SlotClone";const $5e63c961fc1ce211$export$d9f1ccf0bdb05d45=({children:et})=>y$4(k$6,null,et);function $5e63c961fc1ce211$var$isSlottable(et){return an(et)&&et.type===$5e63c961fc1ce211$export$d9f1ccf0bdb05d45}function $5e63c961fc1ce211$var$mergeProps(et,tt){const rt={...tt};for(const nt in tt){const it=et[nt],ot=tt[nt];/^on[A-Z]/.test(nt)?it&&ot?rt[nt]=(...st)=>{ot(...st),it(...st)}:it&&(rt[nt]=it):nt==="style"?rt[nt]={...it,...ot}:nt==="className"&&(rt[nt]=[it,ot].filter(Boolean).join(" "))}return{...et,...rt}}function $e02a7d9cb1dc128c$export$c74125a8e3af6bb2(et){const tt=et+"CollectionProvider",[rt,nt]=$c512c27ab02ef895$export$50c7b4e9d9f19c1(tt),[it,ot]=rt(tt,{collectionRef:{current:null},itemMap:new Map}),st=dt=>{const{scope:pt,children:gt}=dt,_t=Cn.useRef(null),mt=Cn.useRef(new Map).current;return Cn.createElement(it,{scope:pt,itemMap:mt,collectionRef:_t},gt)},at=et+"CollectionSlot",ct=Cn.forwardRef((dt,pt)=>{const{scope:gt,children:_t}=dt,mt=ot(at,gt),At=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(pt,mt.collectionRef);return Cn.createElement($5e63c961fc1ce211$export$8c6ed5c666ac1360,{ref:At},_t)}),ut=et+"CollectionItemSlot",lt="data-radix-collection-item",ht=Cn.forwardRef((dt,pt)=>{const{scope:gt,children:_t,...mt}=dt,At=Cn.useRef(null),It=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(pt,At),Mt=ot(ut,gt);return Cn.useEffect(()=>(Mt.itemMap.set(At,{ref:At,...mt}),()=>void Mt.itemMap.delete(At))),Cn.createElement($5e63c961fc1ce211$export$8c6ed5c666ac1360,{[lt]:"",ref:It},_t)});function ft(dt){const pt=ot(et+"CollectionConsumer",dt);return Cn.useCallback(()=>{const gt=pt.collectionRef.current;if(!gt)return[];const _t=Array.from(gt.querySelectorAll(`[${lt}]`));return Array.from(pt.itemMap.values()).sort((mt,At)=>_t.indexOf(mt.ref.current)-_t.indexOf(At.ref.current))},[pt.collectionRef,pt.itemMap])}return[{Provider:st,Slot:ct,ItemSlot:ht},ft,nt]}const $9f79659886946c16$export$e5c5a5f917a5871c=globalThis!=null&&globalThis.document?y$3:()=>{},$1746a345f3d73bb7$var$useReactId=compat_module["useId".toString()]||(()=>{});let $1746a345f3d73bb7$var$count=0;function $1746a345f3d73bb7$export$f680877a34711e37(et){const[tt,rt]=h$4($1746a345f3d73bb7$var$useReactId());return $9f79659886946c16$export$e5c5a5f917a5871c(()=>{et||rt(nt=>nt??String($1746a345f3d73bb7$var$count++))},[et]),et||(tt?`radix-${tt}`:"")}const $8927f6f2acc4f386$var$NODES=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],$8927f6f2acc4f386$export$250ffa63cdc0d034=$8927f6f2acc4f386$var$NODES.reduce((et,tt)=>{const rt=k$4((nt,it)=>{const{asChild:ot,...st}=nt,at=ot?$5e63c961fc1ce211$export$8c6ed5c666ac1360:tt;return p$5(()=>{window[Symbol.for("radix-ui")]=!0},[]),y$4(at,_extends$7({},st,{ref:it}))});return rt.displayName=`Primitive.${tt}`,{...et,[tt]:rt}},{});function $b1b2314f5f9a1d84$export$25bec8c6f54ee79a(et){const tt=_$2(et);return p$5(()=>{tt.current=et}),F$2(()=>(...rt)=>{var nt;return(nt=tt.current)===null||nt===void 0?void 0:nt.call(tt,...rt)},[])}function $71cd76cc60e0454e$export$6f32135080cb4c3({prop:et,defaultProp:tt,onChange:rt=()=>{}}){const[nt,it]=$71cd76cc60e0454e$var$useUncontrolledState({defaultProp:tt,onChange:rt}),ot=et!==void 0,st=ot?et:nt,at=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(rt),ct=T$2(ut=>{if(ot){const lt=typeof ut=="function"?ut(et):ut;lt!==et&&at(lt)}else it(ut)},[ot,et,it,at]);return[st,ct]}function $71cd76cc60e0454e$var$useUncontrolledState({defaultProp:et,onChange:tt}){const rt=h$4(et),[nt]=rt,it=_$2(nt),ot=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(tt);return p$5(()=>{it.current!==nt&&(ot(nt),it.current=nt)},[nt,it,ot]),rt}const $f631663db3294ace$var$DirectionContext=G$2(void 0);function $f631663db3294ace$export$b39126d51d94e6f3(et){const tt=q$5($f631663db3294ace$var$DirectionContext);return et||tt||"ltr"}const $d7bdfb9eb0fdf311$var$ENTRY_FOCUS="rovingFocusGroup.onEntryFocus",$d7bdfb9eb0fdf311$var$EVENT_OPTIONS={bubbles:!1,cancelable:!0},$d7bdfb9eb0fdf311$var$GROUP_NAME="RovingFocusGroup",[$d7bdfb9eb0fdf311$var$Collection,$d7bdfb9eb0fdf311$var$useCollection,$d7bdfb9eb0fdf311$var$createCollectionScope]=$e02a7d9cb1dc128c$export$c74125a8e3af6bb2($d7bdfb9eb0fdf311$var$GROUP_NAME),[$d7bdfb9eb0fdf311$var$createRovingFocusGroupContext,$d7bdfb9eb0fdf311$export$c7109489551a4f4]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($d7bdfb9eb0fdf311$var$GROUP_NAME,[$d7bdfb9eb0fdf311$var$createCollectionScope]),[$d7bdfb9eb0fdf311$var$RovingFocusProvider,$d7bdfb9eb0fdf311$var$useRovingFocusContext]=$d7bdfb9eb0fdf311$var$createRovingFocusGroupContext($d7bdfb9eb0fdf311$var$GROUP_NAME),$d7bdfb9eb0fdf311$export$8699f7c8af148338=k$4((et,tt)=>y$4($d7bdfb9eb0fdf311$var$Collection.Provider,{scope:et.__scopeRovingFocusGroup},y$4($d7bdfb9eb0fdf311$var$Collection.Slot,{scope:et.__scopeRovingFocusGroup},y$4($d7bdfb9eb0fdf311$var$RovingFocusGroupImpl,_extends$7({},et,{ref:tt}))))),$d7bdfb9eb0fdf311$var$RovingFocusGroupImpl=k$4((et,tt)=>{const{__scopeRovingFocusGroup:rt,orientation:nt,loop:it=!1,dir:ot,currentTabStopId:st,defaultCurrentTabStopId:at,onCurrentTabStopIdChange:ct,onEntryFocus:ut,...lt}=et,ht=_$2(null),ft=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(tt,ht),dt=$f631663db3294ace$export$b39126d51d94e6f3(ot),[pt=null,gt]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:st,defaultProp:at,onChange:ct}),[_t,mt]=h$4(!1),At=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(ut),It=$d7bdfb9eb0fdf311$var$useCollection(rt),Mt=_$2(!1),[kt,Ct]=h$4(0);return p$5(()=>{const Ut=ht.current;if(Ut)return Ut.addEventListener($d7bdfb9eb0fdf311$var$ENTRY_FOCUS,At),()=>Ut.removeEventListener($d7bdfb9eb0fdf311$var$ENTRY_FOCUS,At)},[At]),y$4($d7bdfb9eb0fdf311$var$RovingFocusProvider,{scope:rt,orientation:nt,dir:dt,loop:it,currentTabStopId:pt,onItemFocus:T$2(Ut=>gt(Ut),[gt]),onItemShiftTab:T$2(()=>mt(!0),[]),onFocusableItemAdd:T$2(()=>Ct(Ut=>Ut+1),[]),onFocusableItemRemove:T$2(()=>Ct(Ut=>Ut-1),[])},y$4($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$7({tabIndex:_t||kt===0?-1:0,"data-orientation":nt},lt,{ref:ft,style:{outline:"none",...et.style},onMouseDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(et.onMouseDown,()=>{Mt.current=!0}),onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(et.onFocus,Ut=>{const Wt=!Mt.current;if(Ut.target===Ut.currentTarget&&Wt&&!_t){const Ft=new CustomEvent($d7bdfb9eb0fdf311$var$ENTRY_FOCUS,$d7bdfb9eb0fdf311$var$EVENT_OPTIONS);if(Ut.currentTarget.dispatchEvent(Ft),!Ft.defaultPrevented){const Ce=It().filter(Et=>Et.focusable),bt=Ce.find(Et=>Et.active),yt=Ce.find(Et=>Et.id===pt),$t=[bt,yt,...Ce].filter(Boolean).map(Et=>Et.ref.current);$d7bdfb9eb0fdf311$var$focusFirst($t)}}Mt.current=!1}),onBlur:$e42e1063c40fb3ef$export$b9ecd428b558ff10(et.onBlur,()=>mt(!1))})))}),$d7bdfb9eb0fdf311$var$ITEM_NAME="RovingFocusGroupItem",$d7bdfb9eb0fdf311$export$ab9df7c53fe8454=k$4((et,tt)=>{const{__scopeRovingFocusGroup:rt,focusable:nt=!0,active:it=!1,tabStopId:ot,...st}=et,at=$1746a345f3d73bb7$export$f680877a34711e37(),ct=ot||at,ut=$d7bdfb9eb0fdf311$var$useRovingFocusContext($d7bdfb9eb0fdf311$var$ITEM_NAME,rt),lt=ut.currentTabStopId===ct,ht=$d7bdfb9eb0fdf311$var$useCollection(rt),{onFocusableItemAdd:ft,onFocusableItemRemove:dt}=ut;return p$5(()=>{if(nt)return ft(),()=>dt()},[nt,ft,dt]),y$4($d7bdfb9eb0fdf311$var$Collection.ItemSlot,{scope:rt,id:ct,focusable:nt,active:it},y$4($8927f6f2acc4f386$export$250ffa63cdc0d034.span,_extends$7({tabIndex:lt?0:-1,"data-orientation":ut.orientation},st,{ref:tt,onMouseDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(et.onMouseDown,pt=>{nt?ut.onItemFocus(ct):pt.preventDefault()}),onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(et.onFocus,()=>ut.onItemFocus(ct)),onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(et.onKeyDown,pt=>{if(pt.key==="Tab"&&pt.shiftKey){ut.onItemShiftTab();return}if(pt.target!==pt.currentTarget)return;const gt=$d7bdfb9eb0fdf311$var$getFocusIntent(pt,ut.orientation,ut.dir);if(gt!==void 0){pt.preventDefault();let _t=ht().filter(mt=>mt.focusable).map(mt=>mt.ref.current);if(gt==="last")_t.reverse();else if(gt==="prev"||gt==="next"){gt==="prev"&&_t.reverse();const mt=_t.indexOf(pt.currentTarget);_t=ut.loop?$d7bdfb9eb0fdf311$var$wrapArray(_t,mt+1):_t.slice(mt+1)}setTimeout(()=>$d7bdfb9eb0fdf311$var$focusFirst(_t))}})})))}),$d7bdfb9eb0fdf311$var$MAP_KEY_TO_FOCUS_INTENT={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function $d7bdfb9eb0fdf311$var$getDirectionAwareKey(et,tt){return tt!=="rtl"?et:et==="ArrowLeft"?"ArrowRight":et==="ArrowRight"?"ArrowLeft":et}function $d7bdfb9eb0fdf311$var$getFocusIntent(et,tt,rt){const nt=$d7bdfb9eb0fdf311$var$getDirectionAwareKey(et.key,rt);if(!(tt==="vertical"&&["ArrowLeft","ArrowRight"].includes(nt))&&!(tt==="horizontal"&&["ArrowUp","ArrowDown"].includes(nt)))return $d7bdfb9eb0fdf311$var$MAP_KEY_TO_FOCUS_INTENT[nt]}function $d7bdfb9eb0fdf311$var$focusFirst(et){const tt=document.activeElement;for(const rt of et)if(rt===tt||(rt.focus(),document.activeElement!==tt))return}function $d7bdfb9eb0fdf311$var$wrapArray(et,tt){return et.map((rt,nt)=>et[(tt+nt)%et.length])}const $d7bdfb9eb0fdf311$export$be92b6f5f03c0fe9=$d7bdfb9eb0fdf311$export$8699f7c8af148338,$d7bdfb9eb0fdf311$export$6d08773d2e66f8f2=$d7bdfb9eb0fdf311$export$ab9df7c53fe8454;function $fe963b355347cc68$export$3e6543de14f8614f(et,tt){return s$2((rt,nt)=>tt[rt][nt]??rt,et)}const $921a889cee6df7e8$export$99c2b779aa4e8b8b=et=>{const{present:tt,children:rt}=et,nt=$921a889cee6df7e8$var$usePresence(tt),it=typeof rt=="function"?rt({present:nt.isPresent}):O.only(rt),ot=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(nt.ref,it.ref);return typeof rt=="function"||nt.isPresent?sn(it,{ref:ot}):null};$921a889cee6df7e8$export$99c2b779aa4e8b8b.displayName="Presence";function $921a889cee6df7e8$var$usePresence(et){const[tt,rt]=h$4(),nt=_$2({}),it=_$2(et),ot=_$2("none"),st=et?"mounted":"unmounted",[at,ct]=$fe963b355347cc68$export$3e6543de14f8614f(st,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return p$5(()=>{const ut=$921a889cee6df7e8$var$getAnimationName(nt.current);ot.current=at==="mounted"?ut:"none"},[at]),$9f79659886946c16$export$e5c5a5f917a5871c(()=>{const ut=nt.current,lt=it.current;if(lt!==et){const ht=ot.current,ft=$921a889cee6df7e8$var$getAnimationName(ut);et?ct("MOUNT"):ft==="none"||(ut==null?void 0:ut.display)==="none"?ct("UNMOUNT"):ct(lt&&ht!==ft?"ANIMATION_OUT":"UNMOUNT"),it.current=et}},[et,ct]),$9f79659886946c16$export$e5c5a5f917a5871c(()=>{if(tt){const ut=ht=>{const ft=$921a889cee6df7e8$var$getAnimationName(nt.current).includes(ht.animationName);ht.target===tt&&ft&&pn(()=>ct("ANIMATION_END"))},lt=ht=>{ht.target===tt&&(ot.current=$921a889cee6df7e8$var$getAnimationName(nt.current))};return tt.addEventListener("animationstart",lt),tt.addEventListener("animationcancel",ut),tt.addEventListener("animationend",ut),()=>{tt.removeEventListener("animationstart",lt),tt.removeEventListener("animationcancel",ut),tt.removeEventListener("animationend",ut)}}else ct("ANIMATION_END")},[tt,ct]),{isPresent:["mounted","unmountSuspended"].includes(at),ref:T$2(ut=>{ut&&(nt.current=getComputedStyle(ut)),rt(ut)},[])}}function $921a889cee6df7e8$var$getAnimationName(et){return(et==null?void 0:et.animationName)||"none"}const $69cb30bb0017df05$var$TABS_NAME="Tabs",[$69cb30bb0017df05$var$createTabsContext,$69cb30bb0017df05$export$355f5bd209d7b13a]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($69cb30bb0017df05$var$TABS_NAME,[$d7bdfb9eb0fdf311$export$c7109489551a4f4]),$69cb30bb0017df05$var$useRovingFocusGroupScope=$d7bdfb9eb0fdf311$export$c7109489551a4f4(),[$69cb30bb0017df05$var$TabsProvider,$69cb30bb0017df05$var$useTabsContext]=$69cb30bb0017df05$var$createTabsContext($69cb30bb0017df05$var$TABS_NAME),$69cb30bb0017df05$export$b2539bed5023c21c=k$4((et,tt)=>{const{__scopeTabs:rt,value:nt,onValueChange:it,defaultValue:ot,orientation:st="horizontal",dir:at,activationMode:ct="automatic",...ut}=et,lt=$f631663db3294ace$export$b39126d51d94e6f3(at),[ht,ft]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:nt,onChange:it,defaultProp:ot});return y$4($69cb30bb0017df05$var$TabsProvider,{scope:rt,baseId:$1746a345f3d73bb7$export$f680877a34711e37(),value:ht,onValueChange:ft,orientation:st,dir:lt,activationMode:ct},y$4($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$7({dir:lt,"data-orientation":st},ut,{ref:tt})))}),$69cb30bb0017df05$var$TAB_LIST_NAME="TabsList",$69cb30bb0017df05$export$9712d22edc0d78c1=k$4((et,tt)=>{const{__scopeTabs:rt,loop:nt=!0,...it}=et,ot=$69cb30bb0017df05$var$useTabsContext($69cb30bb0017df05$var$TAB_LIST_NAME,rt),st=$69cb30bb0017df05$var$useRovingFocusGroupScope(rt);return y$4($d7bdfb9eb0fdf311$export$be92b6f5f03c0fe9,_extends$7({asChild:!0},st,{orientation:ot.orientation,dir:ot.dir,loop:nt}),y$4($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$7({role:"tablist","aria-orientation":ot.orientation},it,{ref:tt})))}),$69cb30bb0017df05$var$TRIGGER_NAME="TabsTrigger",$69cb30bb0017df05$export$8114b9fdfdf9f3ba=k$4((et,tt)=>{const{__scopeTabs:rt,value:nt,disabled:it=!1,...ot}=et,st=$69cb30bb0017df05$var$useTabsContext($69cb30bb0017df05$var$TRIGGER_NAME,rt),at=$69cb30bb0017df05$var$useRovingFocusGroupScope(rt),ct=$69cb30bb0017df05$var$makeTriggerId(st.baseId,nt),ut=$69cb30bb0017df05$var$makeContentId(st.baseId,nt),lt=nt===st.value;return y$4($d7bdfb9eb0fdf311$export$6d08773d2e66f8f2,_extends$7({asChild:!0},at,{focusable:!it,active:lt}),y$4($8927f6f2acc4f386$export$250ffa63cdc0d034.button,_extends$7({type:"button",role:"tab","aria-selected":lt,"aria-controls":ut,"data-state":lt?"active":"inactive","data-disabled":it?"":void 0,disabled:it,id:ct},ot,{ref:tt,onMouseDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(et.onMouseDown,ht=>{!it&&ht.button===0&&ht.ctrlKey===!1?st.onValueChange(nt):ht.preventDefault()}),onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(et.onKeyDown,ht=>{[" ","Enter"].includes(ht.key)&&st.onValueChange(nt)}),onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(et.onFocus,()=>{const ht=st.activationMode!=="manual";!lt&&!it&&ht&&st.onValueChange(nt)})})))}),$69cb30bb0017df05$var$CONTENT_NAME="TabsContent",$69cb30bb0017df05$export$bd905d70e8fd2ebb=k$4((et,tt)=>{const{__scopeTabs:rt,value:nt,forceMount:it,children:ot,...st}=et,at=$69cb30bb0017df05$var$useTabsContext($69cb30bb0017df05$var$CONTENT_NAME,rt),ct=$69cb30bb0017df05$var$makeTriggerId(at.baseId,nt),ut=$69cb30bb0017df05$var$makeContentId(at.baseId,nt),lt=nt===at.value,ht=_$2(lt);return p$5(()=>{const ft=requestAnimationFrame(()=>ht.current=!1);return()=>cancelAnimationFrame(ft)},[]),y$4($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:it||lt},({present:ft})=>y$4($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$7({"data-state":lt?"active":"inactive","data-orientation":at.orientation,role:"tabpanel","aria-labelledby":ct,hidden:!ft,id:ut,tabIndex:0},st,{ref:tt,style:{...et.style,animationDuration:ht.current?"0s":void 0}}),ft&&ot))});function $69cb30bb0017df05$var$makeTriggerId(et,tt){return`${et}-trigger-${tt}`}function $69cb30bb0017df05$var$makeContentId(et,tt){return`${et}-content-${tt}`}const $69cb30bb0017df05$export$be92b6f5f03c0fe9=$69cb30bb0017df05$export$b2539bed5023c21c,$69cb30bb0017df05$export$54c2e3dc7acea9f5=$69cb30bb0017df05$export$9712d22edc0d78c1,$69cb30bb0017df05$export$41fb9f06171c75f4=$69cb30bb0017df05$export$8114b9fdfdf9f3ba,$69cb30bb0017df05$export$7c6e2c02157bb7d2=$69cb30bb0017df05$export$bd905d70e8fd2ebb,require$$0$1=getAugmentedNamespace(preact_module);var preact$6=require$$0$1,_extends$6=Object.assign||function(et){for(var tt=1;tt<arguments.length;tt++){var rt=arguments[tt];for(var nt in rt)Object.prototype.hasOwnProperty.call(rt,nt)&&(et[nt]=rt[nt])}return et},objectWithoutProperties$6=function(et,tt){var rt={};for(var nt in et)tt.indexOf(nt)>=0||Object.prototype.hasOwnProperty.call(et,nt)&&(rt[nt]=et[nt]);return rt},ChatProcessingIcon=function et(tt){var rt=tt.color,nt=rt===void 0?"currentColor":rt,it=tt.size,ot=it===void 0?24:it;tt.children;var st=objectWithoutProperties$6(tt,["color","size","children"]),at="mdi-icon "+(st.class||st.className||"");return preact$6.h("svg",_extends$6({},st,{class:at,width:ot,height:ot,fill:nt,viewBox:"0 0 24 24"}),preact$6.h("path",{d:"M12,3C17.5,3 22,6.58 22,11C22,15.42 17.5,19 12,19C10.76,19 9.57,18.82 8.47,18.5C5.55,21 2,21 2,21C4.33,18.67 4.7,17.1 4.75,16.5C3.05,15.07 2,13.13 2,11C2,6.58 6.5,3 12,3M17,12V10H15V12H17M13,12V10H11V12H13M9,12V10H7V12H9Z"}))},ChatProcessingIcon_1=ChatProcessingIcon;const ChatProcessing=getDefaultExportFromCjs(ChatProcessingIcon_1);var preact$5=require$$0$1,_extends$5=Object.assign||function(et){for(var tt=1;tt<arguments.length;tt++){var rt=arguments[tt];for(var nt in rt)Object.prototype.hasOwnProperty.call(rt,nt)&&(et[nt]=rt[nt])}return et},objectWithoutProperties$5=function(et,tt){var rt={};for(var nt in et)tt.indexOf(nt)>=0||Object.prototype.hasOwnProperty.call(et,nt)&&(rt[nt]=et[nt]);return rt},DownloadIcon=function et(tt){var rt=tt.color,nt=rt===void 0?"currentColor":rt,it=tt.size,ot=it===void 0?24:it;tt.children;var st=objectWithoutProperties$5(tt,["color","size","children"]),at="mdi-icon "+(st.class||st.className||"");return preact$5.h("svg",_extends$5({},st,{class:at,width:ot,height:ot,fill:nt,viewBox:"0 0 24 24"}),preact$5.h("path",{d:"M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z"}))},DownloadIcon_1=DownloadIcon;const Download=getDefaultExportFromCjs(DownloadIcon_1),createStoreImpl=et=>{let tt;const rt=new Set,nt=(st,at)=>{const ct=typeof st=="function"?st(tt):st;if(!Object.is(ct,tt)){const ut=tt;tt=at??typeof ct!="object"?ct:Object.assign({},tt,ct),rt.forEach(lt=>lt(tt,ut))}},it=()=>tt,ot={setState:nt,getState:it,subscribe:st=>(rt.add(st),()=>rt.delete(st)),destroy:()=>{({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&"production")!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),rt.clear()}};return tt=et(nt,it,ot),ot},createStore=et=>et?createStoreImpl(et):createStoreImpl;var withSelector={exports:{}},withSelector_production_min={};const require$$0=getAugmentedNamespace(compat_module);var shim={exports:{}},useSyncExternalStoreShim_production_min={},e$1=require$$0;function h$3(et,tt){return et===tt&&(et!==0||1/et===1/tt)||et!==et&&tt!==tt}var k$3=typeof Object.is=="function"?Object.is:h$3,l$1=e$1.useState,m$3=e$1.useEffect,n$2=e$1.useLayoutEffect,p$3=e$1.useDebugValue;function q$3(et,tt){var rt=tt(),nt=l$1({inst:{value:rt,getSnapshot:tt}}),it=nt[0].inst,ot=nt[1];return n$2(function(){it.value=rt,it.getSnapshot=tt,r$2(it)&&ot({inst:it})},[et,rt,tt]),m$3(function(){return r$2(it)&&ot({inst:it}),et(function(){r$2(it)&&ot({inst:it})})},[et]),p$3(rt),rt}function r$2(et){var tt=et.getSnapshot;et=et.value;try{var rt=tt();return!k$3(et,rt)}catch{return!0}}function t$3(et,tt){return tt()}var u$2=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?t$3:q$3;useSyncExternalStoreShim_production_min.useSyncExternalStore=e$1.useSyncExternalStore!==void 0?e$1.useSyncExternalStore:u$2,shim.exports=useSyncExternalStoreShim_production_min;var shimExports=shim.exports,h$2=require$$0,n$1=shimExports;function p$2(et,tt){return et===tt&&(et!==0||1/et===1/tt)||et!==et&&tt!==tt}var q$2=typeof Object.is=="function"?Object.is:p$2,r$1=n$1.useSyncExternalStore,t$2=h$2.useRef,u$1=h$2.useEffect,v$3=h$2.useMemo,w$3=h$2.useDebugValue;withSelector_production_min.useSyncExternalStoreWithSelector=function(et,tt,rt,nt,it){var ot=t$2(null);if(ot.current===null){var st={hasValue:!1,value:null};ot.current=st}else st=ot.current;ot=v$3(function(){function ct(dt){if(!ut){if(ut=!0,lt=dt,dt=nt(dt),it!==void 0&&st.hasValue){var pt=st.value;if(it(pt,dt))return ht=pt}return ht=dt}if(pt=ht,q$2(lt,dt))return pt;var gt=nt(dt);return it!==void 0&&it(pt,gt)?pt:(lt=dt,ht=gt)}var ut=!1,lt,ht,ft=rt===void 0?null:rt;return[function(){return ct(tt())},ft===null?void 0:function(){return ct(ft())}]},[tt,rt,nt,it]);var at=r$1(et,ot[0],ot[1]);return u$1(function(){st.hasValue=!0,st.value=at},[at]),w$3(at),at},withSelector.exports=withSelector_production_min;var withSelectorExports=withSelector.exports;const useSyncExternalStoreExports=getDefaultExportFromCjs(withSelectorExports),{useSyncExternalStoreWithSelector}=useSyncExternalStoreExports;function useStore(et,tt=et.getState,rt){const nt=useSyncExternalStoreWithSelector(et.subscribe,et.getState,et.getServerState||et.getState,tt,rt);return x$4(nt),nt}const createImpl=et=>{({BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1}&&"production")!=="production"&&typeof et!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const tt=typeof et=="function"?createStore(et):et,rt=(nt,it)=>useStore(tt,nt,it);return Object.assign(rt,tt),rt},create$1=et=>et?createImpl(et):createImpl,useMessageStore=create$1(et=>({messages:[],addMessage:tt=>et(rt=>({messages:[...rt.messages,tt]})),deleteMessagesBefore:(tt,rt)=>et(nt=>({messages:nt.messages.filter(it=>it.roomId!==tt&&it.recievedAt>rt)}))})),useClientSideUserTraits=create$1((et,tt)=>({mutedUsers:{},toggleMute:rt=>et(nt=>({mutedUsers:{...nt.mutedUsers,[rt]:!nt.mutedUsers[rt]}})),addUser:rt=>et(nt=>({mutedUsers:{...nt.mutedUsers,[rt]:!1}})),removeUser:rt=>et(nt=>{const{[rt]:it,...ot}=nt.mutedUsers;return{mutedUsers:ot}}),typingUsers:[],addTypingUser:rt=>{tt().typingUsers.includes(rt)||et(nt=>({typingUsers:[...nt.typingUsers,rt]}))},removeTypingUser:rt=>et(nt=>({typingUsers:nt.typingUsers.filter(it=>it!==rt)}))})),useUserStore=create$1(et=>({users:[],addUser:tt=>et(rt=>({users:[...rt.users,tt]})),updateUser:(tt,rt)=>et(nt=>({users:nt.users.map(it=>it.id===tt?{...it,...rt}:it)})),deleteUser:tt=>et(rt=>({users:rt.users.filter(nt=>nt.id!==tt)}))}));class ChatManager{constructor({room:tt,roomId:rt}){xr(this,"sendChatAction");xr(this,"sendTyping");xr(this,"roomId");xr(this,"sendChat",async tt=>{if(tt.trim()===""||this.roomId.trim()==="")return;const rt={sentBy:selfId,id:shortid$1.generate(),text:tt,sentAt:Date.now(),recievedAt:Date.now(),roomId:this.roomId},nt=JSON.stringify(rt),it=useUserStore.getState().users.filter(ot=>ot.roomId===this.roomId&&ot.active).map(ot=>ot.id);await this.sendChatAction(nt,it),useMessageStore.getState().addMessage(rt)});xr(this,"sendTypingIndicator",tt=>{this.sendTyping(tt)});const[nt,it]=tt.makeAction("chat"),[ot,st]=tt.makeAction("isTyping");this.sendChatAction=nt,this.sendTyping=ot,this.roomId=rt,it(async(at,ct)=>{const ut=JSON.parse(at);if(ut&&ut.text.trim()!==""&&useClientSideUserTraits.getState().mutedUsers[ct]!==!0){const lt={id:ut.id,text:ut.text,sentAt:ut.sentAt,sentBy:ct,recievedAt:Date.now(),roomId:ut.roomId};useMessageStore.getState().addMessage(lt)}}),st((at,ct)=>{at===!0?useClientSideUserTraits.getState().addTypingUser(ct):useClientSideUserTraits.getState().removeTypingUser(ct)})}}const fancyBytes=et=>{const tt=Math.floor(et/1e6);return tt<1?`${Math.floor(et/1e3)}Kb`:`${tt}Mb`},isRtcSupported=()=>{const et=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,tt=!!(et&&et.prototype&&et.prototype.createDataChannel);return!!et&&tt},sendSystemMessage=(et,tt)=>useMessageStore.getState().addMessage({id:shortid$1.generate(),text:tt,sentAt:new Date().getTime(),roomId:et,sentBy:"system",recievedAt:new Date().getTime()}),generateHexColorFromString=et=>{let tt=0;for(let nt=0;nt<et.length;nt++)tt=et.charCodeAt(nt)+((tt<<5)-tt);let rt=(tt&16777215).toString(16);return rt="00000".substring(0,6-rt.length)+rt,"#"+rt},useProgressStore=create$1(et=>({progressQueue:[],addProgress:tt=>et(rt=>({progressQueue:[...rt.progressQueue,tt]})),deleteProgress:tt=>et(rt=>({progressQueue:rt.progressQueue.filter(nt=>nt.id!==tt)})),updateProgress:(tt,rt)=>et(nt=>({progressQueue:nt.progressQueue.map(it=>it.id===tt?{...it,...rt}:it)}))})),useRealFiles=create$1(et=>({realFiles:{},addRealFiles:tt=>et(rt=>({realFiles:{...rt.realFiles,...Array.from(tt).reduce((nt,it)=>(nt[shortid$1.generate()]=it,nt),{})}})),deleteRealFile:tt=>et(rt=>{const{[tt]:nt,...it}=rt.realFiles;return{realFiles:it}})})),useOfferStore=create$1(et=>({requestableDownloads:{},updateOrAddRequestable:(tt,rt)=>et(nt=>({requestableDownloads:{...nt.requestableDownloads,[tt]:rt}})),removeRequestablesForId:tt=>et(rt=>({requestableDownloads:(()=>{const nt=rt.requestableDownloads;return tt in nt&&delete nt[tt],nt})()}))}));class DownloadManager{constructor({room:tt,roomId:rt}){xr(this,"sendFileRequest");xr(this,"sendFileOffer");xr(this,"requestFile",async(tt,rt)=>{const nt=useOfferStore.getState().requestableDownloads[tt],it=nt&&nt.find(ot=>ot.id===rt);it?(useProgressStore.getState().addProgress({id:it.id,name:it.name,progress:0,toMe:!0}),this.sendFileRequest(rt,tt)):alert("file not found!")});xr(this,"offerRequestableFiles",async()=>{const tt=useRealFiles.getState().realFiles;if(!tt)return;const rt=Object.entries(tt).map(([it,ot])=>({id:it,ownerId:selfId,name:ot.name,size:ot.size})),nt=useUserStore.getState().users.map(it=>it.id);this.sendFileOffer(rt,nt).catch(it=>console.error(it))});xr(this,"removeRealFile",tt=>{useProgressStore.getState().deleteProgress(tt),useRealFiles.getState().deleteRealFile(tt)});xr(this,"addRealFiles",tt=>{useRealFiles.getState().addRealFiles(tt),this.offerRequestableFiles()});const[nt,it,ot]=tt.makeAction("transfer"),[st,at]=tt.makeAction("fileRequest"),[ct,ut]=tt.makeAction("fileOffer");this.sendFileRequest=st,this.sendFileOffer=ct,ot((lt,ht,ft)=>{const dt=ft;useProgressStore.getState().updateProgress(dt.id,{progress:lt})}),at((lt,ht)=>{const ft=useRealFiles.getState().realFiles;if(ft&&lt in ft){const dt=ft[lt];useProgressStore.getState().addProgress({id:lt,name:dt.name,progress:0,toMe:!1}),nt(dt,ht,{id:lt,name:dt.name,size:dt.size},(pt,gt)=>useProgressStore.getState().updateProgress(lt,{progress:pt}))}}),it((lt,ht,ft)=>{const dt=ft;console.log(useProgressStore.getState().progressQueue),console.log(dt),useProgressStore.getState().deleteProgress(dt.id)}),ut(async(lt,ht)=>{useClientSideUserTraits.getState().mutedUsers[ht]!==!0&&(useOfferStore.getState().updateOrAddRequestable(ht,lt),sendSystemMessage(rt,`${ht} offered you files`))})}}const __vite__wasmUrl="./assets/pqc_kyber_bg-9d6c3d25.wasm",__vite__initWasm=async(et={},tt)=>{let rt;if(tt.startsWith("data:")){const nt=tt.replace(/^data:.*?base64,/,"");let it;if(typeof Buffer=="function"&&typeof Buffer.from=="function")it=Buffer.from(nt,"base64");else if(typeof atob=="function"){const ot=atob(nt);it=new Uint8Array(ot.length);for(let st=0;st<ot.length;st++)it[st]=ot.charCodeAt(st)}else throw new Error("Cannot decode base64-encoded data URL");rt=await WebAssembly.instantiate(it,et)}else{const nt=await fetch(tt),it=nt.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&it.startsWith("application/wasm"))rt=await WebAssembly.instantiateStreaming(nt,et);else{const ot=await nt.arrayBuffer();rt=await WebAssembly.instantiate(ot,et)}}return rt.instance.exports};let wasm$1;function __wbg_set_wasm(et){wasm$1=et}const heap=new Array(128).fill(void 0);heap.push(void 0,null,!0,!1);function getObject(et){return heap[et]}let heap_next=heap.length;function dropObject(et){et<132||(heap[et]=heap_next,heap_next=et)}function takeObject(et){const tt=getObject(et);return dropObject(et),tt}const lTextDecoder=typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder;let cachedTextDecoder=new lTextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});cachedTextDecoder.decode();let cachedUint8Memory0=null;function getUint8Memory0(){return(cachedUint8Memory0===null||cachedUint8Memory0.byteLength===0)&&(cachedUint8Memory0=new Uint8Array(wasm$1.memory.buffer)),cachedUint8Memory0}function getStringFromWasm0(et,tt){return cachedTextDecoder.decode(getUint8Memory0().subarray(et,et+tt))}function addHeapObject(et){heap_next===heap.length&&heap.push(heap.length+1);const tt=heap_next;return heap_next=heap[tt],heap[tt]=et,tt}function debugString(et){const tt=typeof et;if(tt=="number"||tt=="boolean"||et==null)return`${et}`;if(tt=="string")return`"${et}"`;if(tt=="symbol"){const it=et.description;return it==null?"Symbol":`Symbol(${it})`}if(tt=="function"){const it=et.name;return typeof it=="string"&&it.length>0?`Function(${it})`:"Function"}if(Array.isArray(et)){const it=et.length;let ot="[";it>0&&(ot+=debugString(et[0]));for(let st=1;st<it;st++)ot+=", "+debugString(et[st]);return ot+="]",ot}const rt=/\[object ([^\]]+)\]/.exec(toString.call(et));let nt;if(rt.length>1)nt=rt[1];else return toString.call(et);if(nt=="Object")try{return"Object("+JSON.stringify(et)+")"}catch{return"Object"}return et instanceof Error?`${et.name}: ${et.message}
${et.stack}`:nt}let WASM_VECTOR_LEN=0;const lTextEncoder=typeof TextEncoder>"u"?(0,module.require)("util").TextEncoder:TextEncoder;let cachedTextEncoder=new lTextEncoder("utf-8");const encodeString=typeof cachedTextEncoder.encodeInto=="function"?function(et,tt){return cachedTextEncoder.encodeInto(et,tt)}:function(et,tt){const rt=cachedTextEncoder.encode(et);return tt.set(rt),{read:et.length,written:rt.length}};function passStringToWasm0(et,tt,rt){if(rt===void 0){const at=cachedTextEncoder.encode(et),ct=tt(at.length);return getUint8Memory0().subarray(ct,ct+at.length).set(at),WASM_VECTOR_LEN=at.length,ct}let nt=et.length,it=tt(nt);const ot=getUint8Memory0();let st=0;for(;st<nt;st++){const at=et.charCodeAt(st);if(at>127)break;ot[it+st]=at}if(st!==nt){st!==0&&(et=et.slice(st)),it=rt(it,nt,nt=st+et.length*3);const at=getUint8Memory0().subarray(it+st,it+nt),ct=encodeString(et,at);st+=ct.written}return WASM_VECTOR_LEN=st,it}let cachedInt32Memory0=null;function getInt32Memory0(){return(cachedInt32Memory0===null||cachedInt32Memory0.byteLength===0)&&(cachedInt32Memory0=new Int32Array(wasm$1.memory.buffer)),cachedInt32Memory0}function keypair$1(){const et=wasm$1.keypair();return Keys.__wrap(et)}function passArray8ToWasm0(et,tt){const rt=tt(et.length*1);return getUint8Memory0().set(et,rt/1),WASM_VECTOR_LEN=et.length,rt}function encapsulate$1(et){try{const it=wasm$1.__wbindgen_add_to_stack_pointer(-16),ot=passArray8ToWasm0(et,wasm$1.__wbindgen_malloc),st=WASM_VECTOR_LEN;wasm$1.encapsulate(it,ot,st);var tt=getInt32Memory0()[it/4+0],rt=getInt32Memory0()[it/4+1],nt=getInt32Memory0()[it/4+2];if(nt)throw takeObject(rt);return Kex.__wrap(tt)}finally{wasm$1.__wbindgen_add_to_stack_pointer(16)}}function getArrayU8FromWasm0(et,tt){return getUint8Memory0().subarray(et/1,et/1+tt)}function decapsulate$1(et,tt){try{const at=wasm$1.__wbindgen_add_to_stack_pointer(-16),ct=passArray8ToWasm0(et,wasm$1.__wbindgen_malloc),ut=WASM_VECTOR_LEN,lt=passArray8ToWasm0(tt,wasm$1.__wbindgen_malloc),ht=WASM_VECTOR_LEN;wasm$1.decapsulate(at,ct,ut,lt,ht);var rt=getInt32Memory0()[at/4+0],nt=getInt32Memory0()[at/4+1],it=getInt32Memory0()[at/4+2],ot=getInt32Memory0()[at/4+3];if(ot)throw takeObject(it);var st=getArrayU8FromWasm0(rt,nt).slice();return wasm$1.__wbindgen_free(rt,nt*1),st}finally{wasm$1.__wbindgen_add_to_stack_pointer(16)}}function handleError(et,tt){try{return et.apply(this,tt)}catch(rt){wasm$1.__wbindgen_exn_store(addHeapObject(rt))}}class Kex{static __wrap(tt){const rt=Object.create(Kex.prototype);return rt.ptr=tt,rt}__destroy_into_raw(){const tt=this.ptr;return this.ptr=0,tt}free(){const tt=this.__destroy_into_raw();wasm$1.__wbg_kex_free(tt)}constructor(tt){const rt=passArray8ToWasm0(tt,wasm$1.__wbindgen_malloc),nt=WASM_VECTOR_LEN,it=wasm$1.kex_new(rt,nt);return Kex.__wrap(it)}get ciphertext(){try{const it=wasm$1.__wbindgen_add_to_stack_pointer(-16);wasm$1.kex_ciphertext(it,this.ptr);var tt=getInt32Memory0()[it/4+0],rt=getInt32Memory0()[it/4+1],nt=getArrayU8FromWasm0(tt,rt).slice();return wasm$1.__wbindgen_free(tt,rt*1),nt}finally{wasm$1.__wbindgen_add_to_stack_pointer(16)}}get sharedSecret(){try{const it=wasm$1.__wbindgen_add_to_stack_pointer(-16);wasm$1.kex_sharedSecret(it,this.ptr);var tt=getInt32Memory0()[it/4+0],rt=getInt32Memory0()[it/4+1],nt=getArrayU8FromWasm0(tt,rt).slice();return wasm$1.__wbindgen_free(tt,rt*1),nt}finally{wasm$1.__wbindgen_add_to_stack_pointer(16)}}set ciphertext(tt){const rt=passArray8ToWasm0(tt,wasm$1.__wbindgen_malloc),nt=WASM_VECTOR_LEN;wasm$1.kex_set_ciphertext(this.ptr,rt,nt)}set sharedSecret(tt){const rt=passArray8ToWasm0(tt,wasm$1.__wbindgen_malloc),nt=WASM_VECTOR_LEN;wasm$1.kex_set_sharedSecret(this.ptr,rt,nt)}}class Keys{static __wrap(tt){const rt=Object.create(Keys.prototype);return rt.ptr=tt,rt}__destroy_into_raw(){const tt=this.ptr;return this.ptr=0,tt}free(){const tt=this.__destroy_into_raw();wasm$1.__wbg_keys_free(tt)}constructor(){const tt=wasm$1.keypair();return Keys.__wrap(tt)}get pubkey(){try{const it=wasm$1.__wbindgen_add_to_stack_pointer(-16);wasm$1.kex_ciphertext(it,this.ptr);var tt=getInt32Memory0()[it/4+0],rt=getInt32Memory0()[it/4+1],nt=getArrayU8FromWasm0(tt,rt).slice();return wasm$1.__wbindgen_free(tt,rt*1),nt}finally{wasm$1.__wbindgen_add_to_stack_pointer(16)}}get secret(){try{const it=wasm$1.__wbindgen_add_to_stack_pointer(-16);wasm$1.kex_sharedSecret(it,this.ptr);var tt=getInt32Memory0()[it/4+0],rt=getInt32Memory0()[it/4+1],nt=getArrayU8FromWasm0(tt,rt).slice();return wasm$1.__wbindgen_free(tt,rt*1),nt}finally{wasm$1.__wbindgen_add_to_stack_pointer(16)}}}function __wbindgen_object_drop_ref(et){takeObject(et)}function __wbg_crypto_70a96de3b6b73dac(et){const tt=getObject(et).crypto;return addHeapObject(tt)}function __wbindgen_is_object(et){const tt=getObject(et);return typeof tt=="object"&&tt!==null}function __wbg_process_dd1577445152112e(et){const tt=getObject(et).process;return addHeapObject(tt)}function __wbg_versions_58036bec3add9e6f(et){const tt=getObject(et).versions;return addHeapObject(tt)}function __wbg_node_6a9d28205ed5b0d8(et){const tt=getObject(et).node;return addHeapObject(tt)}function __wbindgen_is_string(et){return typeof getObject(et)=="string"}function __wbg_msCrypto_adbc770ec9eca9c7(et){const tt=getObject(et).msCrypto;return addHeapObject(tt)}function __wbg_require_f05d779769764e82(){return handleError(function(){const et=module.require;return addHeapObject(et)},arguments)}function __wbindgen_is_function(et){return typeof getObject(et)=="function"}function __wbindgen_string_new(et,tt){const rt=getStringFromWasm0(et,tt);return addHeapObject(rt)}function __wbg_getRandomValues_3774744e221a22ad(){return handleError(function(et,tt){getObject(et).getRandomValues(getObject(tt))},arguments)}function __wbg_randomFillSync_e950366c42764a07(){return handleError(function(et,tt){getObject(et).randomFillSync(takeObject(tt))},arguments)}function __wbg_newnoargs_2b8b6bd7753c76ba(et,tt){const rt=new Function(getStringFromWasm0(et,tt));return addHeapObject(rt)}function __wbg_call_95d1ea488d03e4e8(){return handleError(function(et,tt){const rt=getObject(et).call(getObject(tt));return addHeapObject(rt)},arguments)}function __wbindgen_object_clone_ref(et){const tt=getObject(et);return addHeapObject(tt)}function __wbg_self_e7c1f827057f6584(){return handleError(function(){const et=self.self;return addHeapObject(et)},arguments)}function __wbg_window_a09ec664e14b1b81(){return handleError(function(){const et=window.window;return addHeapObject(et)},arguments)}function __wbg_globalThis_87cbb8506fecf3a9(){return handleError(function(){const et=globalThis.globalThis;return addHeapObject(et)},arguments)}function __wbg_global_c85a9259e621f3db(){return handleError(function(){const et=window.global;return addHeapObject(et)},arguments)}function __wbindgen_is_undefined(et){return getObject(et)===void 0}function __wbg_call_9495de66fdbe016b(){return handleError(function(et,tt,rt){const nt=getObject(et).call(getObject(tt),getObject(rt));return addHeapObject(nt)},arguments)}function __wbg_buffer_cf65c07de34b9a08(et){const tt=getObject(et).buffer;return addHeapObject(tt)}function __wbg_newwithbyteoffsetandlength_9fb2f11355ecadf5(et,tt,rt){const nt=new Uint8Array(getObject(et),tt>>>0,rt>>>0);return addHeapObject(nt)}function __wbg_new_537b7341ce90bb31(et){const tt=new Uint8Array(getObject(et));return addHeapObject(tt)}function __wbg_set_17499e8aa4003ebd(et,tt,rt){getObject(et).set(getObject(tt),rt>>>0)}function __wbg_newwithlength_b56c882b57805732(et){const tt=new Uint8Array(et>>>0);return addHeapObject(tt)}function __wbg_subarray_7526649b91a252a6(et,tt,rt){const nt=getObject(et).subarray(tt>>>0,rt>>>0);return addHeapObject(nt)}function __wbindgen_debug_string(et,tt){const rt=debugString(getObject(tt)),nt=passStringToWasm0(rt,wasm$1.__wbindgen_malloc,wasm$1.__wbindgen_realloc),it=WASM_VECTOR_LEN;getInt32Memory0()[et/4+1]=it,getInt32Memory0()[et/4+0]=nt}function __wbindgen_throw(et,tt){throw new Error(getStringFromWasm0(et,tt))}function __wbindgen_memory(){const et=wasm$1.memory;return addHeapObject(et)}URL=globalThis.URL;const __vite__wasmModule=await __vite__initWasm({"./pqc_kyber_bg.js":{__wbindgen_object_drop_ref,__wbg_crypto_70a96de3b6b73dac,__wbindgen_is_object,__wbg_process_dd1577445152112e,__wbg_versions_58036bec3add9e6f,__wbg_node_6a9d28205ed5b0d8,__wbindgen_is_string,__wbg_msCrypto_adbc770ec9eca9c7,__wbg_require_f05d779769764e82,__wbindgen_is_function,__wbindgen_string_new,__wbg_getRandomValues_3774744e221a22ad,__wbg_randomFillSync_e950366c42764a07,__wbg_newnoargs_2b8b6bd7753c76ba,__wbg_call_95d1ea488d03e4e8,__wbindgen_object_clone_ref,__wbg_self_e7c1f827057f6584,__wbg_window_a09ec664e14b1b81,__wbg_globalThis_87cbb8506fecf3a9,__wbg_global_c85a9259e621f3db,__wbindgen_is_undefined,__wbg_call_9495de66fdbe016b,__wbg_buffer_cf65c07de34b9a08,__wbg_newwithbyteoffsetandlength_9fb2f11355ecadf5,__wbg_new_537b7341ce90bb31,__wbg_set_17499e8aa4003ebd,__wbg_newwithlength_b56c882b57805732,__wbg_subarray_7526649b91a252a6,__wbindgen_debug_string,__wbindgen_throw,__wbindgen_memory}},__vite__wasmUrl),memory=__vite__wasmModule.memory,keypair=__vite__wasmModule.keypair,encapsulate=__vite__wasmModule.encapsulate,decapsulate=__vite__wasmModule.decapsulate,__wbg_kex_free=__vite__wasmModule.__wbg_kex_free,kex_new=__vite__wasmModule.kex_new,kex_ciphertext=__vite__wasmModule.kex_ciphertext,kex_sharedSecret=__vite__wasmModule.kex_sharedSecret,kex_set_ciphertext=__vite__wasmModule.kex_set_ciphertext,kex_set_sharedSecret=__vite__wasmModule.kex_set_sharedSecret,__wbg_params_free=__vite__wasmModule.__wbg_params_free,__wbg_get_params_publicKeyBytes=__vite__wasmModule.__wbg_get_params_publicKeyBytes,__wbg_get_params_secretKeyBytes=__vite__wasmModule.__wbg_get_params_secretKeyBytes,__wbg_get_params_ciphertextBytes=__vite__wasmModule.__wbg_get_params_ciphertextBytes,__wbg_get_params_sharedSecretBytes=__vite__wasmModule.__wbg_get_params_sharedSecretBytes,keys_pubkey=__vite__wasmModule.keys_pubkey,keys_secret=__vite__wasmModule.keys_secret,__wbg_keys_free=__vite__wasmModule.__wbg_keys_free,keys_new=__vite__wasmModule.keys_new,params_publicKeyBytes=__vite__wasmModule.params_publicKeyBytes,params_secretKeyBytes=__vite__wasmModule.params_secretKeyBytes,params_ciphertextBytes=__vite__wasmModule.params_ciphertextBytes,params_sharedSecretBytes=__vite__wasmModule.params_sharedSecretBytes,__wbindgen_malloc=__vite__wasmModule.__wbindgen_malloc,__wbindgen_realloc=__vite__wasmModule.__wbindgen_realloc,__wbindgen_add_to_stack_pointer=__vite__wasmModule.__wbindgen_add_to_stack_pointer,__wbindgen_free=__vite__wasmModule.__wbindgen_free,__wbindgen_exn_store=__vite__wasmModule.__wbindgen_exn_store,wasm=Object.freeze(Object.defineProperty({__proto__:null,__wbg_get_params_ciphertextBytes,__wbg_get_params_publicKeyBytes,__wbg_get_params_secretKeyBytes,__wbg_get_params_sharedSecretBytes,__wbg_kex_free,__wbg_keys_free,__wbg_params_free,__wbindgen_add_to_stack_pointer,__wbindgen_exn_store,__wbindgen_free,__wbindgen_malloc,__wbindgen_realloc,decapsulate,encapsulate,kex_ciphertext,kex_new,kex_set_ciphertext,kex_set_sharedSecret,kex_sharedSecret,keypair,keys_new,keys_pubkey,keys_secret,memory,params_ciphertextBytes,params_publicKeyBytes,params_secretKeyBytes,params_sharedSecretBytes},Symbol.toStringTag,{value:"Module"}));__wbg_set_wasm(wasm);const generateKeyPair=()=>keypair$1(),algo="AES-GCM",IV_LENGTH=12,SALT_LENGTH=16,getPasswordKey=et=>window.crypto.subtle.importKey("raw",et,"PBKDF2",!1,["deriveKey"]),deriveKey=(et,tt,rt)=>window.crypto.subtle.deriveKey({name:"PBKDF2",salt:tt,iterations:25e4,hash:"SHA-256"},et,{name:algo,length:256},!1,rt),enc=new TextEncoder,dec=new TextDecoder;async function encryptData(et,tt){try{const rt=dec.decode(et),nt=window.crypto.getRandomValues(new Uint8Array(SALT_LENGTH)),it=window.crypto.getRandomValues(new Uint8Array(IV_LENGTH)),ot=await getPasswordKey(tt),st=await deriveKey(ot,nt,["encrypt"]),at=await window.crypto.subtle.encrypt({name:algo,iv:it},st,enc.encode(rt)),ct=new Uint8Array(at);let ut=new Uint8Array(nt.byteLength+it.byteLength+ct.byteLength);return ut.set(nt,0),ut.set(it,nt.byteLength),ut.set(ct,nt.byteLength+it.byteLength),ut}catch(rt){throw console.error(rt),rt}}async function decryptData(et,tt){try{const rt=et.slice(0,SALT_LENGTH),nt=new Uint8Array(et.slice(SALT_LENGTH,SALT_LENGTH+IV_LENGTH)),it=et.slice(SALT_LENGTH+IV_LENGTH),ot=await getPasswordKey(tt),st=await deriveKey(ot,rt,["decrypt"]),at=await window.crypto.subtle.decrypt({name:algo,iv:nt},st,it);return new Uint8Array(at)}catch(rt){throw console.error(rt),rt}}const findUserAndEncrypt=async(et,tt)=>{var nt;const rt=(nt=useUserStore.getState().users.find(it=>it.id===et))==null?void 0:nt.quantumSend;return!rt||tt.byteLength===0?tt:await encryptData(tt,rt)},findUserAndDecrypt=async(et,tt)=>{var nt;const rt=(nt=useUserStore.getState().users.find(it=>it.id===et))==null?void 0:nt.quantumRecv;return!rt||tt.byteLength<IV_LENGTH+1?tt:await decryptData(tt,rt)},hasKey=et=>{var tt;return!!((tt=useUserStore.getState().users.find(rt=>rt.id===et))!=null&&tt.quantumRecv)},encryptDecrypt={encrypt:findUserAndEncrypt,decrypt:findUserAndDecrypt,hasKey,IV_LENGTH},usePersonaStore=create$1(et=>({persona:{name:"Anonymous",keyPair:void 0},updatePersona:tt=>et(rt=>({persona:{...rt.persona,...tt}})),resetPersona:()=>et(tt=>({persona:{name:"Anonymous",keyPair:generateKeyPair()}}))}));class UserManager{constructor({room:tt,roomId:rt}){xr(this,"sendName");xr(this,"sendEncryptionInfo");xr(this,"syncInfo",async tt=>{const rt=usePersonaStore.getState().persona;rt&&(this.sendName(rt.name),rt.keyPair&&await this.sendEncryptionInfo(rt.keyPair.pubkey,tt))});xr(this,"setMyName",tt=>{usePersonaStore.getState().updatePersona({name:tt}),this.syncInfo()});xr(this,"createPersona",async()=>{await usePersonaStore.getState().resetPersona(),this.syncInfo()});const[nt,it]=tt.makeAction("name"),[ot,st]=tt.makeAction("encReq"),[at,ct]=tt.makeAction("encProc");this.sendName=nt,this.sendEncryptionInfo=ot,tt.onPeerJoin(async ut=>{this.syncInfo(ut),useUserStore.getState().addUser({id:ut,roomId:rt,active:!0,name:"Anonymous"}),useClientSideUserTraits.getState().addUser(ut),sendSystemMessage(rt,`${ut} joined the room`)}),tt.onPeerLeave(ut=>{var lt;useUserStore.getState().updateUser(ut,{active:!1}),(lt=useOfferStore.getState().requestableDownloads[ut])==null||lt.forEach(ht=>useProgressStore.getState().deleteProgress(ht.id)),useOfferStore.getState().removeRequestablesForId(ut),useClientSideUserTraits.getState().removeUser(ut),sendSystemMessage(rt,`${ut} left the room`)}),it((ut,lt)=>{useUserStore.getState().updateUser(lt,{name:ut})}),st(async(ut,lt)=>{if(ut)try{const{ciphertext:ht,sharedSecret:ft}=await encapsulate$1(ut);useUserStore.getState().updateUser(lt,{quantumSend:ft}),at(ht,lt)}catch(ht){console.error(ht)}}),ct(async(ut,lt)=>{if(!ut)return;const ht=usePersonaStore.getState().persona;if(ht&&(this.sendName(ht.name),ht.keyPair)){const ft=decapsulate$1(ut,ht.keyPair.secret);try{useUserStore.getState().updateUser(lt,{quantumRecv:ft})}catch(dt){console.error(dt)}}})}}const App$1="";var dayjs_min={exports:{}};(function(et,tt){(function(rt,nt){et.exports=nt()})(commonjsGlobal,function(){var rt=1e3,nt=6e4,it=36e5,ot="millisecond",st="second",at="minute",ct="hour",ut="day",lt="week",ht="month",ft="quarter",dt="year",pt="date",gt="Invalid Date",_t=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,mt=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,At={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function($t){var Et=["th","st","nd","rd"],Tt=$t%100;return"["+$t+(Et[(Tt-20)%10]||Et[Tt]||Et[0])+"]"}},It=function($t,Et,Tt){var Pt=String($t);return!Pt||Pt.length>=Et?$t:""+Array(Et+1-Pt.length).join(Tt)+$t},Mt={s:It,z:function($t){var Et=-$t.utcOffset(),Tt=Math.abs(Et),Pt=Math.floor(Tt/60),St=Tt%60;return(Et<=0?"+":"-")+It(Pt,2,"0")+":"+It(St,2,"0")},m:function $t(Et,Tt){if(Et.date()<Tt.date())return-$t(Tt,Et);var Pt=12*(Tt.year()-Et.year())+(Tt.month()-Et.month()),St=Et.clone().add(Pt,ht),Dt=Tt-St<0,wt=Et.clone().add(Pt+(Dt?-1:1),ht);return+(-(Pt+(Tt-St)/(Dt?St-wt:wt-St))||0)},a:function($t){return $t<0?Math.ceil($t)||0:Math.floor($t)},p:function($t){return{M:ht,y:dt,w:lt,d:ut,D:pt,h:ct,m:at,s:st,ms:ot,Q:ft}[$t]||String($t||"").toLowerCase().replace(/s$/,"")},u:function($t){return $t===void 0}},kt="en",Ct={};Ct[kt]=At;var Ut=function($t){return $t instanceof bt},Wt=function $t(Et,Tt,Pt){var St;if(!Et)return kt;if(typeof Et=="string"){var Dt=Et.toLowerCase();Ct[Dt]&&(St=Dt),Tt&&(Ct[Dt]=Tt,St=Dt);var wt=Et.split("-");if(!St&&wt.length>1)return $t(wt[0])}else{var xt=Et.name;Ct[xt]=Et,St=xt}return!Pt&&St&&(kt=St),St||!Pt&&kt},Ft=function($t,Et){if(Ut($t))return $t.clone();var Tt=typeof Et=="object"?Et:{};return Tt.date=$t,Tt.args=arguments,new bt(Tt)},Ce=Mt;Ce.l=Wt,Ce.i=Ut,Ce.w=function($t,Et){return Ft($t,{locale:Et.$L,utc:Et.$u,x:Et.$x,$offset:Et.$offset})};var bt=function(){function $t(Tt){this.$L=Wt(Tt.locale,null,!0),this.parse(Tt)}var Et=$t.prototype;return Et.parse=function(Tt){this.$d=function(Pt){var St=Pt.date,Dt=Pt.utc;if(St===null)return new Date(NaN);if(Ce.u(St))return new Date;if(St instanceof Date)return new Date(St);if(typeof St=="string"&&!/Z$/i.test(St)){var wt=St.match(_t);if(wt){var xt=wt[2]-1||0,Ke=(wt[7]||"0").substring(0,3);return Dt?new Date(Date.UTC(wt[1],xt,wt[3]||1,wt[4]||0,wt[5]||0,wt[6]||0,Ke)):new Date(wt[1],xt,wt[3]||1,wt[4]||0,wt[5]||0,wt[6]||0,Ke)}}return new Date(St)}(Tt),this.$x=Tt.x||{},this.init()},Et.init=function(){var Tt=this.$d;this.$y=Tt.getFullYear(),this.$M=Tt.getMonth(),this.$D=Tt.getDate(),this.$W=Tt.getDay(),this.$H=Tt.getHours(),this.$m=Tt.getMinutes(),this.$s=Tt.getSeconds(),this.$ms=Tt.getMilliseconds()},Et.$utils=function(){return Ce},Et.isValid=function(){return this.$d.toString()!==gt},Et.isSame=function(Tt,Pt){var St=Ft(Tt);return this.startOf(Pt)<=St&&St<=this.endOf(Pt)},Et.isAfter=function(Tt,Pt){return Ft(Tt)<this.startOf(Pt)},Et.isBefore=function(Tt,Pt){return this.endOf(Pt)<Ft(Tt)},Et.$g=function(Tt,Pt,St){return Ce.u(Tt)?this[Pt]:this.set(St,Tt)},Et.unix=function(){return Math.floor(this.valueOf()/1e3)},Et.valueOf=function(){return this.$d.getTime()},Et.startOf=function(Tt,Pt){var St=this,Dt=!!Ce.u(Pt)||Pt,wt=Ce.p(Tt),xt=function(Ie,Xe){var Je=Ce.w(St.$u?Date.UTC(St.$y,Xe,Ie):new Date(St.$y,Xe,Ie),St);return Dt?Je:Je.endOf(ut)},Ke=function(Ie,Xe){return Ce.w(St.toDate()[Ie].apply(St.toDate("s"),(Dt?[0,0,0,0]:[23,59,59,999]).slice(Xe)),St)},Pe=this.$W,Ht=this.$M,zt=this.$D,jt="set"+(this.$u?"UTC":"");switch(wt){case dt:return Dt?xt(1,0):xt(31,11);case ht:return Dt?xt(1,Ht):xt(0,Ht+1);case lt:var qt=this.$locale().weekStart||0,Ge=(Pe<qt?Pe+7:Pe)-qt;return xt(Dt?zt-Ge:zt+(6-Ge),Ht);case ut:case pt:return Ke(jt+"Hours",0);case ct:return Ke(jt+"Minutes",1);case at:return Ke(jt+"Seconds",2);case st:return Ke(jt+"Milliseconds",3);default:return this.clone()}},Et.endOf=function(Tt){return this.startOf(Tt,!1)},Et.$set=function(Tt,Pt){var St,Dt=Ce.p(Tt),wt="set"+(this.$u?"UTC":""),xt=(St={},St[ut]=wt+"Date",St[pt]=wt+"Date",St[ht]=wt+"Month",St[dt]=wt+"FullYear",St[ct]=wt+"Hours",St[at]=wt+"Minutes",St[st]=wt+"Seconds",St[ot]=wt+"Milliseconds",St)[Dt],Ke=Dt===ut?this.$D+(Pt-this.$W):Pt;if(Dt===ht||Dt===dt){var Pe=this.clone().set(pt,1);Pe.$d[xt](Ke),Pe.init(),this.$d=Pe.set(pt,Math.min(this.$D,Pe.daysInMonth())).$d}else xt&&this.$d[xt](Ke);return this.init(),this},Et.set=function(Tt,Pt){return this.clone().$set(Tt,Pt)},Et.get=function(Tt){return this[Ce.p(Tt)]()},Et.add=function(Tt,Pt){var St,Dt=this;Tt=Number(Tt);var wt=Ce.p(Pt),xt=function(Ht){var zt=Ft(Dt);return Ce.w(zt.date(zt.date()+Math.round(Ht*Tt)),Dt)};if(wt===ht)return this.set(ht,this.$M+Tt);if(wt===dt)return this.set(dt,this.$y+Tt);if(wt===ut)return xt(1);if(wt===lt)return xt(7);var Ke=(St={},St[at]=nt,St[ct]=it,St[st]=rt,St)[wt]||1,Pe=this.$d.getTime()+Tt*Ke;return Ce.w(Pe,this)},Et.subtract=function(Tt,Pt){return this.add(-1*Tt,Pt)},Et.format=function(Tt){var Pt=this,St=this.$locale();if(!this.isValid())return St.invalidDate||gt;var Dt=Tt||"YYYY-MM-DDTHH:mm:ssZ",wt=Ce.z(this),xt=this.$H,Ke=this.$m,Pe=this.$M,Ht=St.weekdays,zt=St.months,jt=function(Xe,Je,Qe,We){return Xe&&(Xe[Je]||Xe(Pt,Dt))||Qe[Je].slice(0,We)},qt=function(Xe){return Ce.s(xt%12||12,Xe,"0")},Ge=St.meridiem||function(Xe,Je,Qe){var We=Xe<12?"AM":"PM";return Qe?We.toLowerCase():We},Ie={YY:String(this.$y).slice(-2),YYYY:Ce.s(this.$y,4,"0"),M:Pe+1,MM:Ce.s(Pe+1,2,"0"),MMM:jt(St.monthsShort,Pe,zt,3),MMMM:jt(zt,Pe),D:this.$D,DD:Ce.s(this.$D,2,"0"),d:String(this.$W),dd:jt(St.weekdaysMin,this.$W,Ht,2),ddd:jt(St.weekdaysShort,this.$W,Ht,3),dddd:Ht[this.$W],H:String(xt),HH:Ce.s(xt,2,"0"),h:qt(1),hh:qt(2),a:Ge(xt,Ke,!0),A:Ge(xt,Ke,!1),m:String(Ke),mm:Ce.s(Ke,2,"0"),s:String(this.$s),ss:Ce.s(this.$s,2,"0"),SSS:Ce.s(this.$ms,3,"0"),Z:wt};return Dt.replace(mt,function(Xe,Je){return Je||Ie[Xe]||wt.replace(":","")})},Et.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},Et.diff=function(Tt,Pt,St){var Dt,wt=Ce.p(Pt),xt=Ft(Tt),Ke=(xt.utcOffset()-this.utcOffset())*nt,Pe=this-xt,Ht=Ce.m(this,xt);return Ht=(Dt={},Dt[dt]=Ht/12,Dt[ht]=Ht,Dt[ft]=Ht/3,Dt[lt]=(Pe-Ke)/6048e5,Dt[ut]=(Pe-Ke)/864e5,Dt[ct]=Pe/it,Dt[at]=Pe/nt,Dt[st]=Pe/rt,Dt)[wt]||Pe,St?Ht:Ce.a(Ht)},Et.daysInMonth=function(){return this.endOf(ht).$D},Et.$locale=function(){return Ct[this.$L]},Et.locale=function(Tt,Pt){if(!Tt)return this.$L;var St=this.clone(),Dt=Wt(Tt,Pt,!0);return Dt&&(St.$L=Dt),St},Et.clone=function(){return Ce.w(this.$d,this)},Et.toDate=function(){return new Date(this.valueOf())},Et.toJSON=function(){return this.isValid()?this.toISOString():null},Et.toISOString=function(){return this.$d.toISOString()},Et.toString=function(){return this.$d.toUTCString()},$t}(),yt=bt.prototype;return Ft.prototype=yt,[["$ms",ot],["$s",st],["$m",at],["$H",ct],["$W",ut],["$M",ht],["$y",dt],["$D",pt]].forEach(function($t){yt[$t[1]]=function(Et){return this.$g(Et,$t[0],$t[1])}}),Ft.extend=function($t,Et){return $t.$i||($t(Et,bt,Ft),$t.$i=!0),Ft},Ft.locale=Wt,Ft.isDayjs=Ut,Ft.unix=function($t){return Ft(1e3*$t)},Ft.en=Ct[kt],Ft.Ls=Ct,Ft.p={},Ft})})(dayjs_min);var dayjs_minExports=dayjs_min.exports;const dayjs=getDefaultExportFromCjs(dayjs_minExports);var relativeTime$1={exports:{}};(function(et,tt){(function(rt,nt){et.exports=nt()})(commonjsGlobal,function(){return function(rt,nt,it){rt=rt||{};var ot=nt.prototype,st={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function at(ut,lt,ht,ft){return ot.fromToBase(ut,lt,ht,ft)}it.en.relativeTime=st,ot.fromToBase=function(ut,lt,ht,ft,dt){for(var pt,gt,_t,mt=ht.$locale().relativeTime||st,At=rt.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],It=At.length,Mt=0;Mt<It;Mt+=1){var kt=At[Mt];kt.d&&(pt=ft?it(ut).diff(ht,kt.d,!0):ht.diff(ut,kt.d,!0));var Ct=(rt.rounding||Math.round)(Math.abs(pt));if(_t=pt>0,Ct<=kt.r||!kt.r){Ct<=1&&Mt>0&&(kt=At[Mt-1]);var Ut=mt[kt.l];dt&&(Ct=dt(""+Ct)),gt=typeof Ut=="string"?Ut.replace("%d",Ct):Ut(Ct,lt,kt.l,_t);break}}if(lt)return gt;var Wt=_t?mt.future:mt.past;return typeof Wt=="function"?Wt(gt):Wt.replace("%s",gt)},ot.to=function(ut,lt){return at(ut,lt,this,!0)},ot.from=function(ut,lt){return at(ut,lt,this)};var ct=function(ut){return ut.$u?it.utc():it()};ot.toNow=function(ut){return this.to(ct(this),ut)},ot.fromNow=function(ut){return this.from(ct(this),ut)}}})})(relativeTime$1);var relativeTimeExports=relativeTime$1.exports;const relativeTime=getDefaultExportFromCjs(relativeTimeExports),{entries,setPrototypeOf,isFrozen,getPrototypeOf:getPrototypeOf$1,getOwnPropertyDescriptor:getOwnPropertyDescriptor$1}=Object;let{freeze,seal,create}=Object,{apply,construct}=typeof Reflect<"u"&&Reflect;apply||(apply=function(et,tt,rt){return et.apply(tt,rt)}),freeze||(freeze=function(et){return et}),seal||(seal=function(et){return et}),construct||(construct=function(et,tt){return new et(...tt)});const arrayForEach=unapply(Array.prototype.forEach),arrayPop=unapply(Array.prototype.pop),arrayPush=unapply(Array.prototype.push),stringToLowerCase=unapply(String.prototype.toLowerCase),stringToString=unapply(String.prototype.toString),stringMatch=unapply(String.prototype.match),stringReplace=unapply(String.prototype.replace),stringIndexOf=unapply(String.prototype.indexOf),stringTrim=unapply(String.prototype.trim),regExpTest=unapply(RegExp.prototype.test),typeErrorCreate=unconstruct(TypeError);function unapply(et){return function(tt){for(var rt=arguments.length,nt=new Array(rt>1?rt-1:0),it=1;it<rt;it++)nt[it-1]=arguments[it];return apply(et,tt,nt)}}function unconstruct(et){return function(){for(var tt=arguments.length,rt=new Array(tt),nt=0;nt<tt;nt++)rt[nt]=arguments[nt];return construct(et,rt)}}function addToSet(et,tt,rt){var nt;rt=(nt=rt)!==null&&nt!==void 0?nt:stringToLowerCase,setPrototypeOf&&setPrototypeOf(et,null);let it=tt.length;for(;it--;){let ot=tt[it];if(typeof ot=="string"){const st=rt(ot);st!==ot&&(isFrozen(tt)||(tt[it]=st),ot=st)}et[ot]=!0}return et}function clone(et){const tt=create(null);for(const[rt,nt]of entries(et))tt[rt]=nt;return tt}function lookupGetter(et,tt){for(;et!==null;){const nt=getOwnPropertyDescriptor$1(et,tt);if(nt){if(nt.get)return unapply(nt.get);if(typeof nt.value=="function")return unapply(nt.value)}et=getPrototypeOf$1(et)}function rt(nt){return console.warn("fallback value for",nt),null}return rt}const html$1=freeze(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),svg$1=freeze(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),svgFilters=freeze(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),svgDisallowed=freeze(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),mathMl$1=freeze(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),mathMlDisallowed=freeze(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),text=freeze(["#text"]),html=freeze(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),svg=freeze(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),mathMl=freeze(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),xml=freeze(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),MUSTACHE_EXPR=seal(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ERB_EXPR=seal(/<%[\w\W]*|[\w\W]*%>/gm),TMPLIT_EXPR=seal(/\${[\w\W]*}/gm),DATA_ATTR=seal(/^data-[\-\w.\u00B7-\uFFFF]/),ARIA_ATTR=seal(/^aria-[\-\w]+$/),IS_ALLOWED_URI=seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),IS_SCRIPT_OR_DATA=seal(/^(?:\w+script|data):/i),ATTR_WHITESPACE=seal(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),DOCTYPE_NAME=seal(/^html$/i);var EXPRESSIONS=Object.freeze({__proto__:null,MUSTACHE_EXPR,ERB_EXPR,TMPLIT_EXPR,DATA_ATTR,ARIA_ATTR,IS_ALLOWED_URI,IS_SCRIPT_OR_DATA,ATTR_WHITESPACE,DOCTYPE_NAME});const getGlobal=()=>typeof window>"u"?null:window,_createTrustedTypesPolicy=function et(tt,rt){if(typeof tt!="object"||typeof tt.createPolicy!="function")return null;let nt=null;const it="data-tt-policy-suffix";rt&&rt.hasAttribute(it)&&(nt=rt.getAttribute(it));const ot="dompurify"+(nt?"#"+nt:"");try{return tt.createPolicy(ot,{createHTML(st){return st},createScriptURL(st){return st}})}catch{return console.warn("TrustedTypes policy "+ot+" could not be created."),null}};function createDOMPurify(){let et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:getGlobal();const tt=Le=>createDOMPurify(Le);if(tt.version="3.0.3",tt.removed=[],!et||!et.document||et.document.nodeType!==9)return tt.isSupported=!1,tt;const rt=et.document,nt=rt.currentScript;let{document:it}=et;const{DocumentFragment:ot,HTMLTemplateElement:st,Node:at,Element:ct,NodeFilter:ut,NamedNodeMap:lt=et.NamedNodeMap||et.MozNamedAttrMap,HTMLFormElement:ht,DOMParser:ft,trustedTypes:dt}=et,pt=ct.prototype,gt=lookupGetter(pt,"cloneNode"),_t=lookupGetter(pt,"nextSibling"),mt=lookupGetter(pt,"childNodes"),At=lookupGetter(pt,"parentNode");if(typeof st=="function"){const Le=it.createElement("template");Le.content&&Le.content.ownerDocument&&(it=Le.content.ownerDocument)}let It,Mt="";const{implementation:kt,createNodeIterator:Ct,createDocumentFragment:Ut,getElementsByTagName:Wt}=it,{importNode:Ft}=rt;let Ce={};tt.isSupported=typeof entries=="function"&&typeof At=="function"&&kt&&kt.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:bt,ERB_EXPR:yt,TMPLIT_EXPR:$t,DATA_ATTR:Et,ARIA_ATTR:Tt,IS_SCRIPT_OR_DATA:Pt,ATTR_WHITESPACE:St}=EXPRESSIONS;let{IS_ALLOWED_URI:Dt}=EXPRESSIONS,wt=null;const xt=addToSet({},[...html$1,...svg$1,...svgFilters,...mathMl$1,...text]);let Ke=null;const Pe=addToSet({},[...html,...svg,...mathMl,...xml]);let Ht=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),zt=null,jt=null,qt=!0,Ge=!0,Ie=!1,Xe=!0,Je=!1,Qe=!1,We=!1,ur=!1,ar=!1,cr=!1,$r=!1,fr=!0,ue=!1;const Qt="user-content-";let me=!0,Lt=!1,Gt={},Xt=null;const Yt=addToSet({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let He=null;const ir=addToSet({},["audio","video","img","source","image","track"]);let vt=null;const Rt=addToSet({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Bt="http://www.w3.org/1998/Math/MathML",Nt="http://www.w3.org/2000/svg",Ot="http://www.w3.org/1999/xhtml";let Kt=Ot,$e=!1,nr=null;const Ze=addToSet({},[Bt,Nt,Ot],stringToString);let tr;const lr=["application/xhtml+xml","text/html"],dr="text/html";let br,Rr=null;const Er=it.createElement("form"),_r=function(Le){return Le instanceof RegExp||Le instanceof Function},Cr=function(Le){if(!(Rr&&Rr===Le)){if((!Le||typeof Le!="object")&&(Le={}),Le=clone(Le),tr=lr.indexOf(Le.PARSER_MEDIA_TYPE)===-1?tr=dr:tr=Le.PARSER_MEDIA_TYPE,br=tr==="application/xhtml+xml"?stringToString:stringToLowerCase,wt="ALLOWED_TAGS"in Le?addToSet({},Le.ALLOWED_TAGS,br):xt,Ke="ALLOWED_ATTR"in Le?addToSet({},Le.ALLOWED_ATTR,br):Pe,nr="ALLOWED_NAMESPACES"in Le?addToSet({},Le.ALLOWED_NAMESPACES,stringToString):Ze,vt="ADD_URI_SAFE_ATTR"in Le?addToSet(clone(Rt),Le.ADD_URI_SAFE_ATTR,br):Rt,He="ADD_DATA_URI_TAGS"in Le?addToSet(clone(ir),Le.ADD_DATA_URI_TAGS,br):ir,Xt="FORBID_CONTENTS"in Le?addToSet({},Le.FORBID_CONTENTS,br):Yt,zt="FORBID_TAGS"in Le?addToSet({},Le.FORBID_TAGS,br):{},jt="FORBID_ATTR"in Le?addToSet({},Le.FORBID_ATTR,br):{},Gt="USE_PROFILES"in Le?Le.USE_PROFILES:!1,qt=Le.ALLOW_ARIA_ATTR!==!1,Ge=Le.ALLOW_DATA_ATTR!==!1,Ie=Le.ALLOW_UNKNOWN_PROTOCOLS||!1,Xe=Le.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Je=Le.SAFE_FOR_TEMPLATES||!1,Qe=Le.WHOLE_DOCUMENT||!1,ar=Le.RETURN_DOM||!1,cr=Le.RETURN_DOM_FRAGMENT||!1,$r=Le.RETURN_TRUSTED_TYPE||!1,ur=Le.FORCE_BODY||!1,fr=Le.SANITIZE_DOM!==!1,ue=Le.SANITIZE_NAMED_PROPS||!1,me=Le.KEEP_CONTENT!==!1,Lt=Le.IN_PLACE||!1,Dt=Le.ALLOWED_URI_REGEXP||IS_ALLOWED_URI,Kt=Le.NAMESPACE||Ot,Ht=Le.CUSTOM_ELEMENT_HANDLING||{},Le.CUSTOM_ELEMENT_HANDLING&&_r(Le.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Ht.tagNameCheck=Le.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Le.CUSTOM_ELEMENT_HANDLING&&_r(Le.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Ht.attributeNameCheck=Le.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Le.CUSTOM_ELEMENT_HANDLING&&typeof Le.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(Ht.allowCustomizedBuiltInElements=Le.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Je&&(Ge=!1),cr&&(ar=!0),Gt&&(wt=addToSet({},[...text]),Ke=[],Gt.html===!0&&(addToSet(wt,html$1),addToSet(Ke,html)),Gt.svg===!0&&(addToSet(wt,svg$1),addToSet(Ke,svg),addToSet(Ke,xml)),Gt.svgFilters===!0&&(addToSet(wt,svgFilters),addToSet(Ke,svg),addToSet(Ke,xml)),Gt.mathMl===!0&&(addToSet(wt,mathMl$1),addToSet(Ke,mathMl),addToSet(Ke,xml))),Le.ADD_TAGS&&(wt===xt&&(wt=clone(wt)),addToSet(wt,Le.ADD_TAGS,br)),Le.ADD_ATTR&&(Ke===Pe&&(Ke=clone(Ke)),addToSet(Ke,Le.ADD_ATTR,br)),Le.ADD_URI_SAFE_ATTR&&addToSet(vt,Le.ADD_URI_SAFE_ATTR,br),Le.FORBID_CONTENTS&&(Xt===Yt&&(Xt=clone(Xt)),addToSet(Xt,Le.FORBID_CONTENTS,br)),me&&(wt["#text"]=!0),Qe&&addToSet(wt,["html","head","body"]),wt.table&&(addToSet(wt,["tbody"]),delete zt.tbody),Le.TRUSTED_TYPES_POLICY){if(typeof Le.TRUSTED_TYPES_POLICY.createHTML!="function")throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof Le.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');It=Le.TRUSTED_TYPES_POLICY,Mt=It.createHTML("")}else It===void 0&&(It=_createTrustedTypesPolicy(dt,nt)),It!==null&&typeof Mt=="string"&&(Mt=It.createHTML(""));freeze&&freeze(Le),Rr=Le}},Ar=addToSet({},["mi","mo","mn","ms","mtext"]),Zt=addToSet({},["foreignobject","desc","title","annotation-xml"]),Vt=addToSet({},["title","style","font","a","script"]),Jt=addToSet({},svg$1);addToSet(Jt,svgFilters),addToSet(Jt,svgDisallowed);const Ue=addToSet({},mathMl$1);addToSet(Ue,mathMlDisallowed);const er=function(Le){let yr=At(Le);(!yr||!yr.tagName)&&(yr={namespaceURI:Kt,tagName:"template"});const pr=stringToLowerCase(Le.tagName),kr=stringToLowerCase(yr.tagName);return nr[Le.namespaceURI]?Le.namespaceURI===Nt?yr.namespaceURI===Ot?pr==="svg":yr.namespaceURI===Bt?pr==="svg"&&(kr==="annotation-xml"||Ar[kr]):!!Jt[pr]:Le.namespaceURI===Bt?yr.namespaceURI===Ot?pr==="math":yr.namespaceURI===Nt?pr==="math"&&Zt[kr]:!!Ue[pr]:Le.namespaceURI===Ot?yr.namespaceURI===Nt&&!Zt[kr]||yr.namespaceURI===Bt&&!Ar[kr]?!1:!Ue[pr]&&(Vt[pr]||!Jt[pr]):!!(tr==="application/xhtml+xml"&&nr[Le.namespaceURI]):!1},sr=function(Le){arrayPush(tt.removed,{element:Le});try{Le.parentNode.removeChild(Le)}catch{Le.remove()}},hr=function(Le,yr){try{arrayPush(tt.removed,{attribute:yr.getAttributeNode(Le),from:yr})}catch{arrayPush(tt.removed,{attribute:null,from:yr})}if(yr.removeAttribute(Le),Le==="is"&&!Ke[Le])if(ar||cr)try{sr(yr)}catch{}else try{yr.setAttribute(Le,"")}catch{}},gr=function(Le){let yr,pr;if(ur)Le="<remove></remove>"+Le;else{const Or=stringMatch(Le,/^[\r\n\t ]+/);pr=Or&&Or[0]}tr==="application/xhtml+xml"&&Kt===Ot&&(Le='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Le+"</body></html>");const kr=It?It.createHTML(Le):Le;if(Kt===Ot)try{yr=new ft().parseFromString(kr,tr)}catch{}if(!yr||!yr.documentElement){yr=kt.createDocument(Kt,"template",null);try{yr.documentElement.innerHTML=$e?Mt:kr}catch{}}const Dr=yr.body||yr.documentElement;return Le&&pr&&Dr.insertBefore(it.createTextNode(pr),Dr.childNodes[0]||null),Kt===Ot?Wt.call(yr,Qe?"html":"body")[0]:Qe?yr.documentElement:Dr},mr=function(Le){return Ct.call(Le.ownerDocument||Le,Le,ut.SHOW_ELEMENT|ut.SHOW_COMMENT|ut.SHOW_TEXT,null,!1)},vr=function(Le){return Le instanceof ht&&(typeof Le.nodeName!="string"||typeof Le.textContent!="string"||typeof Le.removeChild!="function"||!(Le.attributes instanceof lt)||typeof Le.removeAttribute!="function"||typeof Le.setAttribute!="function"||typeof Le.namespaceURI!="string"||typeof Le.insertBefore!="function"||typeof Le.hasChildNodes!="function")},Tr=function(Le){return typeof at=="object"?Le instanceof at:Le&&typeof Le=="object"&&typeof Le.nodeType=="number"&&typeof Le.nodeName=="string"},wr=function(Le,yr,pr){Ce[Le]&&arrayForEach(Ce[Le],kr=>{kr.call(tt,yr,pr,Rr)})},Sr=function(Le){let yr;if(wr("beforeSanitizeElements",Le,null),vr(Le))return sr(Le),!0;const pr=br(Le.nodeName);if(wr("uponSanitizeElement",Le,{tagName:pr,allowedTags:wt}),Le.hasChildNodes()&&!Tr(Le.firstElementChild)&&(!Tr(Le.content)||!Tr(Le.content.firstElementChild))&&regExpTest(/<[/\w]/g,Le.innerHTML)&&regExpTest(/<[/\w]/g,Le.textContent))return sr(Le),!0;if(!wt[pr]||zt[pr]){if(!zt[pr]&&Ir(pr)&&(Ht.tagNameCheck instanceof RegExp&&regExpTest(Ht.tagNameCheck,pr)||Ht.tagNameCheck instanceof Function&&Ht.tagNameCheck(pr)))return!1;if(me&&!Xt[pr]){const kr=At(Le)||Le.parentNode,Dr=mt(Le)||Le.childNodes;if(Dr&&kr){const Or=Dr.length;for(let Mr=Or-1;Mr>=0;--Mr)kr.insertBefore(gt(Dr[Mr],!0),_t(Le))}}return sr(Le),!0}return Le instanceof ct&&!er(Le)||(pr==="noscript"||pr==="noembed")&&regExpTest(/<\/no(script|embed)/i,Le.innerHTML)?(sr(Le),!0):(Je&&Le.nodeType===3&&(yr=Le.textContent,yr=stringReplace(yr,bt," "),yr=stringReplace(yr,yt," "),yr=stringReplace(yr,$t," "),Le.textContent!==yr&&(arrayPush(tt.removed,{element:Le.cloneNode()}),Le.textContent=yr)),wr("afterSanitizeElements",Le,null),!1)},Pr=function(Le,yr,pr){if(fr&&(yr==="id"||yr==="name")&&(pr in it||pr in Er))return!1;if(!(Ge&&!jt[yr]&&regExpTest(Et,yr))&&!(qt&&regExpTest(Tt,yr))){if(!Ke[yr]||jt[yr]){if(!(Ir(Le)&&(Ht.tagNameCheck instanceof RegExp&&regExpTest(Ht.tagNameCheck,Le)||Ht.tagNameCheck instanceof Function&&Ht.tagNameCheck(Le))&&(Ht.attributeNameCheck instanceof RegExp&&regExpTest(Ht.attributeNameCheck,yr)||Ht.attributeNameCheck instanceof Function&&Ht.attributeNameCheck(yr))||yr==="is"&&Ht.allowCustomizedBuiltInElements&&(Ht.tagNameCheck instanceof RegExp&&regExpTest(Ht.tagNameCheck,pr)||Ht.tagNameCheck instanceof Function&&Ht.tagNameCheck(pr))))return!1}else if(!vt[yr]&&!regExpTest(Dt,stringReplace(pr,St,""))&&!((yr==="src"||yr==="xlink:href"||yr==="href")&&Le!=="script"&&stringIndexOf(pr,"data:")===0&&He[Le])&&!(Ie&&!regExpTest(Pt,stringReplace(pr,St,"")))&&pr)return!1}return!0},Ir=function(Le){return Le.indexOf("-")>0},Br=function(Le){let yr,pr,kr,Dr;wr("beforeSanitizeAttributes",Le,null);const{attributes:Or}=Le;if(!Or)return;const Mr={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Ke};for(Dr=Or.length;Dr--;){yr=Or[Dr];const{name:Nr,namespaceURI:Fr}=yr;if(pr=Nr==="value"?yr.value:stringTrim(yr.value),kr=br(Nr),Mr.attrName=kr,Mr.attrValue=pr,Mr.keepAttr=!0,Mr.forceKeepAttr=void 0,wr("uponSanitizeAttribute",Le,Mr),pr=Mr.attrValue,Mr.forceKeepAttr||(hr(Nr,Le),!Mr.keepAttr))continue;if(!Xe&&regExpTest(/\/>/i,pr)){hr(Nr,Le);continue}Je&&(pr=stringReplace(pr,bt," "),pr=stringReplace(pr,yt," "),pr=stringReplace(pr,$t," "));const Vr=br(Le.nodeName);if(Pr(Vr,kr,pr)){if(ue&&(kr==="id"||kr==="name")&&(hr(Nr,Le),pr=Qt+pr),It&&typeof dt=="object"&&typeof dt.getAttributeType=="function"&&!Fr)switch(dt.getAttributeType(Vr,kr)){case"TrustedHTML":{pr=It.createHTML(pr);break}case"TrustedScriptURL":{pr=It.createScriptURL(pr);break}}try{Fr?Le.setAttributeNS(Fr,Nr,pr):Le.setAttribute(Nr,pr),arrayPop(tt.removed)}catch{}}}wr("afterSanitizeAttributes",Le,null)},qr=function Le(yr){let pr;const kr=mr(yr);for(wr("beforeSanitizeShadowDOM",yr,null);pr=kr.nextNode();)wr("uponSanitizeShadowNode",pr,null),!Sr(pr)&&(pr.content instanceof ot&&Le(pr.content),Br(pr));wr("afterSanitizeShadowDOM",yr,null)};return tt.sanitize=function(Le){let yr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},pr,kr,Dr,Or;if($e=!Le,$e&&(Le="<!-->"),typeof Le!="string"&&!Tr(Le))if(typeof Le.toString=="function"){if(Le=Le.toString(),typeof Le!="string")throw typeErrorCreate("dirty is not a string, aborting")}else throw typeErrorCreate("toString is not a function");if(!tt.isSupported)return Le;if(We||Cr(yr),tt.removed=[],typeof Le=="string"&&(Lt=!1),Lt){if(Le.nodeName){const Fr=br(Le.nodeName);if(!wt[Fr]||zt[Fr])throw typeErrorCreate("root node is forbidden and cannot be sanitized in-place")}}else if(Le instanceof at)pr=gr("<!---->"),kr=pr.ownerDocument.importNode(Le,!0),kr.nodeType===1&&kr.nodeName==="BODY"||kr.nodeName==="HTML"?pr=kr:pr.appendChild(kr);else{if(!ar&&!Je&&!Qe&&Le.indexOf("<")===-1)return It&&$r?It.createHTML(Le):Le;if(pr=gr(Le),!pr)return ar?null:$r?Mt:""}pr&&ur&&sr(pr.firstChild);const Mr=mr(Lt?Le:pr);for(;Dr=Mr.nextNode();)Sr(Dr)||(Dr.content instanceof ot&&qr(Dr.content),Br(Dr));if(Lt)return Le;if(ar){if(cr)for(Or=Ut.call(pr.ownerDocument);pr.firstChild;)Or.appendChild(pr.firstChild);else Or=pr;return(Ke.shadowroot||Ke.shadowrootmod)&&(Or=Ft.call(rt,Or,!0)),Or}let Nr=Qe?pr.outerHTML:pr.innerHTML;return Qe&&wt["!doctype"]&&pr.ownerDocument&&pr.ownerDocument.doctype&&pr.ownerDocument.doctype.name&&regExpTest(DOCTYPE_NAME,pr.ownerDocument.doctype.name)&&(Nr="<!DOCTYPE "+pr.ownerDocument.doctype.name+`>
`+Nr),Je&&(Nr=stringReplace(Nr,bt," "),Nr=stringReplace(Nr,yt," "),Nr=stringReplace(Nr,$t," ")),It&&$r?It.createHTML(Nr):Nr},tt.setConfig=function(Le){Cr(Le),We=!0},tt.clearConfig=function(){Rr=null,We=!1},tt.isValidAttribute=function(Le,yr,pr){Rr||Cr({});const kr=br(Le),Dr=br(yr);return Pr(kr,Dr,pr)},tt.addHook=function(Le,yr){typeof yr=="function"&&(Ce[Le]=Ce[Le]||[],arrayPush(Ce[Le],yr))},tt.removeHook=function(Le){if(Ce[Le])return arrayPop(Ce[Le])},tt.removeHooks=function(Le){Ce[Le]&&(Ce[Le]=[])},tt.removeAllHooks=function(){Ce={}},tt}var purify=createDOMPurify(),preact$4=require$$0$1,_extends$4=Object.assign||function(et){for(var tt=1;tt<arguments.length;tt++){var rt=arguments[tt];for(var nt in rt)Object.prototype.hasOwnProperty.call(rt,nt)&&(et[nt]=rt[nt])}return et},objectWithoutProperties$4=function(et,tt){var rt={};for(var nt in et)tt.indexOf(nt)>=0||Object.prototype.hasOwnProperty.call(et,nt)&&(rt[nt]=et[nt]);return rt},ReplyIcon=function et(tt){var rt=tt.color,nt=rt===void 0?"currentColor":rt,it=tt.size,ot=it===void 0?24:it;tt.children;var st=objectWithoutProperties$4(tt,["color","size","children"]),at="mdi-icon "+(st.class||st.className||"");return preact$4.h("svg",_extends$4({},st,{class:at,width:ot,height:ot,fill:nt,viewBox:"0 0 24 24"}),preact$4.h("path",{d:"M10,9V5L3,12L10,19V14.9C15,14.9 18.5,16.5 21,20C20,15 17,10 10,9Z"}))},ReplyIcon_1=ReplyIcon;const Reply=getDefaultExportFromCjs(ReplyIcon_1);var _$1=0;function o(et,tt,rt,nt,it,ot){var st,at,ct={};for(at in tt)at=="ref"?st=tt[at]:ct[at]=tt[at];var ut={type:et,props:ct,key:rt,ref:st,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--_$1,__source:it,__self:ot};if(typeof et=="function"&&(st=et.defaultProps))for(at in st)ct[at]===void 0&&(ct[at]=st[at]);return l$3.vnode&&l$3.vnode(ut),ut}dayjs.extend(relativeTime);const formatMessage=et=>{const tt=/>>(.{9})/gi,rt=/(https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.~#?&//=]*))/gi;return et=et.replace(rt,'<a href="$1" target="_blank" rel="noopener noreferrer">$1</a>'),et=et.replace(tt,'<a class="msgLink $1">&gt;&gt;$1</a>'),et};function RenderMessage(et){const{message:tt,index:rt,isLast:nt,sentByName:it}=et,ot=_$2(null);return p$5(()=>{nt&&ot.current&&ot.current.scrollIntoView({behavior:"smooth",block:"end"}),Array.from(document.getElementsByClassName("msgLink")).forEach(st=>{st.setAttribute("cursor","pointer"),st.addEventListener("click",at=>{const ct=at.target.className.split(" ")[1],ut=document.getElementById(ct);ut&&ut.scrollIntoView({behavior:"smooth",block:"center"})})})}),o(k$6,{children:tt.sentBy==="system"?o("div",{className:"filelistbox",style:{textAlign:"center",border:"1px solid rgba(var(--card-border-rgb), 0.20)",borderRadius:"var(--border-radius)"},children:[tt.text,o("p",{style:{color:"grey"},children:dayjs().to(dayjs(tt.recievedAt))})]},rt):o(k$6,{children:o("div",{className:"horizontal",children:o("div",{id:tt.id,ref:nt?ot:null,className:"tag is-medium filelistbox",style:{backgroundColor:"var(--background-rgb)",color:"var(--foreground-rgb)",textAlign:"left",width:"fit-content"},children:[o("span",{className:"horizontal",children:[o("h4",{style:{fontWeight:"bold",color:generateHexColorFromString(tt.sentBy)},children:it}),o("p",{style:{paddingLeft:"1em",fontSize:".8em",color:"grey"},children:dayjs().to(dayjs(tt.recievedAt))}),o("div",{style:{paddingLeft:"1em",cursor:"pointer"},onClick:()=>{const st=document.getElementById("userTextBox");st&&(st.value+=`>>${tt.id} `)},children:o(Reply,{})})]}),o("div",{dangerouslySetInnerHTML:{__html:purify.sanitize(formatMessage(tt.text))}})]},tt.id)})})})}dayjs.extend(relativeTime);function Messages(){const et=useMessageStore(rt=>rt.messages),tt=usePersonaStore(rt=>rt.persona.name);return o("div",{className:"filelistcontainer",children:et.sort((rt,nt)=>rt.recievedAt-nt.recievedAt).map((rt,nt)=>{var it;return o(RenderMessage,{message:rt,index:nt,sentByName:rt.sentBy===selfId?tt||"You":((it=useUserStore(ot=>ot.users.find(st=>st.id===rt.sentBy)))==null?void 0:it.name)||rt.sentBy,isLast:nt===et.length-1})})})}function ChatView(et){const{chatManagerInstance:tt}=et,rt=_$2(null),nt=useClientSideUserTraits(st=>st.typingUsers),it=useUserStore(st=>st.users.map(at=>({id:at.id,name:at.name}))),ot=useUserStore(st=>st.users.filter(at=>at.active).length>0);return o(k$6,{children:[o(Messages,{}),o("div",{className:"horizontal",style:{overflow:"hidden"},children:nt.length>0&&nt.map(st=>{var ct;const at=(ct=it.find(ut=>ut.id===st))==null?void 0:ct.name;return o("p",{style:{color:"grey"},children:[at," is typing..."]},st)})}),o("div",{className:"horizontal",children:[o("input",{ref:rt,id:"userTextBox",className:"textbox",name:"userInput",type:"text",autoComplete:"off",placeholder:"Type your message",disabled:!ot,onKeyDown:st=>{st.key==="Enter"&&rt.current!==null&&tt?(tt.sendChat(rt.current.value),rt.current.value=""):tt.sendTypingIndicator(!0)},onfocusout:()=>tt.sendTypingIndicator(!1)}),o("button",{onClick:()=>{rt.current!==null&&tt&&(tt.sendChat(rt.current.value),rt.current.value="")},disabled:!ot,type:"button",children:"send \u2794"})]})]})}var reactIs$1={exports:{}},reactIs_production_min={},b$2=typeof Symbol=="function"&&Symbol.for,c$1=b$2?Symbol.for("react.element"):60103,d$1=b$2?Symbol.for("react.portal"):60106,e=b$2?Symbol.for("react.fragment"):60107,f$1=b$2?Symbol.for("react.strict_mode"):60108,g$2=b$2?Symbol.for("react.profiler"):60114,h$1=b$2?Symbol.for("react.provider"):60109,k$2=b$2?Symbol.for("react.context"):60110,l=b$2?Symbol.for("react.async_mode"):60111,m$2=b$2?Symbol.for("react.concurrent_mode"):60111,n=b$2?Symbol.for("react.forward_ref"):60112,p$1=b$2?Symbol.for("react.suspense"):60113,q$1=b$2?Symbol.for("react.suspense_list"):60120,r=b$2?Symbol.for("react.memo"):60115,t$1=b$2?Symbol.for("react.lazy"):60116,v$2=b$2?Symbol.for("react.block"):60121,w$2=b$2?Symbol.for("react.fundamental"):60117,x$2=b$2?Symbol.for("react.responder"):60118,y$2=b$2?Symbol.for("react.scope"):60119;function z$2(et){if(typeof et=="object"&&et!==null){var tt=et.$$typeof;switch(tt){case c$1:switch(et=et.type,et){case l:case m$2:case e:case g$2:case f$1:case p$1:return et;default:switch(et=et&&et.$$typeof,et){case k$2:case n:case t$1:case r:case h$1:return et;default:return tt}}case d$1:return tt}}}function A(et){return z$2(et)===m$2}reactIs_production_min.AsyncMode=l,reactIs_production_min.ConcurrentMode=m$2,reactIs_production_min.ContextConsumer=k$2,reactIs_production_min.ContextProvider=h$1,reactIs_production_min.Element=c$1,reactIs_production_min.ForwardRef=n,reactIs_production_min.Fragment=e,reactIs_production_min.Lazy=t$1,reactIs_production_min.Memo=r,reactIs_production_min.Portal=d$1,reactIs_production_min.Profiler=g$2,reactIs_production_min.StrictMode=f$1,reactIs_production_min.Suspense=p$1,reactIs_production_min.isAsyncMode=function(et){return A(et)||z$2(et)===l},reactIs_production_min.isConcurrentMode=A,reactIs_production_min.isContextConsumer=function(et){return z$2(et)===k$2},reactIs_production_min.isContextProvider=function(et){return z$2(et)===h$1},reactIs_production_min.isElement=function(et){return typeof et=="object"&&et!==null&&et.$$typeof===c$1},reactIs_production_min.isForwardRef=function(et){return z$2(et)===n},reactIs_production_min.isFragment=function(et){return z$2(et)===e},reactIs_production_min.isLazy=function(et){return z$2(et)===t$1},reactIs_production_min.isMemo=function(et){return z$2(et)===r},reactIs_production_min.isPortal=function(et){return z$2(et)===d$1},reactIs_production_min.isProfiler=function(et){return z$2(et)===g$2},reactIs_production_min.isStrictMode=function(et){return z$2(et)===f$1},reactIs_production_min.isSuspense=function(et){return z$2(et)===p$1},reactIs_production_min.isValidElementType=function(et){return typeof et=="string"||typeof et=="function"||et===e||et===m$2||et===g$2||et===f$1||et===p$1||et===q$1||typeof et=="object"&&et!==null&&(et.$$typeof===t$1||et.$$typeof===r||et.$$typeof===h$1||et.$$typeof===k$2||et.$$typeof===n||et.$$typeof===w$2||et.$$typeof===x$2||et.$$typeof===y$2||et.$$typeof===v$2)},reactIs_production_min.typeOf=z$2,reactIs$1.exports=reactIs_production_min;var reactIsExports=reactIs$1.exports;function stylis_min(et){function tt(Pe,Ht,zt,jt,qt){for(var Ge=0,Ie=0,Xe=0,Je=0,Qe,We,ur=0,ar=0,cr,$r=cr=Qe=0,fr=0,ue=0,Qt=0,me=0,Lt=zt.length,Gt=Lt-1,Xt,Yt="",He="",ir="",vt="",Rt;fr<Lt;){if(We=zt.charCodeAt(fr),fr===Gt&&Ie+Je+Xe+Ge!==0&&(Ie!==0&&(We=Ie===47?10:47),Je=Xe=Ge=0,Lt++,Gt++),Ie+Je+Xe+Ge===0){if(fr===Gt&&(0<ue&&(Yt=Yt.replace(ft,"")),0<Yt.trim().length)){switch(We){case 32:case 9:case 59:case 13:case 10:break;default:Yt+=zt.charAt(fr)}We=59}switch(We){case 123:for(Yt=Yt.trim(),Qe=Yt.charCodeAt(0),cr=1,me=++fr;fr<Lt;){switch(We=zt.charCodeAt(fr)){case 123:cr++;break;case 125:cr--;break;case 47:switch(We=zt.charCodeAt(fr+1)){case 42:case 47:t:{for($r=fr+1;$r<Gt;++$r)switch(zt.charCodeAt($r)){case 47:if(We===42&&zt.charCodeAt($r-1)===42&&fr+2!==$r){fr=$r+1;break t}break;case 10:if(We===47){fr=$r+1;break t}}fr=$r}}break;case 91:We++;case 40:We++;case 34:case 39:for(;fr++<Gt&&zt.charCodeAt(fr)!==We;);}if(cr===0)break;fr++}switch(cr=zt.substring(me,fr),Qe===0&&(Qe=(Yt=Yt.replace(ht,"").trim()).charCodeAt(0)),Qe){case 64:switch(0<ue&&(Yt=Yt.replace(ft,"")),We=Yt.charCodeAt(1),We){case 100:case 109:case 115:case 45:ue=Ht;break;default:ue=Pt}if(cr=tt(Ht,ue,cr,We,qt+1),me=cr.length,0<Dt&&(ue=rt(Pt,Yt,Qt),Rt=at(3,cr,ue,Ht,$t,yt,me,We,qt,jt),Yt=ue.join(""),Rt!==void 0&&(me=(cr=Rt.trim()).length)===0&&(We=0,cr="")),0<me)switch(We){case 115:Yt=Yt.replace(Ct,st);case 100:case 109:case 45:cr=Yt+"{"+cr+"}";break;case 107:Yt=Yt.replace(At,"$1 $2"),cr=Yt+"{"+cr+"}",cr=Tt===1||Tt===2&&ot("@"+cr,3)?"@-webkit-"+cr+"@"+cr:"@"+cr;break;default:cr=Yt+cr,jt===112&&(cr=(He+=cr,""))}else cr="";break;default:cr=tt(Ht,rt(Ht,Yt,Qt),cr,jt,qt+1)}ir+=cr,cr=Qt=ue=$r=Qe=0,Yt="",We=zt.charCodeAt(++fr);break;case 125:case 59:if(Yt=(0<ue?Yt.replace(ft,""):Yt).trim(),1<(me=Yt.length))switch($r===0&&(Qe=Yt.charCodeAt(0),Qe===45||96<Qe&&123>Qe)&&(me=(Yt=Yt.replace(" ",":")).length),0<Dt&&(Rt=at(1,Yt,Ht,Pe,$t,yt,He.length,jt,qt,jt))!==void 0&&(me=(Yt=Rt.trim()).length)===0&&(Yt="\0\0"),Qe=Yt.charCodeAt(0),We=Yt.charCodeAt(1),Qe){case 0:break;case 64:if(We===105||We===99){vt+=Yt+zt.charAt(fr);break}default:Yt.charCodeAt(me-1)!==58&&(He+=it(Yt,Qe,We,Yt.charCodeAt(2)))}Qt=ue=$r=Qe=0,Yt="",We=zt.charCodeAt(++fr)}}switch(We){case 13:case 10:Ie===47?Ie=0:1+Qe===0&&jt!==107&&0<Yt.length&&(ue=1,Yt+="\0"),0<Dt*xt&&at(0,Yt,Ht,Pe,$t,yt,He.length,jt,qt,jt),yt=1,$t++;break;case 59:case 125:if(Ie+Je+Xe+Ge===0){yt++;break}default:switch(yt++,Xt=zt.charAt(fr),We){case 9:case 32:if(Je+Ge+Ie===0)switch(ur){case 44:case 58:case 9:case 32:Xt="";break;default:We!==32&&(Xt=" ")}break;case 0:Xt="\\0";break;case 12:Xt="\\f";break;case 11:Xt="\\v";break;case 38:Je+Ie+Ge===0&&(ue=Qt=1,Xt="\f"+Xt);break;case 108:if(Je+Ie+Ge+Et===0&&0<$r)switch(fr-$r){case 2:ur===112&&zt.charCodeAt(fr-3)===58&&(Et=ur);case 8:ar===111&&(Et=ar)}break;case 58:Je+Ie+Ge===0&&($r=fr);break;case 44:Ie+Xe+Je+Ge===0&&(ue=1,Xt+="\r");break;case 34:case 39:Ie===0&&(Je=Je===We?0:Je===0?We:Je);break;case 91:Je+Ie+Xe===0&&Ge++;break;case 93:Je+Ie+Xe===0&&Ge--;break;case 41:Je+Ie+Ge===0&&Xe--;break;case 40:if(Je+Ie+Ge===0){if(Qe===0)switch(2*ur+3*ar){case 533:break;default:Qe=1}Xe++}break;case 64:Ie+Xe+Je+Ge+$r+cr===0&&(cr=1);break;case 42:case 47:if(!(0<Je+Ge+Xe))switch(Ie){case 0:switch(2*We+3*zt.charCodeAt(fr+1)){case 235:Ie=47;break;case 220:me=fr,Ie=42}break;case 42:We===47&&ur===42&&me+2!==fr&&(zt.charCodeAt(me+2)===33&&(He+=zt.substring(me,fr+1)),Xt="",Ie=0)}}Ie===0&&(Yt+=Xt)}ar=ur,ur=We,fr++}if(me=He.length,0<me){if(ue=Ht,0<Dt&&(Rt=at(2,He,ue,Pe,$t,yt,me,jt,qt,jt),Rt!==void 0&&(He=Rt).length===0))return vt+He+ir;if(He=ue.join(",")+"{"+He+"}",Tt*Et!==0){switch(Tt!==2||ot(He,2)||(Et=0),Et){case 111:He=He.replace(Mt,":-moz-$1")+He;break;case 112:He=He.replace(It,"::-webkit-input-$1")+He.replace(It,"::-moz-$1")+He.replace(It,":-ms-input-$1")+He}Et=0}}return vt+He+ir}function rt(Pe,Ht,zt){var jt=Ht.trim().split(_t);Ht=jt;var qt=jt.length,Ge=Pe.length;switch(Ge){case 0:case 1:var Ie=0;for(Pe=Ge===0?"":Pe[0]+" ";Ie<qt;++Ie)Ht[Ie]=nt(Pe,Ht[Ie],zt).trim();break;default:var Xe=Ie=0;for(Ht=[];Ie<qt;++Ie)for(var Je=0;Je<Ge;++Je)Ht[Xe++]=nt(Pe[Je]+" ",jt[Ie],zt).trim()}return Ht}function nt(Pe,Ht,zt){var jt=Ht.charCodeAt(0);switch(33>jt&&(jt=(Ht=Ht.trim()).charCodeAt(0)),jt){case 38:return Ht.replace(mt,"$1"+Pe.trim());case 58:return Pe.trim()+Ht.replace(mt,"$1"+Pe.trim());default:if(0<1*zt&&0<Ht.indexOf("\f"))return Ht.replace(mt,(Pe.charCodeAt(0)===58?"":"$1")+Pe.trim())}return Pe+Ht}function it(Pe,Ht,zt,jt){var qt=Pe+";",Ge=2*Ht+3*zt+4*jt;if(Ge===944){Pe=qt.indexOf(":",9)+1;var Ie=qt.substring(Pe,qt.length-1).trim();return Ie=qt.substring(0,Pe).trim()+Ie+";",Tt===1||Tt===2&&ot(Ie,1)?"-webkit-"+Ie+Ie:Ie}if(Tt===0||Tt===2&&!ot(qt,1))return qt;switch(Ge){case 1015:return qt.charCodeAt(10)===97?"-webkit-"+qt+qt:qt;case 951:return qt.charCodeAt(3)===116?"-webkit-"+qt+qt:qt;case 963:return qt.charCodeAt(5)===110?"-webkit-"+qt+qt:qt;case 1009:if(qt.charCodeAt(4)!==100)break;case 969:case 942:return"-webkit-"+qt+qt;case 978:return"-webkit-"+qt+"-moz-"+qt+qt;case 1019:case 983:return"-webkit-"+qt+"-moz-"+qt+"-ms-"+qt+qt;case 883:if(qt.charCodeAt(8)===45)return"-webkit-"+qt+qt;if(0<qt.indexOf("image-set(",11))return qt.replace(bt,"$1-webkit-$2")+qt;break;case 932:if(qt.charCodeAt(4)===45)switch(qt.charCodeAt(5)){case 103:return"-webkit-box-"+qt.replace("-grow","")+"-webkit-"+qt+"-ms-"+qt.replace("grow","positive")+qt;case 115:return"-webkit-"+qt+"-ms-"+qt.replace("shrink","negative")+qt;case 98:return"-webkit-"+qt+"-ms-"+qt.replace("basis","preferred-size")+qt}return"-webkit-"+qt+"-ms-"+qt+qt;case 964:return"-webkit-"+qt+"-ms-flex-"+qt+qt;case 1023:if(qt.charCodeAt(8)!==99)break;return Ie=qt.substring(qt.indexOf(":",15)).replace("flex-","").replace("space-between","justify"),"-webkit-box-pack"+Ie+"-webkit-"+qt+"-ms-flex-pack"+Ie+qt;case 1005:return pt.test(qt)?qt.replace(dt,":-webkit-")+qt.replace(dt,":-moz-")+qt:qt;case 1e3:switch(Ie=qt.substring(13).trim(),Ht=Ie.indexOf("-")+1,Ie.charCodeAt(0)+Ie.charCodeAt(Ht)){case 226:Ie=qt.replace(kt,"tb");break;case 232:Ie=qt.replace(kt,"tb-rl");break;case 220:Ie=qt.replace(kt,"lr");break;default:return qt}return"-webkit-"+qt+"-ms-"+Ie+qt;case 1017:if(qt.indexOf("sticky",9)===-1)break;case 975:switch(Ht=(qt=Pe).length-10,Ie=(qt.charCodeAt(Ht)===33?qt.substring(0,Ht):qt).substring(Pe.indexOf(":",7)+1).trim(),Ge=Ie.charCodeAt(0)+(Ie.charCodeAt(7)|0)){case 203:if(111>Ie.charCodeAt(8))break;case 115:qt=qt.replace(Ie,"-webkit-"+Ie)+";"+qt;break;case 207:case 102:qt=qt.replace(Ie,"-webkit-"+(102<Ge?"inline-":"")+"box")+";"+qt.replace(Ie,"-webkit-"+Ie)+";"+qt.replace(Ie,"-ms-"+Ie+"box")+";"+qt}return qt+";";case 938:if(qt.charCodeAt(5)===45)switch(qt.charCodeAt(6)){case 105:return Ie=qt.replace("-items",""),"-webkit-"+qt+"-webkit-box-"+Ie+"-ms-flex-"+Ie+qt;case 115:return"-webkit-"+qt+"-ms-flex-item-"+qt.replace(Wt,"")+qt;default:return"-webkit-"+qt+"-ms-flex-line-pack"+qt.replace("align-content","").replace(Wt,"")+qt}break;case 973:case 989:if(qt.charCodeAt(3)!==45||qt.charCodeAt(4)===122)break;case 931:case 953:if(Ce.test(Pe)===!0)return(Ie=Pe.substring(Pe.indexOf(":")+1)).charCodeAt(0)===115?it(Pe.replace("stretch","fill-available"),Ht,zt,jt).replace(":fill-available",":stretch"):qt.replace(Ie,"-webkit-"+Ie)+qt.replace(Ie,"-moz-"+Ie.replace("fill-",""))+qt;break;case 962:if(qt="-webkit-"+qt+(qt.charCodeAt(5)===102?"-ms-"+qt:"")+qt,zt+jt===211&&qt.charCodeAt(13)===105&&0<qt.indexOf("transform",10))return qt.substring(0,qt.indexOf(";",27)+1).replace(gt,"$1-webkit-$2")+qt}return qt}function ot(Pe,Ht){var zt=Pe.indexOf(Ht===1?":":"{"),jt=Pe.substring(0,Ht!==3?zt:10);return zt=Pe.substring(zt+1,Pe.length-1),wt(Ht!==2?jt:jt.replace(Ft,"$1"),zt,Ht)}function st(Pe,Ht){var zt=it(Ht,Ht.charCodeAt(0),Ht.charCodeAt(1),Ht.charCodeAt(2));return zt!==Ht+";"?zt.replace(Ut," or ($1)").substring(4):"("+Ht+")"}function at(Pe,Ht,zt,jt,qt,Ge,Ie,Xe,Je,Qe){for(var We=0,ur=Ht,ar;We<Dt;++We)switch(ar=St[We].call(lt,Pe,ur,zt,jt,qt,Ge,Ie,Xe,Je,Qe)){case void 0:case!1:case!0:case null:break;default:ur=ar}if(ur!==Ht)return ur}function ct(Pe){switch(Pe){case void 0:case null:Dt=St.length=0;break;default:if(typeof Pe=="function")St[Dt++]=Pe;else if(typeof Pe=="object")for(var Ht=0,zt=Pe.length;Ht<zt;++Ht)ct(Pe[Ht]);else xt=!!Pe|0}return ct}function ut(Pe){return Pe=Pe.prefix,Pe!==void 0&&(wt=null,Pe?typeof Pe!="function"?Tt=1:(Tt=2,wt=Pe):Tt=0),ut}function lt(Pe,Ht){var zt=Pe;if(33>zt.charCodeAt(0)&&(zt=zt.trim()),Ke=zt,zt=[Ke],0<Dt){var jt=at(-1,Ht,zt,zt,$t,yt,0,0,0,0);jt!==void 0&&typeof jt=="string"&&(Ht=jt)}var qt=tt(Pt,zt,Ht,0,0);return 0<Dt&&(jt=at(-2,qt,zt,zt,$t,yt,qt.length,0,0,0),jt!==void 0&&(qt=jt)),Ke="",Et=0,yt=$t=1,qt}var ht=/^\0+/g,ft=/[\0\r\f]/g,dt=/: */g,pt=/zoo|gra/,gt=/([,: ])(transform)/g,_t=/,\r+?/g,mt=/([\t\r\n ])*\f?&/g,At=/@(k\w+)\s*(\S*)\s*/,It=/::(place)/g,Mt=/:(read-only)/g,kt=/[svh]\w+-[tblr]{2}/,Ct=/\(\s*(.*)\s*\)/g,Ut=/([\s\S]*?);/g,Wt=/-self|flex-/g,Ft=/[^]*?(:[rp][el]a[\w-]+)[^]*/,Ce=/stretch|:\s*\w+\-(?:conte|avail)/,bt=/([^-])(image-set\()/,yt=1,$t=1,Et=0,Tt=1,Pt=[],St=[],Dt=0,wt=null,xt=0,Ke="";return lt.use=ct,lt.set=ut,et!==void 0&&ut(et),lt}var unitlessKeys={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};function memoize(et){var tt=Object.create(null);return function(rt){return tt[rt]===void 0&&(tt[rt]=et(rt)),tt[rt]}}var reactPropsRegex=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,isPropValid=memoize(function(et){return reactPropsRegex.test(et)||et.charCodeAt(0)===111&&et.charCodeAt(1)===110&&et.charCodeAt(2)<91}),reactIs=reactIsExports,REACT_STATICS={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},KNOWN_STATICS={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},FORWARD_REF_STATICS={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},MEMO_STATICS={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},TYPE_STATICS={};TYPE_STATICS[reactIs.ForwardRef]=FORWARD_REF_STATICS,TYPE_STATICS[reactIs.Memo]=MEMO_STATICS;function getStatics(et){return reactIs.isMemo(et)?MEMO_STATICS:TYPE_STATICS[et.$$typeof]||REACT_STATICS}var defineProperty=Object.defineProperty,getOwnPropertyNames=Object.getOwnPropertyNames,getOwnPropertySymbols=Object.getOwnPropertySymbols,getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,getPrototypeOf=Object.getPrototypeOf,objectPrototype=Object.prototype;function hoistNonReactStatics(et,tt,rt){if(typeof tt!="string"){if(objectPrototype){var nt=getPrototypeOf(tt);nt&&nt!==objectPrototype&&hoistNonReactStatics(et,nt,rt)}var it=getOwnPropertyNames(tt);getOwnPropertySymbols&&(it=it.concat(getOwnPropertySymbols(tt)));for(var ot=getStatics(et),st=getStatics(tt),at=0;at<it.length;++at){var ct=it[at];if(!KNOWN_STATICS[ct]&&!(rt&&rt[ct])&&!(st&&st[ct])&&!(ot&&ot[ct])){var ut=getOwnPropertyDescriptor(tt,ct);try{defineProperty(et,ct,ut)}catch{}}}}return et}var hoistNonReactStatics_cjs=hoistNonReactStatics;const m$1=getDefaultExportFromCjs(hoistNonReactStatics_cjs);function y$1(){return(y$1=Object.assign||function(et){for(var tt=1;tt<arguments.length;tt++){var rt=arguments[tt];for(var nt in rt)Object.prototype.hasOwnProperty.call(rt,nt)&&(et[nt]=rt[nt])}return et}).apply(this,arguments)}var v$1=function(et,tt){for(var rt=[et[0]],nt=0,it=tt.length;nt<it;nt+=1)rt.push(tt[nt],et[nt+1]);return rt},g$1=function(et){return et!==null&&typeof et=="object"&&(et.toString?et.toString():Object.prototype.toString.call(et))==="[object Object]"&&!reactIsExports.typeOf(et)},S=Object.freeze([]),w$1=Object.freeze({});function E$1(et){return typeof et=="function"}function b$1(et){return et.displayName||et.name||"Component"}function _(et){return et&&typeof et.styledComponentId=="string"}var N=typeof process<"u"&&process.env!==void 0&&({}.REACT_APP_SC_ATTR||{}.SC_ATTR)||"data-styled",C$1=typeof window<"u"&&"HTMLElement"in window,I=!!(typeof SC_DISABLE_SPEEDY=="boolean"?SC_DISABLE_SPEEDY:typeof process<"u"&&process.env!==void 0&&({}.REACT_APP_SC_DISABLE_SPEEDY!==void 0&&{}.REACT_APP_SC_DISABLE_SPEEDY!==""?{}.REACT_APP_SC_DISABLE_SPEEDY!=="false"&&{}.REACT_APP_SC_DISABLE_SPEEDY:{}.SC_DISABLE_SPEEDY!==void 0&&{}.SC_DISABLE_SPEEDY!==""&&{}.SC_DISABLE_SPEEDY!=="false"&&{}.SC_DISABLE_SPEEDY));function D(et){for(var tt=arguments.length,rt=new Array(tt>1?tt-1:0),nt=1;nt<tt;nt++)rt[nt-1]=arguments[nt];throw new Error("An error occurred. See https://git.io/JUIaE#"+et+" for more information."+(rt.length>0?" Args: "+rt.join(", "):""))}var j=function(){function et(rt){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=rt}var tt=et.prototype;return tt.indexOfGroup=function(rt){for(var nt=0,it=0;it<rt;it++)nt+=this.groupSizes[it];return nt},tt.insertRules=function(rt,nt){if(rt>=this.groupSizes.length){for(var it=this.groupSizes,ot=it.length,st=ot;rt>=st;)(st<<=1)<0&&D(16,""+rt);this.groupSizes=new Uint32Array(st),this.groupSizes.set(it),this.length=st;for(var at=ot;at<st;at++)this.groupSizes[at]=0}for(var ct=this.indexOfGroup(rt+1),ut=0,lt=nt.length;ut<lt;ut++)this.tag.insertRule(ct,nt[ut])&&(this.groupSizes[rt]++,ct++)},tt.clearGroup=function(rt){if(rt<this.length){var nt=this.groupSizes[rt],it=this.indexOfGroup(rt),ot=it+nt;this.groupSizes[rt]=0;for(var st=it;st<ot;st++)this.tag.deleteRule(it)}},tt.getGroup=function(rt){var nt="";if(rt>=this.length||this.groupSizes[rt]===0)return nt;for(var it=this.groupSizes[rt],ot=this.indexOfGroup(rt),st=ot+it,at=ot;at<st;at++)nt+=this.tag.getRule(at)+`/*!sc*/
`;return nt},et}(),T=new Map,x$1=new Map,k$1=1,V=function(et){if(T.has(et))return T.get(et);for(;x$1.has(k$1);)k$1++;var tt=k$1++;return T.set(et,tt),x$1.set(tt,et),tt},B=function(et){return x$1.get(et)},z$1=function(et,tt){tt>=k$1&&(k$1=tt+1),T.set(et,tt),x$1.set(tt,et)},M="style["+N+'][data-styled-version="5.3.11"]',G=new RegExp("^"+N+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),L$1=function(et,tt,rt){for(var nt,it=rt.split(","),ot=0,st=it.length;ot<st;ot++)(nt=it[ot])&&et.registerName(tt,nt)},F=function(et,tt){for(var rt=(tt.textContent||"").split(`/*!sc*/
`),nt=[],it=0,ot=rt.length;it<ot;it++){var st=rt[it].trim();if(st){var at=st.match(G);if(at){var ct=0|parseInt(at[1],10),ut=at[2];ct!==0&&(z$1(ut,ct),L$1(et,ut,at[3]),et.getTag().insertRules(ct,nt)),nt.length=0}else nt.push(st)}}},Y=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:null},q=function(et){var tt=document.head,rt=et||tt,nt=document.createElement("style"),it=function(at){for(var ct=at.childNodes,ut=ct.length;ut>=0;ut--){var lt=ct[ut];if(lt&&lt.nodeType===1&&lt.hasAttribute(N))return lt}}(rt),ot=it!==void 0?it.nextSibling:null;nt.setAttribute(N,"active"),nt.setAttribute("data-styled-version","5.3.11");var st=Y();return st&&nt.setAttribute("nonce",st),rt.insertBefore(nt,ot),nt},H$1=function(){function et(rt){var nt=this.element=q(rt);nt.appendChild(document.createTextNode("")),this.sheet=function(it){if(it.sheet)return it.sheet;for(var ot=document.styleSheets,st=0,at=ot.length;st<at;st++){var ct=ot[st];if(ct.ownerNode===it)return ct}D(17)}(nt),this.length=0}var tt=et.prototype;return tt.insertRule=function(rt,nt){try{return this.sheet.insertRule(nt,rt),this.length++,!0}catch{return!1}},tt.deleteRule=function(rt){this.sheet.deleteRule(rt),this.length--},tt.getRule=function(rt){var nt=this.sheet.cssRules[rt];return nt!==void 0&&typeof nt.cssText=="string"?nt.cssText:""},et}(),$=function(){function et(rt){var nt=this.element=q(rt);this.nodes=nt.childNodes,this.length=0}var tt=et.prototype;return tt.insertRule=function(rt,nt){if(rt<=this.length&&rt>=0){var it=document.createTextNode(nt),ot=this.nodes[rt];return this.element.insertBefore(it,ot||null),this.length++,!0}return!1},tt.deleteRule=function(rt){this.element.removeChild(this.nodes[rt]),this.length--},tt.getRule=function(rt){return rt<this.length?this.nodes[rt].textContent:""},et}(),W=function(){function et(rt){this.rules=[],this.length=0}var tt=et.prototype;return tt.insertRule=function(rt,nt){return rt<=this.length&&(this.rules.splice(rt,0,nt),this.length++,!0)},tt.deleteRule=function(rt){this.rules.splice(rt,1),this.length--},tt.getRule=function(rt){return rt<this.length?this.rules[rt]:""},et}(),U=C$1,J={isServer:!C$1,useCSSOMInjection:!I},X=function(){function et(rt,nt,it){rt===void 0&&(rt=w$1),nt===void 0&&(nt={}),this.options=y$1({},J,{},rt),this.gs=nt,this.names=new Map(it),this.server=!!rt.isServer,!this.server&&C$1&&U&&(U=!1,function(ot){for(var st=document.querySelectorAll(M),at=0,ct=st.length;at<ct;at++){var ut=st[at];ut&&ut.getAttribute(N)!=="active"&&(F(ot,ut),ut.parentNode&&ut.parentNode.removeChild(ut))}}(this))}et.registerId=function(rt){return V(rt)};var tt=et.prototype;return tt.reconstructWithOptions=function(rt,nt){return nt===void 0&&(nt=!0),new et(y$1({},this.options,{},rt),this.gs,nt&&this.names||void 0)},tt.allocateGSInstance=function(rt){return this.gs[rt]=(this.gs[rt]||0)+1},tt.getTag=function(){return this.tag||(this.tag=(it=(nt=this.options).isServer,ot=nt.useCSSOMInjection,st=nt.target,rt=it?new W(st):ot?new H$1(st):new $(st),new j(rt)));var rt,nt,it,ot,st},tt.hasNameForId=function(rt,nt){return this.names.has(rt)&&this.names.get(rt).has(nt)},tt.registerName=function(rt,nt){if(V(rt),this.names.has(rt))this.names.get(rt).add(nt);else{var it=new Set;it.add(nt),this.names.set(rt,it)}},tt.insertRules=function(rt,nt,it){this.registerName(rt,nt),this.getTag().insertRules(V(rt),it)},tt.clearNames=function(rt){this.names.has(rt)&&this.names.get(rt).clear()},tt.clearRules=function(rt){this.getTag().clearGroup(V(rt)),this.clearNames(rt)},tt.clearTag=function(){this.tag=void 0},tt.toString=function(){return function(rt){for(var nt=rt.getTag(),it=nt.length,ot="",st=0;st<it;st++){var at=B(st);if(at!==void 0){var ct=rt.names.get(at),ut=nt.getGroup(st);if(ct&&ut&&ct.size){var lt=N+".g"+st+'[id="'+at+'"]',ht="";ct!==void 0&&ct.forEach(function(ft){ft.length>0&&(ht+=ft+",")}),ot+=""+ut+lt+'{content:"'+ht+`"}/*!sc*/
`}}}return ot}(this)},et}(),Z=/(a)(d)/gi,K=function(et){return String.fromCharCode(et+(et>25?39:97))};function Q(et){var tt,rt="";for(tt=Math.abs(et);tt>52;tt=tt/52|0)rt=K(tt%52)+rt;return(K(tt%52)+rt).replace(Z,"$1-$2")}var ee=function(et,tt){for(var rt=tt.length;rt;)et=33*et^tt.charCodeAt(--rt);return et},te=function(et){return ee(5381,et)};function ne(et){for(var tt=0;tt<et.length;tt+=1){var rt=et[tt];if(E$1(rt)&&!_(rt))return!1}return!0}var re=te("5.3.11"),oe=function(){function et(tt,rt,nt){this.rules=tt,this.staticRulesId="",this.isStatic=(nt===void 0||nt.isStatic)&&ne(tt),this.componentId=rt,this.baseHash=ee(re,rt),this.baseStyle=nt,X.registerId(rt)}return et.prototype.generateAndInjectStyles=function(tt,rt,nt){var it=this.componentId,ot=[];if(this.baseStyle&&ot.push(this.baseStyle.generateAndInjectStyles(tt,rt,nt)),this.isStatic&&!nt.hash)if(this.staticRulesId&&rt.hasNameForId(it,this.staticRulesId))ot.push(this.staticRulesId);else{var st=_e(this.rules,tt,rt,nt).join(""),at=Q(ee(this.baseHash,st)>>>0);if(!rt.hasNameForId(it,at)){var ct=nt(st,"."+at,void 0,it);rt.insertRules(it,at,ct)}ot.push(at),this.staticRulesId=at}else{for(var ut=this.rules.length,lt=ee(this.baseHash,nt.hash),ht="",ft=0;ft<ut;ft++){var dt=this.rules[ft];if(typeof dt=="string")ht+=dt;else if(dt){var pt=_e(dt,tt,rt,nt),gt=Array.isArray(pt)?pt.join(""):pt;lt=ee(lt,gt+ft),ht+=gt}}if(ht){var _t=Q(lt>>>0);if(!rt.hasNameForId(it,_t)){var mt=nt(ht,"."+_t,void 0,it);rt.insertRules(it,_t,mt)}ot.push(_t)}}return ot.join(" ")},et}(),se=/^\s*\/\/.*$/gm,ie=[":","[",".","#"];function ae(et){var tt,rt,nt,it,ot=et===void 0?w$1:et,st=ot.options,at=st===void 0?w$1:st,ct=ot.plugins,ut=ct===void 0?S:ct,lt=new stylis_min(at),ht=[],ft=function(gt){function _t(mt){if(mt)try{gt(mt+"}")}catch{}}return function(mt,At,It,Mt,kt,Ct,Ut,Wt,Ft,Ce){switch(mt){case 1:if(Ft===0&&At.charCodeAt(0)===64)return gt(At+";"),"";break;case 2:if(Wt===0)return At+"/*|*/";break;case 3:switch(Wt){case 102:case 112:return gt(It[0]+At),"";default:return At+(Ce===0?"/*|*/":"")}case-2:At.split("/*|*/}").forEach(_t)}}}(function(gt){ht.push(gt)}),dt=function(gt,_t,mt){return _t===0&&ie.indexOf(mt[rt.length])!==-1||mt.match(it)?gt:"."+tt};function pt(gt,_t,mt,At){At===void 0&&(At="&");var It=gt.replace(se,""),Mt=_t&&mt?mt+" "+_t+" { "+It+" }":It;return tt=At,rt=_t,nt=new RegExp("\\"+rt+"\\b","g"),it=new RegExp("(\\"+rt+"\\b){2,}"),lt(mt||!_t?"":_t,Mt)}return lt.use([].concat(ut,[function(gt,_t,mt){gt===2&&mt.length&&mt[0].lastIndexOf(rt)>0&&(mt[0]=mt[0].replace(nt,dt))},ft,function(gt){if(gt===-2){var _t=ht;return ht=[],_t}}])),pt.hash=ut.length?ut.reduce(function(gt,_t){return _t.name||D(15),ee(gt,_t.name)},5381).toString():"",pt}var ce=Cn.createContext();ce.Consumer;var le=Cn.createContext(),de=(le.Consumer,new X),he=ae();function pe(){return q$5(ce)||de}function fe(){return q$5(le)||he}var ye=function(){function et(tt,rt){var nt=this;this.inject=function(it,ot){ot===void 0&&(ot=he);var st=nt.name+ot.hash;it.hasNameForId(nt.id,st)||it.insertRules(nt.id,st,ot(nt.rules,st,"@keyframes"))},this.toString=function(){return D(12,String(nt.name))},this.name=tt,this.id="sc-keyframes-"+tt,this.rules=rt}return et.prototype.getName=function(tt){return tt===void 0&&(tt=he),this.name+tt.hash},et}(),ve=/([A-Z])/,ge=/([A-Z])/g,Se=/^ms-/,we=function(et){return"-"+et.toLowerCase()};function Ee(et){return ve.test(et)?et.replace(ge,we).replace(Se,"-ms-"):et}var be=function(et){return et==null||et===!1||et===""};function _e(et,tt,rt,nt){if(Array.isArray(et)){for(var it,ot=[],st=0,at=et.length;st<at;st+=1)(it=_e(et[st],tt,rt,nt))!==""&&(Array.isArray(it)?ot.push.apply(ot,it):ot.push(it));return ot}if(be(et))return"";if(_(et))return"."+et.styledComponentId;if(E$1(et)){if(typeof(ut=et)!="function"||ut.prototype&&ut.prototype.isReactComponent||!tt)return et;var ct=et(tt);return _e(ct,tt,rt,nt)}var ut;return et instanceof ye?rt?(et.inject(rt,nt),et.getName(nt)):et:g$1(et)?function lt(ht,ft){var dt,pt,gt=[];for(var _t in ht)ht.hasOwnProperty(_t)&&!be(ht[_t])&&(Array.isArray(ht[_t])&&ht[_t].isCss||E$1(ht[_t])?gt.push(Ee(_t)+":",ht[_t],";"):g$1(ht[_t])?gt.push.apply(gt,lt(ht[_t],_t)):gt.push(Ee(_t)+": "+(dt=_t,(pt=ht[_t])==null||typeof pt=="boolean"||pt===""?"":typeof pt!="number"||pt===0||dt in unitlessKeys||dt.startsWith("--")?String(pt).trim():pt+"px")+";"));return ft?[ft+" {"].concat(gt,["}"]):gt}(et):et.toString()}var Ne=function(et){return Array.isArray(et)&&(et.isCss=!0),et};function Ae(et){for(var tt=arguments.length,rt=new Array(tt>1?tt-1:0),nt=1;nt<tt;nt++)rt[nt-1]=arguments[nt];return E$1(et)||g$1(et)?Ne(_e(v$1(S,[et].concat(rt)))):rt.length===0&&et.length===1&&typeof et[0]=="string"?et:Ne(_e(v$1(et,rt)))}var Oe=function(et,tt,rt){return rt===void 0&&(rt=w$1),et.theme!==rt.theme&&et.theme||tt||rt.theme},Re=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,De=/(^-|-$)/g;function je(et){return et.replace(Re,"-").replace(De,"")}var Te=function(et){return Q(te(et)>>>0)};function xe(et){return typeof et=="string"&&!0}var ke=function(et){return typeof et=="function"||typeof et=="object"&&et!==null&&!Array.isArray(et)},Ve=function(et){return et!=="__proto__"&&et!=="constructor"&&et!=="prototype"};function Be(et,tt,rt){var nt=et[rt];ke(tt)&&ke(nt)?ze(nt,tt):et[rt]=tt}function ze(et){for(var tt=arguments.length,rt=new Array(tt>1?tt-1:0),nt=1;nt<tt;nt++)rt[nt-1]=arguments[nt];for(var it=0,ot=rt;it<ot.length;it++){var st=ot[it];if(ke(st))for(var at in st)Ve(at)&&Be(et,st[at],at)}return et}var Me=Cn.createContext();Me.Consumer;var Fe={};function Ye(et,tt,rt){var nt=_(et),it=!xe(et),ot=tt.attrs,st=ot===void 0?S:ot,at=tt.componentId,ct=at===void 0?function(At,It){var Mt=typeof At!="string"?"sc":je(At);Fe[Mt]=(Fe[Mt]||0)+1;var kt=Mt+"-"+Te("5.3.11"+Mt+Fe[Mt]);return It?It+"-"+kt:kt}(tt.displayName,tt.parentComponentId):at,ut=tt.displayName,lt=ut===void 0?function(At){return xe(At)?"styled."+At:"Styled("+b$1(At)+")"}(et):ut,ht=tt.displayName&&tt.componentId?je(tt.displayName)+"-"+tt.componentId:tt.componentId||ct,ft=nt&&et.attrs?Array.prototype.concat(et.attrs,st).filter(Boolean):st,dt=tt.shouldForwardProp;nt&&et.shouldForwardProp&&(dt=tt.shouldForwardProp?function(At,It,Mt){return et.shouldForwardProp(At,It,Mt)&&tt.shouldForwardProp(At,It,Mt)}:et.shouldForwardProp);var pt,gt=new oe(rt,ht,nt?et.componentStyle:void 0),_t=gt.isStatic&&st.length===0,mt=function(At,It){return function(Mt,kt,Ct,Ut){var Wt=Mt.attrs,Ft=Mt.componentStyle,Ce=Mt.defaultProps,bt=Mt.foldedComponentIds,yt=Mt.shouldForwardProp,$t=Mt.styledComponentId,Et=Mt.target,Tt=function(jt,qt,Ge){jt===void 0&&(jt=w$1);var Ie=y$1({},qt,{theme:jt}),Xe={};return Ge.forEach(function(Je){var Qe,We,ur,ar=Je;for(Qe in E$1(ar)&&(ar=ar(Ie)),ar)Ie[Qe]=Xe[Qe]=Qe==="className"?(We=Xe[Qe],ur=ar[Qe],We&&ur?We+" "+ur:We||ur):ar[Qe]}),[Ie,Xe]}(Oe(kt,q$5(Me),Ce)||w$1,kt,Wt),Pt=Tt[0],St=Tt[1],Dt=function(jt,qt,Ge,Ie){var Xe=pe(),Je=fe(),Qe=qt?jt.generateAndInjectStyles(w$1,Xe,Je):jt.generateAndInjectStyles(Ge,Xe,Je);return Qe}(Ft,Ut,Pt),wt=Ct,xt=St.$as||kt.$as||St.as||kt.as||Et,Ke=xe(xt),Pe=St!==kt?y$1({},kt,{},St):kt,Ht={};for(var zt in Pe)zt[0]!=="$"&&zt!=="as"&&(zt==="forwardedAs"?Ht.as=Pe[zt]:(yt?yt(zt,isPropValid,xt):!Ke||isPropValid(zt))&&(Ht[zt]=Pe[zt]));return kt.style&&St.style!==kt.style&&(Ht.style=y$1({},kt.style,{},St.style)),Ht.className=Array.prototype.concat(bt,$t,Dt!==$t?Dt:null,kt.className,St.className).filter(Boolean).join(" "),Ht.ref=wt,y$4(xt,Ht)}(pt,At,It,_t)};return mt.displayName=lt,(pt=Cn.forwardRef(mt)).attrs=ft,pt.componentStyle=gt,pt.displayName=lt,pt.shouldForwardProp=dt,pt.foldedComponentIds=nt?Array.prototype.concat(et.foldedComponentIds,et.styledComponentId):S,pt.styledComponentId=ht,pt.target=nt?et.target:et,pt.withComponent=function(At){var It=tt.componentId,Mt=function(Ct,Ut){if(Ct==null)return{};var Wt,Ft,Ce={},bt=Object.keys(Ct);for(Ft=0;Ft<bt.length;Ft++)Wt=bt[Ft],Ut.indexOf(Wt)>=0||(Ce[Wt]=Ct[Wt]);return Ce}(tt,["componentId"]),kt=It&&It+"-"+(xe(At)?At:je(b$1(At)));return Ye(At,y$1({},Mt,{attrs:ft,componentId:kt}),rt)},Object.defineProperty(pt,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(At){this._foldedDefaultProps=nt?ze({},et.defaultProps,At):At}}),Object.defineProperty(pt,"toString",{value:function(){return"."+pt.styledComponentId}}),it&&m$1(pt,et,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),pt}var qe=function(et){return function tt(rt,nt,it){if(it===void 0&&(it=w$1),!reactIsExports.isValidElementType(nt))return D(1,String(nt));var ot=function(){return rt(nt,it,Ae.apply(void 0,arguments))};return ot.withConfig=function(st){return tt(rt,nt,y$1({},it,{},st))},ot.attrs=function(st){return tt(rt,nt,y$1({},it,{attrs:Array.prototype.concat(it.attrs,st).filter(Boolean)}))},ot}(Ye,et)};["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","textPath","tspan"].forEach(function(et){qe[et]=qe(et)});const t=qe;var p=function(){return p=Object.assign||function(et){for(var tt,rt=1,nt=arguments.length;rt<nt;rt++)for(var it in tt=arguments[rt])Object.prototype.hasOwnProperty.call(tt,it)&&(et[it]=tt[it]);return et},p.apply(this,arguments)};function d(et,tt){return Object.defineProperty?Object.defineProperty(et,"raw",{value:tt}):et.raw=tt,et}var c,u,f,v,h,x=Ae(c||(c=d([`
  display: flex;
  align-items: center;
  min-width: 322px;
  max-width: 508px;
  height: 48px;
  border: dashed 2px `,`;
  padding: 8px 16px 8px 8px;
  border-radius: 5px;
  cursor: pointer;
  flex-grow: 0;

  &.is-disabled {
    border: dashed 2px `,`;
    cursor: no-drop;
    svg {
      fill: `,`;
      color: `,`;
      path {
        fill: `,`;
        color: `,`;
      }
    }
  }
`],[`
  display: flex;
  align-items: center;
  min-width: 322px;
  max-width: 508px;
  height: 48px;
  border: dashed 2px `,`;
  padding: 8px 16px 8px 8px;
  border-radius: 5px;
  cursor: pointer;
  flex-grow: 0;

  &.is-disabled {
    border: dashed 2px `,`;
    cursor: no-drop;
    svg {
      fill: `,`;
      color: `,`;
      path {
        fill: `,`;
        color: `,`;
      }
    }
  }
`])),"#0658c2","#666","#666","#666","#666","#666"),g=t.label(u||(u=d([`
  position: relative;
  `,`;
  &:focus-within {
    outline: 2px solid black;
  }
  & > input {
    display: block;
    opacity: 0;
    position: absolute;
    pointer-events: none;
  }
`],[`
  position: relative;
  `,`;
  &:focus-within {
    outline: 2px solid black;
  }
  & > input {
    display: block;
    opacity: 0;
    position: absolute;
    pointer-events: none;
  }
`])),function(et){return et.overRide?"":x}),m=t.div(f||(f=d([`
  border: dashed 2px `,`;
  border-radius: 5px;
  background-color: `,`;
  opacity: 0.5;
  position: absolute;
  top: 0;
  right: 0;
  left: 0;
  bottom: 0;
  & > span {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translateX(-50%) translateY(-50%);
  }
`],[`
  border: dashed 2px `,`;
  border-radius: 5px;
  background-color: `,`;
  opacity: 0.5;
  position: absolute;
  top: 0;
  right: 0;
  left: 0;
  bottom: 0;
  & > span {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translateX(-50%) translateY(-50%);
  }
`])),"#666","#999"),b=t.div(v||(v=d([`
  display: flex;
  justify-content: space-between;
  flex-grow: 1;
  & > span {
    font-size: 12px;
    color: `,`;
  }
  .file-types {
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
    max-width: 100px;
  }
`],[`
  display: flex;
  justify-content: space-between;
  flex-grow: 1;
  & > span {
    font-size: 12px;
    color: `,`;
  }
  .file-types {
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
    max-width: 100px;
  }
`])),function(et){return et.error?"red":"#666"}),w=t.span(h||(h=d([`
  font-size: 14px;
  color: `,`;
  span {
    text-decoration: underline;
  }
`],[`
  font-size: 14px;
  color: `,`;
  span {
    text-decoration: underline;
  }
`])),"#666"),y=function(et){return et/1e3/1e3},z=function(et){return et===void 0?"":et.map(function(tt){return".".concat(tt.toLowerCase())}).join(",")};function L(et){var tt=et.types,rt=et.minSize,nt=et.maxSize;if(tt){var it=tt.toString(),ot="";return nt&&(ot+="size >= ".concat(nt,", ")),rt&&(ot+="size <= ".concat(rt,", ")),o("span",p({title:"".concat(ot,"types: ").concat(it),className:"file-types"},{children:it}),void 0)}return null}function C(){return o("svg",p({width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},{children:[o("path",{d:"M5.33317 6.66667H22.6665V16H25.3332V6.66667C25.3332 5.196 24.1372 4 22.6665 4H5.33317C3.8625 4 2.6665 5.196 2.6665 6.66667V22.6667C2.6665 24.1373 3.8625 25.3333 5.33317 25.3333H15.9998V22.6667H5.33317V6.66667Z",fill:"#0658C2"},void 0),o("path",{d:"M10.6665 14.6667L6.6665 20H21.3332L15.9998 12L11.9998 17.3333L10.6665 14.6667Z",fill:"#0658C2"},void 0),o("path",{d:"M25.3332 18.6667H22.6665V22.6667H18.6665V25.3333H22.6665V29.3333H25.3332V25.3333H29.3332V22.6667H25.3332V18.6667Z",fill:"#0658C2"},void 0)]}),void 0)}var H=0,k=function(et,tt,rt,nt,it){return rt?o("span",{children:"File type/size error, Hovered on types!"},void 0):o(w,{children:nt?o("span",{children:"Upload disabled"},void 0):et||tt?o(k$6,{children:[o("span",{children:"Uploaded Successfully!"},void 0)," Upload another?"]},void 0):o(k$6,{children:o(k$6,it?{children:[o("span",{children:it.split(" ")[0]},void 0)," ",it.substr(it.indexOf(" ")+1)]}:{children:[o("span",{children:"Upload"},void 0)," or drop a file right here"]},void 0)},void 0)},void 0)},E=function(et){var tt=et.name,rt=et.hoverTitle,nt=et.types,it=et.handleChange,ot=et.classes,st=et.children,at=et.maxSize,ct=et.minSize,ut=et.fileOrFiles,lt=et.onSizeError,ht=et.onTypeError,ft=et.onSelect,dt=et.onDrop,pt=et.disabled,gt=et.label,_t=et.multiple,mt=et.required,At=et.onDraggingStateChange,It=et.dropMessageStyle,Mt=_$2(null),kt=_$2(null),Ct=h$4(!1),Ut=Ct[0],Wt=Ct[1],Ft=h$4(null),Ce=Ft[0],bt=Ft[1],yt=h$4(!1),$t=yt[0],Et=yt[1],Tt=function(Dt){return nt&&!function(wt,xt){var Ke=wt.name.split(".").pop();return xt.map(function(Pe){return Pe.toLowerCase()}).includes(Ke.toLowerCase())}(Dt,nt)?(Et(!0),ht&&ht("File type is not supported"),!1):at&&y(Dt.size)>at?(Et(!0),lt&&lt("File size is too big"),!1):!(ct&&y(Dt.size)<ct)||(Et(!0),lt&&lt("File size is too small"),!1)},Pt=function(Dt){var wt=!1;if(Dt){if(Dt instanceof File)wt=!Tt(Dt);else for(var xt=0;xt<Dt.length;xt++){var Ke=Dt[xt];wt=!Tt(Ke)||wt}return!wt&&(it&&it(Dt),bt(Dt),Wt(!0),Et(!1),!0)}return!1},St=function(Dt){var wt=Dt.labelRef,xt=Dt.inputRef,Ke=Dt.multiple,Pe=Dt.handleChanges,Ht=Dt.onDrop,zt=h$4(!1),jt=zt[0],qt=zt[1],Ge=T$2(function(){xt.current.click()},[xt]),Ie=T$2(function(We){We.preventDefault(),We.stopPropagation(),H++,We.dataTransfer.items&&We.dataTransfer.items.length!==0&&qt(!0)},[]),Xe=T$2(function(We){We.preventDefault(),We.stopPropagation(),--H>0||qt(!1)},[]),Je=T$2(function(We){We.preventDefault(),We.stopPropagation()},[]),Qe=T$2(function(We){We.preventDefault(),We.stopPropagation(),qt(!1),H=0;var ur=We.dataTransfer.files;if(ur&&ur.length>0){var ar=Ke?ur:ur[0],cr=Pe(ar);Ht&&cr&&Ht(ar)}},[Pe]);return p$5(function(){var We=wt.current;return We.addEventListener("click",Ge),We.addEventListener("dragenter",Ie),We.addEventListener("dragleave",Xe),We.addEventListener("dragover",Je),We.addEventListener("drop",Qe),function(){We.removeEventListener("click",Ge),We.removeEventListener("dragenter",Ie),We.removeEventListener("dragleave",Xe),We.removeEventListener("dragover",Je),We.removeEventListener("drop",Qe)}},[Ge,Ie,Xe,Je,Qe,wt]),jt}({labelRef:Mt,inputRef:kt,multiple:_t,handleChanges:Pt,onDrop:dt});return p$5(function(){At==null||At(St)},[St]),p$5(function(){ut?(Wt(!0),bt(ut)):(kt.current&&(kt.current.value=""),Wt(!1),bt(null))},[ut]),o(g,p({overRide:st,className:"".concat(ot||""," ").concat(pt?"is-disabled":""),ref:Mt,htmlFor:tt,onClick:function(Dt){Dt.preventDefault(),Dt.stopPropagation()}},{children:[o("input",{onClick:function(Dt){Dt.stopPropagation(),kt&&kt.current&&(kt.current.value="",kt.current.click())},onChange:function(Dt){var wt=Dt.target.files,xt=_t?wt:wt[0],Ke=Pt(xt);ft&&Ke&&ft(xt)},accept:z(nt),ref:kt,type:"file",name:tt,disabled:pt,multiple:_t,required:mt},void 0),St&&o(m,p({style:It},{children:o("span",{children:rt||"Drop Here"},void 0)}),void 0),!st&&o(k$6,{children:[o(C,{},void 0),o(b,p({error:$t},{children:[k(Ce,Ut,$t,pt,gt),o(L,{types:nt,minSize:ct,maxSize:at},void 0)]}),void 0)]},void 0),st]}),void 0)};function CollapsibleContainer(et){const{children:tt,title:rt,open:nt=!1,...it}=et,[ot,st]=h$4(!nt);return o("div",{className:"collapsible",...it,children:[o("h4",{onClick:()=>st(!ot),children:o("p",{style:{color:"var(--accent-major)"},children:[ot?"\u23F5":"\u23F7"," "," "+rt]})}),!ot&&tt]})}function DownloadView(et){const{downloadManagerInstance:tt}=et,rt=useRealFiles(st=>st.realFiles),nt=useOfferStore(st=>st.requestableDownloads),it=useProgressStore(st=>st.progressQueue),ot=useUserStore(st=>st.users.filter(at=>at.active).length>0);return o(k$6,{children:tt&&o(k$6,{children:[o(CollapsibleContainer,{open:!0,className:"filelistbox",title:"Send File",children:[o(E,{multiple:!0,required:!0,handleChange:tt.addRealFiles,name:"file",accept:"*",disabled:!ot,children:o("div",{className:"uploadbox",children:"Drag & Drop files here"})}),o("div",{className:"filelistcontainer",children:rt&&Object.entries(rt).map(([st,at])=>o("div",{className:"filelistbox",children:[at.name," ",o("p",{children:[fancyBytes(at.size)," "]}),o("button",{type:"button",className:"bigbutton",style:{padding:"0.3em"},onClick:()=>tt.removeRealFile(st),children:"\u2716"}),o("hr",{})]},st))})]}),o(CollapsibleContainer,{className:"filelistbox",title:"Send Request",children:o("div",{className:"filelistcontainer",children:nt&&Object.entries(nt).map(([st,at])=>{var ut;const ct=((ut=useUserStore(lt=>lt.users.find(ht=>ht.id===st)))==null?void 0:ut.name)||"Anonymous";return at.map(({id:lt,name:ht,size:ft,ownerId:dt})=>o("div",{className:"filelistbox",style:{border:"1px solid var(--accent-major)",borderRadius:"0.5em"},children:o("div",{className:"horizontal",children:[o("h2",{children:ht}),o("div",{style:{paddingLeft:"1em",paddingRight:"1em"},children:[o("h5",{children:["sent by ",ct]}),o("p",{children:fancyBytes(ft)})]}),o("button",{onClick:()=>tt.requestFile(dt,lt),children:"Request"})]})},lt))})})}),o(CollapsibleContainer,{className:"filelistbox",title:"Active Transfers",children:o("div",{className:"filelistcontainer",children:it.map(st=>o("div",{className:`filelistbox ${st.id}`,children:[o("h5",{style:{color:"var(--accent-major)",fontWeight:"600"},children:st.toMe?` \u2190 ${st.name}`:`${st.name} \u2192`}),o("progress",{className:"progressbar",value:st.progress*100,min:"0",max:"100"})]},st.id))})})]})})}var preact$3=require$$0$1,_extends$3=Object.assign||function(et){for(var tt=1;tt<arguments.length;tt++){var rt=arguments[tt];for(var nt in rt)Object.prototype.hasOwnProperty.call(rt,nt)&&(et[nt]=rt[nt])}return et},objectWithoutProperties$3=function(et,tt){var rt={};for(var nt in et)tt.indexOf(nt)>=0||Object.prototype.hasOwnProperty.call(et,nt)&&(rt[nt]=et[nt]);return rt},ChevronLeftIcon=function et(tt){var rt=tt.color,nt=rt===void 0?"currentColor":rt,it=tt.size,ot=it===void 0?24:it;tt.children;var st=objectWithoutProperties$3(tt,["color","size","children"]),at="mdi-icon "+(st.class||st.className||"");return preact$3.h("svg",_extends$3({},st,{class:at,width:ot,height:ot,fill:nt,viewBox:"0 0 24 24"}),preact$3.h("path",{d:"M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z"}))},ChevronLeftIcon_1=ChevronLeftIcon;const ChevronLeft=getDefaultExportFromCjs(ChevronLeftIcon_1);var preact$2=require$$0$1,_extends$2=Object.assign||function(et){for(var tt=1;tt<arguments.length;tt++){var rt=arguments[tt];for(var nt in rt)Object.prototype.hasOwnProperty.call(rt,nt)&&(et[nt]=rt[nt])}return et},objectWithoutProperties$2=function(et,tt){var rt={};for(var nt in et)tt.indexOf(nt)>=0||Object.prototype.hasOwnProperty.call(et,nt)&&(rt[nt]=et[nt]);return rt},ContentCopyIcon=function et(tt){var rt=tt.color,nt=rt===void 0?"currentColor":rt,it=tt.size,ot=it===void 0?24:it;tt.children;var st=objectWithoutProperties$2(tt,["color","size","children"]),at="mdi-icon "+(st.class||st.className||"");return preact$2.h("svg",_extends$2({},st,{class:at,width:ot,height:ot,fill:nt,viewBox:"0 0 24 24"}),preact$2.h("path",{d:"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"}))},ContentCopyIcon_1=ContentCopyIcon;const Copy=getDefaultExportFromCjs(ContentCopyIcon_1),pcdLogo="/programs/ParacordDemo/logo.svg";function RoomCard(et){const{roomId:tt,leaveRoom:rt}=et;return o("div",{className:"horizontal",style:{borderBottom:"1px solid #eaeaea"},children:[o("button",{onClick:rt,children:[o(ChevronLeft,{}),"Leave"]}),o("img",{style:{height:"4em"},src:pcdLogo}),o("div",{style:{width:"100%"},children:[o("h1",{children:"Paracord"}),o("hr",{}),o("div",{className:"horizontal",children:[o("h4",{style:{paddingRight:"1em"},children:"Room ID"}),o("h2",{children:tt}),o("button",{style:{marginLeft:"auto"},onClick:()=>{navigator.clipboard.writeText(window.location.href)},children:["Copy room link ",o(Copy,{})]})]})]})]})}var preact$1=require$$0$1,_extends$1=Object.assign||function(et){for(var tt=1;tt<arguments.length;tt++){var rt=arguments[tt];for(var nt in rt)Object.prototype.hasOwnProperty.call(rt,nt)&&(et[nt]=rt[nt])}return et},objectWithoutProperties$1=function(et,tt){var rt={};for(var nt in et)tt.indexOf(nt)>=0||Object.prototype.hasOwnProperty.call(et,nt)&&(rt[nt]=et[nt]);return rt},VolumeHighIcon=function et(tt){var rt=tt.color,nt=rt===void 0?"currentColor":rt,it=tt.size,ot=it===void 0?24:it;tt.children;var st=objectWithoutProperties$1(tt,["color","size","children"]),at="mdi-icon "+(st.class||st.className||"");return preact$1.h("svg",_extends$1({},st,{class:at,width:ot,height:ot,fill:nt,viewBox:"0 0 24 24"}),preact$1.h("path",{d:"M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z"}))},VolumeHighIcon_1=VolumeHighIcon;const VolumeHigh=getDefaultExportFromCjs(VolumeHighIcon_1);var preact=require$$0$1,_extends=Object.assign||function(et){for(var tt=1;tt<arguments.length;tt++){var rt=arguments[tt];for(var nt in rt)Object.prototype.hasOwnProperty.call(rt,nt)&&(et[nt]=rt[nt])}return et},objectWithoutProperties=function(et,tt){var rt={};for(var nt in et)tt.indexOf(nt)>=0||Object.prototype.hasOwnProperty.call(et,nt)&&(rt[nt]=et[nt]);return rt},VolumeMuteIcon=function et(tt){var rt=tt.color,nt=rt===void 0?"currentColor":rt,it=tt.size,ot=it===void 0?24:it;tt.children;var st=objectWithoutProperties(tt,["color","size","children"]),at="mdi-icon "+(st.class||st.className||"");return preact.h("svg",_extends({},st,{class:at,width:ot,height:ot,fill:nt,viewBox:"0 0 24 24"}),preact.h("path",{d:"M3,9H7L12,4V20L7,15H3V9M16.59,12L14,9.41L15.41,8L18,10.59L20.59,8L22,9.41L19.41,12L22,14.59L20.59,16L18,13.41L15.41,16L14,14.59L16.59,12Z"}))},VolumeMuteIcon_1=VolumeMuteIcon;const VolumeMute=getDefaultExportFromCjs(VolumeMuteIcon_1);function MuteUserButton(et){const{isMuted:tt,toggleMuted:rt}=et;return o("div",{className:"collapsible",children:o("h4",{onClick:rt,children:o("p",{style:{color:"var(--accent-major)"},children:tt?o(VolumeMute,{}):o(VolumeHigh,{})})})})}function UserView(et){const{roomId:tt,userManagerInstance:rt}=et,nt=usePersonaStore(st=>st.persona),it=useUserStore(st=>st.users.filter(at=>at.roomId===tt&&at.active)),ot=useClientSideUserTraits();return o("div",{className:"sidebar filelistcontainer",style:{overflow:"scroll"},children:[o("h2",{style:{color:generateHexColorFromString(selfId)},children:"You"}),o("input",{type:"text",value:(nt==null?void 0:nt.name)||"Anonymous",autocapitalize:"off",autoComplete:"off",style:{width:"100%"},onfocusout:st=>st.currentTarget.value.trim()!==""&&rt.setMyName(st.currentTarget.value)}),o("p",{style:{color:"grey"},children:selfId}),o("h2",{children:"Peers"}),o("ul",{style:{listStyle:"none"},children:it.length?it.map(({name:st,id:at})=>o("li",{children:[o("h5",{className:"horizontal",style:{color:generateHexColorFromString(at)},children:[o(MuteUserButton,{toggleMuted:()=>ot.toggleMute(at),isMuted:ot.mutedUsers[at]||!1}),st]}),o("p",{style:{color:"grey"},children:at})]},at)):o("h3",{children:"Waiting..."})})]})}function MainModal(et){const{room:tt,roomId:rt,leaveRoom:nt}=et,[it]=h$4(new UserManager({room:tt,roomId:rt})),[ot]=h$4(new ChatManager({room:tt,roomId:rt})),[st]=h$4(new DownloadManager({room:tt,roomId:rt}));return p$5(()=>{it.createPersona()},[]),o(k$6,{children:[o(RoomCard,{roomId:rt,leaveRoom:nt}),o($69cb30bb0017df05$export$be92b6f5f03c0fe9,{defaultValue:"tab1",children:[o("div",{className:"horizontal",children:[o("div",{style:{width:"80%",height:"100%"},children:[o($69cb30bb0017df05$export$7c6e2c02157bb7d2,{value:"tab1",children:o(ChatView,{chatManagerInstance:ot})}),o($69cb30bb0017df05$export$7c6e2c02157bb7d2,{value:"tab2",children:o(DownloadView,{downloadManagerInstance:st})})]}),o(UserView,{roomId:rt,userManagerInstance:it})]}),o("div",{className:"bottombar",children:o($69cb30bb0017df05$export$54c2e3dc7acea9f5,{"aria-label":"tabs example",children:[o($69cb30bb0017df05$export$41fb9f06171c75f4,{className:"tabbutton",value:"tab1",title:"Chat",children:o(ChatProcessing,{})}),o($69cb30bb0017df05$export$41fb9f06171c75f4,{className:"tabbutton",value:"tab2",title:"Downloads",children:o(Download,{})})]})})]})]})}const installedTrackers=["wss://tracker.openwebtorrent.com","wss://tracker.btorrent.xyz","wss://tracker.files.fm:7073/announce","wss://qot.abiir.top:443/announce"],tradeName="paracord_chat",defaultRoomConfig={appId:tradeName,trackerUrls:installedTrackers,rtcConfig:{iceServers:[{urls:"stun:46.165.240.76:3478"},{urls:"stun:108.61.211.199:3478"},{urls:"turn:46.165.240.76:3478",credential:"asperTinO1",username:"otrto"},{urls:"turn:108.61.211.199:3478",credential:"asperTinO1",username:"otrto"}]}},RTCSupport=isRtcSupported();function RoomCreator(et){const[tt,rt]=h$4(!1),nt=_$2(null),it=_$2(null),{bootStrapRoom:ot}=et;return o(k$6,{children:[o("div",{className:"headtext horizontal",children:[o("img",{style:{height:".5em"},src:pcdLogo}),o("h1",{className:"headtext",children:"Paracord"})]}),o("div",{className:"center",children:o("div",{className:"card",children:[o("h2",{children:"Join a room"}),o("div",{className:"horizontal",children:[o("h3",{children:"PD-"}),o("input",{ref:nt,className:"textbox",name:"userInput",type:"text",autoComplete:"off",placeholder:"Room ID"}),o("button",{className:"button",onClick:()=>nt.current&&(nt.current.value=shortid$1.generate()),children:"Random"})]}),o("div",{className:"horizontal",children:[o("h3",{children:"Password(optional):"}),o("input",{ref:it,className:"textbox",name:"userInput",type:tt?"text":"password",autoComplete:"off",placeholder:"Password"}),o("button",{className:"button",onClick:()=>rt(!tt),children:tt?"Hide":"Show"})]}),o("button",{className:"button",onClick:()=>nt.current&&ot(nt.current.value,it.current?it.current.value:void 0),children:"Join"})]})})]})}function App(){const[et,tt]=h$4(null),[rt,nt]=h$4(null),it=async(ot,st)=>{if(ot&&!et){const at=await joinRoom({...defaultRoomConfig,password:st,encryptDecrypt},ot);nt(ot),tt(at),window.location.hash=`${ot}?${st}`}};return p$5(()=>{if(window.top){const ot=window.top.location.hash.slice(1).split("?");ot.length>1?it(ot[0],ot[1]):it(ot[0])}},[]),o(k$6,{children:RTCSupport?et&&rt?o(k$6,{children:o(MainModal,{room:et,roomId:rt,leaveRoom:()=>{et&&(et.leave(),tt(null),nt(null),window.location.hash="")}})}):o(RoomCreator,{bootStrapRoom:it}):o(k$6,{children:[o("div",{className:"headtext horizontal",children:[o("img",{style:{height:".5em"},src:pcdLogo}),o("h1",{className:"headtext",children:"Paracord"})]}),o("div",{className:"center",children:o("div",{className:"card",children:[o("h2",{children:"Sorry, your browser is not supported"}),o("p",{children:"Paracord uses WebRTC to connect peers, and your browser does not support it. Please use a browser that supports WebRTC, such as Google Chrome."})]})})]})})}D$3(o(App,{}),document.getElementById("app"))})()});export default An();
